\newif\ifplastex
\plastexfalse

\ifplastex
\documentclass{book}
\else
\documentclass[10pt,oneside]{amsart}
\fi

\input{preamble}

\title{EGA I}
\author{A. Grothendieck \& J. Dieudonn{\'e}}
% is this going to be the date it was last updated or the date of the original?
% \date{ }

\begin{document}

\ifplastex
\textbf{What this is.}
    This is a community translation of Grothendieck's EGA I.
    As it is a work in progress by multiple people, it will probably have a few
    mistakes --- if you spot any then please feel free to
    \href{https://github.com/ryankeleti/ega/issues}{let us know}!
    \thanks{\url{https://github.com/ryankeleti/ega}}

\noindent
    \textbf{Note.} EGA uses `prescheme' for what is now usually called
    a scheme, and `scheme' for what is now usually called a
    separated scheme.
 
    On est d{\'e}sol{\'e}s, Grothendieck.

    --- Ryan Keleti, Tim Hosgood

\else

\renewcommand{\abstractname}{What this is}
\begin{abstract}
    This is a community translation of Grothendieck's EGA I.
    As it is a work in progress by multiple people, it will probably have a few
    mistakes --- if you spot any then please feel free to
    \href{https://github.com/ryankeleti/ega/issues}{let us know}!
    \thanks{\url{https://github.com/ryankeleti/ega}}

\noindent
    \textbf{Note.} EGA uses `prescheme' for what is now usually called
    a scheme, and `scheme' for what is now usually called a
    separated scheme.
 
    On est d{\'e}sol{\'e}s, Grothendieck.

    --- Ryan Keleti, Tim Hosgood
\end{abstract}

\fi

\maketitle

%\noindent\hspace{0.15\linewidth}

{
  \hypersetup{
    linkcolor=[rgb]{0,0,0}
  }
  \tableofcontents{}
}

\clearpage

\part*{Introduction}
\label{intro-section}

\begin{flushright}
\emph{To Oscar Zariski and Andr\'e Weil.}
\end{flushright}
\medskip

\oldpage{5}This memoir, and the many others that must follow, are intended to
form a treatise on the foundations of algebraic geometry. They do not assume, in
principle, any particular knowledge of this discipline, and it has even been
that such knowledge, despite its obvious advantages, could sometimes (by the
too-exclusive habit that the birational point of view it implies) to be harmful
to the one who wants to become familiar with the point of view and techniques
presented here. However, we assume that the reader has a good knowledge of the
following topics:
\begin{itemize}
  \item[(a)] \emph{Commutative algebra}, as it is exhibited for example in
             volumes under preparation of the \emph{Elements} of N.~Bourbaki
             (and, pending the publication of these volumes, in Samuel-Zariski
             \cite{13} and Samuel \cite{11}, \cite{12}).
  \item[(b)] \emph{Homological algebra}, for which we refer to Cartan-Eilenberg
             \cite{2} (cited as (M)) and Godement \cite{4} (cited as (G)), as well
             as the recent article by A. Grothendieck \cite{6} (cited as (T)).
  \item[(c)] \emph{Sheaf Theory}, where our main references will be (G) and (T);
             this theory provides the essential language for interpreting in
             ``geometric'' terms the essential notions of commutative algebra,
             and to ``globalize'' them.
  \item[(d)] Finally, it will be useful for the reader to have some familiarity with
             \emph{functorial language}, which will be constantly used in this Treatise,
             and for which the reader may consult (M), (G), and especially (T); the
             principles of this language and the main results of the general theory of
             functors will be described in more detail in a book currently in preparation
             by the authors of this Treatise.
\end{itemize}

\asttri

It is not the place, in this Introduction, to give a more or less summarily
description from the point of view of ``schemes'' in algebraic geometry, nor the
long list of reasons which made its adoption necessary, and in particular the
systematic acceptance of nilpotent elements in the local rings of ``manifolds''
that we consider (which necessarily shifts the idea of rational mappings into
the background, in favor of those of regular mappings or ``morphisms''). This
Treatise aims precisely to systematically develop the language of schemes, and
will demonstrate, we hope, its necessity. Although it would be easy to do so,
\oldpage{6}we will not try to give here an ``intuitive'' introduction to the
notions developed in Chapter 1. For the reader who would like to have a glimpse
of the preliminary study of the subject matter of this Treatise, we refer them
to the conference by A. Grothendieck at the International Congress of
Mathematicians in Edinburgh in 1958 \cite{7}, and the expose \cite{8} of the
same author. The work \cite{14} (cited as (FAC)) of J.-P. Serre can also be
considered as an intermediary exposition between the classical point of view and
the point of view of schemes in algebraic geometry, and, as such, its reading
may be an excellent preparation to that of our \emph{Elements}.

\asttri

We give below the general outline planned for this Treatise, subject to later
modifications, especially concerning the later chapters.

\begin{tabular}{rrl}
Chapter & I. & --- The language of schemes.\\
--- & II. & --- Elementary global study of some classes of morphisms.\\
--- & III. & --- Cohomology of algebraic coherent sheaves. Applications.\\
--- & IV. & --- Local study of morphisms.\\
--- & V. & --- Elementary procedures of constructing schemes.\\
--- & VI. & --- Descent. General method of constructing schemes.\\
--- & VII. & --- Schemes of groups, principal fibre bundles.\\
--- & VIII. & --- Differential study of fibre bundles.\\
--- & IX. & --- The fundamental group.\\
--- & X. & --- Residues and duality.\\
--- & XI. & --- Theories of intersection, Chern classes, Riemann-Roch theorem.\\
--- & XII. & --- Abelian schemes and Picard schemes.\\
--- & XIII. & --- Weil cohomology.
\end{tabular}\\

\bigskip

In principal, all chapters are considered open to changes, and supplementary
paragraphs can always be added later; such paragraphs would appear in separate
fascicles in order to minimise the inconveniences accompanying whatever mode of
publication adopted. When the writing of such a paragraph is foreseen or in
progress during the publication of a chapter, it will be mentioned in the
summary of the chapter in question, even if, owing to certain orders of urgency,
\unsure{its actual publication clearly ought to have been later.} For the use of
the reader, we give in ``Chapter 0'' the necessary tools in commutative algebra,
homological algebra, and sheaf theory, that will be used throughout this
Treatise, that are more or less well known but for which it was not possible to
give convenient references. It is recommended for the reader to not read
Chapter 0 except whilst reading the Treatise proper, when the results to which
we refer \oldpage{7}seem unfamiliar. Besides, we think that in this way, the
reading of this Treatise could be a good method for the beginner to familiarise
themselves with commutative algebra and homological algebra, whose study, when
not accompanied with tangible applications, is considered tedious, or even
depressing, by many.

\asttri

It is outside of our capabilities to give a historic overview, or even a summary
thereof, of the ideas and results described. The text will contain only those
references considered particularly useful for comprehension, and we indicate the
origin only of the most important results. Formally, at least, the subjects
discussed in our work are reasonably new, which explains the scarcity of
references made to the Fathers of algebraic geometry from the 19th to the
beginning of the 20th century, whose works we know only by hear-say. It is
suitable, however, to say some words here about the works which have most
directly influenced the authors and contributed to the development of
scheme-theoretic point of view. We absolutely must mention the fundamental work
(FAC) of J.-P.~Serre first, which has served as an introduction to algebraic
geometry for more that one young student (one of the authors of this Treatise
being one), deterred by the dryness of the classic \emph{Foundations} of A.~Weil
\cite{18}. It is there that it is shown, for the first time, that the ``Zariski
topology'' of an ``abstract'' algebraic variety is perfectly suited to applying
certain techniques from algebraic topology, and notably to be able to define a
cohomology theory. Further, the definition of an algebraic variety given
therein is that which translates most naturally to the idea that we develop
here\footnote{Just as J.-P.~Serre informed us, it is right to note that the idea
of defining the structure of a manifold by the data of a sheaf of rings is due
to H.~Cartan, who took this idea as the starting point of his theory of analytic
spaces. Of course, just as in algebraic geometry, it would be important in
``analytic geometry'' to give the right to use nilpotent elements in local rings
of analytic spaces. This extension of the definition of H.~Cartan and
J.-P.~Serre has recently been broached by H.~Grauert \cite{5}, and there is room
to hope that a systematic report of analytic geometry in this setting will soon
see the light of day. It is also evident that the ideas and techniques developed
in this Treatise retain a sense of analytic geometry, even though one must
expect more considerable technical difficulties in this latter theory. We can
foresee that algebraic geometry, by the simplicity of its methods, will be able
to serve as a sort of formal model for future developments in the theory of
analytic spaces.}. Serre himself had incidentally noted that the cohomology
theory of affine algebraic varieties could translate without difficulty by
replacing the affine algebras over a field by arbitrary commutative rings.
Chapters~I and II of this Treatise, and the first two paragraphs of chapter~III,
can thus be considered, for the most part, as easy translations, in this bigger
framework, of the principal results of (FAC) and a later article of the same
author \cite{15}. We have also vastly profited from the \emph{S{\'e}minaire de
G{\'e}om{\'e}trie alg{\'e}brique} de C.~Chevalley \cite{1}; in particular, the
systematic usage of ``constructible sets'' introduced by him has turned out to
be extremely useful in the theory of schemes (cf. chap.~IV). We have also
borrowed from him the study of morphisms from \oldpage{8}the point of view of
dimension (chap.~IV), that translates with negligible change to the framework of
schemes. It also merits noting that the idea of ``schemes of local rings'',
introduced by Chevalley, naturally lends itself to being extended to algebraic
geometry (not having, however, all the flexibility and generality that we intend
to give it here); for the connections between this idea and our theory, see the
chap.~I,~\textsection~8. One such extension has been developed by M.~Nagata in
a series of memoires \cite{9}, which contain many special results concerning
algebraic geometry over Dedekind rings\footnote{Amongst the works that come
close to our point of view of algebraic geometry, we pick out the work of
E.~K{\`a}hler \cite{22} and a recent note of Chow and Igusa \cite{3}, which go
back over certain results of (FAC) in the context of Nagata-Chevalley theory, as
well as giving a K{\"u}nneth formula.}.

\asttri

It goes without saying that a book on algebraic geometry, and especially a book
dealing with the fundamentals, is of course influenced, \completelyunsure, by
mathematicians such as O.~Zariski and A.~Weil. In particular, the
\emph{Th{\'e}orie des fonctions holomorphes} de Zariski \cite{20}, properly
flexible thanks to the cohomological methods and an existence theorem
(chap.~III,~\textsection\textsection~4~and~5), is (along with the method of
descent described in chap.~VI) one of the principal tools used in this Treatise,
and it seems to us one of the most powerful at our disposal in algebraic
geometry.

The general technique in which it is employed can be sketched as follows (a
typical example of which will be given in chap.~XI, in the study of the
fundamental group). We have a proper morphism (chap.~II) $f\colon X\to Y$ of
algebraic varieties (more generally, of schemes) that we wish to study on the
neighbourhood of a point $y\in Y$, with the aim of resolving a problem $P$
relative to a neighbourhood of $y$. We follow successive steps:
\begin{itemize}
  \item[1\textsuperscript{st}]
                 We can suppose that $Y$ is affine, such that $X$ becomes a scheme
                 defined on the affine ring $A$ of $Y$, and we can even replace $A$
                 by the local ring of $y$. This reduction is always easy in practice
                 (chap.~V) and brings us to the case where $A$ is a \emph{local} ring.
  \item[2\textsuperscript{nd}]
                 We study the problem in question when $A$ is a local \emph{Artinian}
                 ring. So that the problem $P$ still makes sense when $A$ is not
                 assumed to be integral, sometimes we have to reformulate $P$, and it
                 appears that we often thus obtain a better understanding of the problem
                 during this stage, in an ``infinitesimal'' way.
  \item[3\textsuperscript{rd}]
                 The theory of formal schemes (chap.~III,~\textsection\textsection~3,~4,~and~5)
                 lets us pass from the case of an Artinian ring to a \emph{complete local ring}.
  \item[4\textsuperscript{th}]
                 Finally, if $A$ is an arbitrary local ring, considering
                 ``\unsure{multiform} sections'' of suitable schemes over $X$
                 approximates the idea of a given ``formal'' section (chap.~IV), and
                 this will let us pass, \oldpage{9}by extension of scalars to the
                 completion of $A$, from a known result (of \completelyunsure) to an
                 analogous result for a finite simple (e.g. unramified) extension of $A$.
\end{itemize}

This sketch shows the importance of the systematic study of schemes defined over
an artinien ring $A$. The point of view of Serre in his formulation of the
theory of local class fields, and the recent works of Greenberg, seem
to suggest that such a study could be undertaken by functorially attaching, to
some such scheme $X$, a scheme $X'$ over the residue field $k$ of $A$ (assumed
perfect) of dimension equal (in nice cases) to $n\dim X$, where $n$ is
the height of $A$.

As for the influence of A.~Weil, it suffices to say that it is the need to
develop the tools necessary to formulate, with full generality, the definition
of ``Weil cohomology,'' and to tackle the proof\footnote{To avoid any
misunderstanding, we point out that this task has barely been undertaken at the
moment of writing this Introduction, and still hasn't led to the proof of the
Weil conjectures.} of all the formal properties necessary to establish the
famous conjectures in diophantine geometry \cite{19}, that has been one of the
principal motivations of the writing of this Treatise, as has the desire to find
the natural setting of the usual ideas and methods of algebraic geometry, and to
give the authors the chance to understand these ideas and methods.

\asttri

To finish, we believe it useful to warn the reader that, as was the case with
all the authors themselves, they will almost certainly have difficulty before
becoming accustomed to the language of schemes, and to convince themselves that
the usual constructions that suggest geometric intuition can be translated, in
essentially only one sensible way, to this language. As in many parts of modern
mathematics, the first intuition seems further and further away, in appearance,
from the correct language needed to express the mathematics in question with
complete precision and the desired level of generality. In practice, the
psychological difficulty comes from the need to replicate some familiar
set-theoretic constructions to a category that is already quite different from
that of sets (the category of preschemes, or the category of preschemes over a
given prescheme): cartesian products, group laws, ring laws, module laws, fibre
bundles, principal homogeneous fibre bundles, etc. It will most likely
be difficult for the mathematician, in the future, to shy away from this new
effort of abstraction, maybe rather negligible, on the whole, in comparison with
that endowed by our fathers, to familiarise themselves with the Theory of Sets.

\asttri

The references are given following the numerical system; for example, in
III,~4.9.3, the III indicates the chapter, the 4 the paragraph, the 9 the
section of the paragraph. If we reference a chapter from within itself then we
omit the chapter number.

\bigskip

\oldpage{10}\emph{Page 10 in the original is left blank. [trans.]}


\clearpage

\setcounter{part}{-1}

\part{Preliminaries}
\label{0-prelim}

\section{Rings of fractions}
\label{0-prelim-1}
\setcounter{subsection}{-1}

\subsection{Rings and Algebras}
\label{0-prelim-1.0}

\begin{env}{1.0.1}
\label{env-0.1.0.1}
\oldpage{11}All the rings considered in this Treatise will have a \emph{unit element}; all the modules
on such a ring will be assumed to be \emph{unitary}; the ring homomorphisms will always be
assumed to \emph{transform the unit element into a unit element}; unless otherwise stated,
a sub-ring of a ring $A$ will be assumed to \emph{contain the unit element of} $A$. We will
consider especially \emph{commutative} rings, and when we speak of a ring without
specification, it
will be implied that it is commutative. If $A$ is a ring not necessarily commutative, by
$A$-module we will we mean a left module, unless stated otherwise.
\end{env}

\begin{env}{1.0.2}
\label{env-0.1.0.2}
Let $A$, $B$ be two rings, not necessarily commutative, $\varphi\colon A\to B$ a homomorphism.
Any left (resp. right) $B$-module $M$ can be provided with a left (resp. right) $A$-module
structure by $a\cdot m=\varphi(a)\cdot m$ (resp. $m\cdot a=m\cdot\varphi(a)$); when it will
be necessary to distinguish $M$ as an $A$-module or a $B$-module, we will denote by
$M_{[\varphi]}$ the left (resp. right) $A$-module as defined. If $L$ is an $A$-module, then
a homomorphism $u\colon L\to M_{[\varphi]}$ is a homomorphism of commutative groups such that
$u(a\cdot x)=\varphi(a)\cdot u(x)$ for $a\in A$, $x\in L$; we will also say that it is a
$\varphi$-\emph{homomorphism} $L\to M$,
and that the pair $(\varphi,u)$ (or, by misuse of langauge, $u$)
is a \emph{di-homomorphism} of $(A,L)$ in $(B,M)$. The pairs $(A,L)$ formed by a ring $A$
and an $A$-module $L$ thus form a \emph{category} for which the morphisms are
di-homomorphisms.
\end{env}

\begin{env}{1.0.3}
\label{env-0.1.0.3}
Under the hypothesis of \eref{1.0.2}, if $\mathfrak{J}$ is a left (resp. right) ideal of $A$, we
denote by $B\mathfrak{J}$ (resp. $\mathfrak{J}B$) the left (resp. right) ideal $B\varphi(\mathfrak{J})$
(resp. $\varphi(\mathfrak{J})B$) of $B$ generated by $\varphi(\mathfrak{J})$; it is also the image
of the canonical homomorphism $B\otimes_A\mathfrak{J}\to B$ (resp. $\mathfrak{J}\otimes_A B\to B$)
of left (resp. right) $B$-modules.
\end{env}

\begin{env}{1.0.4}
\label{env-0.1.0.4}
If $A$ is a (commutative) ring, $B$ a non necessarily commutative ring, the data of
a structure of an $A$-\emph{algebra} on $B$ is equivalent to the data of a ring
homomorphism $\varphi\colon A\to B$ such that $\varphi(A)$ is contained in the center of $B$.
For all ideals $\mathfrak{J}$ of $A$, $\mathfrak{J}B=B\mathfrak{J}$ is then a two-sided ideal of $B$, and
for every $B$-module $M$, $\mathfrak{J}M$ is then a $B$-module equal to $(B\mathfrak{J})M$.
\end{env}

\begin{env}{1.0.5}
\label{env-0.1.0.5}
We will not return to the notions of \emph{module of finite type} and
\emph{algebra} (commutative) \emph{of finite type}; to say that an $A$-module $M$
is of finite type means that there exists \oldpage{12}an exact sequence $A^p\to M\to 0$. We say that
an $A$-module $M$ admits a \emph{finite presentation} if it is isomorphic to the cokernel
of a homomorphism $A^p\to A^q$, in other words, there exists an exact sequence
$A^p\to A^q\to M\to 0$. We note that for a \emph{Noetherian} ring $A$, every $A$-module
of finite type admits a finite presentation.

Let us recall that an $A$-algebra $B$ is called \emph{integral} over $A$ if every element
in $B$ is a root in $B$ of a monic polynomial with coefficients in $A$; equivalently, every
element of $B$ is contained in a subalgebra of $B$ which is an $A$-\emph{module of finite type}.
When this is so, and $B$ is commutative, the subalgebra of $B$ generated by a finite part of
$B$ is an $A$-module of finite type; for a commutative algebra $B$ to be integral and of finite
type over $A$, it is necessary and therefore sufficient that $B$ be an $A$-module of finite
type; we also say that $B$ is an \emph{integral} $A$-\emph{algebra of finite type} (or
simply \emph{finite} if there is no confusion). It will be observed that in these definitions,
it is not assumed that the homomorphism $A\to B$ defining the structure of an $A$-algebra
is injective.
\end{env}

\begin{env}{1.0.6}
\label{env-0.1.0.6}
An \emph{integral domain} is a ring in which the product of a finite family of elements
$\neq 0$ is $\neq 0$; equivalently, in such a ring we have $0\neq 1$ and the product of
two elements $\neq 0$ is non zero. A \emph{prime} ideal of a ring $A$ is an ideal $\mathfrak{p}$
such that $A/\mathfrak{p}$ is integral; this therefore entails $\mathfrak{p}\neq A$. For a ring $A$ to
have at least one prime ideal, it is necessary and sufficent that $A\neq\{0\}$.
\end{env}

\begin{env}{1.0.7}
\label{env-0.1.0.7}
A \emph{local} ring is a ring $A$ in which there exists a single maximal ideal, which is then
the complement of the invertible elements and contains all the ideals $\neq A$. If $A$ and $B$
are two local rings, $\mathfrak{m}$ and $\mathfrak{n}$ their respective maximal ideals, we say that a
homomorphism $\varphi\colon A\to B$ is \emph{local} if $\varphi(\mathfrak{m})\subset\mathfrak{n}$ (or, equivalently,
$\varphi^{-1}(\mathfrak{n})=\mathfrak{m}$). By passing to quotients, such a homomorphism then defines
a momomorphism of the residue field $A/\mathfrak{m}$ into the residue field $B/\mathfrak{n}$. The
composition of two local homomorphisms is a local homomorphism.
\end{env}

\subsection{Radical of an ideal. Nilradical and radical of a ring}
\label{0-prelim-1.1}

\begin{env}{1.1.1}
\label{env-0.1.1.1}
Let $\mathfrak{a}$ be an ideal of a ring $A$; the \emph{radical} of $\mathfrak{a}$, denoted
by $\rad(\mathfrak{a})$, is the set of $x\in A$ such that $x^n\in\mathfrak{a}$ for
an integer $n>0$; it is an ideal containing $\mathfrak{a}$. We have
$\rad(\mathfrak{r}(\mathfrak{a}))=\rad(\mathfrak{a})$; the relation
$\mathfrak{a}\subset\mathfrak{b}$ leads to $\rad(\mathfrak{a})\subset\rad(\mathfrak{b})$;
the radical of a finite intersection of ideals is the intersection of their radicals. If $\varphi$
is a homomorphism of a ring $A'$ into $A$, then we have
$\rad(\varphi^{-1}(\mathfrak{a}))=\varphi^{-1}(\rad(\mathfrak{a}))$
for any ideal $\mathfrak{a}\subset A$. For an ideal to be the radical of an ideal,
it is necessary and sufficient that it be an intersection of prime ideals. The radical of an
ideal $\mathfrak{a}$ is the intersection of the
\emph{minimal} prime ideals among those containing $\mathfrak{a}$; if $A$ is
Noetherian, these minimal prime ideals are finite in number.

The radical of the ideal $(0)$ is also called the \emph{nilradical} of $A$; it is the set
$\nilrad$ of the nilpotent elements of $A$. It is said that the ring $A$ is \emph{reduced} if
$\nilrad=(0)$; for every ring $A$, the quotient $A/\nilrad$ of $A$ by its nilradical is a
reduced ring.
\end{env}

\begin{env}{1.1.2}
\label{env-0.1.1.2}
Recall that the \emph{nilradical} $\nilrad(A)$ of a ring $A$ (not necessarily commutative) is the
intersection of the maximal left ideals of $A$ (and also the intersection of maximal
right ideals). The nilradical of $A/\nilrad(A)$ is $(0)$.
\end{env}

\subsection{Modules and rings of fractions}
\label{0-prelim-1.2}

\begin{env}{1.2.1}
\label{env-0.1.2.1}
We say that a subset $S$ of a ring $A$ is \emph{multiplicative} if $1\in S$ and if the product of two elements of
\oldpage{13}We say that a part $S$ of a ring $A$ is \emph{multiplicative} if $1\in S$ and if the product of two elements of
$S$ is in $S$. The examples which will be the most important for the following are:
1\textsuperscript{st} the set $S_f$Â of powers $f^n$ ($n\geq 0$) of an element $f\in A$;
2\textsuperscript{nd} the complement $A-\mathfrak{p}$ of a \emph{prime} ideal $\mathfrak{p}$ of $A$.
\end{env}

\begin{env}{1.2.2}
\label{env-0.1.2.2}
Let $S$ be a multiplicative subset of a ring $A$, $M$ an $A$-module; in the set $M\times S$, the relation between
couples $(m_1,s_1)$, $(m_2,s_2)$:
\begin{center}
   ``There exists $s\in S$ such that $s(s_1 m_2-s_2 m_1)=0$''
\end{center}
is an equivalence relation. We denote by $S^{-1}M$ the quotient set of $M\times S$ by this relation, by $m/s$ the canonical
image in $S^{-1}M$ of the pair $(m,s)$; we call the \emph{canonical} mapping of $M$ in $S^{-1}M$ the mapping $i_M^S\colon m\mapsto m/1$
(also denoted $i^S$). This mapping is generally neither injective nor surjective; its kernel is the set of $m\in M$ such that there
exists an $s\in S$ for which $sm=0$.

On $S^{-1}M$ we define an additive group law by taking
\[
  (m_1/s_1)+(m_2/s_2)=(s_2 m_1+s_1 m_2)/(s_1 s_2)
\]
(we check that it is independent of the expressions of the elements of $S^{-1}M$ considered). On $S^{-1}A$ we further define
a multiplicative law by taking $(a_1/s_1)(a_2/s_2)=(a_1 a_2)/(s_1 s_2)$, and finally an external law on $S^{-1}M$, having
$S^{-1}A$ as a set of operators, by setting $(a/s)(m/s')=(am)/(ss')$. It is thus verified that $S^{-1}A$ is provided with a
ring structure (called \emph{the ring of fractions of} $A$, \emph{with denominators in} $S$) and $S^{-1}M$ the structure of
an $S^{-1}A$-module (called \emph{the  module of fractions of} $M$, \emph{with denominators in} $S$); for all $s\in S$,
$s/1$ is invertible in $S^{-1}A$, its inverse being $1/s$. The canonical mapping $i_A^S$ (resp. $i_M^S$) is a homomorphism
of rings (resp. a homomorphism of $A$-modules, $S^{-1}M$ being considered $A$-module by means of the homomorphism
$i_A^S\colon A\to S^{-1}A$).
\end{env}

\begin{env}{1.2.3}
\label{env-0.1.2.3}
If $S_f=\{f^n\}_{n\geq 0}$ for a $f\in A$, we write $A_f$ and $M_f$ instead of $S_f^{-1}A$ and $S_f^{-1}M$; when $A_f$ is
considered as algebra over $A$, we can write $A_f=A[1/f]$. $A_f$ is isomorphic to the quotient algebra $A[T]/(fT-1)A[T]$.
When $f=1$, $A_f$ and $M_f$ identify canonically with $A$ and $M$; if $f$ is niipotent, $A_f$ and $M_f$ are reduced to $0$.
When $S=A-\mathfrak{p}$, where $\mathfrak{p}$ is a prime ideal of $A$, we write $A_\mathfrak{p}$ and $M_\mathfrak{p}$ instead of $S^{-1}A$ and $S^{-1}M$;
$A_\mathfrak{p}$ is a \emph{local ring} whose maximal ideal $\mathfrak{q}$ is generated by $i_A^S(\mathfrak{p})$, and we have
$(i_A^S)^{-1}(\mathfrak{q})=\mathfrak{p}$; by passing to the quotients, $i_A^S$ gives a monomorphism of the integral domains $A/\mathfrak{p}$ into the
field $A_\mathfrak{p}/\mathfrak{q}$, which identifies with the field of fractions of $A/\mathfrak{p}$.
\end{env}

\begin{env}{1.2.4}
\label{env-0.1.2.4}
The ring of fractions $S^{-1}A$ and the canonical homomorphism $i_A^S$ are a solution of a \emph{universal mapping problem}:
any homomorphism $u$ of $A$ into a ring $B$ such that $u(S)$ is composed of \emph{invertible} elements in $B$ factorizes in
one way
\[
  u\colon A\xrightarrow{i_A^S}S^{-1}A\xrightarrow{u^\ast}B
\]
\oldpage{14}where $u^\ast$ is a ring homomorphism. Under the same hypotheses, let $M$ be an
$A$-module, $N$ a $B$-module, $v\colon M\to N$ a homomorphism of $A$-modules (for the
$B$-module structure on $N$ defined by $u\colon A\to B$); then $v$ is factorizes in a single
way
\[
  v\colon M\xrightarrow{i_M^S}S^{-1}M\xrightarrow{v^\ast}N
\]
where $v^\ast$ is a homomorphism of $S^{-1}A$-modules (for the $S^{-1}A$-module structure 
on $N$ defined by $u^\ast$).
\end{env}

\begin{env}{1.2.5}
\label{env-0.1.2.5}
We define a canonical isomorphism $S^{-1}A\otimes_A M\xrightarrow{\sim}S^{-1}M$ of $S^{-1}A$-
modules, sending the element $(a/s)\otimes m$ to the element $(am)/s$, the isomorphism
reciprocally applying $m/s$ to $(1/s)\otimes m$.
\end{env}

\begin{env}{1.2.6}
\label{env-0.1.2.6}
For each ideal $\mathfrak{a}'$ of $S^{-1}A$, $\mathfrak{a}=(i_A^S)^{-1}(\mathfrak{a}')$ is an ideal of $A$, and $\mathfrak{a}'$
is the ideal of $S^{-1}A$ generated by $i_A^S(\mathfrak{a})$, which identifies with $S^{-1}\mathfrak{a}$ \eref{1.3.2}. The map
$\mathfrak{p}'\to(i_A^S)^{-1}(\mathfrak{p}')$ is an isomorphism, for the structure order, of the set of \emph{prime} ideals
of $S^{-1}A$ to the set of prime ideals $\mathfrak{p}$ of $A$ such that $\mathfrak{p}\cap S=\emp$. In addition, the local rings
$A_{\mathfrak{p}}$ and $(S^{-1}A)_{S^{-1}\mathfrak{p}}$ are canonically isomorphic \eref{1.5.1}.
\end{env}

\begin{env}{1.2.7}
\label{env-0.1.2.7}
When $A$ is an \emph{integral domain}, for which $K$ denotes its field of fractions, the canonical mapping $i_A^S\colon A\to S^{-1}A$
is injective for any multiplicative subset $S$ not containing $0$, and $S^{-1}A$ then identifies canonically with a subring of $K$
containing $A$. In particular, for every prime ideal $\mathfrak{p}$ of $A$ , $A_\mathfrak{p}$ is a local ring containing $A$,
with maximal ideal $\mathfrak{p}A_\mathfrak{p}$, and we have $\mathfrak{p}A_\mathfrak{p}\cap A=\mathfrak{p}$.
\end{env}

\begin{env}{1.2.8}
\label{env-0.1.2.8}
If $A$ is a \emph{reduced} ring \eref{1.1.1}, so is $S^{-1}A$: indeed, if $(x/s)^n=0$ for $x\in A$, $s\in S$, it means that
there exists $s'\in S$ such that $s'x^n=0$, hence $(s'x)^n=0$, which, by hypothesis, entails $s'x=0$, so $x/s=0$.
\end{env}

\subsection{Functorial properties}
\label{0-prelim-1.3}

\begin{env}{1.3.1}
\label{env-0.1.3.1}
Let $M$, $N$ be two $A$-modules, $u$ an $A$-homomorphism $M\to N$. If $S$ is a multiplicative subset of $A$,
we define a $S^{-1}A$-homomorphism $S^{-1}M\to S^{-1}N$, denoted by $S^{-1}u$, by putting
$S^{-1}u(m/s)=u(m)/s$; if $S^{-1}M$ and $S^{-1}N$ are canonically identified with $S^{-1}A\otimes_A M$ and
$S^{-1}A\otimes_A N$ \eref{1.2.5}, $S^{-1}u$ is considered as $1\otimes u$. If $P$ is a third $A$-module,
$v$ an $A$-homomorphism $N\to P$, we have $S^{-1}(v\circ u)=(S^{-1}v)\circ(S^{-1}u)$; in other words,
$S^{-1}M$ is a \emph{covariant functor in} $M$, of the category of $A$-modules into that of $S^{-1}A$-modules
($A$ and $S$ being fixed).
\end{env}

\begin{env}{1.3.2}
\label{env-0.1.3.2}
The functor $S^{-1}M$ is \emph{exact}; in other words, if the following
\[
  M\xrightarrow{u}N\xrightarrow{v}P
\]
is exact, so is the following
\[
  S^{-1}M\xrightarrow{S^{-1}u}S^{-1}N\xrightarrow{S^{-1}v}S^{-1}P.
\]
In particular, if $u\colon M\to N$ is injective (resp. surjective), the same is true for $S^{-1}u$;
\oldpage{15} if $N$ and $P$ are two
submodules of $M$, $S^{-1}N$ and $S^{-1}P$ identify canonically with submodules of $S^{-1}M$, and we have
\[
  S^{-1}(N+P)=S^{-1}N+S^{-1}P\quad\text{and}\quad S^{-1}(N\cap P)=(S^{-1}N)\cap(S^{-1}P).
\]
\end{env}

\begin{env}{1.3.3}
\label{env-0.1.3.3}
Let $(M_\alpha,\varphi_{\beta\alpha})$ be an inductive system of $A$-modules; then
$(S^{-1}M_\alpha,S^{-1}\varphi_{\beta\alpha})$ is an inductive system of $S^{-1}A$-modules.
Expressing the $S^{-1}M_\alpha$ and $S^{-1}\varphi_{\beta\alpha}$ as tensor products (\eref{1.2.5} and \eref{1.3.1}),
it follows from the permutability of tensor product and inductive limit operations that we have a canonical isomorphism
\[
  S^{-1}\varinjlim M_\alpha\xrightarrow{\sim}\varinjlim S^{-1}M_\alpha
\]
which is further expressed by saying that the functor $S^{-1}M$ (in $M$) \emph{commutes with inductive limits}.
\end{env}

\begin{env}{1.3.4}
\label{env-0.1.3.4}
Let $M$, $N$ be two $A$-modules; there is a canonical \emph{functorial} isomorphism (in $M$ and $N$)
\[
  (S^{-1}M)\otimes_{S^{-1}A}(S^{-1}N)\xrightarrow{\sim}S^{-1}(M\otimes_A N)
\]
which transforms $(m/s)\otimes(n/t)$ into $(m\otimes n)/st$.
\end{env}

\begin{env}{1.3.5}
\label{env-0.1.3.5}
We also have a \emph{functorial} homomorphism (in $M$ and $N$)
\[
  S^{-1}\Hom_A(M,N)\longrightarrow\Hom_{S^{-1}A}(S^{-1}M,S^{-1}N)
\]
which, at $u/s$, corresponds to the homomorphism $m/t\mapsto u(m)/st$. When $M$ has a finite presentation, the
preceding homomorphism is an \emph{isomorphism}: it is immediate when $M$ is of the form $A^r$, and goes on to the general
case starting from the following exact sequence $A^p\to A^q\to M\to 0$, and using the exactness of the functor $S^{-1}M$ and
the left-exactness of the functor $\Hom_A(M,N)$ in $M$. Note that this case always occurs when $A$ is \emph{Noetherian} and the
$A$-module $M$ is \emph{of finite type}.
\end{env}

\subsection{Change of multiplicative subset}
\label{0-prelim-1.4}

\begin{env}{1.4.1}
\label{env-0.1.4.1}
Let $S$, $T$ be two multiplicative subsets of a ring $A$ such that $S\subset T$; there exists a canonical
homomorphism $\rho_A^{T,S}$ (or simply $\rho^{T,S}$) of $S^{-1}A$ into  $T^{-1}A$, sending the
element denoted $a/s$ of $S^{-1}A$ to the element denoted $a/s$ in $T^{-1}A$; we have
${i_A^T=\rho_A^{T,S}\circ i_A^S}$. For every $A$-module $M$, there exists in the same way an
$S^{-1}A$-linear map of $S^{-1}M$ into $T^{-1}M$ (the latter considered as an $S^{-1}A$-module thanks
to the homomorphism $\rho_A^{T,S}$), which matches the element $m/s$ of $S^{-1}M$ to the element $m/s$
of $T^{-1}M$; we note that the map $\rho_M^{T,S}$, or simply $\rho^{T,S}$, and we still have
$i_M^T=\rho_M^{T,S}\circ i_M^S$; in canonical identification \eref{1.2.5}, $\rho_M^{T,S}$ identifies with
$\rho_A^{T,S}\otimes 1$. The homomorphism $\rho_M^{T,S}$ is a \emph{functorial morphism} (or natural
transformation) of the functor $S^{-1}M$ into the functor $T^{-1}M$, in other words, the diagram
\[
  \xymatrix{
  S^{-1}M\ar[r]^{S^{-1}u}\ar[d]_{\rho_M^{T,S}} & S^{-1}N\ar[d]^{\rho_N^{T,S}}\\
  T^{-1}M\ar[r]^{T^{-1}u} & T^{-1}N
  }
\]
\oldpage{16}is commutative, for every homomorphism $u\colon M\to N$; $T^{-1}u$ is entirely determined by
$S^{-1}u$, because for $m\in M$ and $t\in T$, we have
\[
  (T^{-1}u)(m/t)=(t/1)^{-1}\rho^{T,S}((S^{-1}u)(m/1)).
\]
\end{env}

\begin{env}{1.4.2}
\label{env-0.1.4.2}
With the same notation, for two $A$-modules $M$, $N$, the diagrams (cf. \eref{1.3.4} and \eref{1.3.5})
\[
  \xymatrix{
    (S^{-1}M)\otimes_{S^{-1}A}(S^{-1}N)\ar[r]^\sim \ar[d] & S^{-1}(M\otimes_A N)\ar[d] & &
    S^{-1}\Hom_A(M,N)\ar[r]\ar[d] & \Hom_{S^{-1}A}(S^{-1}M,S^{-1}N)\ar[d]\\
    (T^{-1}M)\otimes_{T^{-1}A}(T^{-1}N)\ar[r]^\sim & T^{-1}(M\otimes_A N) & &
    T^{-1}\Hom_A(M,N)\ar[r] & \Hom_{T^{-1}A}(T^{-1}M,T^{-1}N)
  }
\]
are commutative.
\end{env}

\begin{env}{1.4.3}
\label{env-0.1.4.3}
There is an important case in which the homomorphism $\rho^{T,S}$ is \emph{bijective},
we know that then every element of $T$ is divisor of an element of $S$; we then identify by
$\rho^{T,S}$ the modules $S^{-1}M$ and $T^{-1}M$. We say that $S$ is \emph{saturated} if every divisor
in $A$ of an element of $S$ is in $S$; by replacing $S$ with  the set $T$ of all the divisors of the
elements of $S$ (a set which is multiplicative and saturated), we see that we can always, if we wish,
be limited to the consideration of modules of fractions $S^{-1}M$, where $S$ is saturated.
\end{env}

\begin{env}{1.4.4}
\label{env-0.1.4.4}
If $S$, $T$, $U$ are three multiplicative subsets of $A$ such that $S\subset T\subset U$, we have
\[
  \rho^{U,S}=\rho^{U,T}\circ\rho^{T,S}.
\]
\end{env}

\begin{env}{1.4.5}
\label{env-0.1.4.5}
Consider an \emph{increasing filtered family} $(S_\alpha)$ of multiplicative subsets of $A$
(we write $\alpha\leq\beta$ for $S_\alpha\subset S_\beta$), and let $S$ be the multiplicative subset
$\bigcup_\alpha S_\alpha$; let us put $\rho_{\beta\alpha}=\rho_A^{S_\beta,S_\alpha}$ for $\alpha\leq\beta$;
according to \eref{1.4.4}, the homomorphisms $\rho_{\beta\alpha}$ define a ring $A'$ as the \emph{inductive limit}
of the inductive system of rings $(S_\alpha^{-1}A,\rho_{\beta\alpha})$. Let $\rho_\alpha$ be the canonical
map $S_\alpha^{-1}A\to A'$, and let $\varphi_\alpha=\rho_A^{S,S_\alpha}$; as
$\varphi_\alpha=\varphi_\beta\circ\rho_{\beta\alpha}$ for $\alpha\leq\beta$ according to
\eref{1.4.4}, we can uniquely define a homomorphism $\varphi\colon A'\to S^{-1}A$ such that the diagram
\[
  \xymatrix{
    & S_\alpha^{-1}A\ar[ddl]_{\rho_\alpha}\ar[d]^{\rho_{\beta\alpha}}\ar[rdd]^{\varphi_\alpha}\\
    & S_\beta^{-1}A\ar[ld]^{\rho_\beta}\ar[rd]_{\varphi_\beta} & & (\alpha\leq\beta)\\
    A' \ar[rr]_\varphi & & S^{-1}A
  }
\]
is commutative. In fact, $\varphi$ is an \emph{isomorphism}; it is indeed immediate by construction that
$\varphi$ is surjective. On the other hand, if $\rho_\alpha(a/s_\alpha)\in A'$ is such that
${\varphi(\rho_\alpha(a/s_\alpha))=0}$, this means that $a/s_\alpha=0$ in $S^{-1}A$, that is, to say that
there exists $s\in S$ such that $sa=0$; but there is a $\beta\geq\alpha$ such that $s\in S_\beta$, and
consequently, as $\rho_\alpha(a/s_\alpha)=\rho_\beta(sa/ss_\alpha)=0$, we find that $\varphi$ is injective.
The case for an $A$-module $M$ is treated likewise, and thus we have defined canonical isomorphisms
\[
  \varinjlim S_\alpha^{-1}A\xrightarrow{\sim}(\varinjlim S_\alpha)^{-1}A,\quad
  \varinjlim S_\alpha^{-1}M\xrightarrow{\sim}(\varinjlim S_\alpha)^{-1}M,
\]
the second being \emph{functorial} in $M$.
\end{env}

\begin{env}{1.4.6}
\label{env-0.1.4.6}
\oldpage{17}Let $S_1$, $S_2$ be two multiplicative subsets of $A$; then $S_1 S_2$ is also a multiplicative subset
of $A$. Let us denote by $S_2'$ the canonical image of $S_2$ in the ring $S_1^{-1}A$, which is a multiplicative
subset of this ring. For every $A$-module $M$ there is then a functorial isomorphism
\[
  {S_2'}^{-1}(S_1^{-1}M)\xrightarrow{\sim}(S_1 S_2)^{-1}M
\]
which maps $(m/s_1)/(s_2/1)$ to the element $m/(s_1 s_2)$.
\end{env}

\subsection{Change of ring}
\label{0-prelim-1.5}

\begin{env}{1.5.1}
\label{env-0.1.5.1}
Let $A$, $A'$ be two rings, $\varphi$ a homomorphism $A'\to A$, $S$ (resp. $S'$)
a multiplicative subset of $A$ (resp. $A'$), such that $\varphi(S')\subset S$; the
composition homomorphism $\smash{A'\xrightarrow{\varphi} A\to S^{-1}A}$ factors as
$\smash{A'\to{S'}^{-1}\xrightarrow{\varphi^{S'}} S^{-1}A}$ by virtue of \eref{1.2.4};
where $\varphi^{S'}(a'/s')=\varphi(a')/\varphi(s')$. If $A=\varphi(A')$ and
$S=\varphi(S')$, $\varphi^{S'}$ is \emph{surjective}. If $A'=A$ and if $\varphi$
is the identity, $\varphi^{S'}$ is none other than the homomorphism $\rho_A^{S,S'}$
defined in \eref{1.4.1}.
\end{env}

\begin{env}{1.5.2}
\label{env-0.1.5.2}
Under the hypothesis of \eref{1.5.1}, let $M$ be an $A$-module. There exists a canonical
functorial morphism
\[
  \sigma\colon{S'}^{-1}(M_{[\varphi]})\longrightarrow(S^{-1}M)_{[\varphi^{S'}]}
\]
of ${S'}^{-1}A'$-modules, sending each element $m/s'$ of ${S'}^{-1}(M_{[\varphi]})$ to
the element $m/\varphi(s')$ of $(S^{-1}M)_{[\varphi^{S'}]}$; in fact, we verify
immediately that this definition does not depend on the expression $m/s'$ of the element
considered. \emph{When} $S=\varphi(S')$, the homomorphism $\sigma$ is \emph{bijective}.
When $A'=A$ and $\varphi$ is the identity, $\sigma$ is none other than the homomorphism
$\rho_M^{S,S'}$ defined in \eref{1.4.1}.

When $M=A$ is taken in particular, the homomorphism $\varphi$ defines on $A$ an $A'$-algebra
structure; ${S'}^{-1}(A_{[\varphi]})$ is then provided with a ring structure, for which it
identifies with $(\varphi(S'))^{-1}A$, and the homomorphism
${\sigma\colon{S'}^{-1}(A_{[\varphi]})\to S^{-1}A}$ is a homomorphism of ${S'}^{-1}A'$-algebras.
\end{env}

\begin{env}{1.5.3}
\label{env-0.1.5.3}
Let $M$ and $N$ be two $A$-modules; by composing the homomorphisms defined in \eref{1.3.4} and
\eref{1.5.2}, we obtain a homomorphism
\[
  (S^{-1}M\otimes_{S^{-1}A}S^{-1}N)_{[\varphi^{S'}]}\longleftarrow{S'}^{-1}((M\otimes A)_{[\varphi]})
\]
which is an isomorphism when $\varphi(S')=S$. Similarly, by composing the homorphisms in \eref{1.3.5}
and \eref{1.5.2}, we obtain a homomorphism
\[
  {S'}^{-1}((\Hom_A(M,N))_{[\varphi]})\longrightarrow(\Hom_{S^{-1}A}(S^{-1}M,S^{-1}N))_{[\varphi^{S'}]}
\]
which is an isomorphism when $\varphi(S')=S$ and $M$ admits a finite presentation.
\end{env}

\begin{env}{1.5.4}
\label{env-0.1.5.4}
Let us now consider an $A'$-module $N'$, and form the tensor product $N'\otimes_{A'}A_{[\varphi]}$,
which can be considered as an $A$-module by setting $a\cdot(n'\otimes b)=n'\otimes(ab)$. There is a
functorial isomorphism of $S^{-1}A$-modules
\[
  \tau\colon({S'}^{-1}N')\otimes_{{S'}^{-1}A'}(S^{-1}A)_{[\varphi^{S'}]}
  \xrightarrow{\sim}S^{-1}(N'\otimes_{A'}A_{[\varphi]})
\]
\oldpage{18}which maps the element $(n'/s')\otimes(a/s)$ to the element $(n'\otimes a)/(\varphi(s')s)$;
indeed, we verify separately that when we replace $n'/s'$ (resp. $a/s$) by another expression of the
same element, $(n'\otimes a)/(\varphi(s')s)$ does not change; on the other hand, we can define a
reciprocal homomorphism of $\tau$ by sending $(n'\otimes a)/s$ to the element $(n'/1)\otimes(a/s)$:
we use the fact that $S^{-1}(N'\otimes_{A'}A_{[\varphi]})$ is canonically isomorphic to
$(N'\otimes_{A'}A_{[\varphi]})\otimes_A S^{-1}A$ \eref{1.2.5}, so also to $N'\otimes_{A'}(S^{-1}A)_{[\psi]}$,
denoting by $\psi$ the composite homomorphism $a'\mapsto\varphi(a')/1$ of $A'$ into $S^{-1}A$.
\end{env}

\begin{env}{1.5.5}
\label{env-0.1.5.5}
If $M'$ and $N'$ are two $A'$-modules, by composing the isomorphisms \eref{1.3.4} and \eref{1.5.4}, we obtain
an isomorphism
\[
  {S'}^{-1}M\otimes_{{S'}^{-1}A'}{S'}^{-1}N'\otimes_{{S'}^{-1}A'}S^{-1}A
  \xrightarrow{\sim}S^{-1}(M'\otimes_{A'}N'\otimes_{A'}A).
\]
Likewise, if $M'$ admits a finite presentation, we have by \eref{1.3.5} and \eref{1.5.4} an isomorphism
\[
  \Hom_{{S'}^{-1}A'}({S'}^{-1}M',{S'}^{-1}N')\otimes_{{S'}^{-1}A'}S^{-1}A
  \xrightarrow{\sim}S^{-1}(\Hom_{A'}(M',N')\otimes_{A'}A).
\]
\end{env}

\begin{env}{1.5.6}
\label{env-0.1.5.6}
Under the hypothesis of \eref{1.5.1}, let $T$ (resp. $T'$) be a second multiplicative subset of $A$
(resp. $A'$) such that $S\subset T$ (resp. $S'\subset T'$) and $\varphi(T')\subset T$. Then the diagram
\[
  \xymatrix{
    {S'}^{-1}A'\ar[r]^{\varphi^{S'}}\ar[d]_{\rho^{T',S'}} & S^{-1}A\ar[d]^{\rho^{T,S}}\\
    {T'}^{-1}A'\ar[r]^{\varphi^{T'}} & T^{-1}A
  }
\]
is commutative. If $M$ is an $A$-module, the diagram
\[
  \xymatrix{
    {S'}^{-1}(M_{[\varphi]})\ar[r]^\sigma\ar[d]_{\rho^{T',S'}} &
    (S^{-1}M)_{[\varphi^{S'}]}\ar[d]^{\rho^{T,S}}\\
    {T'}^{-1}(M_{[\varphi]})\ar[r]^\sigma & (T^{-1}M)_{[\varphi^{T'}]}
  }
\]
is commutative. Finally, if $N'$ is an $A'$-module, the diagram
\[
  \xymatrix{
    ({S'}^{-1}N')\otimes_{{S'}^{-1}A'}(S^{-1}A)_{[\varphi^{S'}]}\ar[r]^\sim_\tau\ar[d] &
    S^{-1}(N'\otimes_{A'}A_{[\varphi]})\ar[d]^{\rho^{T,S}}\\
    ({T'}^{-1}N')\otimes_{{T'}^{-1}A'}(T^{-1}A)_{[\varphi^{T'}]}
    \ar[r]^\sim_\tau & T^{-1}(N'\otimes_{A'}A_{[\varphi]})
  }
\]
is commutative, the left vertical arrow obtained by applying
$\rho_{N'}^{T',S'}$ to ${S'}^{-1}N'$ and $\rho_A^{T,S}$ to $S^{-1}A$.
\end{env}

\begin{env}{1.5.7}
\label{env-0.1.5.7}
\oldpage{19}Let $A''$ be a third ring, $\varphi'\colon A''\to A'$ a ring homomorphism,
$S''$ a multiplicative subset of $A''$ such that $\varphi'(S'')\subset S'$. Set
$\varphi''=\varphi\circ\varphi'$; then we have
\[
  {\varphi''}^{S''}=\varphi^{S'}\circ{\varphi'}^{S''}.
\]
Let $M$ be an $A$-module; evidently we have $M_{[\varphi'']}=(M_{[\varphi]})_{[\varphi']}$;
if $\sigma'$ and $\sigma''$ are the homomorphisms defined by $\varphi'$ and $\varphi''$ as
$\sigma$ is defined in \eref{1.5.2} by $\varphi$, we have the transitivity formula
\[
  \sigma''=\sigma\circ\sigma'.
\]

Finally, let $N''$ be an $A''$-module; the $A$-module $N''\otimes_{A''}A_{[\varphi'']}$
identifies canonically with
$(N''\otimes_{A''}{A'}_{[\varphi']})\otimes_{A'}A_{[\varphi]}$,
and likewise the $S^{-1}A$-module
${({S''}^{-1}N'')\otimes_{{S''}^{-1}A''}(S^{-1}A)_{[{\varphi''}^{S''}]}}$ identifies
canonically with
$(({S''}^{-1}N'')$ \smash{$\otimes_{{S''}^{-1}A''}({S'}^{-1}A')_{[{\varphi'}^{S''}]})
  \otimes_{{S'}^{-1}A'}(S^{-1}A)_{[\varphi^{S'}]}$}. With these identifications, if $\tau'$
and $\tau''$ are the isomorphisms defined by $\varphi'$ and $\varphi''$ as $\tau$ is defined
in \eref{1.5.4} by $\varphi$, we have the transitivity formula
\[
  \tau''=\tau\circ(\tau'\otimes 1).
\]
\end{env}

\begin{env}{1.5.8}
\label{env-0.1.5.8}
Let $A$ be a subring of a ring $B$; for every \emph{minimal} prime ideal $\mathfrak{p}$ of $A$, there
exists a minimal prime ideal $\mathfrak{q}$ of $B$ such that $\mathfrak{p}=A\cap\mathfrak{q}$. Indeed, $A_\mathfrak{p}$
is a subring of $B_\mathfrak{p}$ \eref{1.3.2} and has \emph{a single} prime ideal $\mathfrak{p}'$ \eref{1.2.6}; since
$B_\mathfrak{p}$ is not reduced to $0$, it has at least one prime ideal $\mathfrak{q}'$ and we have
necessarily $\mathfrak{q}'\cap A_\mathfrak{p}=\mathfrak{p}'$; the prime ideal $\mathfrak{q}_1$ of $B$, a reciprocal image
of $\mathfrak{q}'$ is thus such that $\mathfrak{q}_1\cap A=\mathfrak{p}$, and $\emph{a fortiori}$ we have
$\mathfrak{q}\cap A=\mathfrak{p}$ for every minimal prime ideal $\mathfrak{q}$ of $B$ contained in $\mathfrak{q}_1$.
\end{env}

\subsection{Indentification of the module $M_f$ as an inductive limit}
\label{0-prelim-1.6}

\begin{env}{1.6.1}
\label{env-0.1.6.1}
Let $M$ be an $A$-module, $f$ an element of $A$. Consider a sequence
$(M_n)$ of $A$-modules, all identical to $M$, and for each pair of integers
$m\leq n$, let $\varphi_{nm}$ be the homomorphism $z\mapsto f^{n-m}z$ of $M_m$
into $M_n$; it is immediate that $((M_n),(\varphi_{nm}))$ is an \emph{inductive system}
of $A$-modules; let $N=\varinjlim M_n$ be the inductive limit of this system. We define
a canonical $A$-isomorphism, \emph{functorial} of $N$ on $M_f$. For this reason, let us
note that, for all $n$, $\theta_n\colon z\mapsto z/f^n$ is an $A$-homomorphism of $M=M_n$ into
$M_f$, and it follows from the definitions that we have $\theta_n\circ\varphi_{nm}=\theta_m$
for $m\leq n$. There exists therefore an $A$-homomorphism $\theta\colon N\to M_f$ such that, if
$\varphi_n$ denotes the canonical homomorphism $M_n\to N$, we have $\theta_n=\theta\circ\varphi_n$
for all $n$. Since, by hypothesis, every element of $M_f$ is of the form $z/f^n$ for at least $n$,
it is clear that $\theta$ is surjective. On the other hand, if $\theta(\varphi_n(z))=0$,
in other words $z/f^n=0$, there exists an integer $k>0$ such that $f^k z=0$, so $\varphi_{n+k,n}(z)=0$,
which results in $\varphi_n(z)=0$. We can therefore identify $M_f$ and $\varinjlim M_n$ by means
of $\theta$.
\end{env}

\begin{env}{1.6.2}
\label{env-0.1.6.2}
Now write $M_{f,n}$, $\varphi_{nm}^f$ and $\varphi_n^f$ instead of $M_n$, $\varphi_{nm}$ and
$\varphi_n$. Let $g$ be a second element of $A$. As $f^n$ divides $f^n g^n$, we have a functorial
homomorphism
\[
  \rho_{fg,f}\colon M_f\longrightarrow M_{fg}\quad(\eref{1.4.1}\text{ and }\eref{1.4.3});
\]
\oldpage{20}if we indentify $M_f$ and $M_{fg}$ with $\varinjlim M_{f,n}$ and $\varinjlim M_{fg,n}$
respectively, $\rho_{fg,f}$ identifies with the \emph{inductive limit} of the maps
$\rho_{fg,f}^n\colon M_{f,n}\to M_{fg,n}$, defined by $\rho_{fg,f}^n(z)=g^n z$. Indeed, this follows
immediately from the commutivity of the diagram
\[
  \xymatrix{
    M_{f,n}\ar[r]^{\rho_{fg,f}^n}\ar[d]_{\varphi_n^f} & M_{fg,n}\ar[d]^{\varphi_n^{fg}}\\
    M_f\ar[r]^{\rho_{fg,f}} & M_{fg}.
  }
\]
\end{env}

\subsection{Support of a module}
\label{0-prelim-1.7}

\begin{env}{1.7.1}
\label{env-0.1.7.1}
Given an $A$-module $M$, we call the \emph{support} of $M$ and denote by $\Supp(M)$
the set of prime ideals $\mathfrak{p}$ of $A$ such that $M_\mathfrak{p}\neq 0$. For $M=0$, it
is necessary and sufficient that $\Supp(M)=\emp$, because if $M_\mathfrak{p}=0$ for all
$\mathfrak{p}$, the annihilator of an element $x\in M$ cannot be contained in any prime
ideal of $A$, so $A$ is \unsure{total}.
\end{env}

\begin{env}{1.7.2}
\label{env-0.1.7.2}
If $0\to N\to M\to P\to 0$ is an exact sequence of $A$-modules, we have
\[
  \Supp(M)=\Supp(N)\cup\Supp(P)
\]
because for every prime ideal $\mathfrak{p}$ of $A$, the sequence
${0\to N_\mathfrak{p}\to M_\mathfrak{p}\to P_\mathfrak{p}\to 0}$ is exact \eref{1.3.2} and for
$M_\mathfrak{p}=0$, it is necessary and sufficient that $N_\mathfrak{p}=P_\mathfrak{p}=0$.
\end{env}

\begin{env}{1.7.3}
\label{env-0.1.7.3}
If $M$ is the sum of a family $(M_\lambda)$ of submodules, $M_\mathfrak{p}$ is the sum
of $(M_\lambda)_\mathfrak{p}$ for every prime ideal $\mathfrak{p}$ of $A$ (\eref{1.3.3} and \eref{1.3.2}),
so $\Supp(M)=\bigcup_\lambda\Supp(M_\lambda)$.
\end{env}

\begin{env}{1.7.4}
\label{env-0.1.7.4}
If $M$ is an $A$-module \emph{of finite type}, $\Supp(M)$ is the set of prime
ideals \emph{containing the annihilator of} $M$. Indeed, if $M$ is cyclic and
generated by $x$, say that $M_\mathfrak{p}=0$ means that there exists $s\not\in\mathfrak{p}$
such that $s\cdot x=0$, so that $\mathfrak{p}$ does not contain the annihilator of $x$.
If now $M$ admits a finite system $(x_i)_{1\leq i\leq n}$ of generators and if
$\mathfrak{a}_i$ is the annihilator of $x_i$, it follows from \eref{1.7.3} that $\Supp(M)$
is th set of $\mathfrak{p}$ containing one of $\mathfrak{a}_i$, or, equivalently, the
set of $\mathfrak{p}$ containing $\mathfrak{a}=\bigcap_i\mathfrak{a}_i$, which is the annihilator
of $M$.
\end{env}

\begin{env}{1.7.5}
\label{env-0.1.7.5}
If $M$ and $N$ are two $A$-modules \emph{of finite type}, we have
\[
  \Supp(M\otimes_A N)=\Supp(M)\cap\Supp(N).
\]
It can be seen that if $\mathfrak{p}$ is a prime ideal of $A$, the condition
$M_\mathfrak{p}\otimes_{A_\mathfrak{p}}N_\mathfrak{p}\neq 0$ is equivalent to
``$M_\mathfrak{p}\neq 0$ and $N_\mathfrak{p}\neq 0$'' (taking into account \eref{1.3.4}). In
other words, it is about seeing that if $P$, $Q$ are two modules of finite type
over a \emph{local} ring $B$, not reduced to $0$, then $P\otimes_B Q\neq 0$. Let
$\mathfrak{m}$ be the maximal ideal of $B$. By virtue of Nakayama's lemma, the vector
spaces $P/\mathfrak{m}P$ and $Q/\mathfrak{m}Q$ are not reduced to $0$, so it is the same with
the tensor product
$(P/\mathfrak{m}P)\otimes_{B/\mathfrak{m}}(Q/\mathfrak{m}Q)=(P\otimes_B Q)\otimes_B(B/\mathfrak{m})$,
hence the conclusion.

In particular, if $M$ is an $A$-module of finite type, $\mathfrak{a}$ an ideal of $A$,
$\Supp(M/\mathfrak{a}M)$ is the set of prime ideals containing both $\mathfrak{a}$ and the
annihilator $\mathfrak{n}$ of $M$ \eref{1.7.4}, that is, the set of prime ideals containing
$\mathfrak{a}+\mathfrak{n}$.
\end{env}

\section{Irreducible spaces. Noetherian spaces}
\label{0-prelim-2}

\subsection{Irreducible spaces}
\label{0-prelim-2.1}

\begin{env}{2.1.1}
\label{env-0.2.1.1}
\oldpage{21}We say that a topological space $X$ is \emph{irreducible} if it is nonempty and
if it is not a union of two distinct closed subspaces of $X$. It is the same to say
that $X\neq\emp$ and that the intersection of two nonempty open sets (and consequently
of a finite number of open sets) of $X$ is nonempty, or that every nonempty open set
is everywhere dense, or that any closed subset is \unsure{\emph{rare}}, or finally
that all open sets of $X$ are \emph{connected}.
\end{env}

\begin{env}{2.1.2}
\label{env-0.2.1.2}
For a subspace $Y$ of a topological space $X$ to be irreducible, it is necessary and
sufficient that its closure $\overline{Y}$ be irreducible. In particular, any subspace
which is the closure $\overline{\{x\}}$ of a singleton is irreducible;
we will express the relation $y\in\overline{\{x\}}$ (equivalent to
$\overline{\{y\}}\subset\overline{\{x\}}$) by saying that there is a \emph{specialization of}
$x$ or that there is a \emph{generalization of} $y$. When there exists in an irreducible
space $X$ a point $x$ such that $X=\overline{\{x\}}$, we will say that $x$ is a
\emph{generic point} of $X$. Any nonempty open subset of $X$ then contains $x$, and any
subspace containing $x$ admits $x$ for a generic point.
\end{env}

\begin{env}{2.1.3}
\label{env-0.2.1.3}
Recall that a \emph{Kolmogoroff space} is a topological space $X$ satisfying the axiom
of separation:

$(T_0)$ If $x\neq y$ are any two points of $X$, there is an open set containing one of
the points $x$, $y$ and not the other.

If an irreducible Kolmogoroff space admits a generic point, it admits \emph{only} one
since a nonempty open set contains any generic point.

Recall that a topological space $X$ is said to be \emph{quasicompact} if, from any
collection of open sets of $X$, one can extract a finite cover of $X$ (or, equivalently,
if any decreasing filter family of nonempty closed sets has a nonempty intersection). If
$X$ is a quasicompact space, then any nonempty closed subset $A$ of $X$ contains a \emph{minimal}
nonempty closed set $M$, because the set of nonempty closed subsets of $A$ is inductive for
the relation $\supset$; if in addition $X$ is a Kolmogoroff space, $M$ is necessarily reduced
to a single point (or, as we say by abuse of language, is a \emph{closed point}).
\end{env}

\begin{env}{2.1.4}
\label{env-0.2.1.4}
In an irreducible space $X$, every nonempty open subspace $U$ is irreducible, and if $X$
admits a generic point $x$, $x$ is also a generic point of $U$.

Let $(U_\alpha)$ be a cover (whose set of indices is nonempty) of a topological space $X$,
consisting of nonempty open sets; if $X$ is irreducible, it is necessary and sufficient that
$U_\alpha$ is irreducible for all $\alpha$, and that $U_\alpha\cap U_\beta\neq\emp$ for any
$\alpha$, $\beta$. The condition is clearly necessary; to the that it is sufficient, it suffices
to prove that if $V$ is a nonempty open subset of $X$, then $V\cap U_\alpha$ is nonempty for all
$\alpha$, since then $V\cap U_\alpha$ is dense in $U_\alpha$ for all $\alpha$, and consequently
$V$ is dense in $X$. Now there is at least one index $\gamma$ such that $V\cap U_\gamma\neq\emp$,
so $V\cap U_\gamma$ is dense in $U_\gamma$, and as for all $\alpha$, $U_\alpha\cap V_\alpha\neq\emp$,
we also have $V\cap U_\alpha\cap U_\gamma\neq\emp$.
\end{env}

\begin{env}{2.1.5}
\label{env-0.2.1.5}
\oldpage{22}Let $X$ be an irreducible space, $f$ a continuous map of $X$ into a topological space $Y$.
Then $f(X)$ is irreducible, and if $x$ is a generic point of $X$, $f(x)$ is a generic point of
$f(X)$ and hence also of $\overline{f(X)}$. In particular, if in addition $Y$ is irreducible and
with a single generic point $y$, for $f(X)$ to be everywhere dense, it is necessary and sufficient
that $f(x)=y$.
\end{env}

\begin{env}{2.1.6}
\label{env-0.2.1.6}
Any irreducible subspace of a topological space $X$ is contained
in a maximal irreducible subspace, which is necessarily closed.
Maximal irreducible subspaces of $X$ are called the \emph{irreducible components} of $X$.
If $Z_1$, $Z_2$ are two irreducible components distinct from the space $X$, $Z_1\cap Z_2$ is a closed
\unsure{\emph{rare}} set in each of the subspaces $Z_1$, $Z_2$; in particular, if an irreducible component
of $X$ admits a generic point \eref{2.1.2} such a point can not belong to any other
irreducible component. If $X$ has only a \emph{finite} number of irreducible 
components $Z_i$ ($1\leq i\leq n$), and if, for each $i$,we put $U_i=Z_i\cap\mathrm{C}(\bigcup_{j\neq i}Z_j)$,
the $U_i$ are open, irreducible, \unsure{disjoint}, and their union is dense in $X$.
Let $U$ be an open subset of a topological space $X$. If $Z$ is an irreducible subset of $X$
that intersects with $U$, $Z\cap U$ is open and dense in $Z$, thus irreducible; conversely, for any irreducible
closed subset $Y$ of $U$, the closure $\overline{Y}$ of $Y$ in $X$ is irreducible and $\overline{Y}\cap U=Y$.
We conclude that there is a \emph{bijective correspondence} between the irreducible components of $U$ and the
irreducible components of $X$ which intersect $U$.
\end{env}

\begin{env}{2.1.7}
\label{env-0.2.1.7}
If a topological space $X$ is a union of a \emph{finite} number of irreducible closed subspaces $Y_i$, the
irreducible components of $X$ are the maximal elements of the set of $Y_i$, because if $Z$ is an irreducible
closed subset of $X$, $Z$ is the union of $Z\cap Y_i$, from which one sees that $Z$ must be contained in one
of the $Y_i$. Let $Y$ be a subspace of a topological space $X$, and suppose that $Y$ has only a finite number
of irreducible components $Y_i$, ($1\leq i\leq n$); then the closures $\overline{Y_i}$ in $X$ are the
irreducible components of $Y$.
\end{env}

\begin{env}{2.1.8}
\label{env-0.2.1.8}
Let $Y$ be an irreducible space admitting a single generic point $y$.
Let $X$ be a topological space, $f$ a continuous mapping from $X$ to $Y$. Then, for
any irreducible component $Z$ of $X$ intersecting $f^{-1}(y)$, $f(Z)$ is dense in $Y$. The
converse is not necessarily true; however, if $Z$ has a generic point $z$,
and if $f(Z)$ is dense in $Y$, we must have $f(z)=y$ \eref{2.1.5}; in addition, $Z\cap f^{-1}(y)$
is then the closure of $\{z\}$ in $f^{-1}(y)$ and is therefore irreducible, and like any
irreducible subset of $f^{-1}(y)$ containing $z$ is necessarily contained in $Z$ \eref{2.1.6}, $z$ is
a generic point of $Z\cap f^{-1}(y)$. As any irreducible component of $f^{-1}(y)$ is
contained in an irreducible component of $X$, we see that if any irreducible component
$Z$ of $X$ intersecting $f^{-1}(y)$ admits a generic point, then there is a \emph{bijective correspondence}
between all these components and all the irreducible components
$Z\cap f^{-1}(y)$ of $f^{-1}(y)$, the generic points of $Z$ being identical to those of $Z\cap f^{-1}(y)$.
\end{env}

\subsection{Noetherian spaces}
\label{0-prelim-2.2}

\begin{env}{2.2.1}
\label{env-0.2.2.1}
\oldpage{23}We say that a topological space $X$ is \emph{Noetherian} if the set of open
subsets of $X$ satisfies the \emph{maximal} condition, or, equivalently, if the set of closed
subsets of $X$ satisfies the \emph{minimal} condition. We say that $X$ is
\emph{locally Noetherian} if all $x\in X$ admit a neighborhood which is a Noetherian subspace.
\end{env}

\begin{env}{2.2.2}
\label{env-0.2.2.2}
Let $E$ be an ordered set satisfying the \emph{minimal} condition, and let $\mathbf{P}$ be a
property of the elements of $E$ subject to the following condition: if $a\in E$ is such that
for any $x<a$, $\mathbf{P}(x)$ is true, then $\mathbf{P}(a)$ is true. Under these conditions,
$\mathbf{P}(x)$ \emph{is true for all} $x\in E$
(``principle of Noetherian recurrence''). Indeed, let $F$ be the set of $x\in E$ for
which $\mathbf{P}(x)$ is false; if $F$ were not empty, it would have a minimal element $a$,
and as then $\mathbf{P}(x)$ is true for all $x<a$, $\mathbf{P}(a)$ would be true, which is
a contradiction.

We will apply this principle in particular when $E$ is a
\emph{set of closed subsets of a Noetherian space}.
\end{env}

\begin{env}{2.2.3}
\label{env-0.2.2.3}
Any subspace of a Noetherian space is Noetherian. Conversely,
any topological space that is a finite union of Noetherian subspaces is Noetherian.
\end{env}

\begin{env}{2.2.4}
\label{env-0.2.2.4}
Any Noetherian space is quasicompact; conversely, any  topological space in which all
open sets are quasicompact is Noetherian.
\end{env}

\begin{env}{2.2.5}
\label{env-0.2.2.5}
A Noetherian space has only a \emph{finite} number of irreducible components,
as we see by Noetherian recurrence.
\end{env}

\section{Supplement on sheaves}
\label{0-prelim-3}

\subsection{Sheaves with values in a category}
\label{0-prelim-3.1}

\begin{env}{3.1.1}
\label{env-0.3.1.1}
Let $\K$ be a category, $(A_\alpha)_{\alpha\in I}$,
$(A_{\alpha\beta})_{(\alpha,\beta)\in I\times I}$ two families of objects
of $\K$ such that $A_{\beta\alpha}=A_{\alpha\beta}$,
$(\rho_{\alpha\beta})_{(\alpha,\beta)\in I\times I}$ a family of morphisms
$\rho_{\alpha\beta}\colon A_\alpha\to A_{\alpha\beta}$. We say that a pair formed by
an object $A$ of $\K$ and a family of morphisms $\rho_\alpha\colon A\to A_\alpha$ 
is a \emph{solution to the universal problem} defined by the data of the families
$(A_\alpha)$, $(A_{\alpha\beta})$, and $(\rho_{\alpha\beta})$ if, for every object $B$
of $\K$, the mapping which, at all $f\in\Hom(B,A)$ matches the
family $(\rho_\alpha\circ f)\in\prod_\alpha\Hom(B,A_\alpha)$ is a \emph{bijection}
of $\Hom(B,A)$ to the set of all $(f_\alpha)$ such that
$\rho_{\alpha\beta}\circ f_\alpha=\rho_{\beta\alpha}\circ f_\beta$ for any pair of
indices $(\alpha,\beta)$. If such a solution exists, it is unique up to an isomorphism.
\end{env}

\begin{env}{3.1.2}
\label{env-0.3.1.2}
We will not recall the defintion of a \emph{presheaf} $U\mapsto\sheaf{F}(U)$ on a
topological space $X$ with values in a category $\K$ (G, I, 1.9); we say that
such a presheaf is a \emph{sheaf with values in} $\K$ if it satifies the following
axiom:\\

(F) \emph{For any covering $(U_\alpha)$ of an open set $U$ of $X$ by open sets
   $U_\alpha$ contained in $U$, if we denote by $\rho_\alpha$ (resp. $\rho_{\alpha\beta}$) the
   restriction morphism}
   \[
     \sheaf{F}(U)\to\sheaf{F}(U_\alpha)\quad(\text{\emph{resp. }}\sheaf{F}(U_\alpha)\to\sheaf{F}(U_\alpha\cap U_\beta)),
   \]
   \oldpage{24}\emph{the pair formed by $\sheaf{F}(U)$ and the family $(\rho_\alpha)$ are a solution to
   the universal problem for $(\sheaf{F}(U_\alpha))$, $(\sheaf{F}(U_\alpha\cap U_\beta))$, and $(\rho_{\alpha\beta})$
   in} \eref{3.1.1}\footnote{This is a special case of the more general notion of a
   \emph{projective limit} (non-filtered) (\emph{see} (T, I, 1.8) and the book in
   preparation announced in the Introduction).}.\\

Equivalently, we can say that, for each object $T$ of $\K$, the family
$U\mapsto\Hom(T,\sheaf{F}(U))$ is a \emph{sheaf of sets}.
\end{env}

\begin{env}{3.1.3}
\label{env-0.3.1.3}
Assume that $\K$ is the category defined by a ``type of structure
with morphisms" $\Sigma$, the objects of $\K$ being the sets with structures
of type $\Sigma$ and morphisms those of $\Sigma$. Suppose that the category $\K$ also satisfies
the following condition:\\

(E) If $(A,(\rho_\alpha))$ is a solution of a universal mapping problem \emph{in the category} $\K$
for families $(A_\alpha)$, $(A_{\alpha\beta})$, $(\rho_{\alpha\beta})$, then it is also a solution of the
universal mapping problem for the same families \emph{in the category of sets} (that is, when we
consider $A$, $A_\alpha$, and $A_{\alpha\beta}$ as sets, $\rho_\alpha$ and $\rho_{\alpha\beta}$ as functions)
\footnote{It can be proved that it also means that the canonical functor $\K\to(\mathrm{Ens})$
\emph{commutes with projective limits} (not necessarily filtered).}.\\

Under these conditions, the condition (F) gives that, when considered as a presheaf
\emph{of sets}, $U\mapsto\sheaf{F}(U)$ is a \emph{sheaf}. In addition, for a map $u\colon T\to\sheaf{F}(U)$
to be a morphism of $\K$, it is necessary and sufficient, under (F), that each map $\rho_\alpha\circ u$
is a morphism $T\to\sheaf{F}(U_\alpha)$, which means that the structure of type $\Sigma$ on $\sheaf{F}(U)$
is the \emph{initial structure} for the morphisms $\rho_\alpha$ . Conversely, suppose a presheaf
$U\mapsto\sheaf{F}(U)$ on $X$, with values in $\K$, is a \emph{sheaf of sets} and satisfies the previous
condition; it is then clear that it satisfies (F), so it is a \emph{sheaf with values in} $\K$.
\end{env}

\begin{env}{3.1.4}
\label{env-0.3.1.4}
When $\Sigma$ is a type of a group or ring structure, the fact that
the presheaf $U\mapsto\sheaf{F}(U)$ with values in $\K$ is a sheaf of \emph{sets} leads \emph{ipso facto}
that it is a sheaf with values in $\K$ (in other words, a sheaf of groups or rings
within the meaning of (G))\footnote{This is because in the category $\K$, any morphism that is a
\emph{bijection} (as a map of sets) is an \emph{isomorphism}. This is no longer true when $\K$
is the category of topological spaces, for example.}. But it is not the same when, for example,
$\K$ is the category of \emph{topological rings} (with morphisms as continuous homomorphisms): a sheaf
with values in $\K$ is a sheaf of rings $U\mapsto\sheaf{F}(U)$ such that for any open $U$
and any covering of $U$ by open sets $U_\alpha\subset U$, the topology of the ring $\sheaf{F}(U)$
is to be \emph{the least fine}, making the homomorpisms $\sheaf{F}(U)\to\sheaf{F}(U_\alpha)$ continuous. We will say in
this case that $U\mapsto\sheaf{F}(U)$, considered as a sheaf of rings (without a topology), is
\emph{underlying} the sheaf of topological rings $U\mapsto\sheaf{F}(U)$. Morphisms $u_V\colon\sheaf{F}(V)\to\sheaf{G}(V)$
($V$ an arbitrary open subset of $X$) of sheaves of topological rings are therefore homomorphisms of the
underlying sheaves of rings, such that $u_V$ be \emph{continuous} for all
open $V\subset X$; to distinguish them from any homomorphisms of the sheaves
of the underlying rings, we will call them continuous homomorphisms of sheaves of topological rings.
We have similar definitions and conventions for sheaves of topological spaces or topological groups.
\end{env}

\begin{env}{3.1.5}
\label{env-0.3.1.5}
\oldpage{25}It is clear that for any category $\K$, if there is a presheaf (respectively a
sheaf) $\sheaf{F}$ on $X$ with values in $\K$ and $U$ is an open set of $X$, the $\sheaf{F}(V)$ for
open $V\subset U$ constitute a presheaf (or a sheaf) with values in $\K$, which we call
the presheaf (or sheaf) \emph{induced} by $\sheaf{F}$ on $U$ and denote it by $\sheaf{F}|U$.

For any morphism $u\colon\sheaf{F}\to\sheaf{G}$ of presheaves on $X$ with values in $\K$, we
denote by $u|U$ the morphism $\sheaf{F}|U\to\sheaf{G}|U$ formed by the $u_V$ for $V\subset U$.
\end{env}

\begin{env}{3.1.6}
\label{env-0.3.1.6}
Suppose now that the category $\K$ admits \emph{inductive limits} (T, 1.8);
then, for any presheaf (and in particular any sheaf) $\sheaf{F}$ on $X$ with
values in $\K$ and all $x\in X$, we can define the \emph{stalk} $\sheaf{F}_x$ as the object of $\K$ defined
by the inductive limit of the $\sheaf{F}(U)$ with respect to the filtering set
(for $\supset$) of the open neighborhoods $U$ of $x$ in $X$, and for the morphisms $\rho_U^V\colon\sheaf{F}(V)\to\sheaf{F}(U)$.
If $u\colon\sheaf{F}\to\sheaf{G}$ is a morphism of presheaves with values in $\K$, we define for all
$x\in X$ the morphism $u_x\colon\sheaf{F}_x\to\sheaf{G}_x$ as the inductive limit of $u_U\colon\sheaf{F}(U)\to\sheaf{G}(U)$ with respect to all
open neighborhoods of $x$; we thus define $\sheaf{F}_x$ as a covariant functor in $\sheaf{F}$, with values in $\K$, for
all $x\in X$.

When $\K$ is further defined by a kind of structure with morphisms $\Sigma$,
we call \emph{sections over $U$} of a \emph{sheaf} $\sheaf{F}$ with values in $\K$ the elements
of $\sheaf{F}(U)$, and we write $\Gamma(U,\sheaf{F})$ instead of $\sheaf{F}(U)$; for $s\in\Gamma(U,\sheaf{F})$, $V$ an open set
contained in $U$, we write $s|V$ instead of $\rho_V^U(s)$; for all $x\in U$, the canonical image
of $s$ in $\sheaf{F}_x$ is the \emph{germ} of $s$ at the point $x$, denoted by $s_x$ (\emph{we will never replace
the notation $s(x)$ in this sense,} this notation being reserved for another notion relating to sheaves
which will be considered in this Treaty \eref{5.5.1}).

If then $u\colon\sheaf{F}\to\sheaf{G}$ is a morphism of sheaves with values in $\K$, we will write $u(s)$
instead of $u_V(s)$ for all $s\in\Gamma(U,\sheaf{F})$.

If $\sheaf{F}$ is a sheaf of commutative groups, or rings, or modules, we say
that the set of $x\in X$ such that $\sheaf{F}_x\neq\{0\}$ is the \emph{support} of $\sheaf{F}$, denoted
$\Supp(\sheaf{F})$; this set is not necessarily closed in $X$.

When $\K$ is defined by a type of structure with morphisms, \emph{we
systematically refrain from using the point of view of ``{\'e}tal{\'e} spaces''} in terms of
relating to sheaves with values in $\K$; in other words, we will never consider
a sheaf as a topological space (nor even as the whole union of its
fibers), and we will not consider also a morphism $u\colon\sheaf{F}\to\sheaf{G}$ of such sheaves
on $X$ as a continuous map of topological spaces.
\end{env}

\subsection{Presheaves on an open basis}
\label{0-prelim-3.2}

\begin{env}{3.2.1}
\label{env-0.3.2.1}
We will restrict to the following categories $\K$ admitting
\emph{projective limits} (generalized, that is, corresponding to not necessarily filtered preordered sets,
cf. (T, 1.8)). Let $X$ be a topological space, $\mathfrak{B}$ an open basis
for the topology of $X$. We will call a \emph{presheaf on $\mathfrak{B}$, with values in $\K$,} to be
a family of objects $\sheaf{F}(U)\in\K$, corresponding to each $U\in\mathfrak{B}$, and a family of morphisms
$\rho_U^V\colon\sheaf{F}(V)\to\sheaf{F}(U)$ defined for any pair $(U,V)$ of elements of $\mathfrak{B}$ such that $U\subset V$,
\oldpage{26}with the conditions $\rho_U^U=$ identity and $\rho_U^W=\rho_U^V\circ\rho_V^W$ if $U$, $V$, $W$ in
$\mathfrak{B}$ are such that $U\subset V\subset W$. We can associate a \emph{presheaf with values in} $\K$: $U\mapsto\sheaf{F}(U)$
in the ordinary sense, taking for all open $U$, $\sheaf{F}'(U)=\varprojlim\sheaf{F}(V)$, where $V$ runs through
the ordered set (for $\subset$, \emph{not filtered} in general) of $V\in\mathfrak{B}$ sets such that $V\subset U$, since
the $\sheaf(V)$ form a projective system for the $\rho_V^W$ ($V\subset W\subset U$, $V\in\mathfrak{B}$, $W\in\mathfrak{B}$).
Indeed, if $U$, $U'$ are two open sets of $X$ such that $U\subset U'$, we define ${\rho'}_U^{U'}$ as the
projective limit (for $V\subset U$) of the canonical morphisms $\sheaf{F}'(U')\to\sheaf{F}(V)$, in other words
the unique morphism y $\sheaf{F}'(U')\to\sheaf{F}'(U)$, which, when composed with the canonical morphisms
$\sheaf{F}'(U)\to\sheaf{F}(V)$, gives the canonical morphisms $\sheaf{F}'(U')\to\sheaf{F}(V)$; the verification of
the transitivity of ${\rho'}_U^{U'}$ is then immediate. Moreover, if $U\in\mathfrak{B}$,
the canonical morphism $\sheaf{F}'(U)\to\sheaf{F}(U)$ is an isomorphism, allowing to identify these two objects
\footnote{
If $X$ is a \emph{Noetherian} space, we can still define $\sheaf{F}'(U)$ and show that it is a presheaf (in the
ordinary sense) when one supposes only that $\K$ admits projective limits for \emph{finite} projective systems. Indeed,
if $U$ is any open set of $X$, there is a \emph{finite} covering $(V_i)$ of $U$ formed by sets of $\mathfrak{B}$; for every
couple $(i,j)$ of indices, let $(V_{ijk})$ be a finite covering of $V_i\cap V_j$ formed by sets of $\mathfrak{B}$. Let $I$ be the set
of $i$ and triples $(i,j,k)$, ordered only by the relations $i>(i,j,k)$, $j>(i,j,k)$; we then take $\sheaf{F}'(U)$ to be
the projective limit of the system of $\sheaf{F}(V_i)$ and $\sheaf{F}(V_{ijk})$; it is easy to verify that this does not depend on the
coverings $(V_i)$ and $(V_{ijk})$ and that $U\mapsto\sheaf{F}'(U)$ is a presheaf.}.
\end{env}

\begin{env}{3.2.2}
\label{env-0.3.2.2}
For the presheaf $\sheaf{F}'$ thus defined to be a \emph{sheaf}, it is necessary and sufficient
that the presheaf $\sheaf{F}$ on $\mathfrak{B}$ satisfies the condition:\\

  (F$_0$) \emph{For any covering $(U_\alpha)$ of $U\in\mathfrak{B}$ by sets $U_\alpha\in\mathfrak{B}$
  contained in $U$, and for any object $T\in\K$, the map which takes $f\in\Hom(T,\sheaf{F}(U))$
  to the family $(\rho_{U_\alpha}^U\circ f)\in\prod_\alpha\Hom(T,\sheaf{F}(U_\alpha))$ is a bijection of
  $\Hom(T,\sheaf{F}(U))$ on the set of all $(f_\alpha)$ such that $\rho_V^{U_\alpha}\circ f_\alpha=\rho_V^{U_\beta}\circ f_\beta$
  for any pair of indices $(\alpha,\beta)$ and any $V\in\mathfrak{B}$ such that $V\subset U_\alpha\cap U_\beta$
  \footnote{It also means that the pair formed by $\sheaf{F}(U)$ and the $\rho_\alpha=\rho_{U_\alpha}^U$
  is a \emph{solution to the universal problem} defined in \eref{3.1.1} by the data of $A_\alpha=\sheaf{F}(U_\alpha)$,
  $A_{\alpha\beta}=\prod\sheaf{F}(V)$ (for $V\in\mathfrak{B}$ such that $V\subset U_\alpha\cap U_\beta$) and
  $\rho_{\alpha\beta}=(\rho_V'')\colon\sheaf{F}(U_\alpha)\to\prod\sheaf{F}(V)$ defined by the condition that for
  $V\in\mathfrak{B}$, $V'\in\mathfrak{B}$, $W\in\mathfrak{B}$, $V\cup V'\subset U_\alpha\cap U_\beta$,
  $W\subset V\cap V'$, $\rho_W^V\circ\rho_V''=\rho_W^{V'}\circ\rho_{V'}''$.}.}\\

The condition is obviously necessary. To show that it is sufficient,
consider first a second basis $\mathfrak{B}'$ of the topology of $X$, \emph{contained in} $\mathfrak{B}$, and
show that if $\sheaf{F}''$ denotes the presheaf induced by the subfamily $(\sheaf{F}(V))_{V\in\mathfrak{B}'}$, $\sheaf{F}''$ is
\emph{canonically isomorphic} to $\sheaf{F}'$. Indeed, firstly the projective limit (for $V\in\mathfrak{B}'$,
$V\subset U$) canonical morphisms ${\sheaf{F}'(U)\to\sheaf{F}(V)}$ is a morphism ${\sheaf{F}'(U)\to\sheaf{F}''(U)}$
for all open $U$. If $U\in\mathfrak{B}$, this morphism is an isomorphism, because by hypothesis
the canonical morphisms ${\sheaf{F}''(U)\to\sheaf{F}(V)}$ for $V\in\mathfrak{B}'$, $V\subset U$, factorize into
${\sheaf{F}''(U)\to\sheaf{F}(U)\to\sheaf{F}(V)}$, and it is immediate to see that the composition of morphisms
${\sheaf{F}(U)\to\sheaf{F}''(U)}$ and ${\sheaf{F}''(U)\to\sheaf{F}(U)}$ thus defined are the identities. This being so, for
all open $U$, the morphisms ${\sheaf{F}''(U)\to\sheaf{F}''(W)=\sheaf{F}(W)}$ for $W\in\mathfrak{B}$ and $W\subset U$ satisfy
the conditions characterizing the projective limit of $\sheaf{F}(W)$ ($W\in\mathfrak{B}$, $W\subset U$), which demonstrates
our assertion given the uniqueness of a projective limit up to isomorphism.

This posed, let $U$ be any open set of $X$, $(U_\alpha)$ a covering of $U$ by
the open sets contained in $U$, and $\mathfrak{B}'$ the subfamily of $\mathfrak{B}$ formed by the sets
\oldpage{27}of $\mathfrak{B}$ contained in at least $U_\alpha$; it is clear that $\mathfrak{B}'$ is still a basis
of the topology of $X$, so $\sheaf{F}'(U)$ (resp. $\sheaf{F}''(U_\alpha)$) is the projective limit of $\sheaf{F}(V)$ for $V\in\mathfrak{B}'$
and $V\subset U$ (resp., $V\subset U_\alpha$), the axiom (F) is then immediately verified by virtue of the definition of the
projective limit.

When (F$_0$) is satisfied, we will say by abuse of language that the presheaf $\sheaf{F}$ on the basis $\mathfrak{B}$ is a sheaf.
\end{env}

\begin{env}{3.2.3}
\label{env-0.3.2.3}
Let $\sheaf{F}$, $\sheaf{G}$ be two presheaves on a basis $\mathfrak{B}$, with values in $\K$; we define a \emph{morphism}
$u\colon\sheaf{F}\to\sheaf{G}$ as a family $(u_V)_{V\in\mathfrak{B}}$ of morphisms $u_V\colon\sheaf{F}(V)\to\sheaf{G}(V)$ satisfying the usual
compatibility conditions with the restriction morphisms $\rho_V^W$. With the notation of \eref{3.2.1},
we have a morphism $u'\colon\sheaf{F}'\to\sheaf{G}'$ of (ordinary) presheaves by taking for $u_U'$ the projective limit
of the $u_V$ for $V\in\mathfrak{B}$ and $V\subset U$; the verification of the compatibility conditions with
the ${\rho'}_U^{U'}$ follows from the functorial properties of the projective limit.
\end{env}

\begin{env}{3.2.4}
\label{env-0.3.2.4}
If the category $\K$ admits inductive limits, and if $\sheaf{F}$ is a presheaf on the basis $\mathfrak{B}$, with
values in $\K$, for each $x\in X$ the neighborhoods of $x$ belonging to $\mathfrak{B}$ form a cofinal set
(for $\supset$) in the set of neighborhoods of $x$, therefore, if $\sheaf{F}'$ is the (ordinary) presheaf
corresponding to $\sheaf{F}$, the stalk $\sheaf{F}_x'$ is equal to $\varinjlim_{\mathfrak{B}}\sheaf{F}(V)$ over the set of
$V\in\mathfrak{B}$ containing $x$. If $u\colon\sheaf{F}\to\sheaf{G}$ is morphism of presheaves on $\mathfrak{B}$ with values in
$\K$, $u'\colon\sheaf{F}'\to\sheaf{G}'$ the corresponding morphism of ordinary presheaves, $u_x'$ is likewise the
inductive limit of the morphisms $u_V\colon\sheaf{F}(V)\to\sheaf{G}(V)$ for $V\in\mathfrak{B}$, $x\in V$.
\end{env}

\begin{env}{3.2.5}
\label{env-0.3.2.5}
We return to the general conditions of \eref{3.2.1}. If $\sheaf{F}$ is an ordinary
\emph{sheaf} with values in $\K$, $\sheaf{F}_1$ the sheaf \emph{on} $\mathfrak{B}$ obtained
by the restriction of $\sheaf{F}$ to $\mathfrak{B}$, the ordinary sheaf $\sheaf{F}_1'$
obtained from $\sheaf{F}_1$ by the procedure of \eref{3.2.1} is canonically
isomorphic to $\sheaf{F}$, by virtue of the condition (F) and the uniqueness properties
of the projective limit. We identify the ordinary sheaf $\sheaf{F}$ with $\sheaf{F}_1'$.

If $\sheaf{G}$ is a second (ordinary) sheaf on $X$ with values in $\K$, and
$u\colon\sheaf{F}\to\sheaf{G}$ a morphism, the preceding remark shows that the data of
the $u_V\colon\sheaf{F}(V)\to\sheaf{G}(V)$ \emph{for only the $V\in\mathfrak{B}$} completely
determine $u$; conversely, it is sufficient, the $u_V$ being given for $V\in\mathfrak{B}$,
to verify that the commutative diagram with the restriction morphisms $\rho_V^W$ for
$V\in\mathfrak{B}$, $W\in\mathfrak{B}$, and $V\subset W$, for
\end{env}

\subsection{Gluing of sheaves}
\label{0-prelim-3.3}

\subsection{Direct images of presheaves}
\label{0-prelim-3.4}

\subsection{Inverse images of presheaves}
\label{0-prelim-3.5}

\subsection{Constant sheaves and locally constant sheaves}
\label{0-prelim-3.6}

\subsection{Inverse images of presheaves of groups or rings}
\label{0-prelim-3.7}

\subsection{Sheaves on pseudo-discrete spaces}
\label{0-prelim-3.8}

\section{Ringed spaces}
\label{0-prelim-4}

\subsection{Ringed spaces, sheaves of $\sheaf{A}$-modules, $\sheaf{A}$-algebras}
\label{0-prelim-4.1}

\begin{env}{4.1.1}
\label{env-0.4.1.1}
A \emph{ringed space} (resp. topologically ringed space) is a couple $(X,\sheaf{A})$
consisting of a topological space $X$ and a sheaf of rings (not necessarily commutative)
(resp. of a sheaf of topological rings) $\sheaf{A}$ on $X$; we say that $X$ is the
\emph{underlying} topological space of the ringed space $(X,\sheaf{A})$, and $\sheaf{A}$
the \emph{structure sheaf}. The latter is denoted $\O_X$, and its stalk at a point
$x\in X$ is denotes $\O_{X,x}$ or simply $\O_x$ when there is no chance of confusion.

We denote by $1$ or $e$ the \emph{unit section} of $\O_X$ over $X$ (the unit element
of $\Gamma(X,\O_X)$).

As in this Treaty we will have to consider in particular sheaves of \emph{commutative}
rings, it will be understood, when we speak of a ringed space $(X,\sheaf{A})$ without
specification, that $\sheaf{A}$ is a sheaf of commutative rings.

The ringed spaces with with not necessarily commutative structure sheaves
(resp. the topologically ringed spaces) form a \emph{category}, where we define
a \emph{morphism} $(X,\sheaf{A})\to(Y,\sheaf{B})$ as a couple $(\psi,\theta)=\Psi$
consisting of a continuous map $\psi\colon X\to Y$ and a \emph{$\psi$-morphism}
$\theta\colon\sheaf{G}\to\sheaf{F}$ (3.5.1) of sheaves of rings (resp. of sheaves of
topological rings); the \emph{composition} of a second morphism
$\Psi'=(\psi',\theta')\colon(Y,\sheaf{B})\to(Z,\sheaf{C})$ and of $\Psi$, denoted
$\Psi''=\Psi'\circ\Psi$, is the morphism $(\psi'',\theta'')$ where $\psi''=\psi'\circ\psi$,
and $\theta''$ is the composition of $\theta$ and $\theta'$ (equal to
$\psi_\ast'(\theta)\circ\theta'$, cf. \eref{3.5.2}). For ringed spaces, remember that we
then have ${\theta''}^\#=\theta^\#\circ\psi^\ast({\theta'}^\#)$ \eref{3.5.5}; therefore
if ${\theta'}^\#$ and $\theta^\#$ are the \emph{injective} (resp. \emph{surjective}),
the same is true of ${\theta''}^\#$, taking into account that $\psi_x\circ\rho_{\psi(x)}$
is an isomorphism for all $x\in X$ \eref{3.7.2}. We verify immediately, thanks to the
above, that when $\psi$ is an \emph{injective} continuous map and $\theta^\#$ is
a \emph{surjective} homomophism of sheaves of rings, the morphism $(\psi,\theta)$ is
a \emph{momomorphism} (T, 1.1) in the category of ringed spaces.

By abuse of language, we will often replace $\psi$ by $\Psi$ in notation, for
example in writing $\Psi^{-1}(U)$ in place of $\psi^{-1}(U)$ for a subset $U$ of $Y$,
when the is no risk of confusion.
\end{env}

\begin{env}{4.1.2}
\label{env-0.4.1.2}
For each subset $M$ of $X$, the pair $(M,\sheaf{A}|M)$ is evidently a ringed space, said
to be \emph{induced} on $M$ by the ringed space $(X,\sheaf{A})$ (and is still called
the \emph{restriction} of $(X,\sheaf{A})$ to $M$). If $j$ is the canonical injection
$M\to X$ and $\omega$ is the identity map of $\sheaf{A}|M$, $(j,\omega^\flat)$ is a
monomorphism $(M,\sheaf{A}|M)\to(X,\sheaf{A})$ of ringed spaces, called the
\emph{canonical injection}. The composition of a morphism
$\Psi\colon(X,\sheaf{A})\to(Y,\sheaf{B})$ and this injection is called the \emph{restriction}
of $\Psi$ to $M$.
\end{env}

\begin{env}{4.1.3}
\label{env-0.4.1.3}
We will not revisit the defintions of \emph{$\sheaf{A}$-modules} or
\emph{algebraic sheaves} on a ringed space $(X,\sheaf{A})$ (G, II, 2.2);
when $\sheaf{A}$ is a sheaf of not necessarily commutative rings, by $\sheaf{A}$-module
it will always mean ``left $\sheaf{A}$-module'' unless expressly stated otherwise. The
$\sheaf{A}$-submodules of $\sheaf{A}$ will be called \emph{sheaves of ideals} (left,
right, or two-sided) in $\sheaf{A}$ or \emph{$\sheaf{A}$-ideals}.

When $\sheaf{A}$ is a sheaf of commutative rings, and in the definition of
$\sheaf{A}$-modules, we replace everywhere the \emph{module} structure by that of
an \emph{algebra}, we obtain the definition of an \emph{$\sheaf{A}$-algebra} on $X$.
It is the same to say that an $\sheaf{A}$-algebra (not necessarily commutative) is
a $\sheaf{A}$-module $\sheaf{C}$, given with a homomorphism of $\sheaf{A}$-modules
$\varphi\colon\sheaf{C}\otimes_{\sheaf{A}}\sheaf{C}\to\sheaf{C}$ and a section $e$ over $X$,
such that: 1\textsuperscript{st} the diagram
\[
  \xymatrix{
    \sheaf{C}\otimes_{\sheaf{A}}\sheaf{C}\otimes_{\sheaf{A}}\sheaf{C}
    \ar[r]^{\varphi\otimes 1}\ar[d]_{1\otimes\varphi} &
    \sheaf{C}\otimes_{\sheaf{A}}\sheaf{C}\ar[d]^\varphi\\
    \sheaf{C}\otimes_{\sheaf{A}}\sheaf{C}\ar[r]^\varphi & \sheaf{C}
  }
\]
is commutative; 2\textsuperscript{nd} for each open $U\subset X$ and each section
$s\in\Gamma(U,\sheaf{C})$, we have $\varphi((e|U)\otimes s)=\varphi(s\otimes(e|U))=s$.
We say that $\sheaf{C}$ is a commutative $\sheaf{A}$-algebra if the diagram
\[
  \xymatrix{
    \sheaf{C}\otimes_{\sheaf{A}}\sheaf{C}\ar[rr]^\sigma\ar[rd]_\varphi
    & & \sheaf{C}\otimes_{\sheaf{A}}\sheaf{C}\ar[ld]^\varphi\\
    & \sheaf{C}
  }
\]
is commutative, $\sigma$ denoting the canonical symmetry (twist) map of the tensor product
$\sheaf{C}\otimes_{\sheaf{A}}\sheaf{C}$.

The homomorphisms of $\sheaf{A}$-algebras are also defined as the homomorphisms of $\sheaf{A}$-modules
in (G, II, 2.2), but naturally no longer form an abelian group.

If $\sheaf{M}$ is an $\sheaf{A}$-submodule of an $\sheaf{A}$-algebra $\sheaf{C}$, the
\emph{$\sheaf{A}$-subalgebra of $\sheaf{C}$ generated by $\sheaf{M}$} is the sum of the images
of the homomorphisms $\bigotimes^n\sheaf{M}\to\sheaf{C}$ (for each $n\geq 0$). This is also the sheaf
associated to the presheaf $U\mapsto\sheaf{B}(U)$ of algebras, $\sheaf{B}(U)$ being the subalgebra
of $\Gamma(U,\sheaf{C})$ generated by the submodule $\Gamma(U,\sheaf{M})$.
\end{env}

\begin{env}{4.1.4}
\label{env-0.4.1.4}
We say that a sheaf of rings $\sheaf{A}$ on a topological space $X$ is \emph{reduced at a point $x$ in $X$}
if the stalk $\sheaf{A}_x$ is a \emph{reduced} ring \eref{1.1.1}; we say that $\sheaf{A}$ is \emph{reduced}
if it is reduced at all point of $X$. Recall that a ring $A$ is called \emph{regular} if each of the local
rings $A_{\mathfrak{p}}$ (where $\mathfrak{p}$ runs through the set of prime ideals of $A$) is a regular local ring;
we will say that a sheaf of rings $\sheaf{A}$ on $X$ is \emph{regular at a point $x$} (resp. \emph{regular})
if the stalk $\sheaf{A}_x$ is a regular ring (resp. if $\sheaf{A}$ is regular at each point). Finally, we will
say that a sheaf of rings $\sheaf{A}$ on $X$ is \emph{normal at a point $x$} (resp. \emph{normal}) if the
stalk $\sheaf{A}_x$ is an \emph{integral domain and integrally closed} (resp. if $\sheaf{A}$ is normal at each
point). We will say that a ringed space $(X,\sheaf{A})$ has any of these preceeding properties if the sheaf
of rings $\sheaf{A}$ has that property.

A \emph{graded} sheaf of rings $\sheaf{A}$ is by definition a sheaf of rings that is the direct sum
(G, II, 2,7) of a family $(\sheaf{A}_n)_{n\in\bbold{Z}}$ of sheaves of abelian groups with the conditions
$\sheaf{A}_m\sheaf{A}_n\subset\sheaf{A}_{m+n}$; a \emph{graded $\sheaf{A}$-module} is an $\sheaf{A}$-module
$\sheaf{F}$ that is the direct sum of a family $(\sheaf{F}_n)_{n\in\bbold{Z}}$ of sheaves of abelian groups,
satisfying the conditions $\sheaf{A}_m\sheaf{F}_n\subset\sheaf{F}_{m+n}$. It is equivalent to say that
$(\sheaf{A}_m)_x(\sheaf{A}_n)_x\subset(\sheaf{A}_{m+n})_x$ (resp. $(\sheaf{A}_m)_x(\sheaf{F}_n)_x\subset(\sheaf{F}_{m+n})_x$)
for each point $x$.
\end{env}

\begin{env}{4.1.5}
\label{env-0.4.1.5}
Given a ringed space $(X,\sheaf{A})$ (not necessarily commutative), we will not recall here the definitions of the
bifunctors $\sheaf{F}\otimes_{\sheaf{A}}\sheaf{G}$, $\sheafHom_{\sheaf{A}}(\sheaf{F},\sheaf{F})$, and
$\Hom_{\sheaf{A}}(\sheaf{F},\sheaf{G})$ (G, II, 2.8~and~2.2) in the categories of right or left (depending on
the case) $\sheaf{A}$-modules, with values in the category of sheaves of abelian groups (or more generally
of $\sheaf{C}$-modules, if $\sheaf{C}$ is the center of $\sheaf{A}$). The stalk $(\sheaf{F}\otimes_{\sheaf{A}}\sheaf{G})_x$
for each point $x\in X$ identifies canonically with $\sheaf{F}_x\otimes_{\sheaf{A}_x}\sheaf{G}_x$ and we define a
canonical and functorial homomorphism $(\sheafHom_{\sheaf{A}}(\sheaf{F},\sheaf{G}))_x\to\Hom_{\sheaf{A}_x}(\sheaf{F}_x,\sheaf{G}_x)$
which is in general not injective or surjective. The bifunctors considered above are additive and in particular,
commute with finite direct limits; $\sheaf{F}\otimes_{\sheaf{A}}\sheaf{G}$ is right exact in $\sheaf{F}$ and in $\sheaf{G}$,
commutes with inductive limits, and $\sheaf{A}\otimes_{\sheaf{A}}\sheaf{G}$ (resp. $\sheaf{F}\otimes_{\sheaf{A}}\sheaf{A}$)
identifies canonically with $\sheaf{G}$ (resp. $\sheaf{F}$). The functors $\sheafHom_{\sheaf{A}}(\sheaf{F},\sheaf{G})$ and
$\Hom_{\sheaf{A}}(\sheaf{F},\sheaf{G})$ are \emph{left exact} in $\sheaf{F}$ and $\sheaf{G}$; more precisely,
if we have an exact sequence of the form $0\to\sheaf{G}'\to\sheaf{G}\to\sheaf{G}''$, the sequence
\[
  0\longrightarrow\sheafHom_{\sheaf{A}}(\sheaf{F},\sheaf{G}')\longrightarrow
  \sheafHom_{\sheaf{A}}(\sheaf{F},\sheaf{G})\longrightarrow\sheafHom_{\sheaf{A}}(\sheaf{F},\sheaf{G}'')
\]
is exact, and if we have an exact sequence of the form $\sheaf{F}'\to\sheaf{F}\to\sheaf{F}''\to 0$, the sequence
\[
  0\longrightarrow\sheafHom_{\sheaf{A}}(\sheaf{F}'',\sheaf{G})\longrightarrow
  \sheafHom_{\sheaf{A}}(\sheaf{F},\sheaf{G})\longrightarrow\sheafHom_{\sheaf{A}}(\sheaf{F}',\sheaf{G})
\]
is exact, with the analagous properties for the functor $\Hom$.
\end{env}

\subsection{Direct image of an $\sheaf{A}$-module}
\label{0-prelim-4.2}

\subsection{Inverse image of an $\sheaf{A}$-module}
\label{0-prelim-4.3}

\subsection{Relation between direct and inverse images}
\label{0-prelim-4.4}

\section{Quasi-coherent and coherent sheaves}
\label{0-prelim-5}

\subsection{Quasicoherent sheaves}
\label{0-prelim-5.1}

\subsection{Sheaves of finite type}
\label{0-prelim-5.2}

\subsection{Coherent sheaves}
\label{0-prelim-5.3}

\subsection{Locally free sheaves}
\label{0-prelim-5.4}

\subsection{Sheaves on a locally ringed space}
\label{0-prelim-5.5}

\section{Flatness}
\label{0-prelim-6}

\subsection{Flat modules}
\label{0-prelim-6.1}

\subsection{Change of ring}
\label{0-prelim-6.2}

\subsection{Local nature of flatness}
\label{0-prelim-6.3}

\subsection{Faithfully flat modules}
\label{0-prelim-6.4}

\subsection{Restriction of scalars}
\label{0-prelim-6.5}

\subsection{Faithfully flat rings}
\label{0-prelim-6.6}

\subsection{Flat morphisms of ringed spaces}
\label{0-prelim-6.7}

\section{Adic rings}
\label{0-prelim-7}

\subsection{Admissible rings}
\label{0-prelim-7.1}

\subsection{Adic rings and projective limits}
\label{0-prelim-7.2}

\subsection{Pre-adic Noetherian rings}
\label{0-prelim-7.3}

\subsection{Quasifinite modules over local rings}
\label{0-prelim-7.4}

\subsection{Rings of restricted formal series}
\label{0-prelim-7.5}

\subsection{Completed rings of fractions}
\label{0-prelim-7.6}

\subsection{Completed tensor products}
\label{0-prelim-7.7}

\subsection{Topologies on modules of homomorphisms}
\label{0-prelim-7.8}

\clearpage

\setcounter{subsection}{0}
\setcounter{section}{0}
\part{The language of schemes}
    
\section*{Summary}
\label{1-schemes.summary}

\begin{tabular}{rrl}
  \textsection & 1. & Affine schemes.\\
  \textsection & 2. & Preschemes and morphisms of preschemes.\\
  \textsection & 3. & Products of preschemes.\\
  \textsection & 4. & Subpreschemes and immersion morphisms.\\
  \textsection & 5. & Reduced preschemes; separation condition.\\
  \textsection & 6. & Finiteness conditions.\\
  \textsection & 7. & Rational maps.\\
  \textsection & 8. & Chevalley schemes.\\
  \textsection & 9. & Supplement on quasi-coherent sheaves.\\
  \textsection & 10. & Formal schemes.
\end{tabular}\\

\oldpage{79}The \textsection\textsection 1-8 do little more than develop a language, which will be used in the following.
It should be noted, however, that in accordance with the general spirit of this Treaty, \textsection\textsection
7-8 will be used less than the others, and in a less essential way; we have moreover spoken of Chevalley's schemes
only to make the link with the language of Chevalley [1] and Nagata [9]. The \textsection 9 gives definitions and results
on quasi-coherent sheaves, some of which are no longer limited to a translation into a ``geometric'' language of known notions
of commutative algebra, but are already of a global nature; they will be indispensable, from the following chapters,
in the global study of morphisms. Finally, \textsection 10 introduces a generalization of the notion of schemes, which will
be used as an intermediary in Chapter III to formulate and demonstrate in a convenient way the fundamental results of the
cohomological study of the proper morphisms; moreover, it should be noted that the notion of formal schemes seems indispensable
to express certain facts of the ``theory of modules'' (classification problems of algebraic varieties). The results of
\textsection 10 will not be used before \textsection 3 of Chapter III and it is recommended to omit reading until then.
\bigskip

\section{Affine schemes}
\label{1-schemes-1}

\subsection{The prime spectrum of a ring}
\label{1-schemes-1.1}

\begin{env}{1.1.1}
\label{env-1.1.1.1}
\oldpage{80}\emph{Notation}. Let $A$ be a (commutative) ring, $M$ an $A$-module. In
this chapter and the following, we will constantly use the following notations:
\begin{itemize}
  \item[] $\Spec(A)=$ \emph{set of prime ideals} of $A$, also called the
          \emph{prime spectrum} of $A$; for an $x\in X=\Spec(A)$, it will often be
          convenient to write $\mathfrak{j}_x$ instead of $x$. When $\Spec(A)$ is
          \emph{empty}, it is necessary and sufficient that the ring $A$ is
          reduced to $0$.
  \item[] $A_x=A_{\mathfrak{j}_x}=$ \emph{(local) ring of fractions $S^{-1}A$},
          where $S=A-\mathfrak{j}_x$.
  \item[] $\mathfrak{m}_x=\mathfrak{j}_x A_{\mathfrak{j}_x}=$ \emph{maximal ideal of $A$}.
  \item[] $\k(x)=A_x/\mathfrak{m}_x=$ \emph{residue field of $A_x$},
          canonically isomorphic to the field of fractions
          of the integral ring $A/\mathfrak{j}_x$, to which it is identified.
  \item[] $f(x)=$ \emph{class of $f$} mod. $\mathfrak{j}_x$ in $A/\mathfrak{j}_x\subset\k(x)$,
          for $f\in A$ and $x\in X$. We still say that $f(x)$ is the \emph{value}
          of $f$ at a point $x\in\Spec(A)$; the relations $f(x)=0$ and $f\in\mathfrak{j}_x$ are
          \emph{equivalent}.
  \item[] $M_x=M\otimes_A A_x=$ \emph{module of denominators of fractions in $A-\mathfrak{j}_x$}.
  \item[] $\rad(E)=$ \emph{radical of the ideal of $A$ generated by a subset $E$ of $A$}.
  \item[] $V(E)=$ \emph{set of $x\in X$ such that $E\subset\mathfrak{j}_x$} (or the set of $x\in X$
          such that $f(x)=0$ for all $f\in E$), for $E\subset A$. So we have
          \[
            \rad(E)=\bigcap_{x\in V(E)}\mathfrak{j}_x.\tag{1.1.1.1}
          \]
  \item[] $V(f)=V(\{f\})$ for $f\in A$.
  \item[] $D(f)=X-V(f)=$ \emph{set of $x\in X$ where $f(x)\neq 0$}.
\end{itemize}
\end{env}

\begin{envs}[Proposition]{1.1.2}
\label{env-1.1.1.2}
We have the following properties:
\begin{itemize}
  \item[(i)] $V(0)=X$, $V(1)=\emp$.
  \item[(ii)] The relation $E\subset E'$ implies $V(E)\supset V(E')$.
  \item[(iii)] For each family $(E_\lambda)$ of subsets of $A$,
               $V(\bigcup_\lambda E_\lambda)=V(\sum_\lambda E_\lambda)=\bigcap_\lambda V(E_\lambda)$.
  \item[(iv)] $V(EE')=V(E)\cup V(E')$.
  \item[(v)] $V(E)=V(\mathfrak{r}(E))$.
\end{itemize}
\end{envs}
The properties (i), (ii), (iii) are trivial, and (v) follows from (ii) and from the
formula (1.1.1.1). It is evident that $V(EE')\supset V(E)\cap V(E')$; conversely, if
$x\not\in V(E)$ and $x\not\in V(E')$, there exists $f\in E$ and $f'\in E'$ such that
$f(x)\neq 0$ and $f'(x)\neq 0$ in $\k(x)$, hence $f(x)f'(x)\neq 0$, i.e., $x\not\in V(EE')$,
which proves (iv).

The proposition \eref{1.1.2} shows, among other things, that sets of the form $V(E)$ (where
$E$ runs through all the subsets of $A$) are the \emph{closed sets} of a topology on
$X$, which we will call the \emph{spectral topology}\footnote{The introduction of this
topology in algebraic geometry is due to Zariski. So this topology is usually called
the ``Zariski topology'' of $X$.}; unless expressely stated otherwise, always assume
$X=\Spec(A)$ with the spectral topology.

\begin{env}{1.1.3}
\label{env-1.1.1.3}
\oldpage{81}For each subset $Y$ of $X$, we denote by $\mathfrak{j}(Y)$ the set of $f\in A$
such that $f(y)=0$ for all $y\in Y$; equivalently, $\mathfrak{j}(Y)$ is the intersection of
the prime ideals $\mathfrak{j}_y$ for $y\in Y$. It is clear that the relation $Y\subset Y'$
implies that $\mathfrak{j}(Y)\supset\mathfrak{j}(Y')$ and that we have
\[
  \mathfrak{j}\bigg(\bigcup_\lambda Y_\lambda\bigg)=\bigcap_\lambda\mathfrak{j}(Y_\lambda)\tag{1.1.3.1}
\]
for each family $(Y_\lambda)$ of subsets of $X$. Finally we have
\[
  \mathfrak{j}(\{x\})=\mathfrak{j}_x.\tag{1.1.3.2}
\]
\end{env}

\begin{envs}[Proposition]{1.1.4}
\label{prop-1.1.1.4}
\begin{itemize}
  \item[(i)] For each subset $E$ of $A$, we have $\mathfrak{j}(V(E))=\rad(E)$.
  \item[(ii)] For each subset $Y$ of $X$, $V(\mathfrak{j}(Y))=\overline{Y}$, the closure of $Y$ in $X$.
\end{itemize}
\end{envs}
(i) is an immeidate consequence of the definitions and (1.1.1.1); on the other hand, $V(\mathfrak{j}(Y))$
is closed and contains $Y$; conversely, if $Y\subset V(E)$, we have $f(y)=0$ for $f\in E$ and all $y\in Y$,
so $E\subset\mathfrak{j}(Y)$, $V(E)\supset V(\mathfrak{j}(Y))$, which proves (ii).

\begin{envs}[Corollary]{1.1.5}
\label{cor-1.1.1.5}
The closed subsets of $X=\Spec(A)$ and the ideals of $A$ equal to their radicals (otherwise the
intersection of prime ideals) correspond bijectively by the \unsure{descent} maps $Y\mapsto\mathfrak{j}(Y)$,
$\mathfrak{a}\mapsto V(\mathfrak{a})$; the union $Y_1\cup Y_2$ of two closed subsets corresponds to
$\mathfrak{j}(Y_1)\cap\mathfrak{j}(Y_2)$, and the intersection of any family $(Y_\lambda)$ of closed subsets
corresponds to the radical of the sum of the $\mathfrak{j}(Y_\lambda)$.
\end{envs}

\begin{envs}[Corollary]{1.1.6}
\label{cor-1.1.1.6}
If $A$ is a Noetherian ring, $X=\Spec(A)$ is a Noetherian space.
\end{envs}
Note that the converse of this corollary is false, as shown
in the example of a non-Noetherian integral ring with a single prime ideal $\neq\{0\}$, for
example a non-discrete valuation ring of rank $1$.

As an example of ring $A$ whose spectrum is not a Noetherian space, one
can consider the ring $\sheaf{C}(Y)$ of continuous real functions on an infinite compact space
$Y$; we know that as a whole, $Y$ corresponds with the set of maximal ideals
of $A$, and it is easy to see that the topology induced on $Y$ by that of $X=\Spec(A)$
is the initial topology of $Y$. Since $Y$ is not a Noetherian space, the same is true for $X$.

\begin{envs}[Corollary]{1.1.7}
\label{cor-1.1.1.7}
For each $x\in X$, the closure of $\{x\}$ is the set of $y\in X$ such that $\mathfrak{j}_x\subset\mathfrak{j}_y$.
For $\{x\}$ to beclosed, it is necessary and sufficient that $\mathfrak{j}_x$ is maximal.
\end{envs}

\begin{envs}[Corollary]{1.1.8}
\label{cor-1.1.1.8}
The space $X=\Spec(A)$ is a Kolmogoroff space.
\end{envs}

If $x$, $y$ are two distinct points of $X$, we have either $\mathfrak{j}_x\not\subset\mathfrak{j}_y$ or
$\mathfrak{j}_y\not\subset\mathfrak{j}_x$, so one of the points $x$, $y$ does not belong to the closure of the other.

\begin{env}{1.1.9}
\label{env-1.1.1.9}
According to proposition (\eref{1.1.2}, (iv)), for two elements $f$, $g$ of $A$, we have
\[
  D(fg)=D(f)\cap D(g).\tag{1.1.9.1}
\]
Note also that the relation $D(f)=D(g)$ means, according to proposition (\sref{prop}{1.1.4}, (i))
and proposition (\eref{1.1.2}, (v)) that $\rad(f)=\rad(g)$, or that the minimal prime ideals
containing $(f)$ and $(g)$ are the same; in particular, when $f=ug$, where $u$ is invertible.
\end{env}

\begin{envs}[Proposition]{1.1.10}\oldpage{82}
\label{prop-1.1.1.10}
\medskip\noindent
\begin{itemize}
  \item[(i)] When $f$ ranges over $A$, the sets $D(f)$ forms a base for the topology of $X$.
  \item[(ii)] For each $f\in A$, $D(f)$ is quasicompact. In particular $X=D(1)$ is quasicompact.
\end{itemize}
\end{envs}

(i) Let $U$ be an open set in $X$; by definition, we have $U=X-V(E)$ where $E$ is a subset of $A$, and
$V(E)=\bigcap_{f\in E}V(f)$, hence $U=\bigcup_{f\in E}D(f)$.

(ii) According to (i), it is sufficient to prove that if $(f_\lambda)_{\lambda\in L}$ is a family of elements
of $A$ such that $D(f)\subset\bigcup_{\lambda\in L}D(f_\lambda)$, there exists a finite subset $J$ of $L$ such that
$D(f)\subset\bigcup_{\lambda\in J}D(f_\lambda)$. Let $\mathfrak{a}$ be the ideal of $A$ generated by the $f_\lambda$;
we have by hypothesis that $V(f)\supset V(\mathfrak{a})$, so $\rad(f)\subset\rad(\mathfrak{a})$; as
$f\in\rad(f)$, there exists an integer $n\geq 0$ such that $f^n\in\mathfrak{a}$. But then $f^n$ belongs to
the ideal $\mathfrak{b}$ generated by the finite subfamily $(f_\lambda)_{\lambda\in J}$, and we have
$V(f)=V(f^n)\supset V(\mathfrak{b})=\bigcap_{\lambda\in J}V(f_\lambda)$, that is to say,
$D(f)\supset\bigcup_{\lambda\in J}D(f_\lambda)$.

\begin{envs}[Proposition]{1.1.11}
\label{prop-1.1.1.11}
For each ideal $\mathfrak{a}$ of $A$, $\Spec(A/\mathfrak{a})$ identifies canonically with the closed subspace
$V(\mathfrak{a})$ of $\Spec(A)$.
\end{envs}

In effect, we know there is a canonical bijective correspondence, respecting the inclusion order structure,
between ideals (resp. prime ideals) of $A/\mathfrak{a}$ and ideals (resp. prime ideals) of $A$ containing
$\mathfrak{a}$.

Recall that the set $\nilrad$ of nilpotent elements of $A$ (the \emph{nilradical} of $A$) is an ideal equal to
$\rad(0)$, the intersection of all the prime ideals of $A$ \pref{env}{1.1.1}.

\begin{envs}[Corollary]{1.1.12}
\label{cor-1.1.1.12}
The topological spaces $\Spec(A)$ and $\Spec(A/\nilrad)$ are canonically homeomorphic.
\end{envs}

\begin{envs}[Proposition]{1.1.13}
\label{prop-1.1.1.13}
For $X=\Spec(A)$ to be irreducible \pref{env}{2.1.1}, it is necessary and sufficient that the ring $A/\nilrad$
is an integral domain (or, equivalently, that the ideal $\nilrad$ is prime).
\end{envs}

By virtue of Corollary \sref{cor}{1.1.12}, we can restrict to the case $\nilrad=0$. If $X$ is reducible,
there exist two distinct closed subsets $Y_1$, $Y_2$ of $X$ such that $X=Y_1\cup Y_2$, so
$\mathfrak{j}(X)=\mathfrak{j}(Y_1)\cap\mathfrak{j}(Y_2)=0$, the ideals $\mathfrak{j}(Y_1)$ and
$\mathfrak{j}(Y_2)$ being different from $(0)$ \sref{cor}{1.1.5}; so $A$ is not an integral domain.
Conversely, if in $A$ there are elements $f\neq 0$, $g\neq 0$ such that $fg=0$, we have
$V(f)\neq X$, $V(g)\neq X$ (since the intersection of the prime ideals of $A$ is $(0)$), and
$X=V(fg)=V(f)\cup V(g)$.

\begin{envs}[Corollary]{1.1.14}
\label{cor-1.1.1.14}
\begin{itemize}
  \item[(i)] In the bijective correspondence between closed subsets of $X=\Spec(A)$
             and ideals of $A$ equal to their roots, the irreducible closed subsets
             of $X$ correspond to the prime ideals of $A$. In particular, the irreducible
             components of $X$ correspond to the minimal prime ideals of $A$.
  \item[(ii)] The map $x\mapsto\overline{\{x\}}$ establishes a bijective correspondence
              between $X$ and the set of closed irreducible subsets of $X$
              (\emph{said otherwise,} all closed irreducible subsets of $X$ containing
              only one generic point).
\end{itemize}
\end{envs}

(i) follows immediately from \sref{prop}{1.1.13} and \sref{prop}{1.1.11}; and for
proving (ii), we can, by virtue of \sref{prop}{1.1.11}, we restrict to the case where
$X$ is irreducible; then, according to the proposition \sref{prop}{1.1.13}, there exists
in $A$ a smaller prime ideal $\nilrad$, which corresponds to the generic point
\oldpage{83}of $X$; in addition, $X$ does not admit only one generic point since it is
a Kolmogoroff space (\sref{cor}{1.1.8} and \pref{env}{2.1.3}).

\begin{envs}[Proposition]{1.1.15}
\label{prop-1.1.1.15}
If $\mathfrak{J}$ is an ideal in $A$ containing the radical $\nilrad(A)$, the only
neighborhood of $V(\mathfrak{J})$ in $X=\Spec(A)$ is the whole space $X$
\end{envs}

In effect, each maximal ideal of $A$ belongs by definitionn of $V(\mathfrak{J})$.
As each ideal $\mathfrak{a}$ of $A$ is contained in a maximal ideal, we have
$V(\mathfrak{a})\cap V(\mathfrak{J})\neq 0$, hence the proposition.

\subsection{Functorial properties of prime spectra of rings}
\label{1-schemes-1.2}       

\begin{env}{1.2.1}
\label{env-1.1.2.1}
Let $A$, $A'$ be two rings,
\[
  \varphi\colon A'\longrightarrow A
\]
a homomorphism of rings. For each prime ideal $x=\mathfrak{j}_x\in\Spec(A)=X$, the
ring $A'/\varphi^{-1}(\mathfrak{j}_x)$ is canonically isomorphic to a subring of
$A/\mathfrak{j}_x$, so it is an integral domain, otherwise we say
$\varphi^{-1}(\mathfrak{j}_x)$ is a prime ideal of $A'$; we denote it by
$^a\varphi(x)$, and we have also defined a map
\[
  ^a\varphi\colon X=\Spec(A)\longrightarrow X'=\Spec(A')
\]
(also denoted $\Spec(\varphi)$) we call the map \emph{associated} to the
homomorphism $\varphi$. We denote by $\varphi^x$ the injective homomorphism of
$A'/\varphi^{-1}(\mathfrak{j}_x)$ to $A/\mathfrak{j}_x$ induced by $\varphi$ by
passing to quotients, so the canonical extention is a monomorphism of fields
\[
  \varphi^x\colon\k(^a\varphi(x))\longrightarrow\k(x);
\]
for each $f'\in A'$, we therefore have by definition
\[
  \varphi^x(f'(^a\varphi(x)))=(\varphi(f'))(x)\quad(x\in X).\tag{1.2.1.1}
\]
\end{env}

\begin{envs}[Proposition]{1.2.2}
\label{prop-1.1.2.2}
\medskip\noindent
\begin{itemize}
  \item[(i)] For each subset $E'$ of $A'$, we have
             \[
               ^a\varphi^{-1}(V(E'))=V(\varphi(E')),\tag{1.2.2.1}
             \]
             and in particular, for each $f'\in A'$,
             \[
               ^a\varphi^{-1}(D(f'))=D(\varphi(f')).\tag{1.2.2.2}
             \]
  \item[(ii)] For each ideal $\mathfrak{a}$ of $A$, we have
              \[
                \overline{^a\varphi(V(\mathfrak{a}))}=V(\varphi^{-1}(\mathfrak{a})).
                \tag{1.2.2.3}
              \]
\end{itemize}
\end{envs}

In effect, the relation $^a\varphi(x)\in V(E')$ is by definition equivalent to
$E'\subset\varphi^{-1}(\mathfrak{j}_x)$, so $\varphi(E')\subset\mathfrak{j}_x$, and
finally $x\in V(\varphi(E'))$, hence (i). To prove (ii), we can suppose that
$\mathfrak{a}$ is equal to its radical, since $V(\rad(\mathfrak{a}))=V(\mathfrak{a})$
(\sref{prop}{1.1.2}, (v)) and
$\varphi^{-1}(\rad(\mathfrak{a}))=\rad(\varphi^{-1}(\mathfrak{a}))$; the relation
$f'\in\mathfrak{a}'$ is by definition equivalent to $f'(x')=0$ for each
$x\in{^a\varphi(Y)}$, so, by virtue of the formula (1.2.1.1), it is equivalent as well
to $\varphi(f')(x)=0$ for each $x\in Y$, or $\varphi(f')\in\mathfrak{j}(Y)=\mathfrak{a}$,
since $\mathfrak{a}$ is equal to its radical; hence (ii).

\subsection{Sheaf associated to a module}
\label{1-schemes-1.3}

\subsection{Quasicoherent sheaves over a prime spectrum}
\label{1-schemes-1.4}

\subsection{Coherent sheaves over a prime spectrum}
\label{1-schemes-1.5}

\subsection{Functorial properties of quasicoherent sheaves over a prime spectrum}
\label{1-schemes-1.6}

\subsection{Characterisation of morphisms of affine schemes}
\label{1-schemes-1.7}

\section{Preschemes and morphisms of preschemes}
\label{1-schemes-2}

\subsection{Definition of preschemes}
\label{1-schemes-2.1}

\begin{env}{2.1.1}
\label{env-1.2.1.1}
Given a ringed space $(X,\O_X)$, we say that an open subset
$V$ of $X$ is an \emph{affine open} if the ringed space $(V,\O_X|V)$ is an
affine scheme \eref{1.7.1}.
\end{env}

\begin{env}[Definition]{2.1.2}
\label{defn-1.2.1.2}
We define a prescheme to be a ringed space
$(X,\O_X)$ such that every point of $X$ admits an affine open neighbourhood.
\end{env}

\begin{envs}[Proposition]{2.1.3}
\label{prop-2.1.3}
\oldpage{98}If $(X,\O_X)$ is a prescheme then
the affine opens give a base for the topology of $X$.
\end{envs}

In effect, if $V$ is an arbitrary open neighbourhood of $x\in X$, then there
exists by hypothesis an open neighbourhood $W$ of $x$ such that $(W,\O_X|W)$ is
an affine scheme; we write $A$ to mean its ring.  In the space $W$, $V\cap W$ is
an open neighbourhood of $x$; thus there exists $f\in A$ such that $D(f)$ is an
open neighbourhood of $x$ contained inside $V\cap W$ \eref{1.1.10} (i).  The ringed
space $(D(f),\O_X|D(f))$ is thus an affine scheme, isomorphic to $A_f$
\eref{1.3.6}, whence the proposition.

\begin{envs}[Proposition]{2.1.4}
\label{prop-1.2.1.4}
The underlying space of a prescheme is a Kolmogoroff space.
\end{envs}

In effect, if $x,y$ are two distinct points of a prescheme $X$ then it is clear
that there exists an open neighbourhood of one of these points that does not
contain the other if $x$ and $y$ are not in the same affine open; and if they
are in the same affine open, this is a result of \eref{1.1.8}.

\begin{envs}[Proposition]{2.1.5}
\label{prop-1.2.1.5}
If $(X,\O_X)$ is a prescheme then every closed
irreducible subset of $X$ admits exactly one generic point, and the map
$x\mapsto\overline{\{x\}}$ is thus a bijection of $X$ onto its set of closed
irreducible subsets.
\end{envs}

In effect, if $Y$ is a closed irreducible subset of $X$ and $y\in Y$, and if $U$
is an open affine neighbourhood of $y$ in $X$, then $U\cap Y$ is everywhere
dense in $Y$, as well as irreducible (\pref{env}{2.1.1} and \pref{env}{2.1.4}); thus by
(1.1.14), $U\cap Y$ is the closure in $U$ of a point $x$, and then
$Y\subset\overline{U}$ is the closure of $x$ in $X$.  The uniqueness of the
generic point of $X$ is a result of \sref{prop}{2.1.4} and (\pref{env}{2.1.3}).

\begin{env}{2.1.6}
\label{env-1.2.1.6}
If $Y$ is a closed irreducible subset of $X$ and $y$ its
generic point then the local ring $\O_y$, also written $\O_{X/Y}$, is called the
\emph{local ring of $X$ along $Y$}, or the \emph{local ring of $Y$ in $X$}.

If $X$ itself is irreducible and $x$ its generic point then we say that
$\O_x$ is the \emph{ring of rational functions on $X$} (cf.~s.~7).
\end{env}

\begin{envs}[Proposition]{2.1.7}
\label{prop-1.2.1.7}
If $(X,\O_X)$ is a prescheme then the ringed
space $(U,\O_X|U)$ is a prescheme for every open subset $U$.
\end{envs}

This follows directly from definition~\sref{defn}{2.1.2} and
proposition~\sref{prop}{2.1.3}.

We say that $(U,\O_X|U)$ is the prescheme \emph{induced} on $U$ by
$(X,\O_X)$, or the \emph{restriction} of $(X,\O_X)$ to~$U$.

\begin{env}{2.1.8}
\label{env-1.2.1.8}
We say that a prescheme $(X,\O_X)$ is \emph{irreducible}
(resp. \emph{connected}) if the underlying space $X$ is irreducible (resp.
connected).  We say that a prescheme is \emph{integral} if it is
\emph{irreducible and reduced} (cf.~\eref{5.1.4}).  We say that a prescheme
$(X,\O_X)$ is \emph{locally integral} if every $x\in X$ admits an open
neighbourhood $U$ such that the prescheme induced on $U$ by $(X,\O_X)$ is
integral.
\end{env}

\subsection{Morphisms of preschemes}
\label{1-schemes-2.2}

\begin{env}[Definition]{2.2.1}
\label{defn-1.2.2.1}
Given two preschemes $(X,\O_X)$, $(Y,\O_Y)$, we
define a morphism (of preschemes) of $(X,\O_X)$ to $(Y,\O_Y)$ to be a morphism
of ringed spaces $(\psi,\theta)$ such that, for all $x\in X$, $\theta_x^\#$ is a
local homomorphism $\O_{\psi(x)}\to\O_x$.
\end{env}

\oldpage{99}By passing to quotients, the map $\O_{\psi(x)}\to\O_x$ gives us a
monomorphism $\theta^x\colon k(\psi(x))\to k(x)$, which lets us consider $k(x)$
as an \emph{extension} of the field $k(\psi(x))$.

\begin{env}{2.2.2}
\label{env-1.2.2.2}
The composition $(\psi'',\theta'')$ of two morphisms
$(\psi,\theta)$, $(\psi',\theta')$ of preschemes is also a morphism of
preschemes, since it is given by the formula
$\theta''^\#=\theta^\#\circ\psi^\ast(\theta'^\#)$ \pref{env}{3.5.5}. From this
we conclude that preschemes form a \emph{category}; using the usual notation, we
will write $\Hom(X,Y)$ to mean the set of morphisms from a prescheme $X$ to a
prescheme $Y$.
\end{env}

\begin{env}[Example]{2.2.3}
\label{exm-1.2.2.3}
If $U$ is an open subset of $X$ then the canonical
injection \pref{env}{4.1.2} of the induced prescheme $(U,\O_X|U)$ into
$(X,\O_X)$ is a morphism of preschemes; it is further a \emph{monomorphism} of
ringed spaces (and \emph{a fortiori} a monomorphism of preschemes), which
follows rapidly from \pref{env}{4.1.1}.
\end{env}

\begin{envs}[Proposition]{2.2.4}
\label{prop-1.2.2.4}
Let $(X,\O_X)$ be a prescheme, and $(S,\O_S)$ an
affine scheme associated to a ring $A$. Then there exists a canonical bijective
correspondence between morphisms of preschemes from $(X,\O_X)$ to $(S,\O_S)$ and
ring homomorphisms from $A$ to $\Gamma(X,\O_X)$.
\end{envs}

Note first of all that, if $(X,\O_X)$ and $(Y,\O_Y)$ are two arbitrary ringed spaces,
a morphism $(\psi,\theta)$ from $(X,\O_X)$ to $(Y,\O_Y)$ canonically defines a ring
homomorphism
$\Gamma(\theta)\colon\Gamma(Y,\O_Y)\to\Gamma(Y,\psi_\ast(\O_X))=\Gamma(X,\O_X)$.
In the case that we consider, everything boils down to showing that any
homomorphism $\varphi\colon A\to\Gamma(X,\O_X)$ is of the form $\Gamma(\theta)$
for one and only one $\theta$. Now, by hypothesis there is a covering
$(V_\alpha)$ of $X$ by affine opens; by composing of $\varphi$ with the
restriction homomorphism $\Gamma(X,\O_X)\to\Gamma(V_\alpha,\O_X|V_\alpha)$ we
obtain a homomorphism $\varphi_\alpha\colon A\to\Gamma(V_\alpha,\O_X|V_\alpha)$
that corresponds to a unique morphism $(\psi_\alpha,\theta_\alpha)$ from the
prescheme $(V_\alpha,\O_X|V_\alpha)$ to $(S,\O_S)$, thanks to \eref{1.7.3}.
Furthermore, for every pair of indices $(\alpha,\beta)$, every point of
$V_\alpha\cap V_\beta$ admits an open affine neighbourhood $W$ contained inside
$V_\alpha\cap V_\beta$ \eref{2.1.3}; it is clear that that, by composing
$\varphi_\alpha$ and $\varphi_\beta$ with the restriction homomorphisms to $W$,
we obtain the same homomorphism $\Gamma(S,\O_S)\to\Gamma(W,\O_X|W)$, so, thanks
to the relations $(\theta_\alpha^\#)_x=(\varphi_\alpha)_x$ for all $x\in
V_\alpha$ and all $\alpha$ \eref{1.6.1}, the restriction to $W$ of the morphisms
$(\psi_\alpha,\theta_\alpha)$ and $(\psi_\beta,\theta_\beta)$ coincide. From
this we conclude that there is a morphism
$(\psi,\theta)\colon(X,\O_X)\to(S,\O_S)$ of ringed spaces, and only one such
that its restriction to each $V_\alpha$ is $(\psi_\alpha,\theta_\alpha)$, and it
is clear that this morphism is a morphism of preschemes and such that
$\Gamma(\theta)=\varphi$.

Let $u\colon A\to\Gamma(X,\O_X)$ be a ring homomorphism, and $v=(\psi,\theta)$
the corresponding morphism $(X,\O_X)\to(S,\O_S)$. For every $f\in A$ we have
that
\[
  \psi^{-1}(D(f))=X_{u(f)}\tag{2.2.4.1}
\]
with the notation of \pref{env}{5.5.2} relative to the locally-free sheaf
$\O_X$. In fact, it suffices to verify this formula when $X$ itself is affine,
and then this is nothing but (1.2.2.2).

\begin{envs}[Proposition]{2.2.5}
\label{prop-1.2.2.5}
Under the hypotheses of \sref{prop}{2.2.4}, let
$\varphi\colon A\to\Gamma(X,\O_X)$ be a ring homomorphism,
$f\colon(X,\O_X)\to(S,\O_S)$ the corresponding morphism of preschemes,
$\sheaf{G}$ (resp. $\sheaf{F}$) an $\O_X$-module (resp. $\O_S$-module), and
$M=\Gamma(S,\sheaf{F})$. Then there exists a canonical bijective
\oldpage{100}correspondence between $f$-morphisms $\sheaf{F}\to\sheaf{G}$
\pref{env}{4.4.1} and $A$-homomorphisms $M\to(\Gamma(X,\sheaf{G}))_{[\varphi]}$.
\end{envs}

Indeed, reasoning as in
\sref{prop}{2.2.4}, we are rapidly led to the case where $X$ is affine, and the proposition
then follows from \eref{1.6.3} and \eref{1.3.8}.

\begin{env}{2.2.6}
\label{env-1.2.2.6}
We say that a morphism of preschemes
$(\psi,\theta)\colon(X,\O_X)\to(Y,\O_Y)$ is \emph{open} (resp. \emph{closed})
if, for all open subsets $U$ of $X$ (resp. all closed subsets $F$ of $X$),
$\psi(U)$ is open (resp. $\psi(F)$ is closed) in $Y$. We say that
$(\psi,\theta)$ is \emph{dominant} if $\psi(X)$ is dense in $Y$, and
\emph{surjective} if $\psi$ is surjective. We will point out that these
conditions rely only on the continuous map $\psi$.
\end{env}

\begin{envs}[Proposition]{2.2.7}
\label{prop-1.2.2.7}
Let
\begin{gather*}
  f=(\psi,\theta)\colon(X,\O_X)\to(Y,\O_Y);\\
  g=(\psi',\theta')\colon(Y,\O_Y)\to(Z,\O_Z)
\end{gather*}
be two morphisms of
preschemes.
\begin{itemize}
  \item[(i)] If $f$ and $g$ are both open (resp. closed, dominant, surjective),
             then so too is $g\circ f$.
  \item[(ii)] If $f$ is surjective and $g\circ f$ closed, then $g$ is closed.
  \item[(iii)] If $g\circ f$ is surjective, then $g$ is surjective.
\end{itemize}
\end{envs}
Claims (i) and (iii) are evident. Write $g\circ f=(\psi'',\theta'')$.
If $F$ is closed in $Y$ then $\psi^{-1}(F)$ is closed in $X$, so
$\psi''(\psi^{-1}(F))$ is closed in $Z$; but since $\psi$ is surjective,
$\psi(\psi^{-1}(F))=F$, so $\psi''(\psi^{-1}(F))=\psi'(F)$, which proves (ii).

\begin{envs}[Proposition]{2.2.8}
\label{prop-1.2.2.8}
Let $f=(\psi,\theta)$ be a morphism
$(X,\O_X)\to(Y,\O_Y)$, and $(U_\alpha)$ an open cover of $Y$. For $f$ to be
open (resp. closed, surjective, dominant), it is necessary and sufficient that
its restriction to every induced prescheme
$(\psi^{-1}(U_\alpha),\O_X|\psi^{-1}(U_\alpha))$, considered as a morphism of
preschemes from this induced prescheme to the induced prescheme
$(U_\alpha,\O_Y|U_\alpha)$ is open (resp. closed, surjective, dominant).
\end{envs}

The proposition follows immediately from the definitions, taking into
account the fact that a subset $F$ of $Y$ is closed (resp. open, dense) in $Y$
if and only if each of the $F\cap U_\alpha$ are closed (resp. open, dense) in
$U_\alpha$.

\begin{env}{2.2.9}
\label{env-1.2.2.9}
Let $(X,\O_X)$ and $(Y,\O_Y)$ be two preschemes; suppose that
$X$ (resp. $Y$) has a finite number of irreducible components $X_i$ (resp.
$Y_i$) ($1\leqslant i\leqslant n$); let $\xi_i$ (resp. $\eta_i$) be the generic
point of $X_i$ (resp. $Y_i$) \eref{2.1.5}. We say that a morphism
\[
  f=(\psi,\theta)\colon(X,\O_X)\to(Y,\O_Y)
\]
is \emph{birational} if, for all $i$, $\psi^{-1}(\eta_i)=\{\xi_i\}$ and
$\theta_{\xi_i}^\#\colon\O_{\eta_i}\to\O_{\xi_i}$ is an \emph{isomorphism}. It
is clear that a birational morphism is dominant \pref{env}{2.1.8}, and so is
surjective if it is also closed.
\end{env}

\begin{env}[Notational conventions]{2.2.10}
\label{rmk-1.2.2.10}
In all that follows, when there is
no risk of confusion, we \emph{supress} the structure sheaf (resp. the morphism
of structure sheaves) from the notation of a prescheme (resp. morphism of
preschemes). If $U$ is an open subset of the underlying space $X$ of a
prescheme, then whenever we speak of $U$ as a prescheme we always mean the
induced prescheme on $U$.
\end{env}

\subsection{Gluing of preschemes}
\label{1-schemes-2.3}

\begin{env}{2.3.1}
\label{env-1.2.3.1}
\oldpage{101}It follows from definition~\sref{defn}{2.1.2} that every ringed space obtained by
\emph{gluing} preschemes \pref{env}{4.1.6} is again a prescheme. In particular, although every
prescheme admits, by definition, a cover by affine open sets, we see that every prescheme can
actually be obtained by \emph{gluing affine schemes}.
\end{env}

\begin{env}[Example]{2.3.2}
\label{exm-1.2.3.2}
Let $K$ be a field, and $B=K[s]$, $C=K[t]$ be two polynomial rings in one indeterminate over $K$,
and define $X_1=\Spec(B)$, $X_2=\Spec(C)$, which are two isomorphic affine schemes.
In $X_1$ (resp. $X_2$), let $U_{12}$ (resp. $U_{21}$) be the affine open $D(s)$ (resp. $D(t)$) where
the ring $B_s$ (resp. $C_t$) is formed of rational fractions of the form $f(s)/s^m$ (resp. $g(t)/t^n$)
with $f\in B$ (resp. $g\in C$). Let $u_{12}$ be the isomorphism of preschemes $U_{21}\to U_{12}$
corresponding \sref{prop}{2.2.4} to the isomorphism from $B$ to $C$ that, to $f(s)/s^m$, associates
the rational fraction $f(1/t)/(1/t^m)$. We can glue $X_1$ and $X_2$ along $U_{12}$ and $U_{21}$ by
using $u_{12}$, because there is clearly no gluing condition. We later show that the prescheme $X$
obtained in this manner is a particular case of a general method of construction (\textbf{II},~2.4.3).
Here we only show that $X$ \emph{is not an affine scheme}; this will follow from the fact that the ring
$\Gamma(X,\O_X)$ is \emph{isomorphic} to $K$, and so its spectrum reduces to a point. In effect, a section
of $\O_X$ over $X$ has a restriction over $X_1$ (resp. $X_2$), identified to an affine open of $X$, that
is a polynomial $f(s)$ (resp. $g(t)$), and it follows from the definitions that we should have $g(t)=f(1/t)$,
which is not possible if $f=g\in K$.
\end{env}

\subsection{Local schemes}
\label{1-schemes-2.4}

\begin{env}{2.4.1}
\label{env-1.2.4.1}
We say that an affine scheme is a \emph{local scheme} if
it is the affine scheme associated to a local ring $A$; then there exists in
$X=\Spec(A)$ a single \emph{closed point $a\in X$}, and for all other $b\in X$
we have that $a\in\overline{\{b\}}$ \eref{1.1.7}.
\end{env}
    
For all preschemes $Y$ and points $y\in Y$, the local scheme $\Spec(\O_y)$
is called the \emph{local scheme of $Y$ at the point $y$}. Let $V$ be an affine
open of $Y$ containing $y$, and $B$ the ring of the affine scheme $V$; then
$\O_y$ is canonically identified with $B_y$ \eref{1.3.4}, and the canonical
homomorphism $B\to B_y$ thus corresponds \eref{1.6.1} to a morphism of preschemes
$\Spec(\O_y)\to V$.  If we compose this morphism with the canonical injection
$V\to Y$, then we obtain a morphism $\Spec(\O_y)\to Y$, which is
\emph{independent} of the affine open $V$ (containing $y$) that we chose:
indeed, if $V'$ is some other affine open containing $y$, then there exists a
third affine open $W$ containing $y$ and such that $W\subset V\cap V'$ \sref{prop}{2.1.3};
we can thus assume that $V\subset V'$, and then if $B'$ is the ring of $V'$,
everything comes down to remarking that the diagram
\[
  \xymatrix{
    B'\ar[rr]\ar[dr] & & B\ar[dl]\\
    & \O_y &
  }
\]
is commutative
\pref{env}{1.5.1}. The morphism \[ \Spec(\O_y)\to Y \] thus defined is said
to be \emph{canonical}.
    
\begin{envs}[Proposition]{2.4.2}
\label{prop-1.2.4.2}
\oldpage{102}Let $(Y,\O_Y)$ be a prescheme;
for all $y\in Y$, let $(\psi,\theta)$ be the canonical morphism
$(\Spec(\O_y),\widetilde{\O}_y)\to(Y,\O_Y)$. Then $\psi$ is a homeomorphism
from $\Spec(\O_y)$ to the subspace $S_y$ of $Y$ given by the $z$ such that
$y\in\overline{\{z\}}$ (\emph{or, equivalenty, the \completelyunsure of $y$
\pref{env}{2.1.2}}; furthermore, if $z=\psi(\mathfrak{p})$, then
$\theta_z^\#\colon\O_z\to(\O_y)_\mathfrak{p}$ is an isomorphism; $(\psi,\theta)$
is thus a monomorphism of ringed spaces.
\end{envs}
    
As the unique closed point $a$ of $\Spec(\O_y)$ \unsure{is a member of every
point of this space}, and since $\psi(a)=y$, the image of $\Spec(\O_y)$ under
the continuous map $\psi$ is contained in $S_y$. Since $S_y$ is contained in
every affine open containing $y$, one can consider just the case where $Y$ is an
affine scheme; but then this proposition follows from \eref{1.6.2}.
    
\emph{We see \sref{prop}{2.1.5} that there is a bijective correspondence between
$\Spec(\O_y)$ and the set of closed irreducible subsets of $Y$ containing $y$.}
    
\begin{envs}[Corollary]{2.4.3}
\label{cor-1.2.4.3}
For $y\in Y$ to be the generic point of an
irreducible component of $Y$, it is necessary and sufficient that the only prime
ideal of the local ring $\O_y$ is its maximal ideal (\emph{in other words, that
$\O_y$ is of \emph{dimension zero}}).
\end{envs}
    
\begin{envs}[Proposition]{2.4.4}
\label{prop-1.2.4.4}
Let $(X,\O_X)$ be a local scheme of a ring
$A$, $a$ its unique closed point, and $(Y,\O_Y)$ a prescheme.  Every morphism
$u=(\psi,\theta)\colon(X,\O_X)\to(Y,\O_Y)$ then factorises uniquely as
$X\to\Spec(\O_{\psi(a)})\to Y$, where the second arrow denotes the canonical
morphism, and the first corresponds to a local homomorphism $\O_{\psi(a)}\to A$.
This establishes a canonical bijective correspondence between the set of
morphisms $(X,\O_X)\to(Y,\O_Y)$ and the set of local homomorphisms $\O_y\to A$
for ($y\in Y$).
\end{envs}
    
Indeed, for all $x\in X$, we have that $a\in\overline{\{x\}}$, so
$\psi(a)\in\overline{\{\psi(x)\}}$, which shows that $\psi(X)$ is contained in
every affine open containing $\psi(a)$. So it suffices to consider the case
where $(Y,\O_Y)$ is an affine scheme of ring $B$, and we then have that
$u=(^a\varphi,\tilde{\varphi})$, where $\varphi\in\Hom(B,A)$ (1.7.3).  Further,
we have that $\varphi^{-1}(\mathfrak{j}_a)=\mathfrak{j}_{\psi(a)}$, and hence
that the image under $\varphi$ of any element of
$B\setminus\mathfrak{j}_{\psi(a)}$ is invertible in the local ring $A$; the
factorisation in the result follows from the universal property of the ring of
fractions \pref{env}{1.2.4}. Conversely, to every local homomorphism
$\O_y\to A$ there exists a unique corresponding morphism
$(\psi,\theta)\colon X\to\Spec(\O_y)$ such that $\psi(a)=y$ \eref{1.7.3}, and,
by composing with the canonical morphism $\Spec(\O_y)\to Y$, we obtain a morphism
$X\to Y$, which proves the proposition.
    
\begin{env}{2.4.5}
\label{env-1.2.4.5}
The affine schemes whose ring is a field $K$ have an
underlying space that is just a point. If $A$ is a local ring with maximal
ideal $\mathfrak{m}$, then every local homomorphism $A\to K$ has kernel equal to
$\mathfrak{m}$, and so factorises as $A\to A/\mathfrak{m}\to K$, where the
second arrow is a monomorphism. The morphisms $\Spec(K)\to\Spec(A)$ thus
correspond bijectively to monomorphisms of fields $A/\mathfrak{m}\to K$.
\end{env}
    
Let $(Y,\O_Y)$ be a prescheme; for every $y\in Y$ and every ideal
$\mathfrak{a}_y$ of $\O_y$, the canonical homomorphism
$\O_y\to\O_y/\mathfrak{a}_y$ defines a morphism
$\Spec(\O_y/\mathfrak{a}_y)\to\Spec(\O_y)$; if we compose this with the
canonical morphism $\Spec(\O_y)\to Y$, then we obtain a morphism
$\Spec(\O_y/\mathfrak{a}_y)\to Y$, again said to be \textit{canonical}. For
$\mathfrak{a}_y=\mathfrak{m}_y$, this says that $\O_y/\mathfrak{a}_y=\k(y)$, and
so prop.~\sref{prop}{2.4.4} says that:
    
\begin{envs}[Corollary]{2.4.6}
\label{cor-1.2.4.6}
\oldpage{103}Let $(X,\O_X)$ be a local scheme
whose ring $K$ is a field, $\xi$ be the unique point of $X$, and $(Y,\O_Y)$ a
prescheme. Then every morphism $u\colon(X,\O_X)\to(Y,\O_Y)$ factorises uniquely
as $X\to\Spec(\k(\psi(\xi)))\to Y$, where the second arrow denotes the canonical
morphism, and the first corresponds to a monomorphism $\k(\psi(\xi))\to K$.
This establishes a canonical bijective correspondance between the set of
morphisms $(X,\O_X)\to (Y,\O_Y)$ and the set of monomorphisms $\k(y)\to K$ (for
$y\in Y$).
\end{envs}
    
\begin{envs}[Corollary]{2.4.7}
\label{cor-1.2.4.7}
For all $y\in Y$, every canonical morphism
$\Spec(\O_y/\mathfrak{a}_y)\to Y$ is a monomorphism of ringed spaces.
\end{envs}
    
We have already seen this when $\mathfrak{a}_y=0$ \sref{prop}{2.4.2}, and it suffices
to apply \eref{1.7.5}.
    
\begin{env}[Remark]{2.4.8}
\label{rmk-1.2.4.8}
Let $X$ be a local scheme, and $a$ its unique
closed point.  Since every affine open containing $a$ is necessarily in the
whole of $X$, every \emph{invertible} $\O_X$-module \pref{env}{5.4.1} is
necessarily \emph{isomorphic to $\O_X$} (or, as we say, again, \emph{trivial}).
This property doesn't hold in general, for an arbitrary affine scheme
$\Spec(A)$; we will see in chap.~V that if $A$ is a normal ring then this is
true when $A$ is \unsure{\emph{factorial}}.
\end{env}

\subsection{Preschemes over a prescheme}
\label{1-schemes-2.5}

\begin{env}[Definition]{2.5.1}
\label{defn-1.2.5.1}
Given a prescheme $S$, we say that the data of a
prescheme $X$ and a morphism of preschemes $\varphi\colon X\to S$ defines a
prescheme $X$ \emph{over the prescheme $S$}, or an \emph{$S$-prescheme}; we say
that $S$ is the \emph{base prescheme} of the $S$-prescheme $X$. The morphism
$\varphi$ is called the \emph{structure morphism} of the $S$-prescheme $X$.
When $S$ is an affine scheme of ring $A$, we also say that $X$ endowed with
$\varphi$ is a prescheme \emph{over the ring $A$} (or an \emph{$A$-prescheme}).
\end{env}

It follows from \sref{prop}{2.2.4} that the data of a prescheme over a ring $A$ is
equivalent to the data of a prescheme $(X,\O_X)$ whose structure sheaf $\O_X$ is
a sheaf of \emph{$A$-algebras}. \emph{An arbitrary prescheme can always be
considered as a $\mathbb{Z}$-prescheme in a unique way.}

If $\varphi\colon X\to S$ is the structure morphism of an $S$-prescheme $X$, we
say that a point $x\in X$ is \emph{over a point $s\in S$} if $\varphi(x)=s$.  We
say that $X$ \emph{dominates} $S$ if $\varphi$ is a dominant morphism \eref{2.2.6}.

\begin{env}{2.5.2}
\label{env-1.2.5.2}
Let $X$ and $Y$ be two $S$-preschemes; we say that a morphism
of preschemes $u\colon X\to Y$ is a \emph{morphism of preschemes over $S$} (or
an \emph{$S$-morphism}) if the diagram
\[
  \xymatrix{
    X \ar[rr]^u \ar[dr] & & Y\ar[dl]\\
    & S &
  }
\]
(where the diagonal arrows are the structure morphisms) is
commutative: this ensures that, for all $s\in S$ and $x\in X$ over $s$, $u(x)$
is also above $s$.
\end{env}

From this definition it follows immediately that the composition of two
$S$-morphisms is an $S$-morphism; $S$-preschemes thus form a \emph{category}.

We denote by $\Hom_S(X,Y)$ the set of $S$-morphisms from an $S$-prescheme $X$ to
an $S$-prescheme $Y$; the identity morphism of an $S$-prescheme is denoted by
$1_X$.

When $S$ is an affine scheme of ring $A$, we will also say \emph{$A$-morphism}
instead of $S$-morphism.

\begin{env}{2.5.3}
\label{env-1.2.5.3}
\oldpage{104}If $X$ is an $S$-prescheme, and $v\colon X'\to X$ a morphism of preschemes,
then the composition $X'\to X\to S$ endows $X'$ with the structure of an $S$-prescheme;
in particular, every prescheme induced by an open set $U$ of $X$ can be considered as an
$S$-prescheme by the canonical injection.
\end{env}

If $u\colon X\to Y$ is an $S$-morphism of $S$-preschemes, then the restriction
of $u$ to any prescheme induced by an open subset $U$ of $X$ is also an
$S$-morphism $U\to Y$. Conversely, let $(U_\alpha)$ be an open cover of $X$,
and for each $\alpha$ let $u_\alpha\colon U_\alpha\to Y$ be an $S$-morphism; if,
for all pairs of indices $(\alpha,\beta)$, the restrictions of $u_\alpha$ and
$u_\beta$ to $U_\alpha\cap U_\beta$ agree, then there exists an $S$-morphism
$X\to Y$, and only one such that the restriction to each $U_\alpha$ is
$u_\alpha$.

If $u\colon X\to Y$ is an $S$-morphism such that $u(X)\subset V$, where $V$ is
an open subset of $Y$, then $u$, considered as a morphism from $X$ to $V$, is
also an $S$-morphism.

\begin{env}{2.5.4}
\label{env-1.2.5.4}
Let $S'\to S$ be a morphism of preschemes; for all
$S'$-preschemes, the composition $X\to S'\to S$ endows $X$ with the structure of
an $S$-prescheme. Conversely, suppose that $S'$ is the induced prescheme of an
open subset of $S$; let $X$ be an $S$-prescheme and suppose that the structure
morphism $f\colon X\to S$ is such that $f(X)\subset S'$; then we can consider
$X$ as an $S'$-preschemes. In this latter case, if $Y$ is another $S$-prescheme
whose structure morphism sends the underlying space to $S'$, then every
$S$-morphism from $X$ to $Y$ is also an $S'$-morphism.
\end{env}

\begin{env}{2.5.5}
\label{env-1.2.5.5}
If $X$ is an $S$-prescheme, with structure morphism
$\varphi\colon X\to S$, we define an \emph{$S$-section of $X$} to be an
$S$-morphism from $S$ to $X$, that is to say a morphism of preschemes
$\psi\colon S\to X$ such that $\varphi\circ\psi$ is the identity on $S$.  We
denote by $\Gamma(X/S)$ the set of $S$-sections of $X$.
\end{env}

\section{Products of preschemes}
\label{1-schemes-3}

\section{Subpreschemes and immersion morphisms}
\label{1-schemes-4}

\section{Reduced preschemes; separation conditions}
\label{1-schemes-5}

\section{Finiteness conditions}
\label{1-schemes-6}

\section{Rational maps}
\label{1-schemes-7}

\section{Chevalley schemes}
\label{1-schemes-8}

\subsection{Allied local rings}
\label{1-schemes-8.1}

For every local ring $A$, we denote by $\mathfrak{m}(A)$ the maximal ideal of
$A$.

\begin{envs}[Lemma]{8.1.1}
\label{lem-1.8.1.1}
Let $A$ and $B$ be two local rings such that $A\subset B$;
then the following conditions are equivalent: (i)
$\mathfrak{m}(B)\cap A=\mathfrak{m}(A)$; (ii)
$\mathfrak{m}(A)\subset\mathfrak{m}(B)$; (iii) $1$ is not an element of
the ideal of $B$ generated by $\mathfrak{m}(A)$.
\end{envs}

It's evident that (i) implies (ii), and (ii) implies (iii); lastly, if (iii) is
true, then $\mathfrak{m}(B)\cap A$ contains $\mathfrak{m}(A)$ and doesn't
contain $1$, and is thus equal to $\mathfrak{m}(A)$.

When the equivalent conditions of \sref{lem}{8.1.1} are satisfied, we say that $B$
\emph{dominates} $A$; this is equivalent to saying that the injection $A\to B$
is a \emph{local} homomorphism. It is clear that, in the set of local subrings
of a ring $R$, the relation given by domination is an \unsure{order}.

\begin{env}{8.1.2}
\label{env-1.8.1.2}
Now consider a \emph{field} $R$. For all subrings $A$ of
$R$, we denote by $L(A)$ the set of local rings $A_\mathfrak{p}$, where
$\mathfrak{p}$ runs over the prime spectrum of $A$; they are identified with the
subrings of $R$ containing $A$. Since
$\mathfrak{p}=(\mathfrak{p}A_\mathfrak{p})\cap A$, the map $\mathfrak{p}\to
A_\mathfrak{p}$ from $\Spec(A)$ into $L(A)$ is bijective.
\end{env}

\begin{envs}[Lemma]{8.1.3}
\label{lem-1.8.1.3}
Let $R$ be a field, and $A$ a subring of $R$. For a
local subring $M$ of $R$ to dominate a ring $A_\mathfrak{p}\in L(A)$ it is
necessary and sufficient that $A\subset M$; the local ring $A_\mathfrak{p}$
dominated by $M$ is then unique, and corresponds to
$\mathfrak{p}=\mathfrak{m}(M)\cap A$.
\end{envs}

Indeed, if $M$ dominates $A_\mathfrak{p}$, then $\mathfrak{m}(M)\cap
A_\mathfrak{p}=\mathfrak{p}A_\mathfrak{p}$, by \sref{lem}{8.1.1}, whence the
uniqueness of $\mathfrak{p}$; on the other hand, if $A\subset M$, then
$\mathfrak{m}M\cap A=\mathfrak{p}$ is prime in $A$, and since
$A\setminus\mathfrak{p}\subset M$, we have that $A_\mathfrak{p}\subset M$ and
$\mathfrak{p}A_\mathfrak{p}\subset\mathfrak{m}(M)$, so $M$ dominates
$A_\mathfrak{p}$

\begin{envs}[Lemma]{8.1.4}
\label{lem-1.8.1.4}
\oldpage{165}Let $R$ be a field, $M$ and $N$ two local
subrings of $R$, and $P$ the subring of $R$ generated by $M\cup N$. Then the
following conditions are equivalent:
\begin{itemize}
  \item[(i)] There exists a prime ideal $\mathfrak{p}$ of $P$ such that
$\mathfrak{m}(M)=\mathfrak{p}\cap M$ and $\mathfrak{m}(N)=\mathfrak{p}\cap N$.
  \item[(ii)] The ideal $\mathfrak{a}$ generated in $P$ by
$\mathfrak{m}(M)\cup\mathfrak{m}(N)$ is distinct from $P$. \item There exists a
local subring $Q$ of $R$ simultaneously dominating both $M$ and $N$.
\end{itemize}
\end{envs}

It is clear that (i) implies (ii); conversely, if $\mathfrak{a}\neq P$, then
$\mathfrak{a}$ is contained in a maximal ideal $\mathfrak{n}$ of $P$, and since
$1\not\in\mathfrak{n}$, $\mathfrak{n}\cap M$ contains $\mathfrak{m}(M)$ and is
distinct from $M$, so $\mathfrak{n}\cap M=\mathfrak{m}(M)$, and similarly
$\mathfrak{n}\cap N=\mathfrak{m}(N)$. It is clear that, if $Q$ dominates both
$M$ and $N$, then $P\subset Q$ and $\mathfrak{m}(M)=\mathfrak{m}(Q)\cap
M=(\mathfrak{m}(Q)\cap P)\cap M$, and $\mathfrak{m}(N)=(\mathfrak{m}(Q)\cap
P)\cap N$, so (iii) implies (i); the reciprocal is evident when we take
$Q=P_\mathfrak{p}$.

When the conditions of \sref{lem}{8.1.4} are satisfied, we say, with C.~Chevalley,
that the local rings $M$ and $N$ are \emph{allied}.

\begin{envs}[Proposition]{8.1.5}
\label{prop-1.8.1.5}
Let $A$ and $B$ be two subrings of a field $R$,
and $C$ the subring of $R$ generated by $A\cup B$. Then the following
conditions are equivalent:
\begin{itemize}
  \item[(i)] For every local ring $Q$ containing $A$ and $B$, we have that
  $A_\mathfrak{p}=B_\mathfrak{q}$, where $\mathfrak{p}=\mathfrak{m}(Q)\cap A$ and
$\mathfrak{q}=\mathfrak{m}(Q)\cap B$.
  \item[(ii)] For all prime ideals $\mathfrak{r}$
of $C$, we have that $A_\mathfrak{p}=B_\mathfrak{q}$, where
$\mathfrak{p}=\mathfrak{r}\cap A$ and $\mathfrak{q}=\mathfrak{r}\cap B$. \item
If $M\in L(A)$ and $N\in L(B)$ are allied, then they are identical. \item
$L(A)\cap L(B)=L(C)$.
\end{itemize}
\end{envs}

Lemmas \sref{lem}{8.1.3} and \sref{lem}{8.1.4} prove that (i) and (iii) are equivalent; it
is clear that (i) implies (ii) by taking $Q=C_\mathfrak{r}$; conversely, (ii)
implies (i), because if $Q$ contains $A\cup B$ then it contains $C$, and if
$\mathfrak{r}=\mathfrak{m}(Q)\cap C$ then $\mathfrak{p}=\mathfrak{r}\cap A$ and
$\mathfrak{q}=\mathfrak{r}\cap B$, from \sref{lem}{8.1.3}. It is immediate that (iv)
implies (i), because if $Q$ contains $A\cup B$ then it dominates a local ring
$C_\mathfrak{r}\in L(C)$ by \sref{lem}{8.1.3}; by hypothesis we have that
$C_\mathfrak{r}\in L(A)\cap L(B)$, and \sref{lem}{8.1.1} and \sref{lem}{8.1.3} prove that
$C_\mathfrak{r}=A_\mathfrak{p}=B_\mathfrak{q}$. We prove finally that (iii)
implies (iv). Let $Q\in L(C)$; $Q$ dominates some $M\in L(A)$ and some $N\in
L(B)$ \sref{lem}{8.1.3}, so $M$ and $N$, being allied, are identical by hypothesis.
As we then have that $C\subset M$, we know that $M$ dominates some $Q'\in L(C)$
\sref{lem}{8.1.3}, so $Q$ dominates $Q'$, whence necessarily \sref{lem}{8.1.3} $Q=Q'=M$,
so $Q\in L(A)\cap L(B)$. Conversely, if $Q\in L(A)\cap L(B)$, then $C\subset
Q$, so \sref{lem}{8.1.3} $Q$ dominates some $Q''\in L(C)\subset L(A)\cap L(B)$; $Q$
and $Q''$, being allied, are identical, so $Q''=Q\in L(C)$, which completes the
proof.

\subsection{Local rings of an integral scheme}
\label{1-schemes-8.2}

\begin{env}{8.2.1}
\label{env-1.8.2.1}
Let $X$ be an \emph{integral} prescheme, and $R$ its field of
rational functions, identical to the local ring of the generic point $a$ of $X$;
for all $x\in X$, we know that $\O_x$ can be canonically identified with a
subring of $R$ \eref{7.1.5}, and for every rational function $f\in R$, the
domain of definition $\delta(f)$ of $f$ is the open set of $x\in X$ such that
$f\in\O_x$. It thus follows from \eref{7.2.6} that, for every open $U\subset X$,
we have
\[
  \Gamma(U,\O_X)=\bigcap_{x\in U}\O_x.\tag{8.2.1.1}
\]
\end{env}

\begin{envs}[Proposition]{8.2.2}
\label{prop-1.8.2.2}
\oldpage{166}Let $X$ be an integral prescheme,
and $R$ its field of rational fractions. For $X$ to be a scheme, it is
necessary and sufficient that the relation ``$\O_x$ and $\O_y$ are allied''
\sref{lem}{8.1.4}, for points $x,y$ of $X$, implies that $x=y$.
\end{envs}

Suppose that this condition is verified, and aim to show that $X$ is separated.
Let $U$ and $V$ be two distinct affine opens of $X$, with rings $A$ and $B$,
identified with subrings of $R$; $U$ (resp.$V$) is thus identified \eref{8.1.2}
with $L(A)$ (resp.$L(B)$), and the hypothesis tells us \eref{8.1.5} that $C$ is
the subring of $R$ generated by $A\cup B$, and $W=U\cap V$ is identified with
$L(A)\cap L(B)=L(C)$. Further, we know
([1],~p.~\unsure{5-03},~prop.~4~\emph{bis}) that every subring $E$ of $R$ is
equal to the intersection of the local rings belonging to $L(E)$; $C$ is thus
identified with the intersection of the rings $\O_z$ for $z\in W$, or,
equivalently (8.2.1.1) with $\Gamma(W,\O_X)$. So consider the subprescheme
induced by $X$ on $W$; to the \unsure{identity} morphism $\varphi\colon
C\to\Gamma(W,\O_X)$ there corresponds \eref{2.2.4} a morphism
$\Phi=(\psi,\theta)\colon W\to\Spec(C)$; we will see that $\Phi$ is an
\emph{isomorphism} of preschemes, whence $W$ is an \emph{affine} open. The
identification of $W$ with $L(C)=\Spec(C)$ shows that $\psi$ is
\emph{bijective}.On the other hand, for all $x\in W$, $\theta_x^\#$ is the
injection $C_\mathfrak{r}\to\O_x$, where $\mathfrak{r}=\mathfrak{m}_x\cap C$,
and by definition $C_\mathfrak{r}$ is identified with $\O_x$, so $\theta_x^\#$
is bijective. It thus remains to show that $\psi$ is a \emph{homeomorphism},
i.e.\ that for every closed subset $F\subset W$, $\psi(F)$ is closed in
$\Spec(C)$. But $F$ is the \unsure{trace over} $W$ of closed subspace of $U$,
of the form $V(\mathfrak{a})$, where $\mathfrak{a}$ is an ideal of $A$; we show
that $\psi(F)=V(\mathfrak{a}C)$, which proves our claim. In fact, the prime
ideals of $C$ containing $\mathfrak{a}C$ are the prime ideals of $C$ containing
$\mathfrak{a}$, and so are the ideals of the form $\psi(x)=\mathfrak{m}_x\cap
C$, where $\mathfrak{a}\subset\mathfrak{m}_x$ and $x\in W$; since
$\mathfrak{a}\subset\mathfrak{m}_x$ is equivalent to $x\in V(\mathfrak{a})=W\cap
F$ for $x\in U$, we do indeed have that $\psi(F)=V(\mathfrak{a}C)$.

It follows that $X$ is separated, because $U\cap V$ is affine and its ring $C$
is generated by the union $A\cup B$ of the rings of $U$ and $V$ \eref{5.5.6}.

Conversely, suppose that $X$ is separated, and let $x,y$ be two points of $X$
such that $\O_x$ and $\O_y$ are allied. Let $U$ (resp.$V$) be an affine open
containing $x$ (resp.$y$), of ring $A$ (resp.$B$); we then know that $U\cap V$
is affine and that its ring $C$ is generated by $A\cup B$ \eref{5.5.6}. If
$\mathfrak{p}=\mathfrak{m}_x\cap A$ and $\mathfrak{q}=\mathfrak{m}_y\cap B$,
then $A_\mathfrak{p}=\O_x$ and $B_\mathfrak{q}=\O_y$, and since $A_\mathfrak{p}$
and $B_\mathfrak{q}$ are allied, there exists a prime ideal $\mathfrak{r}$ of
$C$ such that $\mathfrak{p}=\mathfrak{r}\cap A$ and
$\mathfrak{q}=\mathfrak{r}\cap B$ \sref{lem}{8.1.4}. But then there exists a point
$z\in U\cap V$ such that $\mathfrak{r}=\mathfrak{m}_z\cap C$, since $U\cap V$ is
affine, and so evidently $x=z$ and $y=z$, whence $x=y$.

\begin{envs}[Corollary]{8.2.3}
\label{cor-1.8.2.3}
Let $X$ be an integral scheme, and $x,y$ two
points of $X$.In order that $x\in\overline{\{y\}}$, it is necessary and
sufficient that $\O_x\subset\O_y$, or, equivalently, that every rational
function defined at $x$ is also defined at $y$.
\end{envs}

The condition is evidently necessary because the domain of definition
$\delta(f)$ of a rational function $f\in R$ is open; we now show that it is
sufficient.If $\O_x\subset\O_y$, then there exists a prime ideal
$\mathfrak{p}$ of $\O_x$ such that $\O_y$ dominates $(\O_x)_\mathfrak{p}$
\sref{lem}{8.1.3}; but \eref{2.4.2} there exists $z\in X$ such that
$x\in\overline{\{z\}}$ and $\O_z=(\O_x)_\mathfrak{p}$; since $\O_z$ and $\O_y$
are allied, we have that $z=y$ by \sref{prop}{8.2.2}, whence the corollary.

\begin{envs}[Corollary]{8.2.4}
\label{cor-1.8.2.4}
If $X$ is an integral scheme then the map
$x\to\O_x$ is injective; equivalently, if $x$ and $y$ are two distinct points of
$X$, then there exists a rational function defined at one of these points but
not the other.
\end{envs}

\oldpage{167}This follows from \sref{cor}{8.2.3} and the axiom ($\mathrm{T}_0$)
\eref{2.1.4}.

\begin{envs}[Corollary]{8.2.5}
\label{cor-1.8.2.5}
Let $X$ be an integral scheme whose underlying
space is Noetherian; letting $f$ run over the field $R$ of rational functions on
$X$, the sets $\delta(f)$ generate the topology of $X$.
\end{envs}

In fact, every closed subset of $X$ is thus a finite union of irreducible closed
subsets, i.e.of the form $\overline{\{y\}}$ \eref{2.1.5}. But, if
$x\not\in\overline{\{y\}}$, then there exists a rational function $f$ defined at
$x$ but not at $y$ \sref{cor}{8.2.3}, or, equivalently, we have that $x\in\delta(f)$
and $\delta(f)$ is not contained in $\overline{\{y\}}$. The complement  of
$\overline{\{y\}}$ is thus a union of sets of the form $\delta(f)$, and by
virtue of the first remark, every open subset of $X$ is the union of finite
intersections of open sets of the form $\delta(f)$.

\begin{env}{8.2.6}
\label{env-1.8.2.6}
Corollary~\sref{cor}{8.2.5} shows that the topology of $X$ is
entirely characterised by the data of the local rings $(\O_x)_{x\in X}$ that
have $R$ as their field of fractions. It amounts to the same to say that the
closed subsets of $X$ are defined in the following manner: given a finite subset
$\{x_1,\ldots,x_n\}$ of $X$, consider the set of $y\in X$ such that
$\O_y\subset\O_{x_i}$ for at least one index $i$, and these sets (over all
choices of $\{x_1,\ldots,x_n\}$) are the closed subsets of $X$. Further, once
the topology on $X$ is known, the structure sheaf $\O_X$ is also determined by
the family of the $\O_x$, since $\Gamma(U,\O_X)=\bigcap_{x\in U}\O_x$ by
(8.2.1.1). The family $(\O_X)_{x\in X}$ thus completely determines the
prescheme $X$ when $X$ is an integral scheme whose underlying space is
Noetherian.
\end{env}

\begin{envs}[Proposition]{8.2.7}
\label{prop-1.8.2.7}
Let $X,Y$ be two integral schemes, $f\colon X\to Y$ a dominant morphism
\eref{2.2.6}, and $K$ (resp.$L$) the field of rational
functions on $X$ (resp.$Y$). Then $L$ can be identified with a subfield of
$K$, and for all $x\in X$, $\O_{f(x)}$ is the unique local ring of $Y$ dominated
by $\O_x$.
\end{envs}

In fact, if $f=(\psi,\theta)$ and $a$ is the generic point of $X$, then
$\psi(a)$ is the generic point of $Y$ \pref{env}{2.1.5}; $\theta_a^\#$ is then
a monomorphism of fields, from $L=\O_{\psi(a)}$ to $K=\O_a$. Since every
non-empty affine open $U$ of $Y$ contains $\psi(a)$, it follows from
\eref{2.2.4} that the homomorphism $\Gamma(U,\O_Y)\to\Gamma(\psi^{-1}(U),\O_X)$
corresponding to $f$ is the restriction of $\theta_a^\#$ to $\Gamma(U,\O_Y)$.
So, for every $x\in X$, $\theta_x^\#$ is the restriction to $\O_{\psi(a)}$ of
$\theta_a^\#$, and is thus a monomorphism. We also know that $\theta_x^\#$ is a
local homomorphism, so, if we identify $L$ with a subfield of $K$ by
$\theta_a^\#$, $\O_{\psi(x)}$ is dominated by $\O_x$ \sref{lem}{8.1.1}; it is also
the only local ring of $Y$ dominated by $\O_x$, since two local rings of $Y$
that are allied are identical \sref{prop}{8.2.2}.

\begin{envs}[Proposition]{8.2.8}
\label{prop-1.8.2.8}
Let $X$ be an \emph{irreducible} prescheme; and
$f\colon X\to Y$ a local immersion (\emph{resp.} a local isomorphism); and
suppose further that $f$ is separated. Then $f$ is an immersion (\emph{resp.}
an open immersion).
\end{envs}

Let $f=(\psi,\theta)$; it suffices, in both cases, to prove that $\psi$ is a
\emph{homeomorphism} from $X$ to $\psi(X)$ \eref{4.5.3}. Replacing $f$ by
$f_\mathrm{red}$ (\eref{5.1.6} and \eref{5.5.1},~(vi)), we can assume that $X$
and $Y$ are \emph{reduced}. If $Y'$ is the closed reduced subprescheme of $Y$
having $\overline{\psi(X)}$ as its underlying space, then $f$ factorises as
$X\xrightarrow{f'}Y'\xrightarrow{j}Y$, where $j$ is the canonical injection
\eref{5.2.2}. It follows from (\eref{5.5.1},~(v)) that $f'$ is again a
separated morphism; further, $f'$ is again \oldpage{168}a local immersion (resp.
a local isomorphism), because, since the condition is local on $X$ and $Y$, we
can reduce ourselves to the case where $f$ is a closed immersion (resp.open
immersion), and then our claim follows immediately from \eref{4.2.2}.

We can thus suppose that $f$ is a \emph{dominant} morphism, which leads to the
fact that $Y$ is, itself, irreducible \pref{env}{2.1.5}, and so $X$ and $Y$
are both \emph{integral}. Further, the condition being local on $Y$, we can
suppose that $Y$ is an affine scheme; since $f$ is separated, $X$ is a scheme
(\eref{5.5.1},~(ii)), and we are finally at the hypotheses of \sref{prop}{8.2.7}.
Then, for all $x\in X$, $\theta_x^\#$ is injective; but the hypothesis that $F$
is a local immersion implies that $\theta_x^\#$ is surjective \eref{4.2.2}, so
$\theta_x^\#$ is bijective, or, equivalently (with the identification of
\eref{8.2.7}) we have that $\O_{\psi(x)}=\O_x$. This implies, by \sref{cor}{8.2.4},
that $\psi$ is an \emph{injective} map, which already proves the proposition
when $f$ is a local isomorphism \eref{4.5.3}. When we suppose that $f$ is only
a local immersion, for all $x\in X$ there exists an open neighbourhood $U$ of
$x$ in $X$ and an open neighbourhood $V$ of $\psi(x)$ in $Y$ such that the
restriction of $\psi$ to $U$ is a homeomorphism from $U$ to a \emph{closed}
subset of $V$. But $U$ is dense in $X$, so $\psi(U)$ is dense in $Y$ and
\emph{a fortiori} in $V$, which proves that $\psi(U)=V$; since $\psi$ is
injective, $\psi^{-1}(V)=U$ and this proves that $\psi$ is a homeomorphism from
$X$ to $\psi(X)$.

\subsection{Chevalley schemes}
\label{1-schemes-8.3}

\begin{env}{8.3.1}
\label{env-1.8.3.1}
Let $X$ be a \emph{Noetherian} integral scheme, and $R$ its
field of rational functions; we denote by $X'$ the set of local subrings
$\O_x\subset R$, where $x$ runs over all points of $X$. The set $X'$ verifies
the three following conditions:
\begin{itemize}
  \item[(Sch. 1)] For all $M\in X'$, $R$ is the field of fractions of $M$.
  \item[(Sch. 2)] There exists a finite set of Noetherian subrings $A_i$ of $R$
  such that $X'=\bigcup_i L(A_i)$, and, for all pairs of indices $i,j$, the subring
  $A_{ij}$ of $R$ generated by $A_i\cup A_j$ is an algebra of finite type over $A_i$.
  \item[(Sch. 3)] Two elements $M$ and $N$ of $X'$ that are allied are identical.
\end{itemize}
\end{env}

We have basically seen in \eref{8.2.1} that (Sch.~1) is satisfied, and (Sch.~3)
follows from \eref{8.2.2}. To show (Sch.~2), it suffices to cover $X$ by a
finite number of affine opens $U_i$, whose rings are Noetherian, and to take
$A_i=\Gamma(U_i,\O_X)$; the hypothesis that $X$ is a scheme implies that
$U_i\cap U_j$ is affine, and also that $\Gamma(U_i\cap U_j,\O_X)=A_{ij}$
\eref{5.5.6}; further, since the space $U_i$ is Noetherian, the immersion
$U_i\cap U_j\to U_i$ is of finite type \eref{6.3.5}, so $A_{ij}$ is an
$A_i$-algebra of finite type \eref{6.3.3}.

\begin{env}{8.3.2}
\label{env-1.8.3.2}
The structures whose axioms are (Sch.~1), (Sch.~2), and
(Sch.~3), generalise ``schemes'' in the sense of C.~Chevalley, who supposes
furthermore that $R$ is an extension of finite type of a field $K$, and that the
$A_i$ are $K$-algebras of finite type (which renders a part of (Sch.~2) useless)
[1]. Conversely, if we have such a structure on a set $X'$, then we can
associate to it an integral scheme $X$ by using the remarks from \eref{8.2.6}:
the underlying space of $X$ is equal to $X'$ endowed with the topology defined
in \eref{8.2.6}, and with the sheaf $\O_X$ such that
$\Gamma(U,\O_X)=\bigcap_{x\in U}\O_x$ for all open $U\subset X$, with the
evident definition of restriction homomorphisms. We leave to the reader the
task of verifying that we obtain thusly an integral scheme, whose local rings
are the elements of $X'$; we will not use this result in what follows.
\end{env}

\section{Supplement on quasicoherent sheaves}
\label{1-schemes-9}

\subsection{Tensor product of quasicoherent sheaves}
\label{1-schemes-9.1}

\begin{envs}[Proposition]{9.1.1}
\label{prop-1.9.1.1}
\oldpage{169}Let $X$ be a prescheme
(\emph{resp.} a locally Noetherian prescheme). Let $\sheaf{F}$ and $\sheaf{G}$
be two quasicoherent (\emph{resp.} coherent) $\O_X$-modules; then
$\sheaf{F}\otimes_{\O_X}\sheaf{G}$ is quasicoherent (\emph{resp.} coherent) and
of finite type if $\sheaf{F}$ and $\sheaf{G}$ are of finite type. If
$\sheaf{F}$ admits a finite presentation and if $\sheaf{G}$ is quasicoherent
(\emph{resp.} coherent), then $\sheafHom(\sheaf{F},\sheaf{G})$ is quasicoherent
(\emph{resp.} coherent).
\end{envs}

Being a local property, we can suppose that $X$ is affine (resp.Noetherian
affine); further, if $\sheaf{F}$ is coherent, then we can assume that it is the
cokernel of a homomorphism $\O_X^m\to\O_X^n$. The claims pertaining to
quasicoherent sheaves then follow from \eref{1.3.12} and \eref{1.3.9}; the
claims pertaining to coherent sheaves follow from \eref{1.5.1} and from the fact
that, if $M$ and $N$ are modules of finite type over a Noetherian ring $A$,
$M\otimes_A N$ and $\Hom_A(M,N)$ are $A$-modules of finite type.

\begin{env}[Definition]{9.1.2}
\label{defn-1.9.1.2}
Let $X$ and $Y$ be two $S$-preschemes, $p$ and
$q$ the projections of $X\times_S Y$, and $\sheaf{F}$ (resp.$\sheaf{G}$) a
quasicoherent $\O_X$-module (resp.quasicoherent $\O_Y$-module). We define the
tensor product of $\sheaf{F}$ and $\sheaf{G}$ over $\O_S$ (\emph{or} over $S$),
denoted by $\sheaf{F}\otimes_{\O_S}\sheaf{G}$ (\emph{or}
$\sheaf{F}\otimes_S\sheaf{G}$) to be the tensor product
$p^\ast(\sheaf{F})\otimes_{\O_{X\times_S Y}}q^\ast(\sheaf{G})$ over the
prescheme $X\times_S Y$.
\end{env}

If $X_i$ ($1\leq i\leq n$) are $S$-preschemes, and $\sheaf{F}_i$ are
quasicoherent $\O_{X_i}$-modules ($1\leq i\leq n$), then we define similarly the
tensor product
$\sheaf{F}_1\otimes_S\sheaf{F}_2\otimes_S\cdots\otimes_S\sheaf{F}_n$ over the
prescheme $Z=X_1\times_S X_2\times_S\cdots\times_S X_n$; it is a
\emph{quasicoherent} $\O_Z$-module by virtue of \sref{prop}{9.1.1} and
\pref{env}{5.1.4}; it is \emph{coherent} if the $\sheaf{F}_i$ are coherent and
$Z$ is \emph{locally Noetherian}, by virtue of \sref{prop}{9.1.1},
\pref{env}{5.3.11}, and \eref{6.1.1}.

Note that if we take $X=Y=S$ then definition \sref{defn}{9.1.2} gives us back the tensor
product of $\O_S$-modules. Furthermore, as $q^\ast(\O_Y)=\O_{X\times_S Y}$
\pref{env}{4.3.4}, the product $\sheaf{F}\otimes_S\O_Y$ is canonically
identified with $p^\ast(\sheaf{F})$, and, in the same way,
$\O_X\otimes_S\sheaf{G}$ is canonically identified with $q^\ast(\sheaf{G})$. In
particular, if we take $Y=S$ and denote by $f$ the structure morphism $X\to Y$,
we have that $\O_X\otimes_Y\sheaf{G}=f^\ast(\sheaf{G})$: the ordinary tensor
product and the inverse image thus appear as particular cases of the general
tensor product.

Definition \sref{defn}{9.1.2} leads immediately to the fact that, for fixed $X$ and
$Y$, $\sheaf{F}\otimes_S\sheaf{G}$ is an \emph{additive covariant bifunctor that
is right-exact} in $\sheaf{F}$ and $\sheaf{G}$.

\begin{envs}[Proposition]{9.1.3}
\label{prop-1.9.1.3}
Let $S,X,Y$ be three affine schemes of rings
$A,B,C$ (respectively), with $B$ and $C$ being $A$-algebras. Let $M$
(\emph{resp.} $N$) be a $B$-module (\emph{resp.} $C$-module), and
$\sheaf{F}=\widetilde{M}$ (\emph{resp.} $\sheaf{G}=\widetilde{N}$) the
associated quasicoherent sheaf; then $\sheaf{F}\otimes_S\sheaf{G}$ is
canonically isomorphic to the sheaf associated to the $(B\otimes_A C)$-module
$M\otimes_A N$.
\end{envs}

\oldpage{170}In fact, by virtue of \eref{1.6.5}, $\sheaf{F}\otimes_S\sheaf{G}$
is canonically isomorphic to the sheaf associated to the $(B\otimes_A C)$-module
\[
  \big(M\otimes_B(B\otimes_A C)\big)\otimes_{B\otimes_A C}\big((B\otimes_A C)\otimes_C N\big)
\]
and by the canonical isomorphisms between tensor
products, this latter module is isomorphic to
\[
  M\otimes_B(B\otimes_A C)\otimes_C N=(M\otimes_B B)\otimes_A(C\otimes_C N)=M\otimes_A N.
\]

\begin{envs}[Proposition]{9.1.4}
\label{prop-1.9.1.4}
Let $f\colon T\to X$, and $g\colon T\to Y$ be
two $S$-morphisms, and $\sheaf{F}$ (\emph{resp.} $\sheaf{G}$) a quasicoherent
$\O_X$-module (\emph{resp.} quasicoherent $\O_Y$-module). Then
\[
  (f,g)^\ast_S(\sheaf{F}\otimes_S\sheaf{G})=f^\ast(\sheaf{F})\otimes_{\O_T}g^\ast(\sheaf{G}).
\]
\end{envs}

If $p,q$ are the projections of $X\times_S Y$, then the formula in fact follows
from the relations $(f,g)^\ast_S\circ p^\ast=f^\ast$ and
$(f,g)^\ast_S\circ q^\ast=g^\ast$ \pref{env}{3.5.5}, and the fact that the inverse
image of a tensor product of algebraic sheaves is the tensor product of their inverse
images \pref{env}{4.3.3}.

\begin{envs}[Corollary]{9.1.5}
\label{cor-1.9.1.5}
Let $f\colon X\to X'$ and $g\colon Y\to Y'$ be
$S$-morphisms, and $\sheaf{F}'$ (\emph{resp.} $\sheaf{G}'$) a quasicoherent
$\O_{X'}$-module (\emph{resp.} quasicoherent $\O_{Y'}$-module). Then
\[
  (f,g)^\ast_S(\sheaf{F}'\otimes_S\sheaf{G}')
  =f^\ast(\sheaf{F}')\otimes_S g^\ast(\sheaf{G}')
\]
\end{envs}

This follows from \eref{9.1.4} and the fact that $f\times_S g=(f\circ p, g\circ
q)_S$, where $p,q$ are the projections of $X\times_S Y$.

\begin{envs}[Corollary]{9.1.6}
\label{cor-1.9.1.6}
Let $X,Y,Z$ be three $S$-preschemes, and
$\sheaf{F}$ (\emph{resp.} $\sheaf{G},\sheaf{H}$) a quasicoherent $\O_X$-module
(\emph{resp.} quasicoherent $\O_Y$-module, quasicoherent $\O_Z$-module); then
the sheaf $\sheaf{F}\otimes_S\sheaf{G}\otimes_S\sheaf{H}$ is the inverse image
of $(\sheaf{F}\otimes_S\sheaf{G})\otimes_S\sheaf{H}$ by the canonical
isomorphism from $X\times_S Y\times_S Z$ to $(X\times_S Y)\times_S Z$.
\end{envs}

In fact, this isomorphism is given by $(p_1,p_2)_S\times_S p_3$, where
$p_1,p_2,p_3$ are the projections of $X\times_S Y\times_S Z$.

Similarly, the inverse image of $\sheaf{G}\otimes_S\sheaf{F}$ by the canonical
isomorphism from $X\times_S Y$ to $Y\times_S X$ is $\sheaf{F}\otimes_S\sheaf{G}$.

\begin{envs}[Corollary]{9.1.7}
\label{cor-1.9.1.7}
If $X$ is an $S$-prescheme, then every
quasicoherent $\O_X$-module $\sheaf{F}$ is the inverse image of
$\sheaf{F}\otimes_S\O_S$ by the canonical isomorphism from $X$ to $X\times_S S$
\eref{3.3.3}.
\end{envs}

In fact, this isomorphism is $(1_X,\varphi)_S$, where $\varphi$ is the structure
morphism $X\to S$, and the corollary follows from \eref{9.1.4} and the fact that
$\varphi^\ast(\O_S)=\O_X$.

\begin{env}{9.1.8}
\label{env-1.9.1.8}
Let $X$ be an $S$-prescheme, $\sheaf{F}$ a quasicoherent
$\O_X$-module, and $\varphi\colon S'\to S$ a morphism; we denote by
$\sheaf{F}_{(\varphi)}$ or $\sheaf{F}_{(S')}$ the quasicoherent sheaf
$\sheaf{F}\otimes_S\O_{S'}$ over $X\times_S S'=X_{(\varphi)}=X_{(S')}$; so
$\sheaf{F}_{(S')}=p^\ast(\sheaf{F})$, where $p$ is the projection $X_{(S')}\to X$.
\end{env}

\begin{envs}[Proposition]{9.1.9}
\label{prop-1.9.1.9}
Let $\varphi''\colon S''\to S'$ be a morphism.
For every quasicoherent $\O_X$-module $\sheaf{F}$ on the $S$-prescheme~$X$,
$(\sheaf{F}_{(\varphi)})_{(\varphi')}$ is the inverse image of
$\sheaf{F}_{(\varphi\circ\varphi')}$ by the canonical isomorphism
$(X_{(\varphi)})_{(\varphi')}\xrightarrow{\sim}X_{(\varphi\circ\varphi')}$
\eref{3.3.9}.
\end{envs}

This follows immediately from the definitions and from \eref{3.3.9}, and is
written
\[
  (\sheaf{F}\otimes_S\O_{S'})\otimes_{S'}\O_{S''}=\sheaf{F}\otimes_S\O_{S''}.\tag{9.1.9.1}
\]

\begin{envs}[Proposition]{9.1.10}
\label{prop-1.9.1.10}
Let $Y$ be an $S$-prescheme, and $f\colon X\to Y$ an $S$-morphism.
For every quasicoherent $\O_Y$-module and every morphism
$S'\to S$, we have that
$(f_{(S')})^\ast(\sheaf{G}_{(S')})=(f^\ast(\sheaf{G}))_{(S')}$.
\end{envs}

This follows immediately from the commutativity of the diagram \oldpage{171}
\[
  \xymatrix{
    X_{(S')}\ar[r]^{f_{(S')}}\ar[d] & Y_{(S')}\ar[d]\\
    X\ar[r]^f & Y
  }
\]

\begin{envs}[Corollary]{9.1.11}
\label{cor-1.9.1.11}
Let $X$ and $Y$ be $S$-preschemes, and
$\sheaf{F}$ (\emph{resp.} $\sheaf{G}$) a quasicoherent $\O_X$-module
(\emph{resp.} quasicoherent $\O_Y$-module). Then the inverse image of the sheaf
$(\sheaf{F}_{(S')})\otimes_{(S')}(\sheaf{G}_{(S')})$ by the canonical isomorphism
$(X\times_S Y)_{(S')}\xrightarrow{\sim}(X_{(S')})\times_{S'}(Y_{(S')})$
\eref{3.3.10} is equal to $(\sheaf{F}\otimes_S\sheaf{G})_{(S')}$.
\end{envs}

If $p,q$ are the projections of $X\times_S Y$, then the isomorphism in question
is nothing but $(p_{(S')}, q_{(S')})_{S'}$; the corollary follows from
propositions \eref{9.1.4} and \eref{9.1.10}.

\begin{envs}[Proposition]{9.1.12}
\label{prop-1.9.1.12}
With the notation from \sref{defn}{9.1.2}, let $z$ be
a point of $X\times_S Y$, $x=p(z)$, and $y=q(z)$; the fibre
$(\sheaf{F}\otimes_S\sheaf{G})_z$ is isomorphic to
$(\sheaf{F}_x\otimes_{\O_x}\O_z)\otimes_{\O_z}(\sheaf{G}_y\otimes_{\O_y}\O_z)
=\sheaf{F}_x\otimes_{\O_x}\O_z\otimes_{\O_y}\otimes\sheaf{G}_y$.
\end{envs}

As we can reduce ourselves to the affine case, the proposition follows from
equation~(1.6.5.1).

\begin{envs}[Corollary]{9.1.13}
\label{cor-1.9.1.13}
If $\sheaf{F}$ and $\sheaf{G}$ are of finite type, then we have that
\[
  \Supp(\sheaf{F}\otimes_S\sheaf{G})
  =p^{-1}(\Supp(\sheaf{F}))\cap q^{-1}(\Supp(\sheaf{G})).
\]
\end{envs}

Since $p^\ast(\sheaf{F})$ and $q^\ast(\sheaf{G})$ are both of finite type over
$\O_{X\times_S Y}$, we are reduced, by \eref{9.1.12} and \pref{env}{1.7.5}, to
the case where $\sheaf{G}=\O_Y$, that is, it remains to prove the following
equation:
\[
  \Supp(p^{-1}(\sheaf{F}))=p^{-1}(\Supp(\sheaf{F})).\tag{9.1.13.1}
\]

The same reasoning as in \pref{env}{1.7.5} leads us to prove that, for all
$z\in X\times_S Y$, we have $\O_z/\mathfrak{m}_x\O_z\neq0$ (with $x=p(z)$),
which follows from the fact that the homomorphism $\O_x\to\O_z$ is \emph{local},
by hypothesis.

We leave it to the reader to extend the results in this section to the more
general case of arbitrarily (but finitely) many factors, instead of just two.

\subsection{Direct image of a quasicoherent sheaf}
\label{1-schemes-9.2}        

\begin{envs}[Proposition]{9.2.1}
\label{prop-1.9.2.1}
Let $f\colon X\to Y$ be a morphism of
preschemes.  We suppose that there exists a cover $(Y_\alpha)$ of $Y$ by affine
opens having the following property: every $f^{-1}(Y_\alpha)$ admits a
\emph{finite} cover $(X_{\alpha i})$ by affine opens contained in
$f^{-1}(Y_\alpha)$ such that every intersection $X_{\alpha i}\cap X_{\alpha j}$
is itself a \emph{finite} union of affine opens.  With these hypotheses, for
every quasicoherent $\O_X$-module $\sheaf{F}$, $f_\ast(\sheaf{F})$ is a
quasicoherent $\O_Y$-module.
\end{envs}

Since this is a local condition on $Y$, we can assume that $Y$ is equal to one
of the $Y_\alpha$, and thus omit the indices~$\alpha$.

\begin{itemize}
\item[(a)] First, suppose that the $X_i\cap X_j$
are themselves \emph{affine} opens.  We set $\sheaf{F}_i=\sheaf{F}|X_i$ and
$\sheaf{F}_{ij}=\sheaf{F}|(X_i\cap X_j)$, and let $\sheaf{F}'_i$ and
$\sheaf{F}'_{ij}$ be the images of $\sheaf{F}_i$ and $\sheaf{F}_{ij}$
(respectively) by the restriction of $f$ to $X_i$ and $X_i\cap X_j$
(respectively); we know that the $\sheaf{F}'_i$ and $\sheaf{F}'_{ij}$ are
quasicoherent \eref{1.6.3}.  Set $\sheaf{G}=\bigoplus_i\sheaf{F}'_i$ and
$\sheaf{H}=\bigoplus_{i,j}\sheaf{F}'_{ij}$; $\sheaf{G}$ and $\sheaf{H}$ are
quasicoherent $\O_Y$-modules; we will define a homomorphism
$u\colon\sheaf{G}\to\sheaf{H}$ such that $f_\ast(\sheaf{F})$ is the
\emph{kernel} of $u$; it will follow from this that $f_\ast(\sheaf{F})$ is
quasicoherent \eref{1.3.9}.  It suffices to define $u$ as\oldpage{172} a homomorphism
of presheaves; taking into account the definitions of $\sheaf{G}$ and
$\sheaf{H}$, it thus suffices, for every open subset $W\subset Y$, to define a
homomorphism
\[
   {u_W\colon\bigoplus_i\Gamma(f^{-1}(W)\cap X_i,\sheaf{F})}\longrightarrow
   {\bigoplus_{i,j}\Gamma(f^{-1}(W)\cap X_i\cap X_j,\sheaf{F})}
\]
in such a way that it satisfies the usual
compatibility conditions when $W$ varies.  If, for every section
$s_i\in\Gamma(f^{-1}(W)\cap X_i, \sheaf{F})$, we denote by $s_{i|j}$ the
restriction to $f^{-1}(W)\cap X_i\cap X_j$, then we set \[
u_W\big((s_i)\big)=(s_{i|j}-s_{j|i}) \] and the compatibility conditions are
clearly satisfied.  To prove that the kernel $\sheaf{R}$ of $u$ is
$f_\ast(\sheaf{F})$, we define a homomorphism from $f_\ast(\sheaf{F})$ to
$\sheaf{R}$ by sending each section $s\in\Gamma(f^{-1}(W),\sheaf{F})$ to the
family $(s_i)$, where $s_i$ is the restriction of $s$ to $f^{-1}(W)\cap X_i$;
the axioms (F1) and (F2) of sheaves (G,~II,~1.1) tell us that this homomorphism
is \emph{bijective}, which finishes the proof in this case.
\item[(b)] In the general case, the same reasoning applies once we have established
that the $\sheaf{F}_{ij}$ are quasicoherent.  But, by hypothesis, $X_i\cap X_j$ is a
finite union of affine opens $X_{ijk}$; and since the $X_{ijk}$ are affine opens
\emph{in a scheme}, the intersection of any two of them is again an affine open
\eref{5.5.6}.  We are thus led to the first case, and so we have proved \eref{9.2.1}.
\end{itemize}

\begin{envs}[Corollary]{9.2.2}
\label{cor-1.9.2.2}
The conclusion of \sref{prop}{9.2.1} holds true in each
of the following cases:
\begin{itemize}
  \item[(a)] $f$ is separated and quasicompact.
  \item[(b)] $f$ is separated and of finite type.
  \item[(c)] $f$ is quasicompact and the underlying space of $X$ is locally Noetherian.
\end{itemize}
\end{envs}

In case \emph{(a)}, the $X_{\alpha i}\cap X_{\alpha j}$ are affine \eref{5.5.6}.
Case \emph{(b)} is a particular case of \emph{(a)} \eref{6.6.3}.  Finally, in case
\emph{(c)}, we can reduce to the case where $Y$ is affine and the underlying
space of $X$ is Noetherian; then $X$ admits a finite cover of affine opens
$(X_i)$, and the $X_i\cap X_j$, being quasicompact, are finite unions of affine
opens \eref{2.1.3}.

\subsection{Extension of sections of quasicoherent sheaves}
\label{1-schemes-9.3}       

\begin{envs}[Theorem]{9.3.1}
\label{thm-1.9.3.1}
Let $X$ be a prescheme whose underlying space is Noetherian, or a scheme whose underlying
space is quasicompact. Let $\sheaf{L}$ be an invertible $\O_X$-module
\pref{env}{5.4.1}, $f$ a section of $\sheaf{L}$ over $X$, $X_f$ the open
set of $x\in X$ such that $f(x)\neq0$ \pref{env}{5.5.1}, and $\sheaf{F}$ a
quasicoherent $\O_X$-module.
\begin{itemize}
  \item[(i)] If $s\in\Gamma(X,\sheaf{F})$ is such that $s|X_f=0$,
             then there exists a whole number $n>0$ such that $s\otimes f^{\otimes n}=0$.
  \item[(ii)] For every section $s\in\Gamma(X_f,\sheaf{F})$, there exists a whole number
              $n>0$ such that $s\otimes f^{\otimes n}$ extends to a section of
              $\sheaf{F}\otimes\sheaf{L}^{\otimes n}$ over $X$.
\end{itemize}
\end{envs}

\begin{itemize}
  \item[(i)] Since the underlying space of $X$ is quasicompact, and thus the union of
             finitely-many affine opens $U_i$ with $\sheaf{L}|U_i$ is isomorphic to
             $\O_X|U_i$, we can reduce to the case where $X$ is affine and $\sheaf{L}=\O_X$.
             In this case, $f$ is identified with an element of $A(X)$, and we have that
             $X_f=D(f)$; $s$ is identified with an element of an $A(X)$-module $M$, and
             $s|X_f$ to the corresponding element of $M_f$, and the result is then trivial,
             recalling the definition of a module of fractions.
  \item[(ii)] Again\oldpage{173}, $X$ is a finite union of affine opens $U_i$ ($1\leq i\leq r$)
              such that $\sheaf{L}|U_i\cong\O_X|U_i$, and for every $i$,
              $(s\otimes f^{\otimes n})|(U_i\cap X_f)$ is identified (by the aforementioned
              isomorphism) with $(f|(U_i\cap X_f))^n(s|(U_i\cap X_f))$. We then know \eref{1.4.1}
              that there exists a whole number $n>0$ such that, for all $i$,
              $(s\otimes f^{\otimes n})|(U_i\cap X_f)$ extends to a section $s_i$ of
              $\sheaf{F}\otimes\sheaf{L}^{\otimes n}$ over $U_i$. Let $s_{i|j}$ be the
              restriction of $s_i$ to $U_i\cap U_j$; by definition we have that
              $s_{i|j}-s_{j|i}=0$ in $X_f\cap U_i\cap U_j$. But, if $X$ is a Noetherian
              space, then $U_i\cap U_j$ is quasicompact; if $X$ is a scheme, then $U_i\cap U_j$
              is an affine open \eref{5.5.6}, and so again quasicompact. By virtue of (i), there
              thus exists a whole number $m$ (independent of $i$ and $j$) such that
              $(s_{i|j}-s_{j|i})\otimes f^{\otimes m}=0$. It immediately follows that there
              exists a section $s'$ of $\sheaf{F}\otimes\sheaf{L}^{\otimes(n+m)}$ over $X$,
              restricting to $s_i\otimes f^{\otimes m}$ over each $U_i$, and restricting to
              $s\otimes f^{\otimes(n+m)}$ over $X_f$.
\end{itemize}

The following corollaries give an interpretation of theorem \eref{9.3.1} in a more algebraic
language:

\begin{envs}[Corollary]{9.3.2}
\label{cor-1.9.3.2}
With the hypotheses of \sref{thm}{9.3.1}, consider the graded ring $A_\ast=\Gamma_\ast(\sheaf{L})$
and the graded $A_\ast$-module $M_\ast=\Gamma_\ast(\sheaf{L},\sheaf{F})$
\pref{env}{5.4.6}. If $f\in A_n$, where $n\in\bbold{Z}$, then there is
a canonical isomorphism $\Gamma(X_f,\sheaf{F})\xrightarrow{\sim}((M_\ast)_f)_0$
(\emph{the subgroup of the module of fractions $(M_\ast)_f$ consisting of elements of degree
$0$}).
\end{envs}

\begin{envs}[Corollary]{9.3.3}
\label{cor-1.9.3.3}
Suppose that the hypotheses of \sref{thm}{9.3.1} are satisfied, and suppose further that
$\sheaf{L}=\O_X$. Then, setting $A=\Gamma(X,\O_X)$ and $M=\Gamma(X,\sheaf{F})$,
the $A_f$-module $\Gamma(X_f,\sheaf{F})$ is canonically isomorphic to $M_f$.
\end{envs}

\begin{envs}[Proposition]{9.3.4}
\label{prop-1.9.3.4}
Let $X$ be a Noetherian prescheme, $\sheaf{F}$ a coherent $\O_X$-module, and $\sheaf{J}$ a
coherent sheaf of ideals in $\O_X$, such that the support of $\sheaf{F}$ is contained in that
of $\O_X|\sheaf{J}$. Then there exists a whole number $n>0$ such that $\sheaf{J}^n\sheaf{F}=0$.
\end{envs}

Since $X$ is a union of finitely-many affine opens whose rings are Noetherian, we can suppose
that $X$ is affine of Noetherian ring $A$; then $\sheaf{F}=\widetilde{M}$, where
$M=\Gamma(X,\sheaf{F})$ is an $A$-module of finite type, and $\sheaf{J}=\widetilde{\mathfrak{J}}$,
where $\mathfrak{J}=\Gamma(X,\sheaf{J})$ is an ideal of $A$ (\eref{1.4.1} and \eref{1.5.1}).
Since $A$ is Noetherian, $\mathfrak{J}$ admits a finite system of generators $f_i$ ($1\leq i\leq m$).
By hypothesis, every section of $\sheaf{F}$ over $X$ is zero in each of the $D(f_i)$; if $s_j$
($1\leq j\leq q$) are sections of $\sheaf{F}$ generating $M$, then there exists a whole number
$h$, independent of $i$ and $j$, such that $f_i^h s_j=0$.\eref{1.4.1}, whence $f_i^h s=0$ for all
$s\in M$. We thus conclude that if $n=mh$ then $\mathfrak{J}^n M=0$, and so the corresponding
$\O_X$-module $\sheaf{J}^n\sheaf{F}=\widetilde{\mathfrak{J}^n M}$ \eref{1.3.13} is zero.

\begin{envs}[Corollary]{9.3.5}
\label{cor-1.9.3.5}
With the hypotheses of \sref{prop}{9.3.4}, there exists a closed subprescheme $Y$ of $X$, whose
underlying space is the support of $\O_X/\sheaf{J}$, such that, if $j\colon Y\to X$ is the canonical
injection, then $\sheaf{F}=j_\ast(j^\ast(\sheaf{F}))$.
\end{envs}

First of all, note that the supports of $\O_X/\sheaf{J}$ and $\O_X/\sheaf{J}^n$ are the same,
since, if $\sheaf{J}_x=\O_x$, then $\sheaf{J}_x^n=\O_x$, and we also have that
$\sheaf{J}_x^n\subset\sheaf{J}_x$ for all $x\in X$. We can, thanks to \sref{prop}{9.3.4}, thus
suppose that $\sheaf{J}\sheaf{F}=0$; we can then take $Y$ to be the closed subprescheme of $X$
defined by $\sheaf{J}$, and since $\sheaf{F}$ is then an $(\O_X/\sheaf{J})$-module, the conclusion
follows immediately.

\subsection{Extension of quasicoherent sheaves}
\label{1-schemes-9.4}        

\begin{env}{9.4.1}
\label{env-1.9.4.1}
Let\oldpage{174} $X$ be a topological space, $\sheaf{F}$ a
sheaf of sets (resp.of groups, of rings) on $X$, $U$ an open subset of $X$,
$\psi\colon U\to X$ the canonical injection, and $\sheaf{G}$ a subsheaf of
$\sheaf{F}|U=\psi^\ast(\sheaf{F})$. Since $\psi_\ast$ is left exact,
$\psi_\ast(\sheaf{G})$ is a subsheaf of $\psi_\ast(\psi^\ast(\sheaf{F}))$; if we denote
by $\rho$ the canonical homomorphism $\sheaf{F}\to\psi_\ast(\psi^\ast(\sheaf{F}))$
\pref{env}{3.5.3}, then we denote by $\overline{\sheaf{G}}$ the subsheaf
$\rho^{-1}(\psi_\ast(\sheaf{G}))$ of $\sheaf{F}$. It follows immediately from the
definitions that, for every open subset $V$ of $X$,
$\Gamma(V,\overline{\sheaf{G}})$ consists of sections $s\in\Gamma(V,\sheaf{F})$
whose restriction to $V\cap U$ is a section of $\sheaf{G}$ over $V\cap U$. We
thus have that $\overline{\sheaf{G}}|U=\psi^\ast(\overline{\sheaf{G}})=\sheaf{G}$,
and that $\overline{\sheaf{G}}$ is the \emph{biggest} subsheaf of $\sheaf{F}$
that restricts to $\sheaf{G}$ over $U$; we say that $\overline{\sheaf{G}}$ is
the \emph{canonical extension} of the subsheaf $\sheaf{G}$ of $\sheaf{F}|U$ to a
subsheaf of $\sheaf{F}$.
\end{env}

\begin{envs}[Proposition]{9.4.2}
\label{prop-1.9.4.2}
Let $X$ be a prescheme, $U$ an open subset of $X$ such that the canonical injection
$j\colon U\to X$ is a quasicompact morphism \emph{(which will be the case for
\emph{all} $U$ if the underlying space of $X$ is \emph{locally Noetherian}
{\normalfont(\eref{6.6.4},~(i))})}. Then:
\begin{itemize}
  \item[(i)] For every quasicoherent $(\O_X|U)$-module $\sheaf{G}$, $j_\ast(\sheaf{G})$
             is a quasicoherent $\O_X$-module, and
             $j_\ast(\sheaf{G})|U=j^\ast(j_\ast(\sheaf{G}))=\sheaf{G}$.
  \item[(ii)] For every quasicoherent $\O_X$-module $\sheaf{F}$ and every quasicoherent
              $(\O_X|U)$-submodule $\sheaf{G}$, the canonical extension
              $\overline{\sheaf{G}}$ of $\sheaf{G}$ \eref{9.4.1} is a
              quasicoherent $\O_X$-submodule of $\sheaf{F}$.
\end{itemize}
\end{envs}

If $j=(\psi,\theta)$ ($\psi$ being the injection $U\to X$ of underlying spaces),
then by definition we have that $j_\ast(\sheaf{G})=\psi_\ast(\sheaf{G})$ for every
$(\O_X|U)$-module $\sheaf{G}$, and, further, that
$j^\ast(\sheaf{H})=\psi^\ast(\sheaf{H})=\sheaf{H}|U$ for every $\O_X$-module
$\sheaf{H}$, by definition of the prescheme induced over an open subset. So (i)
is thus a particular case of (\eref{9.2.2},~(a)); for the same reason,
$j_\ast(j^\ast(\sheaf{F}))$ is quasicoherent, and since $\overline{\sheaf{G}}$ is the
inverse image of $j_\ast(\sheaf{G})$ by the homomorphism $\rho\colon\sheaf{F}\to
j_\ast(j^\ast(\sheaf{F}))$, (ii) follows from \eref{4.1.1}.
 
Note that the hypothesis that the morphism $j\colon U\to X$ is quasicompact
holds whenever the open subset $U$ is \emph{quasicompact} and $X$ is a
\emph{scheme}: indeed, $U$ is then a union of finitely-many affine opens $U_i$,
and for every affine open $V$ of $X$, $V\cap U_i$ is an affine open \eref{5.5.6}, and
thus quasicompact.
 
\begin{envs}[Corollary]{9.4.3}
\label{cor-1.9.4.3}
Let $X$ be a prescheme, $U$ a quasicompact open
subset of $X$ such that the injection morphism $j\colon U\to X$ is
quasicompact.Suppose as well that every quasicoherent $\O_X$-module is the
inductive limit of its quasicoherent $\O_X$-submodules of finite type
\emph{(which will be the case if $X$ is an \emph{affine scheme})}. Then let
$\sheaf{F}$ be a quasicoherent $\O_X$-module, and $\sheaf{G}$ a quasicoherent
$(\O_X|U)$-submodule \emph{of finite type} of $\sheaf{F}|U$.Then there exists
a quasicoherent $\O_X$-submodule $\sheaf{G}'$ of $\sheaf{F}$ \emph{of finite
type} such that $\sheaf{G}'|U=\sheaf{G}$.
\end{envs}
 
Indeed, we have $\sheaf{G}=\overline{\sheaf{G}}|U$, and $\overline{\sheaf{G}}$
is quasicoherent, from \eref{9.4.2}, and so the inductive limit of its
quasicoherent $\O_X$-submodules $\sheaf{H}_\lambda$ of finite type. It
follows that $\sheaf{G}$ is the inductive limit of the $\sheaf{H}_\lambda|U$,
and thus equal to one of the $\sheaf{H}_\lambda|U$ since it is of finite type
\pref{env}{5.2.3}.
 
\begin{env}[Remark]{9.4.4}
\label{rmk-1.9.4.4}
Suppose that for \emph{every} affine open $U\subset X$,
the injection morphism $U\to X$ is quasicompact. Then, if the conclusion
of \sref{cor}{9.4.3} holds for every affine open $U$ and every quasicoherent
$(\O_X|U)$-submodule $\sheaf{G}$ of $\sheaf{F}|U$ of finite type, it
follows\oldpage{175} that $\sheaf{F}$ is the inductive limit of its
quasicoherent $\O_X$-submodules of finite type.Indeed, for every affine open
$U\subset X$, we have that $\sheaf{F}|U=\widetilde{M}$, where $M$ is an
$A(U)$-module, and since the latter is the inductive limit of its quasicoherent
submodules of finite type, $\sheaf{F}|U$ is the inductive limit of its
$(\O_X|U)$-submodules of finite type \eref{1.3.9}.But, by hypothesis, each of
these submodules is induced on $U$ by a quasicoherent $\O_X$-submodule
$\sheaf{G}_{\lambda,U}$ of $\sheaf{F}$ of finite type.The finite sums of the
$\sheaf{G}_{\lambda,U}$ are again quasicoherent $\O_X$-modules of finite type,
because the property is local, and the case where $X$ is affine was covered in
\eref{1.3.10}; it is clear then that $\sheaf{F}$ is the inductive limit of these
finite sums, whence our claim.
\end{env}
 
\begin{envs}[Corollary]{9.4.5}
\label{cor-1.9.4.5}
Under the hypotheses of \sref{cor}{9.4.3}, for every quasicoherent $(\O_X|U)$-module
$\sheaf{G}$ of finite type, there exists a quasicoherent $\O_X$-module
$\sheaf{G}'$ of finite type such that $\sheaf{G}'|U=\sheaf{G}$.
\end{envs}

Since $\sheaf{F}=j_\ast(\sheaf{G})$ is quasicoherent \sref{prop}{9.4.2} and
$\sheaf{F}|U=\sheaf{G}$, it suffices to apply \sref{cor}{9.4.3} to $\sheaf{F}$.

\begin{envs}[Lemma]{9.4.6}
\label{lem-1.9.4.6}
Let $X$ be a prescheme, $L$ a well-ordered set,$(V_\lambda)_{\lambda\in L}$ a cover
of $X$ by affine opens, and $U$ an open of
$X$; for all $\lambda\in L$, we set $W_\lambda=\bigcup_{\mu<\lambda}V_\mu$.
Suppose that: (1) for every $\lambda\in L$, $V_\lambda\cap W_\lambda$ is
quasicompact; (2) the immersion morphism $U\to X$ is quasicompact.Then, for
every quasicoherent $\O_X$-module $\sheaf{F}$ and every quasicoherent
$(\O_X|U)$-submodule $\sheaf{G}$ of $\sheaf{F}|U$ \emph{of finite type}, there
exists a quasicoherent $\O_X$-submodule $\sheaf{G}'$ of $\sheaf{F}$ \emph{of
finite type} such that $\sheaf{G}'|U=\sheaf{G}$.
\end{envs}

Let $U_\lambda=U\cup W_\lambda$; we will define a family $(\sheaf{G}'_\lambda)$
by recurrence, where $\sheaf{G}'_\lambda$ is a quasicoherent
$(\O_X|U_\lambda)$-submodule of $\sheaf{F}|U_\lambda$ of finite type, such that
$\sheaf{G}'_\lambda|U_\mu=\sheaf{G}'_\mu$ for $\mu<\lambda$ and
$\sheaf{G}'_\lambda|U=\sheaf{G}$. The unique $\O_X$-submodule $\sheaf{G}'$ of
$\sheaf{F}$ such that $\sheaf{G}'|U_\lambda=\sheaf{G}'$ for all $\lambda\in L$
\pref{env}{3.3.1} gives us what we want. So suppose that the $\sheaf{G}'_\mu$
are defined and have the preceding properties for $\mu<\lambda$; if $\lambda$
does not have a predecessor then we take for $\sheaf{G}'_\lambda$ the unique
$(\O_X|U_\lambda)$-submodule of $\sheaf{F}|U_\lambda$ such that
$\sheaf{G}'_\lambda|U_\mu=\sheaf{G}'_\mu$ for all $\mu<\lambda$, which is
allowed since the $U_\mu$ with $\mu<\lambda$ then form a cover of $U_\lambda$.
If, conversely, $\lambda=\mu+1$, then $U_\lambda=U_\mu\cup V_\mu$, and it
suffices to define a quasicoherent $(\O_X|V_\mu)$-submodule $\sheaf{G}''_\mu$
of $\sheaf{F}|V_\mu$ of finite type such that
\[
  \sheaf{G}''_\mu|(U_\mu\cap V_\mu)=\sheaf{G}'_\mu|(U_\mu\cap V_\mu);
\]
and then to take for $\sheaf{G}'_\lambda$ the
$(\O_X|U_\lambda)$-submodule of $\sheaf{F}|U_\lambda$ such that
$\sheaf{G}'_\lambda|U_\mu=\sheaf{G}'_\mu$ and
$\sheaf{G}'_\lambda|V_\mu=\sheaf{G}''_\mu$ \pref{env}{3.3.1}. But, since
$V_\mu$ is affine, the existence of $\sheaf{G}''_\mu$ is guaranteed by \sref{cor}{9.4.3}
as soon as we show that $U_\mu\cap V_\mu$ is quasicompact; but $U_\mu\cap V_\mu$
is the union of $U\cap V_\mu$ and $W_\mu\cap V_\mu$, which are both
quasicompact by virtue of the hypothesis.

\begin{envs}[Theorem]{9.4.7}
\label{lem-1.9.4.7}
Let $X$ be a prescheme, and $U$ an open of $X$.
Suppose that one of the following conditions is verified:
\begin{itemize}
  \item[(a)] the underlying space of $X$ is locally Noetherian;
  \item[(b)] $X$ is a quasicompact scheme and $U$ is a quasicompact open.
\end{itemize}
Then, for every quasicoherent $\O_X$-module $\sheaf{F}$ and every quasicoherent
$(\O_X|U)$-submodule $\sheaf{G}$ of $\sheaf{F}|U$ \emph{of finite type}, there exists a
quasicoherent $\O_X$-submodule $\sheaf{G}'$ of $\sheaf{F}$ \emph{of finite type}
such that $\sheaf{G}'|U=\sheaf{G}$.
\end{envs}

Let\oldpage{176} $(V_\lambda)_{\lambda\in L}$ be a cover of $X$ by affine opens,
with $L$ supposed finite in case (b); since $L$ is equipped with the
structure of a well-ordered set, it suffices to verify that the conditions of
\sref{lem}{9.4.6} are satisfied.It is clear in the case of (a), as the spaces
$V_\lambda$ are Noetherian.For case (b), the $V_\lambda\cap\lambda_\mu$
are affine \eref{5.5.6}, and thus quasicompact, and since $L$ is finite,
$V_\lambda\cap W_\lambda$ is quasicompact. Whence the theorem.

\begin{envs}[Corollary]{9.4.8}
\label{cor-1.9.4.8}
Under the hypotheses of \sref{thm}{9.4.7}, for every quasicoherent $(\O_X|U)$-module
$\sheaf{G}$ of finite type, there exists a quasicoherent $\O_X$-module $\sheaf{G}'$
of finite type such that $\sheaf{G}'|U=\sheaf{G}$.
\end{envs}

It suffices to apply \sref{thm}{9.4.7} to $\sheaf{F}=j_\ast(\sheaf{G})$, which is
quasicoherent \sref{prop}{9.4.2} and such that $\sheaf{F}|U=\sheaf{G}$.

\begin{envs}[Corollary]{9.4.9}
\label{cor-1.9.4.9}
Let $X$ be a prescheme whose underlying space is locally Noetherian, or a
quasicompact scheme. Then every quasicoherent $\O_X$-module is the inductive limit
of its quasicoherent $\O_X$-submodules of finite type.
\end{envs}

This follows from \sref{thm}{9.4.7} and the remark \eref{9.4.4}.

\begin{envs}[Corollary]{9.4.10}
\label{cor-1.9.4.10}
Under the hypotheses of \sref{cor}{9.4.9}, if a quasicoherent $\O_X$-module $\sheaf{F}$
is such that every quasicoherent $\O_X$-submodule of finite type of $\sheaf{F}$ is
generated by its sections over $X$, then $\sheaf{F}$ is generated by its sections
over $X$.
\end{envs}

In fact, let $U$ be an affine open neighbourhood of a point $x\in X$, and let
$s$ be a section of $\sheaf{F}$ over $U$; the $\O_X$-submodule $\sheaf{G}$ of
$\sheaf{F}|U$ generated by $s$ is quasicoherent and of finite type, so there
exists a quasicoherent $\O_X$-submodule $\sheaf{G}'$ of $\sheaf{F}$ of finite
type such that $\sheaf{G}'|U=\sheaf{G}$ \sref{thm}{9.4.7}.By hypothesis, there is thus a
finite number of sections $t_i$ of $\sheaf{G}'$ over $X$ and of sections $a_i$
of $\O_X$ over a neighbourhood $V\subset U$ of $x$ such that
$s|V=\sum_i a_i(t_i|V)$, which proves the corollary.

\subsection{Closed image of a prescheme; closure of a subprescheme}
\label{1-schemes-9.5}        

\begin{envs}[Proposition]{9.5.1}
\label{prop-1.9.5.1}
Let $f\colon X\to Y$ be a morphism of preschemes
such that $f_\ast(\O_X)$ is a quasicoherent $\O_Y$-module (which will be the
case if $f$ is quasicompact \unsure{and separated, or} $X$ is locally Noetherian
\sref{cor}{9.2.2}). Then there exists a smaller subprescheme $Y'$ of $Y$ such that
the canonical injection $j\colon Y'\to Y$ \completelyunsure $f$ (\emph{or, equivalently
\eref{4.4.1}, such that the subprescheme $f^{-1}(Y')$ of $X$ is \emph{identical}
to $X$}).
\end{envs}

More precisely:

\begin{envs}[Corollary]{9.5.2}
\label{cor-1.9.5.2}
Under the conditions of \sref{prop}{9.5.1}, let
$f=(\psi,\theta)$, and let $\sheaf{J}$ be the (quasicoherent) kernel of the
homomorphism $\theta\colon\O_Y\to f_\ast(\O_X)$. Then the closed subprescheme
$Y'$ of $Y$ defined by $\sheaf{J}$ satisfies the conditions of \sref{prop}{9.5.1}.
\end{envs}

Since the functor $\psi^\ast$ is exact, the canonical factorisation
$\theta\colon\O_Y\to\O_Y/\sheaf{J}\xrightarrow{\theta'}\psi_\ast(\O_X)$ gives
(\textbf{0},~3.5.4.3) a factorisation
$\theta^\#\colon\psi^\ast(\O_Y)\to\psi^\ast(\O_Y)/\psi^\ast(\sheaf{J})
\xrightarrow{\theta'^\#}\O_X$;
since $\theta_x^\#$ is a local homomorphism for every $x\in X$, the same is true
of ${\theta'_x}^\#$; if we denote by $\psi_0$ the continuous map $\psi$
considered as a map from $X$ to $X'$, and by $\theta_0$ the restriction
$\theta'|X'\colon(\O_Y/\sheaf{J})|X'\to\psi_\ast(\O_X)|X'=(\psi_0)_\ast(\O_X)$,
we see that $f_0=(\psi_0,\theta_0)$ is a morphism of preschemes $X\to X'$
\eref{2.2.1} such that $f=j\circ f_0$. Now, if $X''$ is\oldpage{177} a second
closed subprescheme of $Y$, defined by a quasicoherent sheaf of ideals
$\sheaf{J}'$ of $\O_Y$, such that the injection $j'\colon X''\to Y$ \completelyunsure
$f$, then we should immediately have that $\psi(X)\subset X''$, and so
$X'\subset X''$, since $X''$ is closed. Furthermore, for all $y\in X''$,
$\theta$ should factorise as $\O_y\to\O_y/\sheaf{J}'_y\to(\psi_\ast(\O_X))_y$,
which by definition leads to $\sheaf{J}'_y\subset\sheaf{J}_y$, and thus $X'$ is
a closed subprescheme of $X''$ \eref{4.1.10}.

\begin{env}[Definition]{9.5.3}
\label{defn-1.9.5.3}
Whenever there exists a smaller subprescheme $Y'$
of $Y$ such that the canonical injection $j\colon Y'\to Y$ \completelyunsure $f$, we
say that $Y'$ is the \emph{closed image} prescheme of $X$ by the morphism $f$.
\end{env}

\begin{envs}[Proposition]{9.5.4}
\label{prop-1.9.5.4}
If $f_\ast(\O_X)$ is a quasicoherent $\O_Y$-module, then the underlying space of
the closed image of $X$ by $f$ is the closure $\overline{f(X)}$ in $Y$.
\end{envs}

\subsection{Quasicoherent sheaves of algebras; change of structure sheaf}
\label{1-schemes-9.6}        

\section{Formal schemes}
\label{1-schemes-10}

\clearpage

\input{bib}

\end{document}

