\documentclass[10pt,oneside]{book}

\usepackage{preamble}

\begin{document}
\title{\'El\'ements de g\'eom\'etrie alg\'ebrique I: Le langage des sch\'emas\\
(EGA~I)}
\author{A.~Grothendieck and J.~Dieudonn\'e}
\date{1960}
\maketitle
\frontmatter
\chapter*{What this is}
    This is a community translation of Grothendieck's EGA~I.
    As it is a work in progress by multiple people, it will probably have a few
    mistakes---if you spot any then please feel free to
    \href{https://github.com/ryankeleti/en.ega/issues}{let us know}!

\noindent
    \textbf{Note.} EGA uses `prescheme' for what is now usually called
    a scheme, and `scheme' for what is now usually called a
    separated scheme.
 
    On est d\'esol\'es, Grothendieck.

    ---Ryan Keleti, Tim Hosgood

{
  \hypersetup{
    linkcolor=[rgb]{0,0,0}
  }
  \tableofcontents{}
}

\clearpage
\mainmatter

\chapter*{Introduction}
\label{intro-section}

\begin{flushright}
\emph{To Oscar Zariski and Andr\'e Weil.}
\end{flushright}
\medskip

\oldpage{5}
This memoir, and the many others that must follow, are intended to
form a treatise on the foundations of algebraic geometry. They do not assume, in
principle, any particular knowledge of this discipline, and it has even been
that such knowledge, despite its obvious advantages, could sometimes (by the
too-exclusive habit that the birational point of view it implies) to be harmful
to the one who wants to become familiar with the point of view and techniques
presented here. However, we assume that the reader has a good knowledge of the
following topics:
\begin{enumerate}[label=(\alph*)]
  \item \emph{Commutative algebra}, as it is exhibited for example in
        volumes under preparation of the \emph{Elements} of N.~Bourbaki
        (and, pending the publication of these volumes, in Samuel--Zariski
        \cite{13} and Samuel \cite{11}, \cite{12}).
  \item \emph{Homological algebra}, for which we refer to Cartan--Eilenberg
        \cite{2} (cited as (M)) and Godement \cite{4} (cited as (G)), as well
        as the recent article by A. Grothendieck \cite{6} (cited as (T)).
  \item \emph{Sheaf theory}, where our main references will be (G) and (T);
        this theory provides the essential language for interpreting in
        ``geometric'' terms the essential notions of commutative algebra,
        and to ``globalize'' them.
  \item Finally, it will be useful for the reader to have some familiarity with
        \emph{functorial language}, which will be constantly used in this treatise,
        and for which the reader may consult (M), (G), and especially (T); the
        principles of this language and the main results of the general theory of
        functors will be described in more detail in a book currently in preparation
        by the authors of this treatise.
\end{enumerate}

\sectionbreak

It is not the place, in this introduction, to give a more or less summarily
description from the point of view of ``schemes'' in algebraic geometry, nor the
long list of reasons which made its adoption necessary, and in particular the
systematic acceptance of nilpotent elements in the local rings of ``manifolds''
that we consider (which necessarily shifts the idea of rational maps into
the background, in favor of those of regular maps or ``morphisms''). This
treatise aims precisely to systematically develop the language of schemes, and
will demonstrate, we hope, its necessity. Although it would be easy to do so,
\oldpage{6}
we will not try to give here an ``intuitive'' introduction to the
notions developed in Chapter~I. For the reader who would like to have a glimpse
of the preliminary study of the subject matter of this treatise, we refer them
to the conference by A.~Grothendieck at the International Congress of
Mathematicians in Edinburgh in 1958 \cite{7}, and the expose \cite{8} of the
same author. The work \cite{14} (cited as (FAC)) of J.-P.~Serre can also be
considered as an intermediary exposition between the classical point of view and
the point of view of schemes in algebraic geometry, and, as such, its reading
may be an excellent preparation to that of our \emph{Elements}.

\sectionbreak

We give below the general outline planned for this treatise, subject to later
modifications, especially concerning the later chapters.

\begin{tabular}{rrl}
Chapter & I. & --- The language of schemes.\\
--- & II. & --- Elementary global study of some classes of morphisms.\\
--- & III. & --- Cohomology of algebraic coherent sheaves. Applications.\\
--- & IV. & --- Local study of morphisms.\\
--- & V. & --- Elementary procedures of constructing schemes.\\
--- & VI. & --- Descent. General method of constructing schemes.\\
--- & VII. & --- Schemes of groups, principal fibre bundles.\\
--- & VIII. & --- Differential study of fibre bundles.\\
--- & IX. & --- The fundamental group.\\
--- & X. & --- Residues and duality.\\
--- & XI. & --- Theories of intersection, Chern classes, Riemann--Roch theorem.\\
--- & XII. & --- Abelian schemes and Picard schemes.\\
--- & XIII. & --- Weil cohomology.
\end{tabular}\\

\bigskip

In principal, all chapters are considered open to changes, and supplementary
paragraphs can always be added later; such paragraphs would appear in separate
fascicles in order to minimise the inconveniences accompanying whatever mode of
publication adopted. When the writing of such a paragraph is foreseen or in
progress during the publication of a chapter, it will be mentioned in the
summary of the chapter in question, even if, owing to certain orders of urgency,
\unsure{its actual publication clearly ought to have been later.} For the use of
the reader, we give in ``Chapter~0'' the necessary tools in commutative algebra,
homological algebra, and sheaf theory, that will be used throughout this
treatise, that are more or less well known but for which it was not possible to
give convenient references. It is recommended for the reader to not read
Chapter~0 except whilst reading the actual treatise, when the results to which
we refer
\oldpage{7}
seem unfamiliar. Besides, we think that in this way, the
reading of this treatise could be a good method for the beginner to familiarise
themselves with commutative algebra and homological algebra, whose study, when
not accompanied with tangible applications, is considered tedious, or even
depressing, by many.

\sectionbreak

It is outside of our capabilities to give a historic overview, or even a summary
thereof, of the ideas and results described. The text will contain only those
references considered particularly useful for comprehension, and we indicate the
origin only of the most important results. Formally, at least, the subjects
discussed in our work are reasonably new, which explains the scarcity of
references made to the fathers of algebraic geometry from the 19th to the
beginning of the 20th century, whose works we know only by hear-say. It is
suitable, however, to say some words here about the works which have most
directly influenced the authors and contributed to the development of
scheme-theoretic point of view. We absolutely must mention the fundamental work
(FAC) of J.-P.~Serre first, which has served as an introduction to algebraic
geometry for more that one young student (one of the authors of this treatise
being one), deterred by the dryness of the classic \emph{Foundations} of A.~Weil
\cite{18}. It is there that it is shown, for the first time, that the ``Zariski
topology'' of an ``abstract'' algebraic variety is perfectly suited to applying
certain techniques from algebraic topology, and notably to be able to define a
cohomology theory. Further, the definition of an algebraic variety given
therein is that which translates most naturally to the idea that we develop
here\footnote{Just as J.-P.~Serre informed us, it is right to note that the idea
of defining the structure of a manifold by the data of a sheaf of rings is due
to H.~Cartan, who took this idea as the starting point of his theory of analytic
spaces. Of course, just as in algebraic geometry, it would be important in
``analytic geometry'' to give the right to use nilpotent elements in local rings
of analytic spaces. This extension of the definition of H.~Cartan and
J.-P.~Serre has recently been broached by H.~Grauert \cite{5}, and there is room
to hope that a systematic report of analytic geometry in this setting will soon
see the light of day. It is also evident that the ideas and techniques developed
in this treatise retain a sense of analytic geometry, even though one must
expect more considerable technical difficulties in this latter theory. We can
foresee that algebraic geometry, by the simplicity of its methods, will be able
to serve as a sort of formal model for future developments in the theory of
analytic spaces.}. Serre himself had incidentally noted that the cohomology
theory of affine algebraic varieties could translate without difficulty by
replacing the affine algebras over a field by arbitrary commutative rings.
Chapters~I and II of this treatise, and the first two paragraphs of Chapter~III,
can thus be considered, for the most part, as easy translations, in this bigger
framework, of the principal results of (FAC) and a later article of the same
author \cite{15}. We have also vastly profited from the \emph{S\'eminaire de
G\'eom\'etrie alg\'ebrique} de C.~Chevalley \cite{1}; in particular, the
systematic usage of ``constructible sets'' introduced by him has turned out to
be extremely useful in the theory of schemes (cf. Chapter~IV). We have also
borrowed from him the study of morphisms from
\oldpage{8}
the point of view of dimension (Chapter~IV), that translates with negligible change to the
framework of schemes. It also merits noting that the idea of ``schemes of local rings'',
introduced by Chevalley, naturally lends itself to being extended to algebraic
geometry (not having, however, all the flexibility and generality that we intend
to give it here); for the connections between this idea and our theory, see Chapter~I,
\textsection8. One such extension has been developed by M.~Nagata in
a series of memoirs \cite{9}, which contain many special results concerning
algebraic geometry over Dedekind rings\footnote{Amongst the works that come
close to our point of view of algebraic geometry, we pick out the work of
E.~K\"ahler \cite{22} and a recent note of Chow and Igusa \cite{3}, which go
back over certain results of (FAC) in the context of Nagata--Chevalley theory, as
well as giving a K\"unneth formula.}.

\sectionbreak

It goes without saying that a book on algebraic geometry, and especially a book
dealing with the fundamentals, is of course influenced, if only by proxy, by
mathematicians such as O.~Zariski and A.~Weil. In particular, the
\emph{Th\'eorie des fonctions holomorphes} de Zariski \cite{20}, properly
flexible thanks to the cohomological methods and an existence theorem
(Chapter~III, \textsection\textsection4 and 5), is (along with the method of
descent described in Chapter~VI) one of the principal tools used in this treatise,
and it seems to us one of the most powerful at our disposal in algebraic
geometry.

The general technique in which it is employed can be sketched as follows (a
typical example of which will be given in Chapter~XI, in the study of the
fundamental group). We have a proper morphism (Chapter~II) $f:X\to Y$ of
algebraic varieties (more generally, of schemes) that we wish to study on the
neighbourhood of a point $y\in Y$, with the aim of resolving a problem $P$
relative to a neighbourhood of $y$. We follow successive steps:
\begin{enumerate}
  \item[1\textsuperscript{st}]
     We can suppose that $Y$ is affine, such that $X$ becomes a scheme
     defined on the affine ring $A$ of $Y$, and we can even replace $A$
     by the local ring of $y$. This reduction is always easy in practice
     (Chapter~V) and brings us to the case where $A$ is a \emph{local} ring.
  \item[2\textsuperscript{nd}]
     We study the problem in question when $A$ is a local \emph{Artinian}
     ring. So that the problem $P$ still makes sense when $A$ is not
     assumed to be integral, sometimes we have to reformulate $P$, and it
     appears that we often thus obtain a better understanding of the problem
     during this stage, in an ``infinitesimal'' way.
  \item[3\textsuperscript{rd}]
     The theory of formal schemes (Chapter~III, \textsection\textsection3, 4, and 5)
     lets us pass from the case of an Artinian ring to a \emph{complete local ring}.
  \item[4\textsuperscript{th}]
     Finally, if $A$ is an arbitrary local ring, considering
     ``\unsure{multiform} sections'' of suitable schemes over $X$
     approximates the idea of a given ``formal'' section (Chapter~IV), and
     this will let us pass,
\oldpage{9}
     by extension of scalars to the completion of $A$, from a known result (of
     \completelyunsure) to an
     analogous result for a finite simple (e.g. unramified) extension of $A$.
\end{enumerate}

This sketch shows the importance of the systematic study of schemes defined over
an artinien ring $A$. The point of view of Serre in his formulation of the
theory of local class fields, and the recent works of Greenberg, seem
to suggest that such a study could be undertaken by functorially attaching, to
some such scheme $X$, a scheme $X'$ over the residue field $k$ of $A$ (assumed
perfect) of dimension equal (in nice cases) to $n\dim X$, where $n$ is
the height of $A$.

As for the influence of A.~Weil, it suffices to say that it is the need to
develop the tools necessary to formulate, with full generality, the definition
of ``Weil cohomology'', and to tackle the proof\footnote{To avoid any
misunderstanding, we point out that this task has barely been undertaken at the
moment of writing this introduction, and still hasn't led to the proof of the
Weil conjectures.} of all the formal properties necessary to establish the
famous conjectures in Diophantine geometry \cite{19}, that has been one of the
principal motivations of the writing of this treatise, as has the desire to find
the natural setting of the usual ideas and methods of algebraic geometry, and to
give the authors the chance to understand these ideas and methods.

\sectionbreak

To finish, we believe it useful to warn the reader that, as was the case with
all the authors themselves, they will almost certainly have difficulty before
becoming accustomed to the language of schemes, and to convince themselves that
the usual constructions that suggest geometric intuition can be translated, in
essentially only one sensible way, to this language. As in many parts of modern
mathematics, the first intuition seems further and further away, in appearance,
from the correct language needed to express the mathematics in question with
complete precision and the desired level of generality. In practice, the
psychological difficulty comes from the need to replicate some familiar
set-theoretic constructions to a category that is already quite different from
that of sets (the category of preschemes, or the category of preschemes over a
given prescheme): cartesian products, group laws, ring laws, module laws, fibre
bundles, principal homogeneous fibre bundles, etc. It will most likely
be difficult for the mathematician, in the future, to shy away from this new
effort of abstraction, maybe rather negligible, on the whole, in comparison with
that endowed by our fathers, to familiarise themselves with the theory of sets.

\sectionbreak

The references are given following the numerical system; for example, in
III,~4.9.3, the III indicates the chapter, the 4 the paragraph, the 9 the
section of the paragraph. If we reference a chapter from within itself then we
omit the chapter number.

\bigskip

\oldpage{10}
\emph{Page 10 in the original is left blank. [trans.]}

\clearpage

\setcounter{chapter}{-1}
\chapter{Preliminaries}
\label{0-prelim}

\section{Rings of fractions}
\label{0-prelim-1}

\setcounter{subsection}{-1}
\subsection{Rings and Algebras}
\label{0-prelim-1.0}

\begin{env}{1.0.1}
\label{env-0.1.0.1}
\oldpage{11}
All the rings considered in this treatise will have a \emph{unit element}; all the modules
on such a ring will be assumed to be \emph{unitary}; the ring homomorphisms will always be
assumed to \emph{send the unit element to a unit element}; unless otherwise stated,
a subring of a ring $A$ will be assumed to \emph{contain the unit element of $A$}. We will
consider especially \emph{commutative} rings, and when we speak of a ring without
specification, it will be implied that it is commutative. If $A$ is a ring not necessarily
commutative, by $A$-module we will we mean a left module, unless stated otherwise.
\end{env}

\begin{env}{1.0.2}
\label{env-0.1.0.2}
Let $A$, $B$ be two rings, not necessarily commutative, $\vphi:A\to B$ a homomorphism.
Any left (resp. right) $B$-module $M$ can be provided with a left (resp. right) $A$-module
structure by $a\cdot m=\vphi(a)\cdot m$ (resp. $m\cdot a=m\cdot\vphi(a)$); when it will
be necessary to distinguish $M$ as an $A$-module or a $B$-module, we will denote by
$M_{[\vphi]}$ the left (resp. right) $A$-module as defined. If $L$ is an $A$-module, then
a homomorphism $u:L\to M_{[\vphi]}$ is a homomorphism of commutative groups such that
$u(a\cdot x)=\vphi(a)\cdot u(x)$ for $a\in A$, $x\in L$; we will also say that it is a
$\vphi$-\emph{homomorphism} $L\to M$, and that the pair $(\vphi,u)$ (or, by misuse of
langauge, $u$) is a \emph{di-homomorphism} of $(A,L)$ in $(B,M)$. The pairs $(A,L)$ formed by
a ring $A$ and an $A$-module $L$ thus form a \emph{category} for which the morphisms are
di-homomorphisms.
\end{env}

\begin{env}{1.0.3}
\label{env-0.1.0.3}
Under the hypothesis of \sref{env}{1.0.2}, if $\mathfrak{J}$ is a left (resp. right) ideal of
$A$, we denote by $B\mathfrak{J}$ (resp. $\mathfrak{J}B$) the left (resp. right) ideal
$B\vphi(\mathfrak{J})$ (resp. $\vphi(\mathfrak{J})B$) of $B$ generated by
$\vphi(\mathfrak{J})$; it is also the image of the canonical homomorphism
$B\otimes_A\mathfrak{J}\to B$ (resp. $\mathfrak{J}\otimes_A B\to B$) of left (resp. right)
$B$-modules.
\end{env}

\begin{env}{1.0.4}
\label{env-0.1.0.4}
If $A$ is a (commutative) ring, $B$ a non necessarily commutative ring, the data of
a structure of an \emph{$A$-algebra} on $B$ is equivalent to the data of a ring
homomorphism $\vphi:A\to B$ such that $\vphi(A)$ is contained in the center of $B$.
For all ideals $\mathfrak{J}$ of $A$, $\mathfrak{J}B=B\mathfrak{J}$ is then a two-sided ideal
of $B$, and for every $B$-module $M$, $\mathfrak{J}M$ is then a $B$-module equal to
$(B\mathfrak{J})M$.
\end{env}

\begin{env}{1.0.5}
\label{env-0.1.0.5}
We will not revisit the notions of \emph{module of finite type} and \emph{algebra}
(commutative) \emph{of finite type}; to say that an $A$-module $M$ is of finite type means
that there exists
\oldpage{12}
an exact sequence $A^p\to M\to 0$. We say that an $A$-module $M$ admits a \emph{finite
presentation} if it is isomorphic to the cokernel of a homomorphism $A^p\to A^q$, in other
words, there exists an exact sequence $A^p\to A^q\to M\to 0$. We note that for a
\emph{Noetherian} ring $A$, every $A$-module of finite type admits a finite presentation.

Let us recall that an $A$-algebra $B$ is called \emph{integral} over $A$ if every element
in $B$ is a root in $B$ of a monic polynomial with coefficients in $A$; equivalently, every
element of $B$ is contained in a subalgebra of $B$ which is an $A$-\emph{module of finite
type}. When this is so, and $B$ is commutative, the subalgebra of $B$ generated by a finite
subset of $B$ is an $A$-module of finite type; for a commutative algebra $B$ to be integral
and of finite type over $A$, it is necessary and therefore sufficient that $B$ be an
$A$-module of finite type; we also say that $B$ is an \emph{integral} $A$-\emph{algebra of
finite type} (or simply \emph{finite} if there is no confusion). It will be observed that in
these definitions, it is not assumed that the homomorphism $A\to B$ defining the structure of
an $A$-algebra is injective.
\end{env}

\begin{env}{1.0.6}
\label{env-0.1.0.6}
An \emph{integral} ring (or an \emph{integral domain}) is a ring in which the product of a
finite family of elements $\neq 0$ is $\neq 0$; equivalently, in such a ring we have
$0\neq 1$ and the product of two elements $\neq 0$ is non zero. A \emph{prime} ideal of a
ring $A$ is an ideal $\mathfrak{p}$ such that $A/\mathfrak{p}$ is integral; this therefore
implies that $\mathfrak{p}\neq A$. For a ring $A$ to have at least one prime ideal, it is
necessary and sufficent that $A\neq\{0\}$.
\end{env}

\begin{env}{1.0.7}
\label{env-0.1.0.7}
A \emph{local} ring is a ring $A$ in which there exists a unique maximal ideal, which is then
the complement of the invertible elements and contains all the ideals $\neq A$. If $A$ and $B$
are two local rings, $\mathfrak{m}$ and $\mathfrak{n}$ their respective maximal ideals, we
say that a homomorphism $\vphi:A\to B$ is \emph{local} if
$\vphi(\mathfrak{m})\subset\mathfrak{n}$ (or, equivalently, if
$\vphi^{-1}(\mathfrak{n})=\mathfrak{m}$). By passing to quotients, such a homomorphism then
defines a momomorphism from the residue field $A/\mathfrak{m}$ to the residue field
$B/\mathfrak{n}$. The composition of two local homomorphisms is a local homomorphism.
\end{env}

\subsection{Radical of an ideal. Nilradical and radical of a ring}
\label{0-prelim-1.1}

\begin{env}{1.1.1}
\label{env-0.1.1.1}
Let $\mathfrak{a}$ be an ideal of a ring $A$; the \emph{radical} of $\mathfrak{a}$, denoted
by $\rad(\mathfrak{a})$, is the set of $x\in A$ such that $x^n\in\mathfrak{a}$ for
an integer $n>0$; it is an ideal containing $\mathfrak{a}$. We have
$\rad(\mathfrak{r}(\mathfrak{a}))=\rad(\mathfrak{a})$; the relation
$\mathfrak{a}\subset\mathfrak{b}$ leads to $\rad(\mathfrak{a})\subset\rad(\mathfrak{b})$;
the radical of a finite intersection of ideals is the intersection of their radicals. If
$\vphi$ is a homomorphism of a ring $A'$ into $A$, then we have
$\rad(\vphi^{-1}(\mathfrak{a}))=\vphi^{-1}(\rad(\mathfrak{a}))$ for any ideal
$\mathfrak{a}\subset A$. For an ideal to be the radical of an ideal, it is necessary and
sufficient that it be an intersection of prime ideals. The radical of an ideal $\mathfrak{a}$
is the intersection of the \emph{minimal} prime ideals which contain $\mathfrak{a}$; if $A$
is Noetherian, these minimal prime ideals are finite in number.

The radical of the ideal $(0)$ is also called the \emph{nilradical} of $A$; it is the set
$\nilrad$ of the nilpotent elements of $A$. It is said that the ring $A$ is \emph{reduced} if
$\nilrad=(0)$; for every ring $A$, the quotient $A/\nilrad$ of $A$ by its nilradical is a
reduced ring.
\end{env}

\begin{env}{1.1.2}
\label{env-0.1.1.2}
Recall that the \emph{nilradical} $\nilrad(A)$ of a ring $A$ (not necessarily commutative) is
the intersection of the maximal left ideals of $A$ (and also the intersection of maximal
right ideals). The nilradical of $A/\nilrad(A)$ is $(0)$.
\end{env}

\subsection{Modules and rings of fractions}
\label{0-prelim-1.2}

\begin{env}{1.2.1}
\label{env-0.1.2.1}
\oldpage{13}
We say that a subset $S$ of a ring $A$ is \emph{multiplicative} if $1\in S$ and if the
product of two elements of $S$ is in $S$. The examples which will be the most important for
the following are: 1\textsuperscript{st} the set $S_f$Â of powers $f^n$ ($n\geqslant 0$) of an
element $f\in A$; 2\textsuperscript{nd} the complement $A-\mathfrak{p}$ of a \emph{prime}
ideal $\mathfrak{p}$ of $A$.
\end{env}

\begin{env}{1.2.2}
\label{env-0.1.2.2}
Let $S$ be a multiplicative subset of a ring $A$, $M$ an $A$-module; in the set $M\times S$,
the relation between pairs $(m_1,s_1)$, $(m_2,s_2)$:
\begin{center}
   ``there exists an $s\in S$ such that $s(s_1 m_2-s_2 m_1)=0$''
\end{center}
is an equivalence relation. We denote by $S^{-1}M$ the quotient set of $M\times S$ by this
relation, by $m/s$ the canonical image in $S^{-1}M$ of the pair $(m,s)$; we call the
\emph{canonical} map of $M$ to $S^{-1}M$ the map $i_M^S:m\mapsto m/1$ (also denoted $i^S$).
This map is generally neither injective nor surjective; its kernel is the set of $m\in M$
such that there exists an $s\in S$ for which $sm=0$.

On $S^{-1}M$ we define an additive group law by taking
\[
  (m_1/s_1)+(m_2/s_2)=(s_2 m_1+s_1 m_2)/(s_1 s_2)
\]
(we check that it is independent of the expressions of the elements of $S^{-1}M$ considered).
On $S^{-1}A$ we further define a multiplicative law by setting
$(a_1/s_1)(a_2/s_2)=(a_1 a_2)/(s_1 s_2)$, and finally an external law on $S^{-1}M$, having
$S^{-1}A$ as a set of operators, by setting $(a/s)(m/s')=(am)/(ss')$. It is thus verified
that $S^{-1}A$ is provided with a ring structure (called \emph{the ring of fractions of $A$
with denominators in $S$}) and $S^{-1}M$ the structure of an $S^{-1}A$-module (called
\emph{the  module of fractions of $M$ with denominators in $S$}); for all $s\in S$, $s/1$ is
invertible in $S^{-1}A$, its inverse being $1/s$. The canonical map $i_A^S$ (resp. $i_M^S$)
is a homomorphism of rings (resp. a homomorphism of $A$-modules, $S^{-1}M$ being considered
as an $A$-module by means of the homomorphism $i_A^S:A\to S^{-1}A$).
\end{env}

\begin{env}{1.2.3}
\label{env-0.1.2.3}
If $S_f=\{f^n\}_{n\geqslant 0}$ for a $f\in A$, we write $A_f$ and $M_f$ instead of
$S_f^{-1}A$ and $S_f^{-1}M$; when $A_f$ is considered as algebra over $A$, we can write
$A_f=A[1/f]$. $A_f$ is isomorphic to the quotient algebra $A[T]/(fT-1)A[T]$. When $f=1$,
$A_f$ and $M_f$ identify canonically with $A$ and $M$; if $f$ is nilpotent, $A_f$ and $M_f$
are reduced to $0$.

When $S=A-\mathfrak{p}$, where $\mathfrak{p}$ is a prime ideal of $A$, we
write $A_\mathfrak{p}$ and $M_\mathfrak{p}$ instead of $S^{-1}A$ and $S^{-1}M$;
$A_\mathfrak{p}$ is a \emph{local ring} whose maximal ideal $\mathfrak{q}$ is generated by
$i_A^S(\mathfrak{p})$, and we have $(i_A^S)^{-1}(\mathfrak{q})=\mathfrak{p}$; by passing to
quotients, $i_A^S$ gives a monomorphism from the integral ring $A/\mathfrak{p}$ to the
field $A_\mathfrak{p}/\mathfrak{q}$, which identifies with the field of fractions of
$A/\mathfrak{p}$.
\end{env}

\begin{env}{1.2.4}
\label{env-0.1.2.4}
The ring of fractions $S^{-1}A$ and the canonical homomorphism $i_A^S$ are a solution of a \emph{universal mapping problem}:
any homomorphism $u$ of $A$ into a ring $B$ such that $u(S)$ is composed of \emph{invertible} elements in $B$ factorizes uniquely as
\[
  u:A\xrightarrow{i_A^S}S^{-1}A\xrightarrow{u^*}B
\]
\oldpage{14}
where $u^*$ is a ring homomorphism. Under the same hypotheses, let $M$ be an $A$-module, $N$
a $B$-module, $v:M\to N$ a homomorphism of $A$-modules (for the $B$-module structure on $N$
defined by $u:A\to B$); then $v$ is factorizes uniquely as
\[
  v:M\xrightarrow{i_M^S}S^{-1}M\xrightarrow{v^*}N
\]
where $v^*$ is a homomorphism of $S^{-1}A$-modules (for the $S^{-1}A$-module structure on $N$
defined by $u^*$).
\end{env}

\begin{env}{1.2.5}
\label{env-0.1.2.5}
We define a canonical isomorphism $S^{-1}A\otimes_A M\isoto S^{-1}M$ of
$S^{-1}A$-modules, sending the element $(a/s)\otimes m$ to the element $(am)/s$, the
isomorphism reciprocally applying $m/s$ to $(1/s)\otimes m$.
\end{env}

\begin{env}{1.2.6}
\label{env-0.1.2.6}
For each ideal $\mathfrak{a}'$ of $S^{-1}A$, $\mathfrak{a}=(i_A^S)^{-1}(\mathfrak{a}')$ is an
ideal of $A$, and $\mathfrak{a}'$ is the ideal of $S^{-1}A$ generated by
$i_A^S(\mathfrak{a})$, which identifies with $S^{-1}\mathfrak{a}$ \sref{env}{1.3.2}. The map
$\mathfrak{p}'\to(i_A^S)^{-1}(\mathfrak{p}')$ is an isomorphism, for the structure order, of
the set of \emph{prime} ideals of $S^{-1}A$ to the set of prime ideals $\mathfrak{p}$ of $A$
such that $\mathfrak{p}\cap S=\emp$. In addition, the local rings $A_\mathfrak{p}$ and
$(S^{-1}A)_{S^{-1}\mathfrak{p}}$ are canonically isomorphic \sref{env}{1.5.1}.
\end{env}

\begin{env}{1.2.7}
\label{env-0.1.2.7}
When $A$ is an \emph{integral} ring, for which $K$ denotes its field of fractions, the
canonical map $i_A^S:A\to S^{-1}A$ is injective for any multiplicative subset $S$ not
containing $0$, and $S^{-1}A$ then identifies canonically with a subring of $K$ containing
$A$. In particular, for every prime ideal $\mathfrak{p}$ of $A$ , $A_\mathfrak{p}$ is a local
ring containing $A$, with maximal ideal $\mathfrak{p}A_\mathfrak{p}$, and we have
$\mathfrak{p}A_\mathfrak{p}\cap A=\mathfrak{p}$.
\end{env}

\begin{env}{1.2.8}
\label{env-0.1.2.8}
If $A$ is a \emph{reduced} ring \sref{env}{1.1.1}, so is $S^{-1}A$: indeed, if $(x/s)^n=0$ for
$x\in A$, $s\in S$, it means that there exists $s'\in S$ such that $s'x^n=0$, hence
$(s'x)^n=0$, which, by hypothesis, implies $s'x=0$, so $x/s=0$.
\end{env}

\subsection{Functorial properties}
\label{0-prelim-1.3}

\begin{env}{1.3.1}
\label{env-0.1.3.1}
Let $M$, $N$ be two $A$-modules, $u$ an $A$-homomorphism $M\to N$. If $S$ is a multiplicative
subset of $A$, we define a $S^{-1}A$-homomorphism $S^{-1}M\to S^{-1}N$, denoted by $S^{-1}u$,
by putting $S^{-1}u(m/s)=u(m)/s$; if $S^{-1}M$ and $S^{-1}N$ are canonically identified with
$S^{-1}A\otimes_A M$ and $S^{-1}A\otimes_A N$ \sref{env}{1.2.5}, $S^{-1}u$ is considered as
$1\otimes u$. If $P$ is a third $A$-module, $v$ an $A$-homomorphism $N\to P$, we have
$S^{-1}(v\circ u)=(S^{-1}v)\circ(S^{-1}u)$; in other words, $S^{-1}M$ is a \emph{covariant
functor in} $M$, of the category of $A$-modules into that of $S^{-1}A$-modules ($A$ and $S$
being fixed).
\end{env}

\begin{env}{1.3.2}
\label{env-0.1.3.2}
The functor $S^{-1}M$ is \emph{exact}; in other words, if the following
\[
  M\xrightarrow{u}N\xrightarrow{v}P
\]
is exact, so is the following
\[
  S^{-1}M\xrightarrow{S^{-1}u}S^{-1}N\xrightarrow{S^{-1}v}S^{-1}P.
\]
In particular, if $u:M\to N$ is injective (resp. surjective), the same is true for $S^{-1}u$;
\oldpage{15}
if $N$ and $P$ are two submodules of $M$, $S^{-1}N$ and $S^{-1}P$ identify canonically with
submodules of $S^{-1}M$, and we have
\[
  S^{-1}(N+P)=S^{-1}N+S^{-1}P\quad\text{and}\quad S^{-1}(N\cap P)=(S^{-1}N)\cap(S^{-1}P).
\]
\end{env}

\begin{env}{1.3.3}
\label{env-0.1.3.3}
Let $(M_\alpha,\vphi_{\beta\alpha})$ be an inductive system of $A$-modules; then
$(S^{-1}M_\alpha,S^{-1}\vphi_{\beta\alpha})$ is an inductive system of $S^{-1}A$-modules.
Expressing the $S^{-1}M_\alpha$ and $S^{-1}\vphi_{\beta\alpha}$ as tensor products
(\sref{env}{1.2.5} and \sref{env}{1.3.1}), it follows from the permutability of the tensor
product and inductive limit operations that we have a canonical isomorphism
\[
  S^{-1}\varinjlim M_\alpha\isoto\varinjlim S^{-1}M_\alpha
\]
which is further expressed by saying that the functor $S^{-1}M$ (in $M$) \emph{commutes with
inductive limits}.
\end{env}

\begin{env}{1.3.4}
\label{env-0.1.3.4}
Let $M$, $N$ be two $A$-modules; there is a canonical \emph{functorial} isomorphism (in $M$
and $N$)
\[
  (S^{-1}M)\otimes_{S^{-1}A}(S^{-1}N)\isoto S^{-1}(M\otimes_A N)
\]
which sends $(m/s)\otimes(n/t)$ to $(m\otimes n)/st$.
\end{env}

\begin{env}{1.3.5}
\label{env-0.1.3.5}
We also have a \emph{functorial} homomorphism (in $M$ and $N$)
\[
  S^{-1}\Hom_A(M,N)\longrightarrow\Hom_{S^{-1}A}(S^{-1}M,S^{-1}N)
\]
which sends $u/s$ to the homomorphism $m/t\mapsto u(m)/st$. When $M$ has a finite
presentation, the preceding homomorphism is an \emph{isomorphism}: it is immediate when $M$
is of the form $A^r$, and we pass to the general case by starting with the following exact
sequence $A^p\to A^q\to M\to 0$, and using the exactness of the functor $S^{-1}M$ and
the left-exactness of the functor $\Hom_A(M,N)$ in $M$. Note that this case always occurs
when $A$ is \emph{Noetherian} and the $A$-module $M$ is \emph{of finite type}.
\end{env}

\subsection{Change of multiplicative subset}
\label{0-prelim-1.4}

\begin{env}{1.4.1}
\label{env-0.1.4.1}
Let $S$, $T$ be two multiplicative subsets of a ring $A$ such that $S\subset T$; there exists
a canonical homomorphism $\rho_A^{T,S}$ (or simply $\rho^{T,S}$) of $S^{-1}A$ into $T^{-1}A$,
sending the element denoted $a/s$ of $S^{-1}A$ to the element denoted $a/s$ in $T^{-1}A$; we
have ${i_A^T=\rho_A^{T,S}\circ i_A^S}$. For every $A$-module $M$, there exists in the same
way an $S^{-1}A$-linear map from $S^{-1}M$ to $T^{-1}M$ (the latter considered as an
$S^{-1}A$-module thanks to the homomorphism $\rho_A^{T,S}$), which sends the element $m/s$ of
$S^{-1}M$ to the element $m/s$ of $T^{-1}M$; we denote this map by $\rho_M^{T,S}$, or simply
$\rho^{T,S}$, and we still have $i_M^T=\rho_M^{T,S}\circ i_M^S$; in the canonical
identification \sref{env}{1.2.5}, $\rho_M^{T,S}$ identifies with $\rho_A^{T,S}\otimes 1$. The
homomorphism $\rho_M^{T,S}$ is a \emph{functorial morphism} (or natural transformation) from
the functor $S^{-1}M$ to the functor $T^{-1}M$, in other words, the diagram
\[
  \xymatrix{
  S^{-1}M\ar[r]^{S^{-1}u}\ar[d]_{\rho_M^{T,S}} & S^{-1}N\ar[d]^{\rho_N^{T,S}}\\
  T^{-1}M\ar[r]^{T^{-1}u} & T^{-1}N
  }
\]
\oldpage{16}
is commutative, for every homomorphism $u:M\to N$; $T^{-1}u$ is entirely determined by
$S^{-1}u$, since for $m\in M$ and $t\in T$, we have
\[
  (T^{-1}u)(m/t)=(t/1)^{-1}\rho^{T,S}((S^{-1}u)(m/1)).
\]
\end{env}

\begin{env}{1.4.2}
\label{env-0.1.4.2}
With the same notations, for two $A$-modules $M$, $N$, the diagrams (cf. \sref{env}{1.3.4}
and \sref{env}{1.3.5})
\[
  \xymatrix{
    (S^{-1}M)\otimes_{S^{-1}A}(S^{-1}N)\ar[r]^\sim \ar[d] & S^{-1}(M\otimes_A N)\ar[d] & &
    S^{-1}\Hom_A(M,N)\ar[r]\ar[d] & \Hom_{S^{-1}A}(S^{-1}M,S^{-1}N)\ar[d]\\
    (T^{-1}M)\otimes_{T^{-1}A}(T^{-1}N)\ar[r]^\sim & T^{-1}(M\otimes_A N) & &
    T^{-1}\Hom_A(M,N)\ar[r] & \Hom_{T^{-1}A}(T^{-1}M,T^{-1}N)
  }
\]
are commutative.
\end{env}

\begin{env}{1.4.3}
\label{env-0.1.4.3}
There is an important case in which the homomorphism $\rho^{T,S}$ is \emph{bijective},
we know that then every element of $T$ is divisor of an element of $S$; we then identify by
$\rho^{T,S}$ the modules $S^{-1}M$ and $T^{-1}M$. We say that $S$ is \emph{saturated} if
every divisor in $A$ of an element of $S$ is in $S$; by replacing $S$ with  the set $T$ of
all the divisors of the elements of $S$ (a set which is multiplicative and saturated), we see
that we can always, if we wish, be limited to the consideration of modules of fractions
$S^{-1}M$, where $S$ is saturated.
\end{env}

\begin{env}{1.4.4}
\label{env-0.1.4.4}
If $S$, $T$, $U$ are three multiplicative subsets of $A$ such that $S\subset T\subset U$, we
have
\[
  \rho^{U,S}=\rho^{U,T}\circ\rho^{T,S}.
\]
\end{env}

\begin{env}{1.4.5}
\label{env-0.1.4.5}
Consider an \emph{increasing filtered family} $(S_\alpha)$ of multiplicative subsets of $A$
(we write $\alpha\leqslant\beta$ for $S_\alpha\subset S_\beta$), and let $S$ be the
multiplicative subset $\bigcup_\alpha S_\alpha$; let us put
$\rho_{\beta\alpha}=\rho_A^{S_\beta,S_\alpha}$ for $\alpha\leq\beta$; according to
\sref{env}{1.4.4}, the homomorphisms $\rho_{\beta\alpha}$ define a ring $A'$ as the
\emph{inductive limit} of the inductive system of rings
$(S_\alpha^{-1}A,\rho_{\beta\alpha})$. Let $\rho_\alpha$ be the canonical map
$S_\alpha^{-1}A\to A'$, and let $\vphi_\alpha=\rho_A^{S,S_\alpha}$; as
$\vphi_\alpha=\vphi_\beta\circ\rho_{\beta\alpha}$ for $\alpha\leqslant\beta$ according to
\sref{env}{1.4.4}, we can uniquely define a homomorphism $\vphi:A'\to S^{-1}A$ such that the
diagram
\[
  \xymatrix{
    & S_\alpha^{-1}A\ar[ddl]_{\rho_\alpha}
                    \ar[d]^{\rho_{\beta\alpha}}
                    \ar[rdd]^{\vphi_\alpha}\\
    & S_\beta^{-1}A\ar[ld]^{\rho_\beta}
                   \ar[rd]_{\vphi_\beta}
    & & (\alpha\leqslant\beta)\\
    A'\ar[rr]_\vphi
    & & S^{-1}A
  }
\]
is commutative. In fact, $\vphi$ is an \emph{isomorphism}; it is indeed immediate by
construction that $\vphi$ is surjective. On the other hand, if
$\rho_\alpha(a/s_\alpha)\in A'$ is such that ${\vphi(\rho_\alpha(a/s_\alpha))=0}$, this means
that $a/s_\alpha=0$ in $S^{-1}A$, that is to say that there exists $s\in S$ such that
$sa=0$; but there is a $\beta\geqslant\alpha$ such that $s\in S_\beta$, and consequently, as
$\rho_\alpha(a/s_\alpha)=\rho_\beta(sa/ss_\alpha)=0$, we find that $\vphi$ is injective.
The case for an $A$-module $M$ is treated likewise, and thus we have defined canonical
isomorphisms
\[
  \varinjlim S_\alpha^{-1}A\isoto(\varinjlim S_\alpha)^{-1}A,\quad
  \varinjlim S_\alpha^{-1}M\isoto(\varinjlim S_\alpha)^{-1}M,
\]
the second being \emph{functorial} in $M$.
\end{env}

\begin{env}{1.4.6}
\label{env-0.1.4.6}
\oldpage{17}
Let $S_1$, $S_2$ be two multiplicative subsets of $A$; then $S_1 S_2$ is also a
multiplicative subset of $A$. Let us denote by $S_2'$ the canonical image of $S_2$ in the
ring $S_1^{-1}A$, which is a multiplicative subset of this ring. For every $A$-module $M$
there is then a functorial isomorphism
\[
  {S_2'}^{-1}(S_1^{-1}M)\isoto(S_1 S_2)^{-1}M
\]
which sends $(m/s_1)/(s_2/1)$ to the element $m/(s_1 s_2)$.
\end{env}

\subsection{Change of ring}
\label{0-prelim-1.5}

\begin{env}{1.5.1}
\label{env-0.1.5.1}
Let $A$, $A'$ be two rings, $\vphi$ a homomorphism $A'\to A$, $S$ (resp. $S'$)
a multiplicative subset of $A$ (resp. $A'$), such that $\vphi(S')\subset S$; the
composition homomorphism $\smash{A'\xrightarrow{\vphi} A\to S^{-1}A}$ factors as
$\smash{A'\to{S'}^{-1}\xrightarrow{\vphi^{S'}} S^{-1}A}$ by virtue of \sref{env}{1.2.4};
where $\vphi^{S'}(a'/s')=\vphi(a')/\vphi(s')$. If $A=\vphi(A')$ and
$S=\vphi(S')$, $\vphi^{S'}$ is \emph{surjective}. If $A'=A$ and if $\vphi$
is the identity, $\vphi^{S'}$ is none other than the homomorphism $\rho_A^{S,S'}$
defined in \sref{env}{1.4.1}.
\end{env}

\begin{env}{1.5.2}
\label{env-0.1.5.2}
Under the hypothesis of \sref{env}{1.5.1}, let $M$ be an $A$-module. There exists a canonical
functorial morphism
\[
  \sigma:{S'}^{-1}(M_{[\vphi]})\longrightarrow(S^{-1}M)_{[\vphi^{S'}]}
\]
of ${S'}^{-1}A'$-modules, sending each element $m/s'$ of ${S'}^{-1}(M_{[\vphi]})$ to
the element $m/\vphi(s')$ of $(S^{-1}M)_{[\vphi^{S'}]}$; in fact, we verify
immediately that this definition does not depend on the expression $m/s'$ of the element
considered. \emph{When $S=\vphi(S')$}, the homomorphism $\sigma$ is \emph{bijective}.
When $A'=A$ and $\vphi$ is the identity, $\sigma$ is none other than the homomorphism
$\rho_M^{S,S'}$ defined in \sref{env}{1.4.1}.

When $M=A$ is taken in particular, the homomorphism $\vphi$ defines on $A$ an $A'$-algebra
structure; ${S'}^{-1}(A_{[\vphi]})$ is then provided with a ring structure, for which it
identifies with $(\vphi(S'))^{-1}A$, and the homomorphism
${\sigma:{S'}^{-1}(A_{[\vphi]})\to S^{-1}A}$ is a homomorphism of ${S'}^{-1}A'$-algebras.
\end{env}

\begin{env}{1.5.3}
\label{env-0.1.5.3}
Let $M$ and $N$ be two $A$-modules; by composing the homomorphisms defined in
\sref{env}{1.3.4} and \sref{env}{1.5.2}, we obtain a homomorphism
\[
  (S^{-1}M\otimes_{S^{-1}A}S^{-1}N)_{[\vphi^{S'}]}
  \longleftarrow{S'}^{-1}((M\otimes A)_{[\vphi]})
\]
which is an isomorphism when $\vphi(S')=S$. Similarly, by composing the homomorphisms in
\sref{env}{1.3.5} and \sref{env}{1.5.2}, we obtain a homomorphism
\[
  {S'}^{-1}((\Hom_A(M,N))_{[\vphi]})
  \longrightarrow(\Hom_{S^{-1}A}(S^{-1}M,S^{-1}N))_{[\vphi^{S'}]}
\]
which is an isomorphism when $\vphi(S')=S$ and $M$ admits a finite presentation.
\end{env}

\begin{env}{1.5.4}
\label{env-0.1.5.4}
Let us now consider an $A'$-module $N'$, and form the tensor product
$N'\otimes_{A'}A_{[\vphi]}$, which can be considered as an $A$-module by setting
$a\cdot(n'\otimes b)=n'\otimes(ab)$. There is a functorial isomorphism of $S^{-1}A$-modules
\[
  \tau:({S'}^{-1}N')\otimes_{{S'}^{-1}A'}(S^{-1}A)_{[\vphi^{S'}]}
  \isoto S^{-1}(N'\otimes_{A'}A_{[\vphi]})
\]
\oldpage{18}
which sends the element $(n'/s')\otimes(a/s)$ to the element $(n'\otimes a)/(\vphi(s')s)$;
indeed, we verify separately that when we replace $n'/s'$ (resp. $a/s$) by another expression
of the same element, $(n'\otimes a)/(\vphi(s')s)$ does not change; on the other hand, we can
define an inverse homomorphism of $\tau$ by sending $(n'\otimes a)/s$ to the element
$(n'/1)\otimes(a/s)$: we use the fact that $S^{-1}(N'\otimes_{A'}A_{[\vphi]})$ is canonically
isomorphic to $(N'\otimes_{A'}A_{[\vphi]})\otimes_A S^{-1}A$ \sref{env}{1.2.5}, so also to
$N'\otimes_{A'}(S^{-1}A)_{[\psi]}$, denoting by $\psi$ the composite homomorphism
$a'\mapsto\vphi(a')/1$ of $A'$ into $S^{-1}A$.
\end{env}

\begin{env}{1.5.5}
\label{env-0.1.5.5}
If $M'$ and $N'$ are two $A'$-modules, by composing the isomorphisms \sref{env}{1.3.4} and
\sref{env}{1.5.4}, we obtain an isomorphism
\[
  {S'}^{-1}M\otimes_{{S'}^{-1}A'}{S'}^{-1}N'\otimes_{{S'}^{-1}A'}S^{-1}A
  \isoto S^{-1}(M'\otimes_{A'}N'\otimes_{A'}A).
\]
Likewise, if $M'$ admits a finite presentation, we have by \sref{env}{1.3.5} and
\sref{env}{1.5.4} an isomorphism
\[
  \Hom_{{S'}^{-1}A'}({S'}^{-1}M',{S'}^{-1}N')\otimes_{{S'}^{-1}A'}S^{-1}A
  \isoto S^{-1}(\Hom_{A'}(M',N')\otimes_{A'}A).
\]
\end{env}

\begin{env}{1.5.6}
\label{env-0.1.5.6}
Under the hypotheses of \sref{env}{1.5.1}, let $T$ (resp. $T'$) be a second multiplicative
subset of $A$ (resp. $A'$) such that $S\subset T$ (resp. $S'\subset T'$) and
$\vphi(T')\subset T$. Then the diagram
\[
  \xymatrix{
    {S'}^{-1}A'\ar[r]^{\vphi^{S'}}\ar[d]_{\rho^{T',S'}} & S^{-1}A\ar[d]^{\rho^{T,S}}\\
    {T'}^{-1}A'\ar[r]^{\vphi^{T'}} & T^{-1}A
  }
\]
is commutative. If $M$ is an $A$-module, the diagram
\[
  \xymatrix{
    {S'}^{-1}(M_{[\vphi]})\ar[r]^\sigma\ar[d]_{\rho^{T',S'}} &
    (S^{-1}M)_{[\vphi^{S'}]}\ar[d]^{\rho^{T,S}}\\
    {T'}^{-1}(M_{[\vphi]})\ar[r]^\sigma & (T^{-1}M)_{[\vphi^{T'}]}
  }
\]
is commutative. Finally, if $N'$ is an $A'$-module, the diagram
\[
  \xymatrix{
    ({S'}^{-1}N')\otimes_{{S'}^{-1}A'}(S^{-1}A)_{[\vphi^{S'}]}\ar[r]^\sim_\tau\ar[d] &
    S^{-1}(N'\otimes_{A'}A_{[\vphi]})\ar[d]^{\rho^{T,S}}\\
    ({T'}^{-1}N')\otimes_{{T'}^{-1}A'}(T^{-1}A)_{[\vphi^{T'}]}
    \ar[r]^\sim_\tau & T^{-1}(N'\otimes_{A'}A_{[\vphi]})
  }
\]
is commutative, the left vertical arrow obtained by applying
$\rho_{N'}^{T',S'}$ to ${S'}^{-1}N'$ and $\rho_A^{T,S}$ to $S^{-1}A$.
\end{env}

\begin{env}{1.5.7}
\label{env-0.1.5.7}
\oldpage{19}
Let $A''$ be a third ring, $\vphi':A''\to A'$ a ring homomorphism, $S''$ a multiplicative
subset of $A''$ such that $\vphi'(S'')\subset S'$. Set $\vphi''=\vphi\circ\vphi'$; then we
have
\[
  {\vphi''}^{S''}=\vphi^{S'}\circ{\vphi'}^{S''}.
\]
Let $M$ be an $A$-module; evidently we have $M_{[\vphi'']}=(M_{[\vphi]})_{[\vphi']}$;
if $\sigma'$ and $\sigma''$ are the homomorphisms defined by $\vphi'$ and $\vphi''$ as
$\sigma$ is defined in \sref{env}{1.5.2} by $\vphi$, we have the transitivity formula
\[
  \sigma''=\sigma\circ\sigma'.
\]

Finally, let $N''$ be an $A''$-module; the $A$-module $N''\otimes_{A''}A_{[\vphi'']}$
identifies canonically with $(N''\otimes_{A''}{A'}_{[\vphi']})\otimes_{A'}A_{[\vphi]}$,
and likewise the $S^{-1}A$-module
${({S''}^{-1}N'')\otimes_{{S''}^{-1}A''}(S^{-1}A)_{[{\vphi''}^{S''}]}}$ identifies
canonically with
$(({S''}^{-1}N'')\otimes_{{S''}^{-1}A''}({S'}^{-1}A')_{[{\vphi'}^{S''}]})
  \otimes_{{S'}^{-1}A'}(S^{-1}A)_{[\vphi^{S'}]}$. With these identifications, if $\tau'$
and $\tau''$ are the isomorphisms defined by $\vphi'$ and $\vphi''$ as $\tau$ is defined
in \sref{env}{1.5.4} by $\vphi$, we have the transitivity formula
\[
  \tau''=\tau\circ(\tau'\otimes 1).
\]
\end{env}

\begin{env}{1.5.8}
\label{env-0.1.5.8}
Let $A$ be a subring of a ring $B$; for every \emph{minimal} prime ideal $\mathfrak{p}$ of
$A$, there exists a minimal prime ideal $\mathfrak{q}$ of $B$ such that
$\mathfrak{p}=A\cap\mathfrak{q}$. Indeed, $A_\mathfrak{p}$ is a subring of $B_\mathfrak{p}$
\sref{env}{1.3.2} and has \emph{a single} prime ideal $\mathfrak{p}'$ \sref{env}{1.2.6};
since $B_\mathfrak{p}$ is not reduced to $0$, it has at least one prime ideal $\mathfrak{q}'$
and we have necessarily $\mathfrak{q}'\cap A_\mathfrak{p}=\mathfrak{p}'$; the prime ideal
$\mathfrak{q}_1$ of $B$, an inverse image of $\mathfrak{q}'$ is thus such that
$\mathfrak{q}_1\cap A=\mathfrak{p}$, and $\emph{a fortiori}$ we have
$\mathfrak{q}\cap A=\mathfrak{p}$ for every minimal prime ideal $\mathfrak{q}$ of $B$
contained in $\mathfrak{q}_1$.
\end{env}

\subsection{Indentification of the module $M_f$ as an inductive limit}
\label{0-prelim-1.6}

\begin{env}{1.6.1}
\label{env-0.1.6.1}
Let $M$ be an $A$-module, $f$ an element of $A$. Consider a sequence $(M_n)$ of $A$-modules,
all identical to $M$, and for each pair of integers $m\leqslant n$, let $\vphi_{nm}$ be the
homomorphism $z\mapsto f^{n-m}z$ of $M_m$ into $M_n$; it is immediate that
$((M_n),(\vphi_{nm}))$ is an \emph{inductive system} of $A$-modules; let $N=\varinjlim M_n$
be the inductive limit of this system. We define a canonical $A$-isomorphism,
\emph{functorial} of $N$ on $M_f$. For this reason, let us note that, for all $n$,
$\theta_n:z\mapsto z/f^n$ is an $A$-homomorphism of $M=M_n$ into $M_f$, and it follows from
the definitions that we have $\theta_n\circ\vphi_{nm}=\theta_m$ for $m\leqslant n$. There
exists therefore an $A$-homomorphism $\theta:N\to M_f$ such that, if $\vphi_n$ denotes the
canonical homomorphism $M_n\to N$, we have $\theta_n=\theta\circ\vphi_n$ for all $n$. Since,
by hypothesis, every element of $M_f$ is of the form $z/f^n$ for at least $n$, it is clear
that $\theta$ is surjective. On the other hand, if $\theta(\vphi_n(z))=0$, in other words
$z/f^n=0$, there exists an integer $k>0$ such that $f^k z=0$, so $\vphi_{n+k,n}(z)=0$, which
gives $\vphi_n(z)=0$. We can therefore identify $M_f$ and $\varinjlim M_n$ by means of
$\theta$.
\end{env}

\begin{env}{1.6.2}
\label{env-0.1.6.2}
Now write $M_{f,n}$, $\vphi_{nm}^f$ and $\vphi_n^f$ instead of $M_n$, $\vphi_{nm}$ and
$\vphi_n$. Let $g$ be a second element of $A$. As $f^n$ divides $f^n g^n$, we have a
functorial homomorphism
\[
  \rho_{fg,f}:M_f\longrightarrow M_{fg}\quad(\sref{env}{1.4.1}\text{ and }\sref{env}{1.4.3});
\]
\oldpage{20}
if we indentify $M_f$ and $M_{fg}$ with $\varinjlim M_{f,n}$ and $\varinjlim M_{fg,n}$
respectively, $\rho_{fg,f}$ identifies with the \emph{inductive limit} of the maps
$\rho_{fg,f}^n:M_{f,n}\to M_{fg,n}$, defined by $\rho_{fg,f}^n(z)=g^n z$. Indeed, this
follows immediately from the commutivity of the diagram
\[
  \xymatrix{
    M_{f,n}\ar[r]^{\rho_{fg,f}^n}\ar[d]_{\vphi_n^f} & M_{fg,n}\ar[d]^{\vphi_n^{fg}}\\
    M_f\ar[r]^{\rho_{fg,f}} & M_{fg}.
  }
\]
\end{env}

\subsection{Support of a module}
\label{0-prelim-1.7}

\begin{env}{1.7.1}
\label{env-0.1.7.1}
Given an $A$-module $M$, we call the \emph{support} of $M$ and denote by $\Supp(M)$
the set of prime ideals $\mathfrak{p}$ of $A$ such that $M_\mathfrak{p}\neq 0$. For $M=0$, it
is necessary and sufficient that $\Supp(M)=\emp$, because if $M_\mathfrak{p}=0$ for all
$\mathfrak{p}$, the annihilator of an element $x\in M$ cannot be contained in any prime
ideal of $A$, so $A$ is \unsure{total}.
\end{env}

\begin{env}{1.7.2}
\label{env-0.1.7.2}
If $0\to N\to M\to P\to 0$ is an exact sequence of $A$-modules, we have
\[
  \Supp(M)=\Supp(N)\cup\Supp(P)
\]
because for every prime ideal $\mathfrak{p}$ of $A$, the sequence
${0\to N_\mathfrak{p}\to M_\mathfrak{p}\to P_\mathfrak{p}\to 0}$ is exact \sref{env}{1.3.2}
and for $M_\mathfrak{p}=0$, it is necessary and sufficient that
$N_\mathfrak{p}=P_\mathfrak{p}=0$.
\end{env}

\begin{env}{1.7.3}
\label{env-0.1.7.3}
If $M$ is the sum of a family $(M_\lambda)$ of submodules, $M_\mathfrak{p}$ is the sum
of the $(M_\lambda)_\mathfrak{p}$ for every prime ideal $\mathfrak{p}$ of $A$
(\sref{env}{1.3.3} and \sref{env}{1.3.2}), so $\Supp(M)=\bigcup_\lambda\Supp(M_\lambda)$.
\end{env}

\begin{env}{1.7.4}
\label{env-0.1.7.4}
If $M$ is an $A$-module \emph{of finite type}, $\Supp(M)$ is the set of prime
ideals \emph{containing the annihilator of} $M$. Indeed, if $M$ is cyclic and
generated by $x$, we say that $M_\mathfrak{p}=0$ means that there exists
$s\not\in\mathfrak{p}$ such that $s\cdot x=0$, so that $\mathfrak{p}$ does not contain the
annihilator of $x$. If now $M$ admits a finite system $(x_i)_{1\leqslant i\leqslant n}$ of
generators and if $\mathfrak{a}_i$ is the annihilator of $x_i$, it follows from
\sref{env}{1.7.3} that $\Supp(M)$ is the set of $\mathfrak{p}$ containing one of
$\mathfrak{a}_i$, or, equivalently, the set of $\mathfrak{p}$ containing
$\mathfrak{a}=\bigcap_i\mathfrak{a}_i$, which is the annihilator of $M$.
\end{env}

\begin{env}{1.7.5}
\label{env-0.1.7.5}
If $M$ and $N$ are two $A$-modules \emph{of finite type}, we have
\[
  \Supp(M\otimes_A N)=\Supp(M)\cap\Supp(N).
\]
It can be seen that if $\mathfrak{p}$ is a prime ideal of $A$, the condition
$M_\mathfrak{p}\otimes_{A_\mathfrak{p}}N_\mathfrak{p}\neq 0$ is equivalent to
``$M_\mathfrak{p}\neq 0$ and $N_\mathfrak{p}\neq 0$'' (taking into account
\sref{env}{1.3.4}). In other words, it is about seeing that if $P$, $Q$ are two modules of
finite type over a \emph{local} ring $B$, not reduced to $0$, then $P\otimes_B Q\neq 0$. Let
$\mathfrak{m}$ be the maximal ideal of $B$. By virtue of Nakayama's lemma, the vector spaces
$P/\mathfrak{m}P$ and $Q/\mathfrak{m}Q$ are not reduced to $0$, so it is the same with the
tensor product
$(P/\mathfrak{m}P)\otimes_{B/\mathfrak{m}}(Q/\mathfrak{m}Q)
  =(P\otimes_B Q)\otimes_B(B/\mathfrak{m})$,
hence the conclusion.

In particular, if $M$ is an $A$-module of finite type, $\mathfrak{a}$ an ideal of $A$,
$\Supp(M/\mathfrak{a}M)$ is the set of prime ideals containing both $\mathfrak{a}$ and the
annihilator $\mathfrak{n}$ of $M$ \sref{env}{1.7.4}, that is, the set of prime ideals
containing $\mathfrak{a}+\mathfrak{n}$.
\end{env}

\section{Irreducible spaces. Noetherian spaces}
\label{0-prelim-2}

\subsection{Irreducible spaces}
\label{0-prelim-2.1}

\begin{env}{2.1.1}
\label{env-0.2.1.1}
\oldpage{21}
We say that a topological space $X$ is \emph{irreducible} if it is nonempty and if it is not
a union of two distinct closed subspaces of $X$. It is the same to say that $X\neq\emp$ and
that the intersection of two nonempty open sets (and consequently of a finite number of open
sets) of $X$ is nonempty, or that every nonempty open set is everywhere dense, or that any
closed set is \unsure{\emph{rare}}, or finally that all open sets of $X$ are
\emph{connected}.
\end{env}

\begin{env}{2.1.2}
\label{env-0.2.1.2}
For a subspace $Y$ of a topological space $X$ to be irreducible, it is necessary and
sufficient that its closure $\overline{Y}$ be irreducible. In particular, any subspace which
is the closure $\overline{\{x\}}$ of a singleton is irreducible; we will express the relation
$y\in\overline{\{x\}}$ (equivalent to $\overline{\{y\}}\subset\overline{\{x\}}$) by saying
that there is a \emph{specialization of} $x$ or that there is a \emph{generalization of} $y$.
When there exists in an irreducible space $X$ a point $x$ such that $X=\overline{\{x\}}$, we
will say that $x$ is a \emph{generic point} of $X$. Any nonempty open subset of $X$ then
contains $x$, and any subspace containing $x$ admits $x$ for a generic point.
\end{env}

\begin{env}{2.1.3}
\label{env-0.2.1.3}
Recall that a \emph{Kolmogoroff space} is a topological space $X$ satisfying the axiom of
separation:

$(T_0)$ If $x\neq y$ are any two points of $X$, there is an open set containing one of the
points $x$, $y$ and not the other.

If an irreducible Kolmogoroff space admits a generic point, it admits \emph{only} one since a
nonempty open set contains any generic point.

Recall that a topological space $X$ is said to be \emph{quasicompact} if, from any collection
of open sets of $X$, one can extract a finite cover of $X$ (or, equivalently, if any
decreasing filter family of nonempty closed sets has a nonempty intersection). If $X$ is a
quasicompact space, then any nonempty closed subset $A$ of $X$ contains a \emph{minimal}
nonempty closed set $M$, because the set of nonempty closed subsets of $A$ is inductive for
the relation $\supset$; if in addition $X$ is a Kolmogoroff space, $M$ is necessarily reduced
to a single point (or, as we say by abuse of language, is a \emph{closed point}).
\end{env}

\begin{env}{2.1.4}
\label{env-0.2.1.4}
In an irreducible space $X$, every nonempty open subspace $U$ is irreducible, and if $X$
admits a generic point $x$, $x$ is also a generic point of $U$.

Let $(U_\alpha)$ be a cover (whose set of indices is nonempty) of a topological space $X$,
consisting of nonempty open sets; if $X$ is irreducible, it is necessary and sufficient that
$U_\alpha$ is irreducible for all $\alpha$, and that $U_\alpha\cap U_\beta\neq\emp$ for any
$\alpha$, $\beta$. The condition is clearly necessary; to the that it is sufficient, it
suffices to prove that if $V$ is a nonempty open subset of $X$, then $V\cap U_\alpha$ is
nonempty for all $\alpha$, since then $V\cap U_\alpha$ is dense in $U_\alpha$ for all
$\alpha$, and consequently $V$ is dense in $X$. Now there is at least one index $\gamma$ such
that $V\cap U_\gamma\neq\emp$, so $V\cap U_\gamma$ is dense in $U_\gamma$, and as for all
$\alpha$, $U_\alpha\cap V_\alpha\neq\emp$, we also have
$V\cap U_\alpha\cap U_\gamma\neq\emp$.
\end{env}

\begin{env}{2.1.5}
\label{env-0.2.1.5}
\oldpage{22}
Let $X$ be an irreducible space, $f$ a continuous map of $X$ into a topological space $Y$.
Then $f(X)$ is irreducible, and if $x$ is a generic point of $X$, $f(x)$ is a generic point
of $f(X)$ and hence also of $\overline{f(X)}$. In particular, if in addition $Y$ is
irreducible and with a single generic point $y$, for $f(X)$ to be everywhere dense, it is
necessary and sufficient that $f(x)=y$.
\end{env}

\begin{env}{2.1.6}
\label{env-0.2.1.6}
Any irreducible subspace of a topological space $X$ is contained in a maximal irreducible
subspace, which is necessarily closed. Maximal irreducible subspaces of $X$ are called the
\emph{irreducible components} of $X$. If $Z_1$, $Z_2$ are two irreducible components distinct
from the space $X$, $Z_1\cap Z_2$ is a closed \unsure{\emph{rare}} set in each of the
subspaces $Z_1$, $Z_2$; in particular, if an irreducible component of $X$ admits a generic
point \sref{env}{2.1.2} such a point can not belong to any other irreducible component. If
$X$ has only a \emph{finite} number of irreducible components $Z_i$
($1\leqslant i\leqslant n$), and if, for each $i$,we put
$U_i=Z_i\cap\mathrm{C}(\bigcup_{j\neq i}Z_j)$, the $U_i$ are open, irreducible, disjoint,
and their union is dense in $X$. Let $U$ be an open subset of a topological space $X$. If $Z$
is an irreducible subset of $X$ that intersects with $U$, $Z\cap U$ is open and dense in $Z$,
thus irreducible; conversely, for any irreducible closed subset $Y$ of $U$, the closure
$\overline{Y}$ of $Y$ in $X$ is irreducible and $\overline{Y}\cap U=Y$. We conclude that
there is a \emph{bijective correspondence} between the irreducible components of $U$ and the
irreducible components of $X$ which intersect $U$.
\end{env}

\begin{env}{2.1.7}
\label{env-0.2.1.7}
If a topological space $X$ is a union of a \emph{finite} number of irreducible closed
subspaces $Y_i$, the irreducible components of $X$ are the maximal elements of the set of
$Y_i$, because if $Z$ is an irreducible closed subset of $X$, $Z$ is the union of the
$Z\cap Y_i$, from which one sees that $Z$ must be contained in one of the $Y_i$. Let $Y$ be a
subspace of a topological space $X$, and suppose that $Y$ has only a finite number of
irreducible components $Y_i$, ($1\leqslant i\leqslant n$); then the closures $\overline{Y_i}$
in $X$ are the irreducible components of $Y$.
\end{env}

\begin{env}{2.1.8}
\label{env-0.2.1.8}
Let $Y$ be an irreducible space admitting a single generic point $y$. Let $X$ be a
topological space, $f$ a continuous map from $X$ to $Y$. Then, for any irreducible
component $Z$ of $X$ intersecting $f^{-1}(y)$, $f(Z)$ is dense in $Y$. The converse is not
necessarily true; however, if $Z$ has a generic point $z$, and if $f(Z)$ is dense in $Y$, we
must have $f(z)=y$ \sref{env}{2.1.5}; in addition, $Z\cap f^{-1}(y)$ is then the closure of
$\{z\}$ in $f^{-1}(y)$ and is therefore irreducible, and like any irreducible subset of
$f^{-1}(y)$ containing $z$ is necessarily contained in $Z$ \sref{env}{2.1.6}, $z$ is a
generic point of $Z\cap f^{-1}(y)$. As any irreducible component of $f^{-1}(y)$ is contained
in an irreducible component of $X$, we see that if any irreducible component $Z$ of $X$
intersecting $f^{-1}(y)$ admits a generic point, then there is a \emph{bijective
correspondence} between all these components and all the irreducible components
$Z\cap f^{-1}(y)$ of $f^{-1}(y)$, the generic points of $Z$ being identical to those of
$Z\cap f^{-1}(y)$.
\end{env}

\subsection{Noetherian spaces}
\label{0-prelim-2.2}

\begin{env}{2.2.1}
\label{env-0.2.2.1}
\oldpage{23}
We say that a topological space $X$ is \emph{Noetherian} if the set of open subsets of $X$
satisfies the \emph{maximal} condition, or, equivalently, if the set of closed subsets of $X$
satisfies the \emph{minimal} condition. We say that $X$ is \emph{locally Noetherian} if all
$x\in X$ admit a neighborhood which is a Noetherian subspace.
\end{env}

\begin{env}{2.2.2}
\label{env-0.2.2.2}
Let $E$ be an ordered set satisfying the \emph{minimal} condition, and let $\mathbf{P}$ be a
property of the elements of $E$ subject to the following condition: if $a\in E$ is such that
for any $x<a$, $\mathbf{P}(x)$ is true, then $\mathbf{P}(a)$ is true. Under these conditions,
$\mathbf{P}(x)$ \emph{is true for all} $x\in E$ (``principle of Noetherian recurrence'').
Indeed, let $F$ be the set of $x\in E$ for which $\mathbf{P}(x)$ is false; if $F$ were not
empty, it would have a minimal element $a$, and as then $\mathbf{P}(x)$ is true for all
$x<a$, $\mathbf{P}(a)$ would be true, which is a contradiction.

We will apply this principle in particular when $E$ is a \emph{set of closed subsets of a
Noetherian space}.
\end{env}

\begin{env}{2.2.3}
\label{env-0.2.2.3}
Any subspace of a Noetherian space is Noetherian. Conversely, any topological space that is a
finite union of Noetherian subspaces is Noetherian.
\end{env}

\begin{env}{2.2.4}
\label{env-0.2.2.4}
Any Noetherian space is quasicompact; conversely, any  topological space in which all open
sets are quasicompact is Noetherian.
\end{env}

\begin{env}{2.2.5}
\label{env-0.2.2.5}
A Noetherian space has only a \emph{finite} number of irreducible components, as we see by
Noetherian recurrence.
\end{env}

\section{Supplement on sheaves}
\label{0-prelim-3}

\subsection{Sheaves with values in a category}
\label{0-prelim-3.1}

\begin{env}{3.1.1}
\label{env-0.3.1.1}
Let $\K$ be a category, $(A_\alpha)_{\alpha\in I}$,
$(A_{\alpha\beta})_{(\alpha,\beta)\in I\times I}$ two families of objects of $\K$ such
that $A_{\beta\alpha}=A_{\alpha\beta}$, $(\rho_{\alpha\beta})_{(\alpha,\beta)\in I\times I}$
and $\rho_{\alpha\beta}:A_\alpha\to A_{\alpha\beta}$ is a family of morphisms. We say that a
pair formed by an object $A$ of $\K$ and a family of morphisms
$\rho_\alpha:A\to A_\alpha$ is a \emph{solution to the universal problem} defined by the data
of the families $(A_\alpha)$, $(A_{\alpha\beta})$, and $(\rho_{\alpha\beta})$ if, for every
object $B$ of $\K$, the map which, for sends $f\in\Hom(B,A)$ to the family
$(\rho_\alpha\circ f)\in\prod_\alpha\Hom(B,A_\alpha)$ is a \emph{bijection} of $\Hom(B,A)$ to
the set of all $(f_\alpha)$ such that
$\rho_{\alpha\beta}\circ f_\alpha=\rho_{\beta\alpha}\circ f_\beta$ for any pair of indices
$(\alpha,\beta)$. If such a solution exists, it is unique up to an isomorphism.
\end{env}

\begin{env}{3.1.2}
\label{env-0.3.1.2}
We will not recall the defintion of a \emph{presheaf} $U\mapsto\sh{F}(U)$ on a topological
space $X$ with values in a category $\K$ (G, I, 1.9); we say that such a presheaf is a
\emph{sheaf with values in} $\K$ if it satifies the following axiom:\\

(F) \emph{For any covering $(U_\alpha)$ of an open set $U$ of $X$ by open sets $U_\alpha$
    contained in $U$, if we denote by $\rho_\alpha$ (resp. $\rho_{\alpha\beta}$) the
    restriction morphism}
    \[
      \sh{F}(U)\to\sh{F}(U_\alpha)
      \quad(\text{\emph{resp. }}\sh{F}(U_\alpha)\to\sh{F}(U_\alpha\cap U_\beta)),
    \]
\oldpage{24}
    \emph{the pair formed by $\sh{F}(U)$ and the family $(\rho_\alpha)$ are a solution to
    the universal problem for $(\sh{F}(U_\alpha))$, $(\sh{F}(U_\alpha\cap U_\beta))$, and
    $(\rho_{\alpha\beta})$ in} \sref{env}{3.1.1}\footnote{This is a special case of the more
    general notion of a \emph{projective limit} (non-filtered) (\emph{see} (T, I, 1.8) and
    the book in preparation announced in the introduction).}.\\

Equivalently, we can say that, for each object $T$ of $\K$, the family
$U\mapsto\Hom(T,\sh{F}(U))$ is a \emph{sheaf of sets}.
\end{env}

\begin{env}{3.1.3}
\label{env-0.3.1.3}
Assume that $\K$ is the category defined by a ``type of structure with morphisms''
$\Sigma$,
the objects of $\K$ being the sets with structures of type $\Sigma$ and morphisms those of
$\Sigma$. Suppose that the category $\K$ also satisfies the following condition:\\

(E) If $(A,(\rho_\alpha))$ is a solution of a universal mapping problem \emph{in the
    category $\K$} for families $(A_\alpha)$, $(A_{\alpha\beta})$, $(\rho_{\alpha\beta})$,
    then it is also a solution of the universal mapping problem for the same families
    \emph{in the category of sets} (that is, when we consider $A$, $A_\alpha$, and
    $A_{\alpha\beta}$ as sets, $\rho_\alpha$ and $\rho_{\alpha\beta}$ as
    functions)\footnote{It can be proved that it also means that the canonical functor
    $\K\to(\mathrm{Set})$ \emph{commutes with projective limits} (not necessarily
    filtered).}.\\

Under these conditions, the condition (F) gives that, when considered as a presheaf \emph{of
sets}, $U\mapsto\sh{F}(U)$ is a \emph{sheaf}. In addition, for a map $u:T\to\sh{F}(U)$ to be
a morphism of $\K$, it is necessary and sufficient, under (F), that each map
$\rho_\alpha\circ u$ is a morphism $T\to\sh{F}(U_\alpha)$, which means that the structure of
type $\Sigma$ on $\sh{F}(U)$ is the \emph{initial structure} for the morphisms $\rho_\alpha$.
Conversely, suppose a presheaf $U\mapsto\sh{F}(U)$ on $X$, with values in $\K$, is a
\emph{sheaf of sets} and satisfies the previous condition; it is then clear that it satisfies
(F), so it is a \emph{sheaf with values in} $\K$.
\end{env}

\begin{env}{3.1.4}
\label{env-0.3.1.4}
When $\Sigma$ is a type of a group or ring structure, the fact that the presheaf
$U\mapsto\sh{F}(U)$ with values in $\K$ is a sheaf of \emph{sets} leads \emph{ipso facto}
that it is a sheaf with values in $\K$ (in other words, a sheaf of groups or rings within the
meaning of (G))\footnote{This is because in the category $\K$, any morphism that is a
\emph{bijection} (as a map of sets) is an \emph{isomorphism}. This is no longer true when
$\K$ is the category of topological spaces, for example.}. But it is not the same when, for
example, $\K$ is the category of \emph{topological rings} (with morphisms as continuous
homomorphisms): a sheaf with values in $\K$ is a sheaf of rings $U\mapsto\sh{F}(U)$ such that
for any open $U$ and any covering of $U$ by open sets $U_\alpha\subset U$, the topology of
the ring $\sh{F}(U)$ is to be \emph{the least fine}, making the homomorpisms
$\sh{F}(U)\to\sh{F}(U_\alpha)$ continuous. We will say in this case that $U\mapsto\sh{F}(U)$,
considered as a sheaf of rings (without a topology), is \emph{underlying} the sheaf of
topological rings $U\mapsto\sh{F}(U)$. Morphisms $u_V:\sh{F}(V)\to\sh{G}(V)$ ($V$ an
arbitrary open subset of $X$) of sheaves of topological rings are therefore homomorphisms of
the underlying sheaves of rings, such that $u_V$ be \emph{continuous} for all open
$V\subset X$; to distinguish them from any homomorphisms of the sheaves of the underlying
rings, we will call them continuous homomorphisms of sheaves of topological rings. We have
similar definitions and conventions for sheaves of topological spaces or topological groups.
\end{env}

\begin{env}{3.1.5}
\label{env-0.3.1.5}
\oldpage{25}
It is clear that for any category $\K$, if there is a presheaf (respectively a sheaf)
$\sh{F}$ on $X$ with values in $\K$ and $U$ is an open set of $X$, the $\sh{F}(V)$ for open
$V\subset U$ constitute a presheaf (or a sheaf) with values in $\K$, which we call the
presheaf (or sheaf) \emph{induced} by $\sh{F}$ on $U$ and denote it by $\sh{F}|U$.

For any morphism $u:\sh{F}\to\sh{G}$ of presheaves on $X$ with values in $\K$, we denote by
$u|U$ the morphism $\sh{F}|U\to\sh{G}|U$ formed by the $u_V$ for $V\subset U$.
\end{env}

\begin{env}{3.1.6}
\label{env-0.3.1.6}
Suppose now that the category $\K$ admits \emph{inductive limits} (T, 1.8); then, for any
presheaf (and in particular any sheaf) $\sh{F}$ on $X$ with values in $\K$ and all $x\in X$,
we can define the \emph{stalk} $\sh{F}_x$ as the object of $\K$ defined by the inductive
limit of the $\sh{F}(U)$ with respect to the filtering set (for $\supset$) of the open
neighborhoods $U$ of $x$ in $X$, and for the morphisms $\rho_U^V:\sh{F}(V)\to\sh{F}(U)$. If
$u:\sh{F}\to\sh{G}$ is a morphism of presheaves with values in $\K$, we define for all
$x\in X$ the morphism $u_x:\sh{F}_x\to\sh{G}_x$ as the inductive limit of
$u_U:\sh{F}(U)\to\sh{G}(U)$ with respect to all open neighborhoods of $x$; we thus define
$\sh{F}_x$ as a covariant functor in $\sh{F}$, with values in $\K$, for all $x\in X$.

When $\K$ is further defined by a kind of structure with morphisms $\Sigma$, we call
\emph{sections over $U$} of a \emph{sheaf} $\sh{F}$ with values in $\K$ the elements of
$\sh{F}(U)$, and we write $\Gamma(U,\sh{F})$ instead of $\sh{F}(U)$; for
$s\in\Gamma(U,\sh{F})$, $V$ an open set contained in $U$, we write $s|V$ instead of
$\rho_V^U(s)$; for all $x\in U$, the canonical image of $s$ in $\sh{F}_x$ is the \emph{germ}
of $s$ at the point $x$, denoted by $s_x$ (\emph{we will never replace the notation $s(x)$ in
this sense,} this notation being reserved for another notion relating to sheaves which will
be considered in this treatise \sref{env}{5.5.1}).

If then $u:\sh{F}\to\sh{G}$ is a morphism of sheaves with values in $\K$, we will write
$u(s)$ instead of $u_V(s)$ for all $s\in\Gamma(U,\sh{F})$.

If $\sh{F}$ is a sheaf of commutative groups, or rings, or modules, we say that the set of
$x\in X$ such that $\sh{F}_x\neq\{0\}$ is the \emph{support} of $\sh{F}$, denoted
$\Supp(\sh{F})$; this set is not necessarily closed in $X$.

When $\K$ is defined by a type of structure with morphisms, \emph{we systematically refrain
from using the point of view of ``\'etal\'e spaces''} in terms of relating to sheaves with
values in $\K$; in other words, we will never consider a sheaf as a topological space (nor
even as the whole union of its fibers), and we will not consider also a morphism
$u:\sh{F}\to\sh{G}$ of such sheaves on $X$ as a continuous map of topological spaces.
\end{env}

\subsection{Presheaves on an open basis}
\label{0-prelim-3.2}

\begin{env}{3.2.1}
\label{env-0.3.2.1}
We will restrict to the following categories $\K$ admitting \emph{projective limits}
(generalized, that is, corresponding to not necessarily filtered preordered sets,
cf. (T, 1.8)). Let $X$ be a topological space, $\mathfrak{B}$ an open basis for the topology
of $X$. We will call a \emph{presheaf on $\mathfrak{B}$, with values in $\K$,} to be a family
of objects $\sh{F}(U)\in\K$, corresponding to each $U\in\mathfrak{B}$, and a family of
morphisms $\rho_U^V:\sh{F}(V)\to\sh{F}(U)$ defined for any pair $(U,V)$ of elements of
$\mathfrak{B}$ such that $U\subset V$,
\oldpage{26}
with the conditions $\rho_U^U=$ identity and $\rho_U^W=\rho_U^V\circ\rho_V^W$ if $U$, $V$,
$W$ in $\mathfrak{B}$ are such that $U\subset V\subset W$. We can associate a \emph{presheaf
with values in} $\K$: $U\mapsto\sh{F}(U)$ in the ordinary sense, taking for all open $U$,
$\sh{F}'(U)=\varprojlim\sh{F}(V)$, where $V$ runs through the ordered set (for $\subset$,
\emph{not filtered} in general) of $V\in\mathfrak{B}$ sets such that $V\subset U$, since the
$\sh(V)$ form a projective system for the $\rho_V^W$ ($V\subset W\subset U$,
$V\in\mathfrak{B}$, $W\in\mathfrak{B}$). Indeed, if $U$, $U'$ are two open sets of $X$ such
that $U\subset U'$, we define ${\rho'}_U^{U'}$ as the projective limit (for $V\subset U$) of
the canonical morphisms $\sh{F}'(U')\to\sh{F}(V)$, in other words the unique morphism
$\sh{F}'(U')\to\sh{F}'(U)$, which, when composed with the canonical morphisms
$\sh{F}'(U)\to\sh{F}(V)$, gives the canonical morphisms $\sh{F}'(U')\to\sh{F}(V)$; the
verification of the transitivity of ${\rho'}_U^{U'}$ is then immediate. Moreover, if
$U\in\mathfrak{B}$, the canonical morphism $\sh{F}'(U)\to\sh{F}(U)$ is an isomorphism,
allowing to identify these two objects\footnote{If $X$ is a \emph{Noetherian} space, we can
still define $\sh{F}'(U)$ and show that it is a presheaf (in the ordinary sense) when one
supposes only that $\K$ admits projective limits for \emph{finite} projective systems.
Indeed, if $U$ is any open set of $X$, there is a \emph{finite} covering $(V_i)$ of $U$
formed by sets of $\mathfrak{B}$; for every couple $(i,j)$ of indices, let $(V_{ijk})$ be a
finite covering of $V_i\cap V_j$ formed by sets of $\mathfrak{B}$. Let $I$ be the set of $i$
and triples $(i,j,k)$, ordered only by the relations $i>(i,j,k)$, $j>(i,j,k)$; we then take
$\sh{F}'(U)$ to be the projective limit of the system of $\sh{F}(V_i)$ and $\sh{F}(V_{ijk})$;
it is easy to verify that this does not depend on the coverings $(V_i)$ and $(V_{ijk})$ and
that $U\mapsto\sh{F}'(U)$ is a presheaf.}.
\end{env}

\begin{env}{3.2.2}
\label{env-0.3.2.2}
For the presheaf $\sh{F}'$ thus defined to be a \emph{sheaf}, it is necessary and sufficient
that the presheaf $\sh{F}$ on $\mathfrak{B}$ satisfies the condition:\\

(F$_0$) \emph{For any covering $(U_\alpha)$ of $U\in\mathfrak{B}$ by sets
        $U_\alpha\in\mathfrak{B}$ contained in $U$, and for any object $T\in\K$, the map
        which takes $f\in\Hom(T,\sh{F}(U))$ to the family
        $(\rho_{U_\alpha}^U\circ f)\in\prod_\alpha\Hom(T,\sh{F}(U_\alpha))$ is a bijection of
        $\Hom(T,\sh{F}(U))$ on the set of all $(f_\alpha)$ such that
        $\rho_V^{U_\alpha}\circ f_\alpha=\rho_V^{U_\beta}\circ f_\beta$ for any pair of
        indices $(\alpha,\beta)$ and any $V\in\mathfrak{B}$ such that
        $V\subset U_\alpha\cap U_\beta$\footnote{It also means that the pair formed by
        $\sh{F}(U)$ and the $\rho_\alpha=\rho_{U_\alpha}^U$ is a \emph{solution to the
        universal problem} defined in \sref{env}{3.1.1} by the data of
        $A_\alpha=\sh{F}(U_\alpha)$, $A_{\alpha\beta}=\prod\sh{F}(V)$ (for $V\in\mathfrak{B}$
        such that $V\subset U_\alpha\cap U_\beta$) and
        $\rho_{\alpha\beta}=(\rho_V''):\sh{F}(U_\alpha)\to\prod\sh{F}(V)$ defined by the
        condition that for $V\in\mathfrak{B}$, $V'\in\mathfrak{B}$, $W\in\mathfrak{B}$,
        $V\cup V'\subset U_\alpha\cap U_\beta$, $W\subset V\cap V'$,
        $\rho_W^V\circ\rho_V''=\rho_W^{V'}\circ\rho_{V'}''$.}.}\\

The condition is obviously necessary. To show that it is sufficient, consider first a second
basis $\mathfrak{B}'$ of the topology of $X$, \emph{contained in} $\mathfrak{B}$, and show
that if $\sh{F}''$ denotes the presheaf induced by the subfamily
$(\sh{F}(V))_{V\in\mathfrak{B}'}$, $\sh{F}''$ is \emph{canonically isomorphic} to $\sh{F}'$.
Indeed, firstly the projective limit (for $V\in\mathfrak{B}'$, $V\subset U$) canonical
morphisms ${\sh{F}'(U)\to\sh{F}(V)}$ is a morphism $\sh{F}'(U)\to\sh{F}''(U)$ for all open
$U$. If $U\in\mathfrak{B}$, this morphism is an isomorphism, because by hypothesis the
canonical morphisms $\sh{F}''(U)\to\sh{F}(V)$ for $V\in\mathfrak{B}'$, $V\subset U$,
factorize into $\sh{F}''(U)\to\sh{F}(U)\to\sh{F}(V)$, and it is immediate to see that the
composition of morphisms $\sh{F}(U)\to\sh{F}''(U)$ and $\sh{F}''(U)\to\sh{F}(U)$ thus defined
are the identities. This being so, for all open $U$, the morphisms
$\sh{F}''(U)\to\sh{F}''(W)=\sh{F}(W)$ for $W\in\mathfrak{B}$ and $W\subset U$ satisfy the
conditions characterizing the projective limit of $\sh{F}(W)$ ($W\in\mathfrak{B}$,
$W\subset U$), which proves our assertion given the uniqueness of a projective limit up
to isomorphism.

This posed, let $U$ be any open set of $X$, $(U_\alpha)$ a covering of $U$ by the open sets
contained in $U$, and $\mathfrak{B}'$ the subfamily of $\mathfrak{B}$ formed by the sets
\oldpage{27}
of $\mathfrak{B}$ contained in at least $U_\alpha$; it is clear that $\mathfrak{B}'$ is still
a basis of the topology of $X$, so $\sh{F}'(U)$ (resp. $\sh{F}''(U_\alpha)$) is the
projective limit of $\sh{F}(V)$ for $V\in\mathfrak{B}'$ and $V\subset U$
(resp., $V\subset U_\alpha$), the axiom (F) is then immediately verified by virtue of the
definition of the projective limit.

When (F$_0$) is satisfied, we will say by abuse of language that the presheaf $\sh{F}$ on the
basis $\mathfrak{B}$ is a sheaf.
\end{env}

\begin{env}{3.2.3}
\label{env-0.3.2.3}
Let $\sh{F}$, $\sh{G}$ be two presheaves on a basis $\mathfrak{B}$, with values in $\K$; we
define a \emph{morphism} $u:\sh{F}\to\sh{G}$ as a family $(u_V)_{V\in\mathfrak{B}}$ of
morphisms $u_V:\sh{F}(V)\to\sh{G}(V)$ satisfying the usual compatibility conditions with the
restriction morphisms $\rho_V^W$. With the notation of \sref{env}{3.2.1}, we have a morphism
$u':\sh{F}'\to\sh{G}'$ of (ordinary) presheaves by taking for $u_U'$ the projective limit of
the $u_V$ for $V\in\mathfrak{B}$ and $V\subset U$; the verification of the compatibility
conditions with the ${\rho'}_U^{U'}$ follows from the functorial properties of the projective
limit.
\end{env}

\begin{env}{3.2.4}
\label{env-0.3.2.4}
If the category $\K$ admits inductive limits, and if $\sh{F}$ is a presheaf on the basis
$\mathfrak{B}$, with values in $\K$, for each $x\in X$ the neighborhoods of $x$ belonging to
$\mathfrak{B}$ form a cofinal set (for $\supset$) in the set of neighborhoods of $x$,
therefore, if $\sh{F}'$ is the (ordinary) presheaf corresponding to $\sh{F}$, the stalk
$\sh{F}_x'$ is equal to $\varinjlim_{\mathfrak{B}}\sh{F}(V)$ over the set of
$V\in\mathfrak{B}$ containing $x$. If $u:\sh{F}\to\sh{G}$ is morphism of presheaves on
$\mathfrak{B}$ with values in $\K$, $u':\sh{F}'\to\sh{G}'$ the corresponding morphism of
ordinary presheaves, $u_x'$ is likewise the inductive limit of the morphisms
$u_V:\sh{F}(V)\to\sh{G}(V)$ for $V\in\mathfrak{B}$, $x\in V$.
\end{env}

\begin{env}{3.2.5}
\label{env-0.3.2.5}
We return to the general conditions of \sref{env}{3.2.1}. If $\sh{F}$ is an ordinary
\emph{sheaf} with values in $\K$, $\sh{F}_1$ the sheaf \emph{on} $\mathfrak{B}$ obtained
by the restriction of $\sh{F}$ to $\mathfrak{B}$, the ordinary sheaf $\sh{F}_1'$ obtained
from $\sh{F}_1$ by the procedure of \sref{env}{3.2.1} is canonically isomorphic to $\sh{F}$,
by virtue of the condition (F) and the uniqueness properties of the projective limit. We
identify the ordinary sheaf $\sh{F}$ with $\sh{F}_1'$.

If $\sh{G}$ is a second (ordinary) sheaf on $X$ with values in $\K$, and $u:\sh{F}\to\sh{G}$
a morphism, the preceding remark shows that the data of the $u_V:\sh{F}(V)\to\sh{G}(V)$
\emph{for only the $V\in\mathfrak{B}$} completely determines $u$; conversely, it is
sufficient, the $u_V$ being given for $V\in\mathfrak{B}$, to verify the commutative
diagram with the restriction morphisms $\rho_V^W$ for $V\in\mathfrak{B}$, $W\in\mathfrak{B}$,
and $V\subset W$, for there to exist a morphism $u'$ and a unique $\sh{F}$ in $\sh{G}$ such
that $u_V'=u_V$ for each $V\in\mathfrak{B}$ \sref{env}{3.2.3}.
\end{env}

\begin{env}{3.2.6}
\label{env-0.3.2.6}
Suppose that $\K$ admits projective limits. Then the category of \emph{sheaves on $X$
with values in $\K$} admits \emph{projective limits}; if $(\sh{F}_\lambda)$ is a
projective system of sheaves on $X$ with values in $\K$, the
$\sh{F}(U)=\varprojlim_\lambda\sh{F}_\lambda(U)$ indeed define a presheaf with values in
$\K$, and the verification of the axiom (F) follows from the transitivity of projective
limits; the fact that $\sh{F}$ is then the projective limit of the $\sh{F}_\lambda$ is
immediate.

When $\K$ is the category of sets, for each projective system $(\mathfrak{H}_\lambda)$ such
\oldpage{28}
that $\mathfrak{H}_\lambda$ is a \emph{subsheaf} of $\sh{F}_\lambda$ for each $\lambda$,
$\varprojlim_\lambda\mathfrak{H}_\lambda$ canonically identifies with a \emph{subsheaf} of
$\varprojlim_\lambda\sh{F}_\lambda$. If $\K$ is the category of abelian groups, the covariant
functor $\varprojlim_\lambda\sh{F}_\lambda$ is \emph{additive} and \emph{left exact}.
\end{env}

\subsection{Gluing of sheaves}
\label{0-prelim-3.3}

\begin{env}{3.3.1}
\label{env-0.3.3.1}
Suppose still that the category $\K$ admits (generalized) projective limits. Let $X$ be
a topological space, $\mathfrak{U}=(U_\lambda)_{\lambda\in L}$ an open cover of $X$, and for
each $\lambda\in L$, let $\sh{F}_\lambda$ be a sheaf on $U_\lambda$, with values in $\K$; for
each pair of indices $(\lambda,\mu)$, suppose that we are given an \emph{isomorphism}
$\theta_{\lambda\mu}:\sh{F}_\mu|(U_\lambda\cap U_\mu)\isoto\sh{F}|(U_\lambda\cap U_\mu)$; in
addition, suppose that for each triple $(\lambda,\mu,\nu)$, if we denote by
$\theta_{\lambda\mu}'$, $\theta_{\mu\nu}'$, $\theta_{\lambda\nu}'$ the restrictions of
$\theta_{\lambda\mu}$, $\theta_{\mu\nu}$, $\theta_{\lambda\nu}$ to
$U_\lambda\cap U_\mu\cap U_\nu$, then we have
$\theta_{\lambda\nu}'=\theta_{\lambda\mu}'\circ\theta_{\mu\nu}'$ (\emph{gluing condition} for
the $\theta_{\lambda\mu}$). Then, there exists a sheaf $\sh{F}$ on $X$, with values in $\K$,
and for each $\lambda$ an isomorphism
$\eta_\lambda:\sh{F}|U_\lambda\isoto\sh{F}_\lambda$ such that, for each pair
$(\lambda,\mu)$, if we denote by $\eta_\lambda'$ and $\eta_\mu'$ the restrictions of
$\eta_\lambda$ and $\eta_\mu$ to $U_\lambda\cap U_\mu$, then we have
$\theta_{\lambda\mu}=\eta_\lambda'\circ{\eta_\mu'}^{-1}$; in addition, $\sh{F}$ and the
$\eta_\lambda$ are determined up to unique isomorphism by these conditions. The uniqueness
indeed follows immediately from \sref{env}{3.2.5}. To establish the existence of $\sh{F}$,
denote by $\mathfrak{B}$ the open basis consisting of the open sets contained in at least one
$U_\lambda$, and for each $U\in\mathfrak{B}$, choose (by the Hilbert function $\tau$) one of
the $\sh{F}_\lambda(U)$ for one of the $\lambda$ such that $U\subset U_\lambda$; if we denote
this object by $\sh{F}(U)$, the $\rho_U^V$ for $U\subset V$, $U\in\mathfrak{B}$,
$V\in\mathfrak{B}$ are defined in an evident way (by means of the $\theta_{\lambda\mu}$), and
the transitivity conditions is a consequence of the gluing condition; in addition, the
verification of (F$_0$) is immediate, so the presheaf on $\mathfrak{B}$ thus clearly defines
a sheaf, and we deduce by the general procedure \sref{env}{3.2.1} an (ordinary) sheaf still
denoted $\sh{F}$ and which answers the question. We say that $\sh{F}$ is obtained by
\emph{gluing the $\sh{F}_\lambda$ by means of the $\theta_{\lambda\mu}$} and we usually
indentify the $\sh{F}_\lambda$ and $\sh{F}|U_\lambda$ by means of the $\eta_\lambda$.

It is clear that each sheaf $\sh{F}$ on $X$ with values in $\K$ can be considered as being
obtained by the gluing of the sheaves $\sh{F}_\lambda=\sh{F}|U_\lambda$ (where $(U_\lambda)$
is an arbitrary open cover of $X$), by means of the isomorphisms $\theta_{\lambda\mu}$
reduced to the identity.
\end{env}

\begin{env}{3.3.2}
\label{env-0.3.3.2}
With the same notations, let $\sh{G}_\lambda$ be a second sheaf on $U_\lambda$ (for each
$\lambda\in L$) with values in $\K$, and for each pair $(\lambda,\mu)$ let us be given an
isomorphism
$\omega_{\lambda\mu}:\sh{G}_\mu|(U_\lambda\cap U_\mu)
\isoto\sh{G}_\lambda|(U_\lambda\cap U_\mu)$, these isomorphisms satisfying the
gluing condition. Finally, suppose that we are given for each $\lambda$ a morphism
$u_\lambda:\sh{F}_\lambda\to\sh{G}_\lambda$, and that the diagrams
\[
  \xymatrix{
    \sh{F}_\mu|(U_\lambda\cap U_\mu)\ar[r]^{u_\mu}\ar[d] &
    \sh{G}_\mu|(U_\lambda\cap U_\mu)\ar[d]\\
    \sh{F}_\lambda|(U_\lambda\cap U_\mu)\ar[r]^{u_\lambda} &
    \sh{G}_\lambda|(U_\lambda\cap U_\mu)
  }
  \tag{3.3.2.1}
\]
are commutative. Then, if $\sh{G}$ is obtained by gluing the $\sh{G}_\lambda$ by means of the
$\omega_{\lambda\mu}$, there exists a unique morphism $u:\sh{F}\to\sh{G}$ such that the
diagrams
\oldpage{29}
\[
  \xymatrix{
    \sh{F}|U_\lambda\ar[r]^{u|U_\lambda}\ar[d] &
    \sh{G}|U_\lambda\ar[d]\\
    \sh{F}_\lambda\ar[r]^{u_\lambda} &
    \sh{G}_\lambda
  }
\]
are commutative; this follows immediately from \sref{env}{3.2.3}. The correspondence between
the family $(u_\lambda)$ and $u$ is in a functorial bijection with the subset of
$\prod_\lambda\Hom(\sh{F}_\lambda,\sh{G}_\lambda)$ satisfying the conditions (3.3.2.1) on
$\Hom(\sh{F},\sh{G})$.
\end{env}

\begin{env}{3.3.3}
\label{env-0.3.3.3}
With the notations of \sref{env}{3.3.1}, let $V$ be an open set of $X$; it is immediate that
the restrictions to $V\cap U_\lambda\cap U_\mu$ of the $\theta_{\lambda\mu}$ satisfy the
gluing condition for the induced sheaves $\sh{F}_\lambda|(V\cap U_\lambda)$ and that the
sheaves on $V$ obtained by gluing the latter identifies canonically with $\sh{F}|V$.
\end{env}

\subsection{Direct images of presheaves}
\label{0-prelim-3.4}

\begin{env}{3.4.1}
\label{env-0.3.4.1}
Let $X$, $Y$ be two topological spaces, $\psi:X\to Y$ a continuous map. Let $\sh{F}$ be a
presheaf on $X$ with values in a category $\K$; for each open $U\subset Y$, let
$\sh{G}(U)=\sh{F}(\psi^{-1}(U))$, and if $U$, $V$ are two open subsets of $Y$ such that
$U\subset V$, let $\rho_U^V$ be the morphism $\sh{F}(\psi^{-1}(V))\to\sh{F}(\psi^{-1}(U))$;
it is immediate that the $\sh{G}(U)$ and the $\rho_U^V$ define a \emph{presheaf} on $Y$ with
values in $\K$, that we call the \emph{direct image of $\sh{F}$ by $\psi$} and we denote it
by $\psi_*(\sh{F})$. If $\sh{F}$ is a sheaf, we immediately verify the axiom (F) for the
presheaf $\sh{G}$, so $\psi_*(\sh{F})$ is a sheaf.
\end{env}

\begin{env}{3.4.2}
\label{env-0.3.4.2}
Let $\sh{F}_1$, $\sh{F}_2$ be two presheaves of $X$ with values in $\K$, and let
$u:\sh{F}_1\to\sh{F}_2$ be a morphism. When $U$ varies over the set of open subsets of $Y$,
the family of morphisms $u_{\psi^{-1}(U)}:\sh{F}_1(\psi^{-1}(U))\to\sh{F}_2(\psi^{-1}(U))$
satisfies the compatibility conditions with the restriction morphisms, and as a result
defines a a morphism $\psi_*(u):\psi_*(\sh{F}_1)\to\psi_*(\sh{F}_2)$. If
$v:\sh{F}_2\to\sh{F}_3$ is a morphism from $\sh{F}_2$ to a third preshead on $X$ with values
in $\K$, we have $\psi_*(v\circ u)=\psi_*(v)\circ\psi_*(u)$; in other words, $\psi_*(\sh{F})$
is a \emph{covariant functor} in $\sh{F}$, from the category of presheaves (resp. sheaves) on
$X$ with values in $\K$, to that of presheaves (resp. sheaves) on $Y$ with values in $\K$.
\end{env}

\begin{env}{3.4.3}
\label{env-0.3.4.3}
Let $Z$ be a third topological space, $\psi':Y\to Z$ a continuous map, and let
$\psi''=\psi'\circ\psi$. It is clear that we have $\psi_*''(\sh{F})=\psi_*'(\psi_*(\sh{F}))$
for each presheaf $\sh{F}$ on $X$ with values in $\K$; in addition, for each morphism
$u:\sh{F}\to\sh{G}$ of such presheaves, we have $\psi_*''(u)=\psi_*'(\psi_*(u))$. In other
words, $\psi_*''$ is the \emph{composition} of the functors $\psi_*'$ and $\psi_*$, and this
can be written as
\[
  (\psi'\circ\psi)_*=\psi_*'\circ\psi_*.
\]

In addition, for each open set $U$ of $Y$, the image under the restriction
$\psi|\psi^{-1}(U)$ of the induced presheaf $\sh{F}|\psi^{-1}(U)$ is none other than the
induced presheaf $\psi_*(\sh{F})|U$.
\end{env}

\begin{env}{3.4.4}
\label{env-0.3.4.4}
Suppose that the category $\K$ admits inductive limits, and let $\sh{F}$ be a presheaf on $X$
with values in $\K$; for all $x\in X$, the morphisms $\Gamma(\psi^{-1}(U),\sh{F})\to\sh{F}_x$
($U$ an open neighborhood of $\psi(x)$ in $Y$) form an inductive limit, which gives by
passing
\oldpage{30}
to the limit a morphism $\psi_x:(\psi_*(\sh{F}))_{\psi(x)}\to\sh{F}_x$ of the stalks; in
general, these morphisms are \emph{neither injective or surjective}. It is functorial;
indeed, if $u:\sh{F}_1\to\sh{F}_2$ is a morphism of presheaves on $X$ with values in $\K$,
the diagram
\[
  \xymatrix{
    (\psi_*(\sh{F}_1))_{\psi(x)}\ar[r]^{\psi_x}\ar[d]_{(\psi_*(u))_{\psi(x)}} &
    (\sh{F}_1)_x\ar[d]^{u_x}\\
    (\psi_*(\sh{F}_2))_{\psi(x)}\ar[r]^{\psi_x} &
    (\sh{F}_2)_x
  }
\]
is commutative. If $Z$ is a third topological space, $\psi':Y\to Z$ a continuous map, and
$\psi''=\psi'\circ\psi$, we have $\psi_x''=\psi_x\circ\psi_{\psi(x)}'$ for $x\in X$.
\end{env}

\begin{env}{3.4.5}
\label{env-0.3.4.5}
Under the hypotheses of \sref{env}{3.4.4}, suppose in addition that $\psi$ is a
\emph{homeomorphism} from $X$ to the subspace $\psi(X)$ of $Y$. Then, for each $x\in X$,
$\psi_x$ is an \emph{isomorphism}. This applies in particular to the canonical injection $j$
of a subset $X$ of $Y$ into $Y$.
\end{env}

\begin{env}{3.4.6}
\label{env-0.3.4.6}
Suppose that $\K$ be the category of groups, or of rings, etc. If $\sh{F}$ is a sheaf on $X$
with a values in $\K$, of support $S$, and if $y\not\in\overline{\psi(S)}$, it follows from
the definition of $\psi_*(\sh{F})$ that $(\psi_*(\sh{F}))_y=\{0\}$, or in other words the
support of $\psi_*(\sh{F})$ is contained in $\overline{\psi(S)}$; but it is not necessarily
contined in $\psi(S)$. Under the same hypotheses, if $j$ is the canonical injection of a
subset $X$ of $Y$ into $Y$, the sheaf $j_*(\sh{F})$ induces $\sh{F}$ on $X$; if moreover
$X$ is \emph{closed} in $Y$, $j_*(\sh{F})$ is the sheaf on $Y$ which induces $\sh{F}$ on $X$
and $0$ on $Y-X$ (G, II, 2.9.2), but it is in general distinct from the latter when we
suppose that $X$ is locally closed but not closed.
\end{env}

\subsection{Inverse images of presheaves}
\label{0-prelim-3.5}

\begin{env}{3.5.1}
\label{env-0.3.5.1}
Under the hypotheses of \sref{env}{3.4.1}, if $\sh{F}$ (resp. $\sh{G}$) is a presheaf on $X$
(resp. $Y$) with values in $\K$, each morphism $u:\sh{G}\to\psi_*(\sh{F})$ of presheaves on
$Y$ is then called a \emph{$\phi$-morphism} from $\sh{G}$ to $\sh{F}$, and we denote it also
by $\sh{G}\to\sh{F}$. We denote also by $\Hom_\phi(\sh{G},\sh{F})$ the set of
$\Hom_Y(\sh{G},\psi_*(\sh{F}))$ the $\psi$-morphismes from $\sh{G}$ to $\sh{F}$. For each
pair $(U,V)$, where $U$ is an open set of $X$, $V$ an open set of $Y$ such that
$\psi(U)\subset V$, we have a morphism $u_{U,V}:\sh{G}(U)\to\sh{F}(U)$ by composing the
restriction morphism $\sh{F}(\psi^{-1}(V))\to\sh{F}(U)$ and the morphism
$u_V:\sh{G}(V)\to\psi_*(\sh{F})(V)=\sh{F}(\psi^{-1}(V))$; it is immediate that these
morphisms renders commutative the diagrams
\[
  \xymatrix{
    \sh{G}(V)\ar[r]^{u_{U,V}}\ar[d] &
    \sh{F}(U)\ar[d]\\
    \sh{G}(V')\ar[r]^{u_{U',V'}} &
    \sh{F}(U')
  }
  \tag{3.5.1.1}
\]
for $U'\subset U$, $V'\subset V$, $\psi(U')\subset V'$. Conversely, the data of a family
$(u_{U,V})$ of morphisms rendering commutative the diagrams (3.5.1.1) define a
$\psi$-morphism $u$, since it suffices to take $u_V=u_{\psi^{-1}(V),V}$.

\oldpage{31}
If the category $\K$ admits (generalized) projective limits, and if $\mathfrak{B}$,
$\mathfrak{B}'$ are the bases of the topologies of $X$ and $Y$ respectively, to define a
$\psi$-morphism $u$ of \emph{sheaves}, we can restrict to giving the $u_{U,V}$ for
$U\in\mathfrak{B}$, $V\in\mathfrak{B}'$, and $\psi(U)\subset V$, satisfying the compatibility
conditions of (3.5.1.1) for $U$, $U'$ in $\mathfrak{B}$ and $V$, $V'$ in $\mathfrak{B}'$; it
indeed suffices to define $u_W$, for each open $W\subset Y$, as the projective limit of the
$u_{U,V}$ for $V\in\mathfrak{B}'$ and $V\subset W$, $U\in\mathfrak{B}$ and
$\psi(U)\subset V$.

When the category $\K$ admits inductive limits, we have, for each $x\in X$, a morphism
$\sh{G}(V)\to\sh{F}(\psi^{-1}(V))\to\sh{F}_x$, for each open neighborhood $V$ of $\psi(x)$ in
$Y$, and these morphisms form an inductive system which gives by passing to the limit a
morphism $\sh{G}_{\psi(x)}\to\sh{F}_x$.
\end{env}

\begin{env}{3.5.2}
\label{env-0.3.5.2}
Under the hypotheses of \sref{env}{3.4.3}, let $\sh{F}$, $\sh{G}$, $\sh{H}$ be presheaves
with values in $\K$ on $X$, $Y$, $Z$ respectively, and let $u:\sh{G}\to\psi_*(\sh{F})$,
$v:\sh{H}\to\psi_*'(\sh{G})$ a $\psi$-morphism and a $\psi'$-morphism respectively. We obtain
a $\psi''$-morphism
$w:\sh{H}\xrightarrow{v}\psi_*'(\sh{G})\xrightarrow{\psi_*'(u)}
\psi_*'(\psi_*(\sh{F}))=\psi_*''(\sh{F})$, that we call, by definition, the
\emph{composition} of $u$ and $v$. We can therefore consider the pairs $(X,\sh{F})$
consisting of a topological space $X$ and a presheaf $\sh{F}$ on $X$ (with values in $\K$) as
forming a \emph{category}, the morphisms being the pairs
$(\psi,\theta):(X,\sh{F})\to(Y,\sh{G})$ consisting of a continuous map $\psi:X\to Y$ and
of a $\psi$-morphism $\theta:\sh{G}\to\sh{F}$.
\end{env}

\begin{env}{3.5.3}
\label{env-0.3.5.3}
Let $\psi:X\to Y$ be a continuous map, $\sh{G}$ a \emph{presheaf} on $Y$ with values in $\K$.
We call the \emph{inverse image of $\sh{G}$ under $\psi$} the pair $(\sh{G}',\rho)$, where
$\sh{G}'$ is a \emph{sheaf} on $X$ with values in $\K$, and $\rho:\sh{G}\to\sh{G}'$ a
$\psi$-morphism (in other words a homomorphism $\sh{G}\to\psi_*(\sh{G}')$) such that, for
each \emph{sheaf} $\sh{F}$ on $X$ with values in $\K$, the map
\[
  \Hom_X(\sh{G}',\sh{F})\longrightarrow\Hom_\psi(\sh{G},\sh{F})
  \longrightarrow\Hom_Y(\sh{G},\psi_*(\sh{F}))
  \tag{3.5.3.1}
\]
sending $v$ to $\psi_*(v)\circ\rho$, is a \emph{bijection}; this map, is functorial in
$\sh{F}$, defines then an isomorphism of functors in $\sh{F}$. The pair $(\sh{G}',\rho)$
is the solution of a universal problem, and we say it is \emph{determined up to unique
isomorphism} when it exists. We then write $\sh{G}'=\psi^*(\sh{G})$, $\rho=\rho_\sh{G}$, and
by abuse of language, we say that $\psi^*(\sh{G})$ is \emph{the inverse image sheaf} of
$\sh{G}$ under $\psi$, and we agree that $\psi^*(\sh{G})$ is considered as equipped with a
\emph{canonical $\psi$-morphism $\rho_\sh{G}:\sh{G}\to\psi^*(\sh{G})$}, that is to say the
\emph{canonical homomorphism} of presheaves on $Y$:
\[
  \rho_\sh{G}:\sh{G}\longrightarrow\psi_*(\psi^*(\sh{G})).
  \tag{3.5.3.2}
\]

For each homomorphism $v:\psi^*(\sh{G})\to\sh{F}$ (where $\sh{F}$ is a sheaf on $X$ with
values in $\K$), we put $v^\flat=\psi_*(v)\circ\rho_\sh{G}:\sh{G}\to\psi_*(\sh{F})$. By
definition, \emph{each} morphism of presheaves $u:\sh{G}\to\psi_*(\sh{F})$ is of the form
$v^\flat$ for a unique $v$, which we will denote $u^\sharp$. In other words, each morphism
$u:\sh{G}\to\psi_*(\sh{F})$ of presheaves factorizes in a unique way as
\[
  u:\sh{G}\xrightarrow{\rho_\sh{G}}\psi_*(\psi^*(\sh{G}))
  \xrightarrow{\psi_*(u^\sharp)}\psi_*(\sh{F}).
  \tag{3.5.3.3}
\]
\end{env}

\begin{env}{3.5.4}
\label{env-0.3.5.4}
\oldpage{32}
Suppose now that the category $\K$ be such\footnote{In the book mentioned in the
introduction, we will give very general conditions on the category $\K$ ensuring the
existence of inverse images of presheaves with values in $\K$.} that \emph{each} presheaf
$\sh{F}$ on $Y$ with values in $\K$ admits an inverse image under $\psi$, and we denote it
by $\psi^*(\sh{G})$.

We will see that we can define $\psi^*(\sh{G})$ as a \emph{covariant functor} in $\sh{G}$,
from the category of presheaves on $Y$ with values in $\K$, to that of sheaves on $X$ with
values in $\K$, in such a way that the isomorphism $v\mapsto v^\flat$ is an \emph{isomorphism
of bifunctors}
\[
  \Hom_X(\psi^*(\sh{G}),\sh{F})\isoto\Hom_Y(\sh{G},\psi_*(\sh{F}))
  \tag{3.5.4.1}
\]
in $\sh{G}$ and $\sh{F}$.

Indeed, for each morphism $w:\sh{G}_1\to\sh{G}_2$ of presheaves on $Y$ with values in $\K$,
consider the composite morphism
$\sh{G}_1\xrightarrow{w}\sh{G}_2\xrightarrow{\rho_{\sh{G}_2}}\psi_*(\psi^*(\sh{G}_2))$; to it
corresponds a morphism $(\rho_{\sh{G}_2}\circ w)^\sharp:\psi^*(\sh{G}_1)\to\psi^*(\sh{G}_2)$,
that we denote by $\psi^*(w)$. We therefore have, according to (3.5.3.3),
\[
  \psi_*(\psi^*(w))\circ\rho_{\sh{G}_1}=\rho_{\sh{G}_2}\circ w.
  \tag{3.5.4.2}
\]
For each morphism $u:\sh{G}_2\to\psi_*(\sh{F})$, where $\sh{F}$ is a sheaf on $X$ with values
in $\K$, we have, according to (3.5.3.3), (3.5.4.2), and the definition of $u^\flat$
\[
  (u^\sharp\circ\psi^*(w))^\flat=\psi_*(u^\sharp)\circ\psi_*(\psi^*(w))\circ\rho_{\sh{G}_1}
  =\psi_*(u^\sharp)\circ\rho_{\sh{G}_2}\circ w=u\circ w
\]
where again
\[
  (u\circ w)^\sharp=u^\sharp\circ\psi^*(w).
  \tag{3.5.4.3}
\]

If we take in particular for $u$ a morphism
$\sh{G}_2\xrightarrow{w'}\sh{G}_3\xrightarrow{\rho_{\sh{G}_3}}\psi_*(\psi^*(\sh{G}_3))$, it
becomes
$\psi^*(w'\circ w)=(\rho_{\sh{G}_3}\circ w'\circ w)^\sharp
=(\rho_{\sh{G}_3}\circ w')^\sharp\circ\psi^*(w)=\psi^*(w')\circ\psi^*(w)$, hence our
assertion.

FInally, for each sheaf $\sh{F}$ on $X$ with values in $\K$, let $i_\sh{F}$ be the identity
morphism of $\psi_*(\sh{F})$ and denote by
\[
  \sigma_\sh{F}:\psi^*(\psi_*(\sh{F})\longrightarrow\sh{F}
\]
the morphism $(i_\sh{F})^\sharp$; the formula (3.5.4.3) gives in particular the factorization
\[
  u^\sharp:\psi^*(\sh{G})\xrightarrow{\psi^*(u)}\psi^*(\psi_*(\sh{F}))
  \xrightarrow{\sigma_\sh{F}}\sh{F}
  \tag{3.5.4.4}
\]
for each morphism $u:\sh{G}\to\psi_*(\sh{F})$. We say that the morphism $\sigma_\sh{F}$ is
\emph{canonical}.
\end{env}

\begin{env}{3.5.5}
\label{env-0.3.5.5}
Let $\psi':Y\to Z$ be a continuous map, and suppose that each presheaf $\sh{H}$ on $Z$ with
values in $\K$ admits an inverse image ${\psi'}^*(\sh{H})$ under $\psi'$. Then (with the
hypotheses of \sref{env}{3.5.4}) each presheaf $\sh{H}$ on $Z$ with values in $\K$ admits
an inverse image under $\psi''=\psi'\circ\psi$ and we have a canonical functorial isomorphism
\[
  {\psi''}^*(\sh{H})\isoto\psi^*({\psi'}^*(\sh{H})).
  \tag{3.5.5.1}
\]
\oldpage{33}
This indeed follows immediately from the definitions, taking into account that
$\psi_*''=\psi_*'\circ\psi_*$. In addition, if $u:\sh{G}\to\psi_*(\sh{F})$ is a
$\psi$-morphism, $v:\sh{H}\to\psi_*'(\sh{G})$ a $\psi'$-morphism, and $w=\psi_*'(u)\circ v$
their composition \sref{env}{3.5.2}, we have immediately that $w^\sharp$ is the composite
morphism
\[
  w^\sharp:\psi^*({\psi'}^*(\sh{H}))\xrightarrow{\psi^*(v^\sharp)}\psi^*(\sh{G})
  \xrightarrow{u^\sharp}\sh{F}.
\]
\end{env}

\begin{env}{3.5.6}
\label{env-0.3.5.6}
We take in particular for $\psi$ the identity map $1_X:X\to X$. Then if the inverse image
under $\psi$ of a presheaf $\sh{F}$ on $X$ with values in $\K$ exists, we say that this
inverse image is the \emph{sheaf associated to the presheaf $\sh{F}$}. Each morphism
$u:\sh{F}\to\sh{F}'$ from $\sh{F}$ to a \emph{sheaf} $\sh{F}'$ with values in $\K$ factorizes
in a unique way as
$\sh{F}\xrightarrow{\rho_\sh{F}}1_X^*(\sh{F})\xrightarrow{u^\sharp}\sh{F}'$.
\end{env}

\subsection{Simple sheaves and locally simple sheaves}
\label{0-prelim-3.6}

\begin{env}{3.6.1}
\label{env-0.3.6.1}
We say that a \emph{presheaf} $\sh{F}$ on $X$, with values in $\K$, is \emph{constant} if
the canonical morphisms $\sh{F}(X)\to\sh{F}(U)$ are \emph{isomorphisms} for each nonempty
open $U\subset X$; we note that $\sh{F}$ is not necessarily a sheaf. We say that a
\emph{sheaf} is \emph{simple} if it is the associated sheaf \sref{env}{3.5.6} of a constant
presheaf. We say that a sheaf $\sh{F}$ is \emph{locally simple} if each $x\in X$ admits an
open neighborhood $U$ such that $\sh{F}|U$ is simple.
\end{env}

\begin{env}{3.6.2}
\label{env-0.3.6.2}
Suppose that $X$ is \emph{irreducible} \sref{env}{2.1.1}; then the following properties are
equivalent:
\begin{enumerate}[label=(\alph*)]
  \item \emph{$\sh{F}$ is a constant presheaf on $X$};
  \item \emph{$\sh{F}$ is a simple sheaf on $X$};
  \item \emph{$\sh{F}$ is a locally simple sheaf on $X$}.
\end{enumerate}
\end{env}

Indeed, let $\sh{F}$ be a constant presheaf on $X$; if $U$, $V$ are two nonempty open sets in
$X$, $U\cap V$ is nonempty, so $\sh{F}(X)\to\sh{F}(U)\to\sh{F}(U\cap V)$ and
$\sh{F}(X)\to\sh{F}(U)$ are isomorphisms, and similarly both
$\sh{F}(U)\to\sh{F}(U\cap V)$ and $\sh{F}(V)\to\sh{F}(U\cap V)$ are isomorphisms. We
therefore conclude immediatelt that the axiom (F) of \sref{env}{3.1.2} is clearly satisfied,
$\sh{F}$ is isomorphic to its associated sheaf, and as a result (a) implies (b).

Now let $(U_\alpha)$ be an open cover of $X$ by nonempty open sets and let $\sh{F}$ be a
sheaf on $X$ such that $\sh{F}|U_\alpha$ is simple for each $\alpha$; as $U_\alpha$ is
irreducible, $\sh{F}|U_\alpha$ is a constant presheaf according to the above. As
$U_\alpha\cap U_\beta$ is not empty, $\sh{F}(U_\alpha)\to\sh{F}(U_\alpha\cap U_\beta)$ and
$\sh{F}(U_\beta)\to\sh{F}(U_\alpha\cap U_\beta)$ are isomorphisms, hence we have a canonical
isomorphism $\theta_{\alpha\beta}:\sh{F}(U_\alpha)\to\sh{F}(U_\beta)$ for each pair of
indices. But them if we apply the condition (F) for $U=X$, we see that for each index
$\alpha_0$, $\sh{F}(U_{\alpha_0})$ and the $\theta_{\alpha_0\alpha}$ are solutions to the
universal problem, which (according to the uniqueness) implies that
$\sh{F}(X)\to\sh{F}(U_{\alpha_0})$ is an isomorphism, and hence proves that (c) implies (a).

\subsection{Inverse images of presheaves of groups or rings}
\label{0-prelim-3.7}

\begin{env}{3.7.1}
\label{env-0.3.7.1}
\oldpage{34}
We will show that when we take $\K$ to be the category of sets, the inverse image under
$\psi$ for each presheaf $\sh{G}$ with values in $\K$ \emph{always exists} (the notations
and hypotheses on $X$, $Y$, $\psi$ being that of \sref{env}{3.5.3}). Indeed, for each open
$U\subset X$, define $\sh{G}'(U)$ as follows: an element $s'$ of $\sh{G}'(U)$ is a family
$(s_x')_{x\in U}$, where $s_x'\in\sh{G}_{\psi(x)}$ for each $x\in U$, and where, for each
$x\in U$, the following condition is satisfied: there exists an open neighborhood $V$ of
$\psi(x)$ in $Y$, a neighborhood $W\subset\psi^{-1}(V)\cap U$ of $x$, and an element
$s\in\sh{G}(V)$ such that $s_z'=s_{\psi(x)}$ for all $z\in W$. We verify immediately that
$U\mapsto\sh{G}'(U)$ clearly satisfies the axioms of a \emph{sheaf}.

Now let $\sh{F}$ be a sheaf of sets on $X$, and let $u:\sh{G}\to\psi_*(\sh{F})$,
$v:\sh{G}'\to\sh{F}$ be morphisms. We define $u^\sharp$ and $v^\flat$ in the following
manner: if $s'$ is a section of $\sh{G}'$ over a neighborhood $U$ of $x\in X$ and if $V$ is
an open neighborhood of $\psi(x)$ and $s\in\sh{G}(V)$ such that we have $s_z'=s_{\psi(x)}$
for $z$ in a neighborhood of $x$ contained in $\psi^{-1}(V)\cap U$, we take
$u_x^\sharp(s_x')=u_{\psi(x)}(s_{\psi(x)})$. Similarly, if $s\in\sh{G}(V)$ ($V$ open in $Y$),
$v^\flat(s)$ is the section of $\sh{F}$ over $\psi^{-1}(V)$, the image under $v$ of the
sectin $s'$ of $\sh{G}'$ such that $s_x'=s_{\psi(x)}$ for all $x\in\psi^{-1}(V)$. In
addition, the canonical homomorphism \sref{env}{3.5.3} $\rho:\sh{G}\to\psi_*(\psi^*(\sh{G}))$
is defined in the following manner: for each open $V\subset Y$ and each section
$s\in\Gamma(V,\sh{G})$, $\rho(s)$ is the section $(s_{\psi(x)})_{x\in\psi^{-1}(V)}$ of
$\psi^*(\sh{G})$ over $\psi^{-1}(V)$. The verification of the relations $(u^\sharp)^\flat=u$,
$(v^\flat)^\sharp=v$, and $v^\flat=\psi_*(v)\circ\rho$ is immediate, and proves our
assertion.

We check that, if $w:\sh{G}_1\to\sh{G}_2$ is a homomorphism of sheaves of sets on $Y$,
$\psi^*(w)$ is expressed in the following manner: if $s'=(s_x')_{x\in U}$ is a section of
$\psi^*(\sh{G}_1)$ over an open set $U$ of $X$, $(\psi^*(w))(s')$ is the family
$(w_{\psi(x)}(s_x'))_{x\in U}$. Finally, it is immediate that for each open set $V$ of $Y$,
the inverse image of $\sh{G}|V$ under the restriction of $\psi$ to $\psi^{-1}(V)$ is
identical to the induced sheaf $\psi^*(\sh{G})|\psi^{-1}(V)$.

When $\psi$ is the identity $1_X$, we recover the definition of a sheaf of sets associated
to a presheaf (G, II, 1.2). The above considerations apply without change when $\K$ is the
category of groups or of rings (not necessarily commutative).

When $X$ is any subset of a topological space $Y$, and $j$ the canonical injection $X\to Y$,
for each sheaf $\sh{G}$ on $Y$ with values in a category $\K$, we call the \emph{induced}
sheaf of $X$ by $\sh{G}$ the inverse image $j^*(\sh{G})$ (whenever it exists); for the
sheaves of sets (or of groups, or of rings) we recover the usual definition (G, II, 1.5).
\end{env}

\begin{env}{3.7.2}
\label{env-0.3.7.2}
Keeping the notations and hypotheses of \sref{env}{3.5.3}, suppose that $\sh{G}$ is a
\emph{sheaf} of groups (resp. of rings) on $Y$. The definition of sections of
$\psi^*(\sh{G})$ \sref{env}{3.7.1} shows (considering \sref{env}{3.4.4}) that the
homomorphism of stalks $\psi_x\circ\rho_{\psi(x)}:\sh{G}_{\psi(x)}\to(\psi^*(\sh{G}))_x$
is a \emph{functorial isomorphism in $\sh{G}$}, that identifies the two stalks; with this
identification, $u_x^\sharp$ is identical to the homomorphism defined in \sref{env}{3.5.1},
and in particular, we have $\Supp(\psi^*(\sh{G}))=\psi^{-1}(\Supp(\sh{G}))$.

An immediate consequence of this result is that \emph{the functor $\psi^*(\sh{G})$ is exact
in $\sh{G}$} in the abelian category of sheaves of abelian groups.
\end{env}

\subsection{Sheaves on pseudo-discrete spaces}
\label{0-prelim-3.8}

\begin{env}{3.8.1}
\label{env-0.3.8.1}
\oldpage{35}
Let $X$ be a topological space whose topology admits a basis $\mathfrak{B}$ consisting of
open \emph{quasicompact} subsets. Let $\sh{F}$ be a \emph{sheaf of sets} on $X$; if we equip
each of the $\sh{F}(U)$ with the \emph{discrete} topology, $U\mapsto\sh{F}(U)$ is a
\emph{presheaf of topological spaces}. We will see that there exists a \emph{sheaf of
topological spaces $\sh{F}'$ associated to $\sh{F}$} \sref{env}{3.5.6} such that
$\Gamma(U,\sh{F}')$ is the discrete space $\sh{F}(U)$ for each open \emph{quasicompact}
subsets $U$. It will suffice to show that the presheaf $U\mapsto\sh{F}(U)$ of discrete
topological spaces \emph{on} $\mathfrak{B}$ satisfy the condition (F$_0$) of
\sref{env}{3.2.2}, and more generally that if $U$ is an open quasicompact subset and if
$(U_\alpha)$ is a cover of $U$ by sets of $\mathfrak{B}$, then the least fine topology
$\mathscr{T}$ on $\Gamma(U,\sh{F})$ renders continuous the maps
$\Gamma(U,\sh{F})\to\Gamma(U_\alpha,\sh{F})$ is the \emph{discrete} topology. There exists
a finite number of indices $\alpha_i$ such that $U=\bigcup_i U_{\alpha_i}$.
Let $s\in\Gamma(U,\sh{F})$ and let $s_i$ be its image in $\Gamma(U_{\alpha_i},\sh{F})$;
the intersection of the inverse images of the sets $\{s_i\}$ is by definition a neighborhood
of $s$ for $\mathscr{T}$; but since $\sh{F}$ is a sheaf of sets and the $U_{\alpha_i}$ cover
$U$, this intersection is reduced to $s$, hence our assertion.

We note that if $U$ is an open non quasicompact subset of $X$, the topological space
$\Gamma(U,\sh{F}')$ still has $\Gamma(U,\sh{F})$ as the underlying set, but the topology is
not discrete in general: it is the least fine rendering commutative the maps
$\Gamma(U,\sh{F})\to\Gamma(V,\sh{F})$, for $V\in\mathfrak{B}$ and $V\subset U$ (the
$\Gamma(V,\sh{F})$ being discrete).

The above considerations apply without modification to sheaves of groups or of rings (not
necessarily commutative), and associate to them sheaves of \emph{topological
groups} or \emph{topological rings}, respectively. To summarize, we say that the sheaf
$\sh{F}'$ is the \emph{pseudo-discrete} sheaf of \emph{spaces} (resp. \emph{groups},
\emph{rings}) associated to a sheaf of sets (resp. groups, rings) $\sh{F}$.
\end{env}

\begin{env}{3.8.2}
\label{env-0.3.8.2}
Let $\sh{F}$, $\sh{G}$ be two sheaves of sets (resp. groups, rings) on $X$,
$u:\sh{F}\to\sh{G}$ a homomorphism. Then $u$ is thus a \emph{continuous} homomorphism
$\sh{F}'\to\sh{G}'$, if we denote by $\sh{F}'$ and $\sh{G}'$ the pseudo-discrete sheaves
associated to $\sh{F}$ and $\sh{G}$; this follows in effect from \sref{env}{3.2.5}.
\end{env}

\begin{env}{3.8.3}
\label{env-0.3.8.3}
Let $\sh{F}$ be a sheaf of sets, $\sh{H}$ a subsheaf of $\sh{F}$, $\sh{F}'$ and $\sh{H}'$ the
pseudo-discrete sheaves associated to $\sh{F}$ and $\sh{H}$ respectively. Then, for each open
$U\subset X$, $\Gamma(U,\sh{H}')$ is \emph{closed} in $\Gamma(U,\sh{F}')$: indeed, it is the
intersection of the inverse images of the $\Gamma(V,\sh{H})$ (for $V\in\mathfrak{B}$,
$V\subset U$) under the continuous maps $\Gamma(U,\sh{F})\to\Gamma(V,\sh{F})$, and
$\Gamma(V,\sh{H})$ is closed in the discrete space $\Gamma(V,\sh{F})$.
\end{env}

\section{Ringed spaces}
\label{0-prelim-4}

\subsection{Ringed spaces, sheaves of $\sh{A}$-modules, $\sh{A}$-algebras}
\label{0-prelim-4.1}

\begin{env}{4.1.1}
\label{env-0.4.1.1}
A \emph{ringed space} (resp. topologically ringed space) is a couple $(X,\sh{A})$
consisting of a topological space $X$ and a sheaf of rings (not necessarily commutative)
(resp. of a sheaf of topological rings) $\sh{A}$ on $X$; we say that $X$ is the
\emph{underlying} topological space of the ringed space $(X,\sh{A})$, and $\sh{A}$
the \emph{structure sheaf}. The latter is denoted $\OO_X$, and its stalk at a point
$x\in X$ is denotes $\OO_{X,x}$ or simply $\OO_x$ when there is no chance of confusion.

We denote by $1$ or $e$ the \emph{unit section} of $\OO_X$ over $X$ (the unit element
of $\Gamma(X,\OO_X)$).

As in this treatise we will have to consider in particular sheaves of \emph{commutative}
rings, it will be understood, when we speak of a ringed space $(X,\sh{A})$ without
specification, that $\sh{A}$ is a sheaf of commutative rings.

The ringed spaces with with not necessarily commutative structure sheaves
(resp. the topologically ringed spaces) form a \emph{category}, where we define
a \emph{morphism} $(X,\sh{A})\to(Y,\sh{B})$ as a couple $(\psi,\theta)=\Psi$
consisting of a continuous map $\psi:X\to Y$ and a \emph{$\psi$-morphism}
$\theta:\sh{G}\to\sh{F}$ (3.5.1) of sheaves of rings (resp. of sheaves of
topological rings); the \emph{composition} of a second morphism
$\Psi'=(\psi',\theta'):(Y,\sh{B})\to(Z,\sh{C})$ and of $\Psi$, denoted
$\Psi''=\Psi'\circ\Psi$, is the morphism $(\psi'',\theta'')$ where $\psi''=\psi'\circ\psi$,
and $\theta''$ is the composition of $\theta$ and $\theta'$ (equal to
$\psi_*'(\theta)\circ\theta'$, cf. \sref{env}{3.5.2}). For ringed spaces, remember that we
then have ${\theta''}^\sharp=\theta^\sharp\circ\psi^*({\theta'}^\sharp)$ \sref{env}{3.5.5};
therefore if ${\theta'}^\sharp$ and $\theta^\sharp$ are \emph{injective} (resp.
\emph{surjective}), the same is true of ${\theta''}^\sharp$, taking into account that
$\psi_x\circ\rho_{\psi(x)}$ is an isomorphism for all $x\in X$ \sref{env}{3.7.2}. We verify
immediately, thanks to the above, that when $\psi$ is an \emph{injective} continuous map and
$\theta^\sharp$ is a \emph{surjective} homomophism of sheaves of rings, the morphism
$(\psi,\theta)$ is a \emph{momomorphism} (T, 1.1) in the category of ringed spaces.

By abuse of language, we will often replace $\psi$ by $\Psi$ in notation, for
example in writing $\Psi^{-1}(U)$ in place of $\psi^{-1}(U)$ for a subset $U$ of $Y$,
when the is no risk of confusion.
\end{env}

\begin{env}{4.1.2}
\label{env-0.4.1.2}
For each subset $M$ of $X$, the pair $(M,\sh{A}|M)$ is evidently a ringed space, said
to be \emph{induced} on $M$ by the ringed space $(X,\sh{A})$ (and is still called
the \emph{restriction} of $(X,\sh{A})$ to $M$). If $j$ is the canonical injection
$M\to X$ and $\omega$ is the identity map of $\sh{A}|M$, $(j,\omega^\flat)$ is a
monomorphism $(M,\sh{A}|M)\to(X,\sh{A})$ of ringed spaces, called the
\emph{canonical injection}. The composition of a morphism
$\Psi:(X,\sh{A})\to(Y,\sh{B})$ and this injection is called the \emph{restriction}
of $\Psi$ to $M$.
\end{env}

\begin{env}{4.1.3}
\label{env-0.4.1.3}
We will not revisit the defintions of \emph{$\sh{A}$-modules} or
\emph{algebraic sheaves} on a ringed space $(X,\sh{A})$ (G, II, 2.2);
when $\sh{A}$ is a sheaf of not necessarily commutative rings, by $\sh{A}$-module
it will always mean ``left $\sh{A}$-module'' unless expressly stated otherwise. The
$\sh{A}$-submodules of $\sh{A}$ will be called \emph{sheaves of ideals} (left,
right, or two-sided) in $\sh{A}$ or \emph{$\sh{A}$-ideals}.

When $\sh{A}$ is a sheaf of commutative rings, and in the definition of
$\sh{A}$-modules, we replace everywhere the \emph{module} structure by that of
an \emph{algebra}, we obtain the definition of an \emph{$\sh{A}$-algebra} on $X$.
It is the same to say that an $\sh{A}$-algebra (not necessarily commutative) is
a $\sh{A}$-module $\sh{C}$, given with a homomorphism of $\sh{A}$-modules
$\vphi:\sh{C}\otimes_\sh{A}\sh{C}\to\sh{C}$ and a section $e$ over $X$,
such that: 1\textsuperscript{st} the diagram
\[
  \xymatrix{
    \sh{C}\otimes_\sh{A}\sh{C}\otimes_\sh{A}\sh{C}
    \ar[r]^{\vphi\otimes 1}\ar[d]_{1\otimes\vphi} &
    \sh{C}\otimes_\sh{A}\sh{C}\ar[d]^\vphi\\
    \sh{C}\otimes_\sh{A}\sh{C}\ar[r]^\vphi & \sh{C}
  }
\]
is commutative; 2\textsuperscript{nd} for each open $U\subset X$ and each section
$s\in\Gamma(U,\sh{C})$, we have $\vphi((e|U)\otimes s)=\vphi(s\otimes(e|U))=s$.
We say that $\sh{C}$ is a commutative $\sh{A}$-algebra if the diagram
\[
  \xymatrix{
    \sh{C}\otimes_\sh{A}\sh{C}\ar[rr]^\sigma\ar[rd]_\vphi
    & & \sh{C}\otimes_\sh{A}\sh{C}\ar[ld]^\vphi\\
    & \sh{C}
  }
\]
is commutative, $\sigma$ denoting the canonical symmetry (twist) map of the tensor product
$\sh{C}\otimes_\sh{A}\sh{C}$.

The homomorphisms of $\sh{A}$-algebras are also defined as the homomorphisms of
$\sh{A}$-modules in (G, II, 2.2), but naturally no longer form an abelian group.

If $\sh{M}$ is an $\sh{A}$-submodule of an $\sh{A}$-algebra $\sh{C}$, the
\emph{$\sh{A}$-subalgebra of $\sh{C}$ generated by $\sh{M}$} is the sum of the images of the
homomorphisms $\bigotimes^n\sh{M}\to\sh{C}$ (for each $n\geqslant 0$). This is also the sheaf
associated to the presheaf $U\mapsto\sh{B}(U)$ of algebras, $\sh{B}(U)$ being the subalgebra
of $\Gamma(U,\sh{C})$ generated by the submodule $\Gamma(U,\sh{M})$.
\end{env}

\begin{env}{4.1.4}
\label{env-0.4.1.4}
We say that a sheaf of rings $\sh{A}$ on a topological space $X$ is \emph{reduced at a point
$x$ in $X$} if the stalk $\sh{A}_x$ is a \emph{reduced} ring \sref{env}{1.1.1}; we say that
$\sh{A}$ is \emph{reduced} if it is reduced at all points of $X$. Recall that a ring $A$ is
called \emph{regular} if each of the local rings $A_\mathfrak{p}$ (where $\mathfrak{p}$ runs
through the set of prime ideals of $A$) is a regular local ring; we will say that a sheaf of
rings $\sh{A}$ on $X$ is \emph{regular at a point $x$} (resp. \emph{regular}) if the stalk
$\sh{A}_x$ is a regular ring (resp. if $\sh{A}$ is regular at each point). Finally, we will
say that a sheaf of rings $\sh{A}$ on $X$ is \emph{normal at a point $x$} (resp.
\emph{normal}) if the stalk $\sh{A}_x$ is an \emph{integral and integrally closed} ring
(resp. if $\sh{A}$ is normal at each point). We will say that a ringed space $(X,\sh{A})$ has
any of these preceeding properties if the sheaf of rings $\sh{A}$ has that property.

A \emph{graded} sheaf of rings $\sh{A}$ is by definition a sheaf of rings that is the direct
sum (G, II, 2,7) of a family $(\sh{A}_n)_{n\in\bb{Z}}$ of sheaves of abelian groups with the
conditions $\sh{A}_m\sh{A}_n\subset\sh{A}_{m+n}$; a \emph{graded $\sh{A}$-module} is an
$\sh{A}$-module $\sh{F}$ that is the direct sum of a family $(\sh{F}_n)_{n\in\bb{Z}}$ of
sheaves of abelian groups, satisfying the conditions $\sh{A}_m\sh{F}_n\subset\sh{F}_{m+n}$.
It is equivalent to say that $(\sh{A}_m)_x(\sh{A}_n)_x\subset(\sh{A}_{m+n})_x$ (resp.
$(\sh{A}_m)_x(\sh{F}_n)_x\subset(\sh{F}_{m+n})_x$) for each point $x$.
\end{env}

\begin{env}{4.1.5}
\label{env-0.4.1.5}
Given a ringed space $(X,\sh{A})$ (not necessarily commutative), we will not recall here the
definitions of the bifunctors $\sh{F}\otimes_\sh{A}\sh{G}$,
$\shHom_\sh{A}(\sh{F},\sh{F})$, and $\Hom_\sh{A}(\sh{F},\sh{G})$ (G, II, 2.8 and 2.2) in
the categories of left or right (depending on the case) $\sh{A}$-modules, with values in the
category of sheaves of abelian groups (or more generally of $\sh{C}$-modules, if $\sh{C}$ is
the center of $\sh{A}$). The stalk $(\sh{F}\otimes_\sh{A}\sh{G})_x$ for each point $x\in X$
identifies canonically with $\sh{F}_x\otimes_{\sh{A}_x}\sh{G}_x$ and we define a canonical
and functorial homomorphism
$(\shHom_\sh{A}(\sh{F},\sh{G}))_x\to\Hom_{\sh{A}_x}(\sh{F}_x,\sh{G}_x)$ which is in general
not injective or surjective. The bifunctors considered above are additive and in particular,
commute with finite direct limits; $\sh{F}\otimes_\sh{A}\sh{G}$ is right exact in $\sh{F}$
and in $\sh{G}$, commutes with inductive limits, and $\sh{A}\otimes_\sh{A}\sh{G}$ (resp.
$\sh{F}\otimes_\sh{A}\sh{A}$) identifies canonically with $\sh{G}$ (resp. $\sh{F}$). The
functors $\shHom_\sh{A}(\sh{F},\sh{G})$ and $\Hom_\sh{A}(\sh{F},\sh{G})$ are \emph{left
exact} in $\sh{F}$ and $\sh{G}$; more precisely, if we have an exact sequence of the form
$0\to\sh{G}'\to\sh{G}\to\sh{G}''$, the sequence
\[
  0\longrightarrow\shHom_\sh{A}(\sh{F},\sh{G}')\longrightarrow
  \shHom_\sh{A}(\sh{F},\sh{G})\longrightarrow\shHom_\sh{A}(\sh{F},\sh{G}'')
\]
is exact, and if we have an exact sequence of the form $\sh{F}'\to\sh{F}\to\sh{F}''\to 0$,
the sequence
\[
  0\longrightarrow\shHom_\sh{A}(\sh{F}'',\sh{G})\longrightarrow
  \shHom_\sh{A}(\sh{F},\sh{G})\longrightarrow\shHom_\sh{A}(\sh{F}',\sh{G})
\]
is exact, with the analagous properties for the functor $\Hom$. In addiiton,
$\shHom_\sh{A}(\sh{A},\sh{G})$ identifies canonically with $\sh{G}$; finally, for each open
$U\subset X$, we have
\[
  \Gamma(U,\shHom_\sh{A}(\sh{F},\sh{G})=\Hom_{\sh{A}|U}(\sh{F}|U,\sh{G}|U).
\]

For each left $\sh{A}$-module (resp. right), we define the \emph{dual} of $\sh{F}$ and
denote it by $\dual{\sh{F}}$ the right $\sh{A}$-module (resp. left)
$\shHom_\sh{A}(\sh{F},\sh{A})$.

Finally, if $\sh{A}$ is a sheaf of commutative rings, $\sh{F}$ an $\sh{A}$-module,
$U\mapsto\wedge^p\Gamma(U,\sh{F})$ is a presheaf whose associated sheaf is an $\sh{A}$-module
denoted $\wedge^p\sh{F}$ and is called the \emph{$p$-th exterior power of $\sh{F}$}; we
verify easily that the canonical map of the presheaf $U\mapsto\wedge^p\Gamma(U,\sh{F})$ to
the associated sheaf $\wedge^p\sh{F}$ is \emph{injective}, and for each $x\in X$,
$(\wedge^p\sh{F})_x=\wedge^p(\sh{F}_x)$. It is clear that $\wedge^p\sh{F}$ is a covariant
functor in $\sh{F}$.
\end{env}

\begin{env}{4.1.6}
\label{env-0.4.1.6}
Suppose that $\sh{A}$ is a sheaf of non necessarily commutative rings, $\sh{J}$ a left sheaf
of ideals of $\sh{A}$, $\sh{F}$ an left $\sh{A}$-module; we then denote by $\sh{J}\sh{F}$ the
$\sh{A}$-submodule of $\sh{F}$, the image of $\sh{J}\otimes_\bb{Z}\sh{F}$ (where $\bb{Z}$ is
the sheaf associated to the constant presheaf $U\mapsto\bb{Z}$) under the canonical map
$\sh{J}\otimes_\bb{Z}\sh{F}\to\sh{F}$; it is clear that for each $x\in X$, we have
$(\sh{J}\sh{F})_x=\sh{J}_x\sh{F}_x$. When $\sh{A}$ is commutative, $\sh{J}\sh{F}$ is also
the canonical image of $\sh{J}\otimes_\sh{A}\sh{F}\to\sh{F}$. It is immediate that
$\sh{J}\sh{F}$ is also the $\sh{A}$-module associated to the presheaf
$U\mapsto\Gamma(U,\sh{J})\Gamma(U,\sh{F})$. If $\sh{J}_1$, $\sh{J}_2$ are two left sheaves
of ideals of $\sh{A}$, we have $\sh{J}_1(\sh{J}_2\sh{F})=(\sh{J}_1\sh{J}_2)\sh{F}$.
\end{env}

\begin{env}{4.1.7}
\label{env-0.4.1.7}
Let $(X_\lambda,\sh{A}_\lambda)_{\lambda\in L}$ be a family of ringed spaces; for each couple
$(\lambda,\mu)$, suppose we are given an open subset $V_{\lambda\mu}$ of $X_\lambda$, and an
isomorphism of ringed spaces
$\vphi_{\lambda\mu}:(V_{\mu\lambda},\sh{A}_\mu|V_{\lambda\mu})\isoto
(V_{\lambda\mu},\sh{A}_\lambda|V_{\lambda\mu})$, with $V_{\lambda\lambda}=X_\lambda$,
$\vphi_{\lambda\lambda}$ being the identity. Furthermore, suppose that, for each triple
$(\lambda,\mu,\nu)$, if we denote by $\vphi_{\mu\lambda}'$ the restriction of
$\vphi_{\mu\lambda}$ to $V_{\lambda\mu}\cap V_{\lambda\nu}$, $\vphi_{\mu\lambda}'$ is an
isomorphism from
$(V_{\lambda\mu}\cap V_{\lambda\nu},\sh{A}_\lambda|(V_{\lambda\mu}\cap V_{\lambda\nu}))$ to
$(V_{\mu\nu}\cap V_{\mu\lambda},\sh{A}_\mu|(V_{\mu\nu}\cap V_{\mu\lambda}))$ and that we have
$\vphi_{\lambda\nu}'=\vphi_{\lambda\mu}'\circ\vphi_{\mu\nu}'$ (\emph{gluing condition} for
the $\vphi_{\lambda\mu}$). We can first consider the topological space obtained by gluing
(by means of the $\vphi_{\lambda\mu}$) of the $X_\lambda$
\oldpage{39}
along the $V_{\lambda\mu}$; if we identify $X_\lambda$ with the corresponding open subset
$X_\lambda'$ in $X$, the hypotheses imply that the three sets
$V_{\lambda\mu}\cap V_{\lambda\nu}$, $V_{\mu\nu}\cap V_{\mu\lambda}$,
$V_{\nu\lambda}\cap V_{\nu\mu}$ identify with $X_\lambda'\cap X_\mu'\cap X_\nu'$. We can
also transport to $X_\lambda'$ the ringed space structure of $X_\lambda$, and if
$\sh{A}_\lambda'$ are the transported sheaves of rings corresponding to the $\sh{A}_\lambda$,
the $\sh{A}_\lambda'$ verify the gluing condition \sref{env}{3.3.1} and therefore define a
sheaf of rings $\sh{A}$ on $X$; we say tat $(X,\sh{A})$ is the ringed space obtained by
\emph{gluing the $(X_\lambda,\sh{A}_\lambda)$ along the $V_{\lambda\mu}$}, by means of the
$\vphi_{\lambda\mu}$.
\end{env}

\subsection{Direct image of an $\sh{A}$-module}
\label{0-prelim-4.2}

\begin{env}{4.2.1}
\label{env-0.4.2.1}
Let $(X,\sh{A})$, $(Y,\sh{B})$ be two ringed spaces, $\Psi=(\psi,\theta)$ a morphism
$(X,\sh{A})\to(Y,\sh{B})$; $\psi_*(\sh{A})$ is then a sheaf of rings on $Y$, and $\theta$ a
homomorphism $\sh{B}\to\psi_*(\sh{A})$ of sheaves of rings. Then let $\sh{F}$ be an
$\sh{A}$-module; the direct image $\psi_*(\sh{F})$ is a sheaf of abelian groups on $Y$. In
addition, for each open $U\subset Y$,
\[
  \Gamma(U,\psi_*(\sh{F}))=\Gamma(\psi^{-1}(U),\sh{F})
\]
is equipped with the structure of a module over the ring
$\Gamma(U,\psi_*(\sh{A}))=\Gamma(\psi^{-1}(U),\sh{A})$; the bilinear maps which define these
structures are compatible with the restriction operations, defining on $\psi_*(\sh{F})$ the
structure of a $\psi_*(\sh{A})$-module. The homomorphism $\theta:\sh{B}\to\psi_*(\sh{A})$
then defines also on $\psi_*(\sh{F})$ a \emph{$\sh{B}$-module} structure; we say that this
$\sh{B}$-module is the \emph{direct image of $\sh{F}$ under the morphism $\Psi$}, and we
denote it $\Psi_*(\sh{F})$. If $\sh{F}_1$, $\sh{F}_2$ are two $\sh{A}$-modules over $X$ and
$u$ an $\sh{A}$-homomorphism $\sh{F}_1\to\sh{F}_2$, it is immediate (by considering the
sections over the open subsets of $Y$) that $\psi_*(u)$ is a $\psi_*(\sh{A})$-homomorphism
$\psi_*(\sh{F}_1)\to\psi_*(\sh{F}_2)$, and \emph{a fortiori} a $\sh{B}$-homomorphism
$\Psi_*(\sh{F}_1)\to\Psi_*(\sh{F}_2)$; as a $\sh{B}$-homomorphism, we denote it by
$\Psi_*(u)$. So we see that $\Psi_*$ is a \emph{covariant functor} from the category of
$\sh{A}$-modules to that of $\sh{B}$-modules. In addition, it is immediate that this functor
is \emph{left exact} (G, II, 2.12).

On $\psi_*(\sh{A})$, the structure of a $\sh{B}$-module and the structure of a sheaf of rings
define a $\sh{B}$-algebra structure; we denote by $\Psi_*(\sh{A})$ this $\sh{B}$-algebra.
\end{env}

\begin{env}{4.2.2}
\label{env-0.4.2.2}
Let $\sh{M}$, $\sh{N}$ be two $\sh{A}$-modules. For each open set $U$ of $Y$, we have a
canonical map
\[
  \Gamma(\psi^{-1}(U),\sh{M})\times\Gamma(\psi^{-1}(U),\sh{N})
  \longrightarrow\Gamma(\psi^{-1}(U),\sh{M}\otimes_\sh{A}\sh{N})
\]
which is bilinear over the ring $\Gamma(\psi^{-1}(U),\sh{A})=\Gamma(U,\psi_*(\sh{A}))$, and
\emph{a fortiori} over $\Gamma(U,\sh{B})$; it therefore defines a homomorphism
\[
  \Gamma(U,\Psi_*(\sh{M}))\otimes_{\Gamma(U,\sh{B})}\Gamma(U,\Psi_*(\sh{N}))
  \longrightarrow\Gamma(U,\Psi_*(\sh{M}\otimes_\sh{A}\sh{N}))
\]
and as we check immediately that these homomorphisms are compatible with the restriction
operations, they give a canonical functorial homomorphism of $\sh{B}$-modules
\[
  \Psi_*(\sh{M})\otimes_\sh{B}\Psi_*(\sh{N})
  \longrightarrow\Psi_*(\sh{M}\otimes_\sh{A}\sh{N})
  \tag{4.2.2.1}
\]
\oldpage{40}
which is in general neither injective or surjective. If $\sh{P}$ is a third $\sh{A}$-module,
we check immediately that the diagram
\[
  \xymatrix{
    \Psi_*(\sh{M})\otimes_\sh{B}\Psi_*(\sh{N})\otimes_\sh{B}\Psi_*(\sh{P})\ar[r]\ar[d]
    & \Psi_*(\sh{M}\otimes_\sh{A}\sh{N})\otimes_\sh{B}\Psi_*(\sh{P})\ar[d]\\
    \Psi_*(\sh{M})\otimes_\sh{B}\Psi_*(\sh{N}\otimes_\sh{A}\sh{P})\ar[r]
    & \Psi_*(\sh{M}\otimes_\sh{A}\sh{N}\otimes_\sh{A}\sh{P})
  }
  \tag{4.2.2.2}
\]
is commutative.
\end{env}

\begin{env}{4.2.3}
\label{env-0.4.2.3}
Let $\sh{M}$, $\sh{N}$ be two $\sh{A}$-modules. For each open $U\subset Y$, we have by
definition that
$\Gamma(\psi^{-1}(U),\shHom_\sh{A}(\sh{M},\sh{N}))=\Hom_{\sh{A}|V}(\sh{M}|V,\sh{N}|V)$, where
we put $V=\psi^{-1}(U)$; the map $u\mapsto\Psi_*(u)$ is a homomorphism
\[
  \Hom_{\sh{A}|V}(\sh{M}|V,\sh{N}|V)
  \longrightarrow\Hom_{\sh{B}|U}(\Psi_*(\sh{M})|U,\Psi_*(\sh{N})|U)
\]
on the $\Gamma(U,\sh{B})$-module structures; these homomorphisms are compatible with the
restriction operations, hence they define a canonical functorial homomorphism of
$\sh{B}$-modules
\[
  \Psi_*(\shHom_\sh{A}(\sh{M},\sh{N}))
  \longrightarrow\shHom_\sh{B}(\Psi_*(\sh{M}),\Psi_*(\sh{N})).
  \tag{4.2.3.1}
\]
\end{env}

\begin{env}{4.2.4}
\label{env-0.4.2.4}
If $\sh{C}$ is an $\sh{A}$-algebra, the composite homomorphism
\[
  \Psi_*(\sh{C})\otimes_\sh{B}\Psi_*(\sh{C})
  \longrightarrow\Psi_*(\sh{C}\otimes_\sh{A}\sh{C})
  \longrightarrow\Psi_*(\sh{C})
\]
defines on $\Psi_*(\sh{C})$ the structure of a \emph{$\sh{B}$-algebra}, as a result of
(4.2.2.2). We see similarly that if $\sh{M}$ is a $\sh{C}$-module, $\Psi_*(\sh{M})$ is
canonically equipped with the structure of a $\Psi_*(\sh{C})$-module.
\end{env}

\begin{env}{4.2.5}
\label{env-0.4.2.5}
Consider in particular the case where $X$ is a \emph{closed} subspace of $Y$ and where $\psi$
is the canonical injection $j:X\to Y$. If $\sh{B}'=\sh{B}|X=j^*(\sh{B})$ is the restriction
of the sheaf of rings $\sh{B}$ to $X$, an $\sh{A}$-module $\sh{M}$ can be considered as a
$\sh{B}'$-module by means of the homomorphism $\theta^\sharp:\sh{B}'\to\sh{A}$; then
$\Psi_*(\sh{M})$ is the $\sh{B}$-module which induces $\sh{M}$ on $X$ and $0$ elsewhere. If
$\sh{N}$ is a second $\sh{A}$-module, $\Psi_*(\sh{M})\otimes_\sh{B}\Psi_*(\sh{N})$
canonically identifies with $\Psi_*(\sh{M}\otimes_{\sh{B}'}\sh{N})$ and
$\shHom_\sh{B}(\Psi_*(\sh{M}),\Psi_*(\sh{N}))$ with
$\Psi_*(\shHom_{\sh{B}'}(\sh{M},\sh{N}))$.
\end{env}

\begin{env}{4.2.6}
\label{env-0.4.2.6}
Let $(Z,\sh{C})$ be a third ringed space, $\Psi'=(\psi',\theta')$ a morphism
$(Y,\sh{B})\to(Z,\sh{C})$; if $\Psi''$ is the composite morphism $\Psi'\circ\Psi$, it is
clear that we have $\Psi_*''=\Psi_*'\circ\Psi_*$.
\end{env}

\subsection{Inverse image of an $\sh{A}$-module}
\label{0-prelim-4.3}

\begin{env}{4.3.1}
\label{env-0.4.3.1}
The hypotheses and notation being the same as \sref{env}{4.2.1}, let $\sh{G}$ be a
$\sh{B}$-module and $\psi^*(\sh{G})$ the inverse image \sref{env}{3.7.1} which is therefore
a sheaf of abelian groups on $X$. The deinition of sections of $\psi^*(\sh{G})$ and of
$\psi^*(\sh{B})$ \sref{env}{3.7.1} shows that $\psi^*(\sh{G})$ is canonically equipped with
a $\psi^*(\sh{B})$-module structure. On the other hand, the homomorphism
$\theta^\sharp:\psi^*(\sh{B})\to\sh{A}$ endows $\sh{A}$ with the a $\psi^*(\sh{B})$-module
structure, which we denote by $\sh{A}_{[\theta]}$ when necessary to avoid confusion; the
tensor product $\psi^*(\sh{G})\otimes_{\psi^*(\sh{B})}\sh{A}_{[\theta]}$ is then equipped
with an $\sh{A}$-module structure. We say that this $\sh{A}$-module is \emph{the inverse
image of $\sh{G}$ under the morphism $\Psi$}
\oldpage{41}
and we denote it by $\Psi^*(\sh{G})$. If $\sh{G}_1$, $\sh{G}_2$ are two $\sh{B}$-modules over
$Y$, $v$ a $\sh{B}$-homomorphism $\sh{G}_1\to\sh{G}_2$, $\psi^*(v)$, as we check immediately,
is a $\psi^*(\sh{B})$-homomorphism from $\psi^*(\sh{G}_1)$ to $\psi^*(\sh{G}_2)$; as a result
$\psi^*(v)\otimes 1$ is an $\sh{A}$-homomorphism $\Psi^*(\sh{G}_1)\to\Psi^*(\sh{G}_2)$, which
we denote by $\Psi^*(v)$. So we define $\Psi^*$ as a \emph{covariant functor} from the
category of $\sh{B}$-modules to that of $\sh{A}$-modules. Here, this functor (contrary to
$\psi^*$) is no longer exact in general, but only \emph{right exact}, the tensorization by
$\sh{A}$ being a right exact functor to the category of $\psi^*(\sh{B})$-modules.

For each $x\in X$, we have
$(\Psi^*(\sh{G}))_x=\sh{G}_{\psi(x)}\otimes_{\sh{B}_{\psi(x)}}\sh{A}_x$, according to
\sref{env}{3.7.2}. The support of $\Psi^*(\sh{G})$ is thus contained in
$\psi^{-1}(\Supp\sh{G})$.
\end{env}

\subsection{Relation between direct and inverse images}
\label{0-prelim-4.4}

\section{Quasi-coherent and coherent sheaves}
\label{0-prelim-5}

\subsection{Quasicoherent sheaves}
\label{0-prelim-5.1}

\subsection{Sheaves of finite type}
\label{0-prelim-5.2}

\subsection{Coherent sheaves}
\label{0-prelim-5.3}

\subsection{Locally free sheaves}
\label{0-prelim-5.4}

\subsection{Sheaves on a locally ringed space}
\label{0-prelim-5.5}

\section{Flatness}
\label{0-prelim-6}

\subsection{Flat modules}
\label{0-prelim-6.1}

\subsection{Change of ring}
\label{0-prelim-6.2}

\subsection{Local nature of flatness}
\label{0-prelim-6.3}

\subsection{Faithfully flat modules}
\label{0-prelim-6.4}

\subsection{Restriction of scalars}
\label{0-prelim-6.5}

\subsection{Faithfully flat rings}
\label{0-prelim-6.6}

\subsection{Flat morphisms of ringed spaces}
\label{0-prelim-6.7}

\section{Adic rings}
\label{0-prelim-7}

\subsection{Admissible rings}
\label{0-prelim-7.1}

\subsection{Adic rings and projective limits}
\label{0-prelim-7.2}

\subsection{Pre-adic Noetherian rings}
\label{0-prelim-7.3}

\subsection{Quasifinite modules over local rings}
\label{0-prelim-7.4}

\subsection{Rings of restricted formal series}
\label{0-prelim-7.5}

\subsection{Completed rings of fractions}
\label{0-prelim-7.6}

\subsection{Completed tensor products}
\label{0-prelim-7.7}

\subsection{Topologies on modules of homomorphisms}
\label{0-prelim-7.8}

\clearpage

\chapter{The language of schemes}
    
\section*{Summary}
\label{1-schemes.summary}

\begin{tabular}{ll}
  \textsection1. & Affine schemes.\\
  \textsection2. & Preschemes and morphisms of preschemes.\\
  \textsection3. & Products of preschemes.\\
  \textsection4. & Subpreschemes and immersion morphisms.\\
  \textsection5. & Reduced preschemes; separation condition.\\
  \textsection6. & Finiteness conditions.\\
  \textsection7. & Rational maps.\\
  \textsection8. & Chevalley schemes.\\
  \textsection9. & Supplement on quasicoherent sheaves.\\
  \textsection10. & Formal schemes.
\end{tabular}\\

\oldpage{79}
The \textsection\textsection1--8 do little more than develop a language, which will be used
in the following. It should be noted, however, that in accordance with the general spirit of
this treatise, \textsection\textsection7--8 will be used less than the others, and in a less
essential way; we have moreover spoken of Chevalley's schemes only to make the link with the
language of Chevalley \cite{1} and Nagata \cite{9}. The \textsection9 gives definitions and
results on quasicoherent sheaves, some of which are no longer limited to a translation into a
``geometric'' language of known notions of commutative algebra, but are already of a global
nature; they will be indispensable, in the following chapters, for the global study of
morphisms. Finally, \textsection10 introduces a generalization of the notion of schemes,
which will be used as an intermediary in Chapter~III to formulate and prove in a
convenient way the fundamental results of the cohomological study of the proper morphisms;
moreover, it should be noted that the notion of formal schemes seems indispensable to express
certain facts of the ``theory of modules'' (classification problems of algebraic varieties).
The results of \textsection10 will not be used before \textsection3 of Chapter~III and it is
recommended to omit reading until then.
\bigskip

\setcounter{section}{0}
\section{Affine schemes}
\label{1-schemes-1}

\setcounter{subsection}{0}
\subsection{The prime spectrum of a ring}
\label{1-schemes-1.1}

\begin{env}{1.1.1}
\label{env-1.1.1.1}
\oldpage{80}
\emph{Notation}. Let $A$ be a (commutative) ring, $M$ an $A$-module. In
this chapter and the following, we will constantly use the following notations:
\begin{enumerate}[label=--]
  \item $\Spec(A)=$ \emph{set of prime ideals} of $A$, also called the
        \emph{prime spectrum} of $A$; for an $x\in X=\Spec(A)$, it will often be
        convenient to write $\mathfrak{j}_x$ instead of $x$. When $\Spec(A)$ is
        \emph{empty}, it is necessary and sufficient that the ring $A$ is
        reduced to $0$.
  \item $A_x=A_{\mathfrak{j}_x}=$ \emph{(local) ring of fractions $S^{-1}A$},
        where $S=A-\mathfrak{j}_x$.
  \item $\mathfrak{m}_x=\mathfrak{j}_x A_{\mathfrak{j}_x}=$ \emph{maximal ideal of $A$}.
  \item $\k(x)=A_x/\mathfrak{m}_x=$ \emph{residue field of $A_x$},
        canonically isomorphic to the field of fractions
        of the integral ring $A/\mathfrak{j}_x$, to which it is identified.
  \item $f(x)=$ \emph{class of $f$} mod. $\mathfrak{j}_x$ in $A/\mathfrak{j}_x\subset\k(x)$,
        for $f\in A$ and $x\in X$. We still say that $f(x)$ is the \emph{value}
        of $f$ at a point $x\in\Spec(A)$; the relations $f(x)=0$ and $f\in\mathfrak{j}_x$
        are \emph{equivalent}.
  \item $M_x=M\otimes_A A_x=$ \emph{module of denominators of fractions in
        $A-\mathfrak{j}_x$}.
  \item $\rad(E)=$ \emph{radical of the ideal of $A$ generated by a subset $E$ of $A$}.
  \item $V(E)=$ \emph{set of $x\in X$ such that $E\subset\mathfrak{j}_x$} (or the set of
        $x\in X$ such that $f(x)=0$ for all $f\in E$), for $E\subset A$. So we have
        \[
          \rad(E)=\bigcap_{x\in V(E)}\mathfrak{j}_x.
          \tag{1.1.1.1}
        \]
  \item $V(f)=V(\{f\})$ for $f\in A$.
  \item $D(f)=X-V(f)=$ \emph{set of $x\in X$ where $f(x)\neq 0$}.
\end{enumerate}
\end{env}

\begin{envs}[Proposition]{1.1.2}
\label{env-1.1.1.2}
We have the following properties:
\begin{enumerate}[label=\rm{(\roman*)}]
  \item $V(0)=X$, $V(1)=\emp$.
  \item The relation $E\subset E'$ implies $V(E)\supset V(E')$.
  \item For each family $(E_\lambda)$ of subsets of $A$,
        $V(\bigcup_\lambda E_\lambda)=V(\sum_\lambda E_\lambda)
          =\bigcap_\lambda V(E_\lambda)$.
  \item $V(EE')=V(E)\cup V(E')$.
  \item $V(E)=V(\mathfrak{r}(E))$.
\end{enumerate}
\end{envs}
The properties (i), (ii), (iii) are trivial, and (v) follows from (ii) and from the
formula (1.1.1.1). It is evident that $V(EE')\supset V(E)\cap V(E')$; conversely, if
$x\not\in V(E)$ and $x\not\in V(E')$, there exists $f\in E$ and $f'\in E'$ such that
$f(x)\neq 0$ and $f'(x)\neq 0$ in $\k(x)$, hence $f(x)f'(x)\neq 0$, i.e., $x\not\in V(EE')$,
which proves (iv).

The proposition \sref{env}{1.1.2} shows, among other things, that sets of the form $V(E)$
(where $E$ runs through all the subsets of $A$) are the \emph{closed sets} of a topology on
$X$, which we will call the \emph{spectral topology}\footnote{The introduction of this
topology in algebraic geometry is due to Zariski. So this topology is usually called
the ``Zariski topology'' of $X$.}; unless expressely stated otherwise, always assume
$X=\Spec(A)$ with the spectral topology.

\begin{env}{1.1.3}
\label{env-1.1.1.3}
\oldpage{81}
For each subset $Y$ of $X$, we denote by $\mathfrak{j}(Y)$ the set of $f\in A$ such that
$f(y)=0$ for all $y\in Y$; equivalently, $\mathfrak{j}(Y)$ is the intersection of the prime
ideals $\mathfrak{j}_y$ for $y\in Y$. It is clear that the relation $Y\subset Y'$ implies
that $\mathfrak{j}(Y)\supset\mathfrak{j}(Y')$ and that we have
\[
  \mathfrak{j}\bigg(\bigcup_\lambda Y_\lambda\bigg)=\bigcap_\lambda\mathfrak{j}(Y_\lambda)
  \tag{1.1.3.1}
\]
for each family $(Y_\lambda)$ of subsets of $X$. Finally we have
\[
  \mathfrak{j}(\{x\})=\mathfrak{j}_x.
  \tag{1.1.3.2}
\]
\end{env}

\begin{envs}[Proposition]{1.1.4}
\label{prop-1.1.1.4}
\begin{enumerate}[label=\rm{(\roman*)}]
  \item For each subset $E$ of $A$, we have $\mathfrak{j}(V(E))=\rad(E)$.
  \item For each subset $Y$ of $X$, $V(\mathfrak{j}(Y))=\overline{Y}$, the closure of $Y$ in $X$.
\end{enumerate}
\end{envs}
(i) is an immeidate consequence of the definitions and (1.1.1.1); on the other hand, $V(\mathfrak{j}(Y))$
is closed and contains $Y$; conversely, if $Y\subset V(E)$, we have $f(y)=0$ for $f\in E$ and all $y\in Y$,
so $E\subset\mathfrak{j}(Y)$, $V(E)\supset V(\mathfrak{j}(Y))$, which proves (ii).

\begin{envs}[Corollary]{1.1.5}
\label{cor-1.1.1.5}
The closed subsets of $X=\Spec(A)$ and the ideals of $A$ equal to their radicals (otherwise the
intersection of prime ideals) correspond bijectively by the \unsure{descent} maps $Y\mapsto\mathfrak{j}(Y)$,
$\mathfrak{a}\mapsto V(\mathfrak{a})$; the union $Y_1\cup Y_2$ of two closed subsets corresponds to
$\mathfrak{j}(Y_1)\cap\mathfrak{j}(Y_2)$, and the intersection of any family $(Y_\lambda)$ of closed subsets
corresponds to the radical of the sum of the $\mathfrak{j}(Y_\lambda)$.
\end{envs}

\begin{envs}[Corollary]{1.1.6}
\label{cor-1.1.1.6}
If $A$ is a Noetherian ring, $X=\Spec(A)$ is a Noetherian space.
\end{envs}
Note that the converse of this corollary is false, as shown
in the example of a non-Noetherian integral ring with a single prime ideal $\neq\{0\}$, for
example a non-discrete valuation ring of rank $1$.

As an example of ring $A$ whose spectrum is not a Noetherian space, one
can consider the ring $\sh{C}(Y)$ of continuous real functions on an infinite compact space
$Y$; we know that as a whole, $Y$ corresponds with the set of maximal ideals
of $A$, and it is easy to see that the topology induced on $Y$ by that of $X=\Spec(A)$
is the initial topology of $Y$. Since $Y$ is not a Noetherian space, the same is true for $X$.

\begin{envs}[Corollary]{1.1.7}
\label{cor-1.1.1.7}
For each $x\in X$, the closure of $\{x\}$ is the set of $y\in X$ such that $\mathfrak{j}_x\subset\mathfrak{j}_y$.
For $\{x\}$ to beclosed, it is necessary and sufficient that $\mathfrak{j}_x$ is maximal.
\end{envs}

\begin{envs}[Corollary]{1.1.8}
\label{cor-1.1.1.8}
The space $X=\Spec(A)$ is a Kolmogoroff space.
\end{envs}

If $x$, $y$ are two distinct points of $X$, we have either $\mathfrak{j}_x\not\subset\mathfrak{j}_y$ or
$\mathfrak{j}_y\not\subset\mathfrak{j}_x$, so one of the points $x$, $y$ does not belong to the closure of the other.

\begin{env}{1.1.9}
\label{env-1.1.1.9}
According to proposition (\sref{env}{1.1.2}, (iv)), for two elements $f$, $g$ of $A$, we have
\[
  D(fg)=D(f)\cap D(g).
  \tag{1.1.9.1}
\]
Note also that the relation $D(f)=D(g)$ means, according to proposition (\sref{prop}{1.1.4}, (i))
and proposition (\sref{env}{1.1.2}, (v)) that $\rad(f)=\rad(g)$, or that the minimal prime
ideals containing $(f)$ and $(g)$ are the same; in particular, when $f=ug$, where $u$ is
invertible.
\end{env}

\begin{envs}[Proposition]{1.1.10}
\label{prop-1.1.1.10}
\oldpage{82}
\begin{enumerate}[label=\rm{(\roman*)}]
  \item When $f$ ranges over $A$, the sets $D(f)$ forms a basis for the topology of $X$.
  \item For each $f\in A$, $D(f)$ is quasicompact. In particular $X=D(1)$ is quasicompact.
\end{enumerate}
\end{envs}

(i) Let $U$ be an open set in $X$; by definition, we have $U=X-V(E)$ where $E$ is a subset of $A$, and
$V(E)=\bigcap_{f\in E}V(f)$, hence $U=\bigcup_{f\in E}D(f)$.

(ii) According to (i), it is sufficient to prove that if $(f_\lambda)_{\lambda\in L}$ is a family of elements
of $A$ such that $D(f)\subset\bigcup_{\lambda\in L}D(f_\lambda)$, there exists a finite subset $J$ of $L$ such that
$D(f)\subset\bigcup_{\lambda\in J}D(f_\lambda)$. Let $\mathfrak{a}$ be the ideal of $A$ generated by the $f_\lambda$;
we have by hypothesis that $V(f)\supset V(\mathfrak{a})$, so $\rad(f)\subset\rad(\mathfrak{a})$; as
$f\in\rad(f)$, there exists an integer $n\geqslant 0$ such that $f^n\in\mathfrak{a}$. But then $f^n$ belongs to
the ideal $\mathfrak{b}$ generated by the finite subfamily $(f_\lambda)_{\lambda\in J}$, and we have
$V(f)=V(f^n)\supset V(\mathfrak{b})=\bigcap_{\lambda\in J}V(f_\lambda)$, that is to say,
$D(f)\supset\bigcup_{\lambda\in J}D(f_\lambda)$.

\begin{envs}[Proposition]{1.1.11}
\label{prop-1.1.1.11}
For each ideal $\mathfrak{a}$ of $A$, $\Spec(A/\mathfrak{a})$ identifies canonically with the closed subspace
$V(\mathfrak{a})$ of $\Spec(A)$.
\end{envs}

In effect, we know there is a canonical bijective correspondence, respecting the inclusion order structure,
between ideals (resp. prime ideals) of $A/\mathfrak{a}$ and ideals (resp. prime ideals) of $A$ containing
$\mathfrak{a}$.

Recall that the set $\nilrad$ of nilpotent elements of $A$ (the \emph{nilradical} of $A$) is an ideal equal to
$\rad(0)$, the intersection of all the prime ideals of $A$ \pref{env}{1.1.1}.

\begin{envs}[Corollary]{1.1.12}
\label{cor-1.1.1.12}
The topological spaces $\Spec(A)$ and $\Spec(A/\nilrad)$ are canonically homeomorphic.
\end{envs}

\begin{envs}[Proposition]{1.1.13}
\label{prop-1.1.1.13}
For $X=\Spec(A)$ to be irreducible \pref{env}{2.1.1}, it is necessary and sufficient that the
ring $A/\nilrad$ is integral (or, equivalently, that the ideal $\nilrad$ is prime).
\end{envs}

By virtue of corollary \sref{cor}{1.1.12}, we can restrict to the case $\nilrad=0$. If $X$ is
reducible, there exist two distinct closed subsets $Y_1$, $Y_2$ of $X$ such that
$X=Y_1\cup Y_2$, so $\mathfrak{j}(X)=\mathfrak{j}(Y_1)\cap\mathfrak{j}(Y_2)=0$, the ideals
$\mathfrak{j}(Y_1)$ and $\mathfrak{j}(Y_2)$ being distinct from $(0)$ \sref{cor}{1.1.5}; so
$A$ is not an integral. Conversely, if in $A$ there are elements $f\neq 0$, $g\neq 0$ such
that $fg=0$, we have $V(f)\neq X$, $V(g)\neq X$ (since the intersection of the prime ideals
of $A$ is $(0)$), and $X=V(fg)=V(f)\cup V(g)$.

\begin{envs}[Corollary]{1.1.14}
\label{cor-1.1.1.14}
\begin{enumerate}[label=\rm{(\roman*)}]
  \item In the bijective correspondence between closed subsets of $X=\Spec(A)$
        and ideals of $A$ equal to their roots, the irreducible closed subsets
        of $X$ correspond to the prime ideals of $A$. In particular, the irreducible
        components of $X$ correspond to the minimal prime ideals of $A$.
  \item The map $x\mapsto\overline{\{x\}}$ establishes a bijective correspondence
        between $X$ and the set of closed irreducible subsets of $X$
        (\emph{said otherwise,} all closed irreducible subsets of $X$ containing
        only one generic point).
\end{enumerate}
\end{envs}

(i) follows immediately from \sref{prop}{1.1.13} and \sref{prop}{1.1.11}; and for
proving (ii), we can, by virtue of \sref{prop}{1.1.11}, we restrict to the case where
$X$ is irreducible; then, according to the proposition \sref{prop}{1.1.13}, there exists
in $A$ a smaller prime ideal $\nilrad$, which corresponds to the generic point
\oldpage{83}
of $X$; in addition, $X$ does not admit only one generic point since it is a Kolmogoroff
space (\sref{cor}{1.1.8} and \pref{env}{2.1.3}).

\begin{envs}[Proposition]{1.1.15}
\label{prop-1.1.1.15}
If $\mathfrak{J}$ is an ideal in $A$ containing the radical $\nilrad(A)$, the only
neighborhood of $V(\mathfrak{J})$ in $X=\Spec(A)$ is the whole space $X$
\end{envs}

In effect, each maximal ideal of $A$ belongs by definitionn of $V(\mathfrak{J})$.
As each ideal $\mathfrak{a}$ of $A$ is contained in a maximal ideal, we have
$V(\mathfrak{a})\cap V(\mathfrak{J})\neq 0$, hence the proposition.

\subsection{Functorial properties of prime spectra of rings}
\label{1-schemes-1.2}       

\begin{env}{1.2.1}
\label{env-1.1.2.1}
Let $A$, $A'$ be two rings,
\[
  \vphi:A'\longrightarrow A
\]
a homomorphism of rings. For each prime ideal $x=\mathfrak{j}_x\in\Spec(A)=X$, the
ring $A'/\vphi^{-1}(\mathfrak{j}_x)$ is canonically isomorphic to a subring of
$A/\mathfrak{j}_x$, so it is integral, otherwise we say
$\vphi^{-1}(\mathfrak{j}_x)$ is a prime ideal of $A'$; we denote it by
$^a\vphi(x)$, and we have also defined a map
\[
  ^a\vphi:X=\Spec(A)\longrightarrow X'=\Spec(A')
\]
(also denoted $\Spec(\vphi)$) we call the map \emph{associated} to the
homomorphism $\vphi$. We denote by $\vphi^x$ the injective homomorphism of
$A'/\vphi^{-1}(\mathfrak{j}_x)$ to $A/\mathfrak{j}_x$ induced by $\vphi$ by
passing to quotients, so the canonical extention is a monomorphism of fields
\[
  \vphi^x:\k(^a\vphi(x))\longrightarrow\k(x);
\]
for each $f'\in A'$, we therefore have by definition
\[
  \vphi^x(f'(^a\vphi(x)))=(\vphi(f'))(x)\quad(x\in X).
  \tag{1.2.1.1}
\]
\end{env}

\begin{envs}[Proposition]{1.2.2}
\label{prop-1.1.2.2}
\begin{enumerate}[label=\rm{(\roman*)}]
  \item For each subset $E'$ of $A'$, we have
        \[
          ^a\vphi^{-1}(V(E'))=V(\vphi(E')),
          \tag{1.2.2.1}
        \]
        and in particular, for each $f'\in A'$,
        \[
          ^a\vphi^{-1}(D(f'))=D(\vphi(f')).
          \tag{1.2.2.2}
        \]
  \item For each ideal $\mathfrak{a}$ of $A$, we have
        \[
          \overline{^a\vphi(V(\mathfrak{a}))}=V(\vphi^{-1}(\mathfrak{a})).
          \tag{1.2.2.3}
        \]
\end{enumerate}
\end{envs}

In effect, the relation $^a\vphi(x)\in V(E')$ is by definition equivalent to
$E'\subset\vphi^{-1}(\mathfrak{j}_x)$, so $\vphi(E')\subset\mathfrak{j}_x$, and
finally $x\in V(\vphi(E'))$, hence (i). To prove (ii), we can suppose that
$\mathfrak{a}$ is equal to its radical, since $V(\rad(\mathfrak{a}))=V(\mathfrak{a})$
(\sref{prop}{1.1.2}, (v)) and
$\vphi^{-1}(\rad(\mathfrak{a}))=\rad(\vphi^{-1}(\mathfrak{a}))$; the relation
$f'\in\mathfrak{a}'$ is by definition equivalent to $f'(x')=0$ for each
$x\in{^a\vphi(Y)}$, so, by virtue of the formula (1.2.1.1), it is equivalent as well
to $\vphi(f')(x)=0$ for each $x\in Y$, or $\vphi(f')\in\mathfrak{j}(Y)=\mathfrak{a}$,
since $\mathfrak{a}$ is equal to its radical; hence (ii).

\begin{envs}[Corollary]{1.2.3}
\label{cor-1.1.2.3}
The map $^a\vphi$ is continuous.
\end{envs}

We remark that if $A''$ is a third ring, $\vphi'$ a homomorphism $A''\to A'$, we have
$^a(\vphi'\circ\vphi)= ^a\vphi\circ ^a\vphi'$; this result and the corollary
\sref{cor}{1.2.3} means that $\Spec(A)$ is a \emph{contravariant functor} in $A$, from the
category of rings to that of topological spaces.

\begin{envs}[Corollary]{1.2.4}
\label{cor-1.1.2.4}
\oldpage{84}
Suppose that $\vphi$ is such that for each $f\in A$ written as $f=h\vphi(f')$, where $h$ is
invertible in $A$ (\emph{which is in particular the case when $\vphi$ is} surjective). Then
$^a\vphi$ is a homeomorphism from $X$ to $^a\vphi(X)$.
\end{envs}

We show that for each subset $E\subset A$, there exists a subset $E'$ of $A'$ such that
$V(E)=V(\vphi(E'))$; according to the axiom ($T_0$) \sref{cor}{1.1.8} and the formula
(1.2.2.1), this implies first that $^a\vphi$ is injective, then, according to (1.2.2.1),
that $^a\vphi$ is a homeomorphism. Or, it suffices for each $f\in E$ to have a $f'\in A'$
such that $h\vphi(f')=f$ with $h$ invertible in $A$; the set $E'$ of these elements $f'$
provides the answer.

\begin{env}{1.2.5}
\label{env-1.1.2.5}
In particular, when $\vphi$ is the canonical homomorphism of $A$ to a ring quotient
$A/\mathfrak{a}$, we get \sref{cor}{1.1.12}, and $^a\vphi$ is the \emph{canonical injection}
of $V(\mathfrak{a})$, identifes with $\Spec(A/\mathfrak{a})$, in $X=\Spec(A)$.
\end{env}

Another particular case of \sref{cor}{1.2.4}:
\begin{envs}[Corollary]{1.2.6}
\label{cor-1.1.2.6}
If $S$ is a multiplicative subset of $A$, the spectrum $\Spec(S^{-1}A)$ identifies
canonically (with its topology) with the subspace of $X=\Spec(A)$ consisting of the $x$
such that $\mathfrak{j}_x\cap S=\emp$.
\end{envs}

We know by \pref{env}{1.2.6} that the prime ideals of $S^{-1}A$ are the ideals
$S^{-1}\mathfrak{j}_x$ such that $\mathfrak{j}_x\cap S=\emp$, and that we have
$\mathfrak{j}_x=(i_A^S)^{-1}(S^{-1}\mathfrak{j}_x)$. It suffices to apply the $i_A^S$
with the corollary \sref{cor}{1.2.4}.

\begin{envs}[Corollary]{1.2.7}
\label{cor-1.1.2.7}
For $^a\vphi(X)$ to be dense in $X'$, it is necessary and sufficient that each element
of the kernel $\ker\vphi$ is nilpotent.
\end{envs}

\subsection{Sheaf associated to a module}
\label{1-schemes-1.3}

\begin{env}{1.3.1}
\label{env-1.1.3.1}
Let $A$ be a commutative ring, $M$ an $A$-module, $f$ an element of $A$, $S_f$ the
multiplicative set of the $f^n$, where $n\geqslant 0$. Recall that we put $A_f=S_f^{-1}A$,
$M_f=S_f^{-1}M$. If $S_f'$ is the saturated multiplicative subset of $A$ consisting of the
$g\in A$ which divide an element of $S_f$, we know that $A_f$ and $M_f$ identify canonically
with ${S_f'}^{-1}A$ and ${S_f'}^{-1}M$ \pref{env}{1.4.3}.
\end{env}

\begin{envs}[Lemma]{1.3.2}
\label{lem-1.1.3.2}
The following conditions are equivalent:
\begin{center}
\rm{(a)} $g\in S_f'$;
\rm{(b)} $S_g'\subset S_f'$;
\rm{(c)} $f\in\rad(g)$;
\rm{(d)} $\rad(f)\subset\rad(g)$;
\rm{(e)} $V(g)\subset V(f)$;
\rm{(f)} $D(f)\subset D(g)$.
\end{center}
\end{envs}
This follows immediately from the definitions and from \sref{cor}{1.1.5}.

\begin{env}{1.3.3}
\label{env-1.1.3.3}
If $D(f)=D(g)$, the lemma (\sref{lem}{1.3.2}, (b)), shows that $M_f=M_g$. More generally, if
$D(f)\supset D(g)$, then $S_f'\subset S_g'$, and we know \pref{env}{1.4.1} that there exists
a canonical functorial homomorphism
\[
  \rho_{g,f}:M_f\longrightarrow M_g,
\]
and if $D(f)\supset D(g)\supset D(h)$, we have \pref{env}{1.4.4}
\[
  \rho_{h,g}\circ\rho_{g,f}=\rho_{h,f}.
  \tag{1.3.3.1}
\]
\end{env}

\oldpage{85}
When $f$ runs over the elements of $A-\mathfrak{j}_x$ (for a given $x$ in $X=\Spec(A)$), the
sets $S_f'$ constitute an increasing filtered set of subsets of $A-\mathfrak{j}_x$, since for
two elements $f$, $g$ of $A-\mathfrak{j}_x$, $S_f'$ and $S_g'$ are contained in $S_{fg}'$; as
the union of the $S_f'$ for $f\in A-\mathfrak{j}_x$ is $A-\mathfrak{j}_x$, we conclude
\pref{env}{1.4.5} that the $A_x$-module $M_x$ identifies canonically with the \emph{inductive
limit} $\varinjlim M_f$, relative to the family of homomorphisms $(\rho_{g,f})$. We denote
by
\[
  \rho_x^f:M_f\longrightarrow M_x
\]
the canonical homomorphism for $f\in A-\mathfrak{j}_x$ (or, equivalently, $x\in D(f)$).

\begin{envs}[Definition]{1.3.4}
\label{defn-1.1.3.4}
We define the structure sheaf of the prime spectrum $X=\Spec(A)$ (resp. sheaf associated to
an $A$-module $M$) and denote it by $\widetilde{A}$ or $\OO_X$ (resp. $\widetilde{M}$) as the
sheaf of rings (resp. the $\widetilde{A}$-module) associated to the presheaf
$D(f)\mapsto A_f$ (resp. $D(f)\mapsto M_f$) over the base $\mathfrak{B}$ of $X$ consisting
of the $D(f)$ for $f\in A$ (\sref{prop}{1.1.10}, \pref{env}{3.2.1}, and \pref{env}{3.5.6}).
\end{envs}

We saw \pref{env}{3.2.4} that the fibre $\widetilde{A}_x$ (resp. $\widetilde{M}_x$)
\emph{identifies with the ring $A_x$} (resp. \emph{the $A_x$-module $M_x$}); we denote by
\[
  \theta_f:A_f\longrightarrow\Gamma(D(f),\widetilde{A})
\]
\[
  (\text{resp. }\theta_f:M_f\longrightarrow\Gamma(D(f),\widetilde{M})),
\]
the canonical map, so that for each $x\in D(f)$ and each $\xi\in M_f$, we have
\[
  (\theta_f(\xi))_x=\rho_x^f(\xi).
  \tag{1.3.4.1}
\]

\begin{envs}[Proposition]{1.3.5}
\label{prop-1.1.3.5}
$\widetilde{M}$ is an exact covariant functor in $M$, from the category of $A$-modules to the
category of $\widetilde{A}$-modules.
\end{envs}

Indeed, let $M$, $N$ be two $A$-modules, $u$ a homomorphism $M\to N$; for each $f\in A$,
it canonically assigns to $u$ a homomorphism $u_f$ of the $A_f$-module $M_f$ to the
$A_f$-module $N_f$, and the diagram (for $D(g)\subset D(f)$)
\[
  \xymatrix{
    M_f\ar[r]^{u_f}\ar[d]_{\rho_{g,f}} & N_f\ar[d]^{\rho_{g,f}}\\
    M_g\ar[r]^{u_g} & N_g
  }
\]
is commutative \pref{env}{1.4.1}; these homomorphisms then define a homomorphism of
$\widetilde{A}$-modules $\widetilde{u}:\widetilde{M}\to\widetilde{N}$ \pref{env}{3.2.3}. In
addition, for each $x\in X$, $\widetilde{u}_x$ is the inductive limit of the $u_f$ for
$x\in D(f)$ ($f\in A$), and as a result \pref{env}{1.4.5} if we canonically identify
$\widetilde{M}_x$ and $\widetilde{N}_x$ with $M_x$ and $N_x$ respectively, $\widetilde{u}_x$
identifies with the homomorphism $u_x$ canonically induced by $u$. If $P$ is a third
$A$-module, $v$ a homomorphism $N\to P$ and $w=v\circ u$, it is immediate that
$w_x=v_x\circ u_x$, so $\widetilde{w}=\widetilde{v}\circ\widetilde{u}$. We have therefore
clearly defined a \emph{covariant functor} $\widetilde{M}$ in $M$, from the category of
$A$-modules to that of $\widetilde{A}$-modules. \emph{This functor is exact}, since for each
$x\in X$, $M_x$ is an exact functor in $M$ \pref{env}{1.3.2}; in addition, we have
$\Supp(M)=\Supp(\widetilde{M})$ by the definitions \pref{env}{1.7.1} and \pref{env}{3.1.6}.

\oldpage{86}
\begin{envs}[Proposition]{1.3.6}
\label{prop-1.1.3.6}
For each $f\in A$, the open subset $D(f)\subset X$ canonically identifies with the prime
spectrum $\Spec(A_f)$, and the sheaf $\widetilde{M_f}$ associated to the $A_f$-module
$M_f$ canonically identifies with the restriction $\widetilde{M}|D(f)$.
\end{envs}

The first assertion is a particular case of \sref{cor}{1.2.6}. In addition, for $g\in A$ is
such that $D(g)\subset D(f)$, $M_g$ canonically identifies with the module of fractions of
$M_f$ whose denominators are the powers of the canonical image of $g$ in $A_f$
\pref{env}{1.4.6}. The canonical identification of $\widetilde{M_f}$ with
$\widetilde{M}|D(f)$ then follows from the definitions.

\begin{envs}[Theorem]{1.3.7}
\label{thm-1.1.3.7}
For each $A$-module $M$ and each $f\in A$, the homomorphism
\[
  \theta_f:M_f\longrightarrow\Gamma(D(f),\widetilde{M})
\]
is bijective (\emph{otherwise said, the presheaf $D(f)\mapsto M_f$ is a} sheaf). In
particular, $M$ identifies by $\theta_1$ with $\Gamma(X,\widetilde{M})$.
\end{envs}

We note that, if $M=A$, $\theta_f$ is a homomorphism of structure rings; the theorem
\sref{thm}{1.3.7} implies then that, if we identify the rings $A_f$ and
$\Gamma(D(f),\widetilde{A})$ by means of the $\theta_f$, the homomorphism
$\theta_f:M_f\to\Gamma(D(f),\widetilde{M})$ is an isomorphism of \emph{modules}.

We show first that $\theta_f$ is \emph{injective}. Indeed, if $\xi\in M_f$ is such that
$\theta_f(\xi)=0$, then this means that for each prime ideal $\mathfrak{p}$ of $A_f$, there
exists $h\not\in\mathfrak{p}$ such that $h\xi=0$; as the annihilator of $\xi$ is not
contained in any prime ideal of $A_f$, each $A_f$ integral, so $\xi=0$.

It remains to show that $\theta_f$ is \emph{surjective}; we can reduce to the case where
$f=1$, the general case deduced by ``localizing'' using \sref{prop}{1.3.6}. Now let $s$ be a
section of $\widetilde{M}$ over $X$; according to \sref{defn}{1.3.4} and
(\sref{prop}{1.1.10}, (ii)), there exists a \emph{finite} cover $(D(f_i))_{i\in I}$ of $X$
($f_i\in A$) such that, for each $i\in I$, the restriction $s_i=s|D(f_i)$ is of the form
$\theta_{f_i}(\xi_i)$, where $\xi_i\in M_{f_i}$. If $i$, $j$ are two indices of $I$, if
the restrictions of $s_i$ and $s_j$ to $D(f_i)\cap D(f_j)=D(f_i f_j)$ are equal, it follows
by definition of $M$ that
\[
  \rho_{f_i f_j,f_i}(\xi_i)=\rho_{f_i f_j,f_j}(\xi_j).
  \tag{1.3.7.1}
\]
By definition, we can write, for each $i\in I$, $\xi_i=z_i/f_i^{n_i}$, where $z_i\in M$, and
as $I$ is finite, by multiplying each $z_i$ by a power of $f_i$, we can suppose that all the
$n_i$ are equal to the same $n$. Then, by definition, (1.3.7.1) implies that there exists an
integer $m_{ij}\geqslant 0$ such that $(f_i f_j)^{m_{ij}}(f_j^n z_i-f_i^n z_j)=0$, and we can
moreover suppose that the $m_{ij}$ are equal to the same integer $m$; replacing then the
$z_i$ by $f_i^m z_i$, it remains to prove for the case where $m=0$, otherwise said, the case
where we have
\[
  f_j^n z_i=f_i^n z_j
  \tag{1.3.7.2}
\]
for any $i$, $j$. We have $D(f_i^n)=D(f_i)$, and as the $D(f_i)$ form a cover of $X$,
the ideal generated by the $f_i^n$ is $A$; in other words, there exist elements $g_i\in A$
such that $\sum_i g_i f_i^n=1$. Then consider the element $z=\sum_i g_i z_i$ of $M$; in
(1.3.7.2), we have $f_i^n z=\sum_j g_j f_i^n z_j=(\sum_j g_j f_j^n)z_i=z_i$, where by
definition $\xi_i=z/1$ in $M_{f_i}$. We conclude
\oldpage{87}
that the $s_i$ are the restrictions to $D(f_i)$ of $\theta_1(z)$, which proves that
$s=\theta_1(z)$ and finishes the proof.

\begin{envs}[Corollary]{1.3.8}
\label{cor-1.1.3.8}
Let $M$, $N$ be two $A$-modules; the canonical homomorphism $u\mapsto\widetilde{u}$ from
$\Hom_A(M,N)$ to $\Hom_{\widetilde{A}}(\widetilde{M},\widetilde{N})$ is bijective. In
particular, the relations $M=0$ and $\widetilde{M}=0$ are equivalent.
\end{envs}

Consider the canonical homomorphism $v\mapsto\Gamma(v)$ from
$\Hom_{\widetilde{A}}(\widetilde{M},\widetilde{N})$ to
$\Hom_{\Gamma(\widetilde{A})}(\Gamma(\widetilde{M}),\Gamma(\widetilde{N}))$; the latter
module canonically identifies with $\Hom_A(M,N)$ according to the theorem \sref{thm}{1.3.7}.
It remains to show that $u\mapsto\widetilde{u}$ and $v\mapsto\Gamma(v)$ are inverses of each
other; it is evident that $\Gamma(\widetilde{u})=u$ by definition of $\widetilde{u}$; on the
other hand, if we put $u=\Gamma(v)$ for
$v\in\Hom_{\widetilde{A}}(\widetilde{M},\widetilde{N})$, the map
$w:\Gamma(D(f),\widetilde{M})\to\Gamma(D(f),\widetilde{N})$ canonically induced from $v$
is such that the diagram
\[
  \xymatrix{
    M\ar[r]^u\ar[d]_{\rho_{f,1}} & N\ar[d]^{\rho_{f,1}}\\
    M_f\ar[r]^w & N_f
  }
\]
is commutative; so we have necessarily that $w=u_f$ for all $f\in A$ \pref{env}{1.2.4}, which
shows that $\widetilde{\Gamma(v)}=v$.

\begin{envs}[Corollary]{1.3.9}
\begin{enumerate}[label=\rm{(\roman*)}]
  \item Let $u$ be a homomorphism from an $A$-module $M$ to an $A$-module $N$; then the
        sheaves associated to $\ker u$, $\img u$, $\coker u$, are respectively
        $\ker\widetilde{u}$, $\img\widetilde{u}$, $\coker\widetilde{u}$. In particular, for
        $\widetilde{u}$ to be injective (resp. surjective, bijective), it is necessary and
        sufficient that $u$ is.
  \item If $M$ is an inductive limit (resp. direct sum) of a family of $A$-modules
        $(M_\lambda)$, $\widetilde{M}$ is the inductive limit (resp. direct sum) of the
        family $(\widetilde{M_\lambda})$, via a canonical isomorphism.
\end{enumerate}
\end{envs}


\subsection{Quasicoherent sheaves over a prime spectrum}
\label{1-schemes-1.4}

\subsection{Coherent sheaves over a prime spectrum}
\label{1-schemes-1.5}

\subsection{Functorial properties of quasicoherent sheaves over a prime spectrum}
\label{1-schemes-1.6}

\subsection{Characterisation of morphisms of affine schemes}
\label{1-schemes-1.7}

\section{Preschemes and morphisms of preschemes}
\label{1-schemes-2}

\subsection{Definition of preschemes}
\label{1-schemes-2.1}

\begin{env}{2.1.1}
\label{env-1.2.1.1}
Given a ringed space $(X,\OO_X)$, we say that an open subset
$V$ of $X$ is an \emph{affine open} if the ringed space $(V,\OO_X|V)$ is an
affine scheme \sref{env}{1.7.1}.
\end{env}

\begin{envs}[Definition]{2.1.2}
\label{defn-1.2.1.2}
We define a prescheme to be a ringed space
$(X,\OO_X)$ such that every point of $X$ admits an affine open neighbourhood.
\end{envs}

\begin{envs}[Proposition]{2.1.3}
\label{prop-1.2.1.3}
\oldpage{98}
If $(X,\OO_X)$ is a prescheme then the affine opens give a base for the topology of $X$.
\end{envs}

In effect, if $V$ is an arbitrary open neighbourhood of $x\in X$, then there
exists by hypothesis an open neighbourhood $W$ of $x$ such that $(W,\OO_X|W)$ is
an affine scheme; we write $A$ to mean its ring.  In the space $W$, $V\cap W$ is
an open neighbourhood of $x$; thus there exists $f\in A$ such that $D(f)$ is an
open neighbourhood of $x$ contained inside $V\cap W$ (\sref{prop}{1.1.10}, (i)).  The ringed
space $(D(f),\OO_X|D(f))$ is thus an affine scheme, isomorphic to $A_f$
\sref{env}{1.3.6}, whence the proposition.

\begin{envs}[Proposition]{2.1.4}
\label{prop-1.2.1.4}
The underlying space of a prescheme is a Kolmogoroff space.
\end{envs}

In effect, if $x,y$ are two distinct points of a prescheme $X$ then it is clear
that there exists an open neighbourhood of one of these points that does not
contain the other if $x$ and $y$ are not in the same affine open; and if they
are in the same affine open, this is a result of \sref{cor}{1.1.8}.

\begin{envs}[Proposition]{2.1.5}
\label{prop-1.2.1.5}
If $(X,\OO_X)$ is a prescheme then every closed
irreducible subset of $X$ admits exactly one generic point, and the map
$x\mapsto\overline{\{x\}}$ is thus a bijection of $X$ onto its set of closed
irreducible subsets.
\end{envs}

In effect, if $Y$ is a closed irreducible subset of $X$ and $y\in Y$, and if $U$
is an open affine neighbourhood of $y$ in $X$, then $U\cap Y$ is everywhere
dense in $Y$, as well as irreducible (\pref{env}{2.1.1} and \pref{env}{2.1.4}); thus by
\sref{cor}{1.1.14}, $U\cap Y$ is the closure in $U$ of a point $x$, and then
$Y\subset\overline{U}$ is the closure of $x$ in $X$.  The uniqueness of the
generic point of $X$ is a result of \sref{prop}{2.1.4} and (\pref{env}{2.1.3}).

\begin{env}{2.1.6}
\label{env-1.2.1.6}
If $Y$ is a closed irreducible subset of $X$ and $y$ its
generic point then the local ring $\OO_y$, also written $\OO_{X/Y}$, is called the
\emph{local ring of $X$ along $Y$}, or the \emph{local ring of $Y$ in $X$}.

If $X$ itself is irreducible and $x$ its generic point then we say that
$\OO_x$ is the \emph{ring of rational functions on $X$} (cf. \textsection7).
\end{env}

\begin{envs}[Proposition]{2.1.7}
\label{prop-1.2.1.7}
If $(X,\OO_X)$ is a prescheme then the ringed
space $(U,\OO_X|U)$ is a prescheme for every open subset $U$.
\end{envs}

This follows directly from definition \sref{defn}{2.1.2} and proposition \sref{prop}{2.1.3}.

We say that $(U,\OO_X|U)$ is the prescheme \emph{induced} on $U$ by
$(X,\OO_X)$, or the \emph{restriction} of $(X,\OO_X)$ to $U$.

\begin{env}{2.1.8}
\label{env-1.2.1.8}
We say that a prescheme $(X,\OO_X)$ is \emph{irreducible}
(resp. \emph{connected}) if the underlying space $X$ is irreducible (resp.
connected).  We say that a prescheme is \emph{integral} if it is
\emph{irreducible and reduced} (cf. \sref{env}{5.1.4}).  We say that a prescheme
$(X,\OO_X)$ is \emph{locally integral} if every $x\in X$ admits an open
neighbourhood $U$ such that the prescheme induced on $U$ by $(X,\OO_X)$ is
integral.
\end{env}

\subsection{Morphisms of preschemes}
\label{1-schemes-2.2}

\begin{envs}[Definition]{2.2.1}
\label{defn-1.2.2.1}
Given two preschemes $(X,\OO_X)$, $(Y,\OO_Y)$, we
define a morphism (of preschemes) of $(X,\OO_X)$ to $(Y,\OO_Y)$ to be a morphism
of ringed spaces $(\psi,\theta)$ such that, for all $x\in X$, $\theta_x^\sharp$ is a
local homomorphism $\OO_{\psi(x)}\to\OO_x$.
\end{envs}

\oldpage{99}
By passing to quotients, the map $\OO_{\psi(x)}\to\OO_x$ gives us a monomorphism
$\theta^x:k(\psi(x))\to k(x)$, which lets us consider $k(x)$ as an \emph{extension} of the
field $k(\psi(x))$.

\begin{env}{2.2.2}
\label{env-1.2.2.2}
The composition $(\psi'',\theta'')$ of two morphisms
$(\psi,\theta)$, $(\psi',\theta')$ of preschemes is also a morphism of
preschemes, since it is given by the formula
${\theta''}^\sharp=\theta^\sharp\circ\psi^*({\theta'}^\sharp)$ \pref{env}{3.5.5}. From this
we conclude that preschemes form a \emph{category}; using the usual notation, we
will write $\Hom(X,Y)$ to mean the set of morphisms from a prescheme $X$ to a
prescheme $Y$.
\end{env}

\begin{env}[Example]{2.2.3}
\label{exm-1.2.2.3}
If $U$ is an open subset of $X$ then the canonical
injection \pref{env}{4.1.2} of the induced prescheme $(U,\OO_X|U)$ into
$(X,\OO_X)$ is a morphism of preschemes; it is further a \emph{monomorphism} of
ringed spaces (and \emph{a fortiori} a monomorphism of preschemes), which
follows rapidly from \pref{env}{4.1.1}.
\end{env}

\begin{envs}[Proposition]{2.2.4}
\label{prop-1.2.2.4}
Let $(X,\OO_X)$ be a prescheme, and $(S,\OO_S)$ an
affine scheme associated to a ring $A$. Then there exists a canonical bijective
correspondence between morphisms of preschemes from $(X,\OO_X)$ to $(S,\OO_S)$ and
ring homomorphisms from $A$ to $\Gamma(X,\OO_X)$.
\end{envs}

Note first of all that, if $(X,\OO_X)$ and $(Y,\OO_Y)$ are two arbitrary ringed spaces,
a morphism $(\psi,\theta)$ from $(X,\OO_X)$ to $(Y,\OO_Y)$ canonically defines a ring
homomorphism
$\Gamma(\theta):\Gamma(Y,\OO_Y)\to\Gamma(Y,\psi_*(\OO_X))=\Gamma(X,\OO_X)$.
In the case that we consider, everything boils down to showing that any
homomorphism $\vphi:A\to\Gamma(X,\OO_X)$ is of the form $\Gamma(\theta)$
for one and only one $\theta$. Now, by hypothesis there is a covering
$(V_\alpha)$ of $X$ by affine opens; by composing of $\vphi$ with the
restriction homomorphism $\Gamma(X,\OO_X)\to\Gamma(V_\alpha,\OO_X|V_\alpha)$ we
obtain a homomorphism $\vphi_\alpha:A\to\Gamma(V_\alpha,\OO_X|V_\alpha)$
that corresponds to a unique morphism $(\psi_\alpha,\theta_\alpha)$ from the
prescheme $(V_\alpha,\OO_X|V_\alpha)$ to $(S,\OO_S)$, thanks to \sref{env}{1.7.3}.
Furthermore, for every pair of indices $(\alpha,\beta)$, every point of
$V_\alpha\cap V_\beta$ admits an open affine neighbourhood $W$ contained inside
$V_\alpha\cap V_\beta$ \sref{prop}{2.1.3}; it is clear that that, by composing
$\vphi_\alpha$ and $\vphi_\beta$ with the restriction homomorphisms to $W$,
we obtain the same homomorphism $\Gamma(S,\OO_S)\to\Gamma(W,\OO_X|W)$, so, thanks
to the relations $(\theta_\alpha^\sharp)_x=(\vphi_\alpha)_x$ for all $x\in
V_\alpha$ and all $\alpha$ \sref{env}{1.6.1}, the restriction to $W$ of the morphisms
$(\psi_\alpha,\theta_\alpha)$ and $(\psi_\beta,\theta_\beta)$ coincide. From
this we conclude that there is a morphism
$(\psi,\theta):(X,\OO_X)\to(S,\OO_S)$ of ringed spaces, and only one such
that its restriction to each $V_\alpha$ is $(\psi_\alpha,\theta_\alpha)$, and it
is clear that this morphism is a morphism of preschemes and such that
$\Gamma(\theta)=\vphi$.

Let $u:A\to\Gamma(X,\OO_X)$ be a ring homomorphism, and $v=(\psi,\theta)$
the corresponding morphism $(X,\OO_X)\to(S,\OO_S)$. For every $f\in A$ we have
that
\[
  \psi^{-1}(D(f))=X_{u(f)}
  \tag{2.2.4.1}
\]
with the notation of \pref{env}{5.5.2} relative to the locally-free sheaf
$\OO_X$. In fact, it suffices to verify this formula when $X$ itself is affine,
and then this is nothing but (1.2.2.2).

\begin{envs}[Proposition]{2.2.5}
\label{prop-1.2.2.5}
Under the hypotheses of \sref{prop}{2.2.4}, let
$\vphi:A\to\Gamma(X,\OO_X)$ be a ring homomorphism,
$f:(X,\OO_X)\to(S,\OO_S)$ the corresponding morphism of preschemes,
$\sh{G}$ (resp. $\sh{F}$) an $\OO_X$-module (resp. $\OO_S$-module), and
$M=\Gamma(S,\sh{F})$. Then there exists a canonical bijective
\oldpage{100}
correspondence between $f$-morphisms $\sh{F}\to\sh{G}$ \pref{env}{4.4.1} and
$A$-homomorphisms $M\to(\Gamma(X,\sh{G}))_{[\vphi]}$.
\end{envs}

Indeed, reasoning as in \sref{prop}{2.2.4}, we are rapidly led to the case where $X$ is
affine, and the proposition then follows from \sref{env}{1.6.3} and \sref{env}{1.3.8}.

\begin{env}{2.2.6}
\label{env-1.2.2.6}
We say that a morphism of preschemes
$(\psi,\theta):(X,\OO_X)\to(Y,\OO_Y)$ is \emph{open} (resp. \emph{closed})
if, for all open subsets $U$ of $X$ (resp. all closed subsets $F$ of $X$),
$\psi(U)$ is open (resp. $\psi(F)$ is closed) in $Y$. We say that
$(\psi,\theta)$ is \emph{dominant} if $\psi(X)$ is dense in $Y$, and
\emph{surjective} if $\psi$ is surjective. We will point out that these
conditions rely only on the continuous map $\psi$.
\end{env}

\begin{envs}[Proposition]{2.2.7}
\label{prop-1.2.2.7}
Let
\begin{gather*}
  f=(\psi,\theta):(X,\OO_X)\to(Y,\OO_Y);\\
  g=(\psi',\theta'):(Y,\OO_Y)\to(Z,\OO_Z)
\end{gather*}
be two morphisms of
preschemes.
\begin{enumerate}[label=\rm{(\roman*)}]
  \item If $f$ and $g$ are both open (resp. closed, dominant, surjective),
        then so is $g\circ f$.
  \item If $f$ is surjective and $g\circ f$ closed, then $g$ is closed.
  \item If $g\circ f$ is surjective, then $g$ is surjective.
\end{enumerate}
\end{envs}
Claims (i) and (iii) are evident. Write $g\circ f=(\psi'',\theta'')$.
If $F$ is closed in $Y$ then $\psi^{-1}(F)$ is closed in $X$, so
$\psi''(\psi^{-1}(F))$ is closed in $Z$; but since $\psi$ is surjective,
$\psi(\psi^{-1}(F))=F$, so $\psi''(\psi^{-1}(F))=\psi'(F)$, which proves (ii).

\begin{envs}[Proposition]{2.2.8}
\label{prop-1.2.2.8}
Let $f=(\psi,\theta)$ be a morphism
$(X,\OO_X)\to(Y,\OO_Y)$, and $(U_\alpha)$ an open cover of $Y$. For $f$ to be
open (resp. closed, surjective, dominant), it is necessary and sufficient that
its restriction to every induced prescheme
$(\psi^{-1}(U_\alpha),\OO_X|\psi^{-1}(U_\alpha))$, considered as a morphism of
preschemes from this induced prescheme to the induced prescheme
$(U_\alpha,\OO_Y|U_\alpha)$ is open (resp. closed, surjective, dominant).
\end{envs}

The proposition follows immediately from the definitions, taking into
account the fact that a subset $F$ of $Y$ is closed (resp. open, dense) in $Y$
if and only if each of the $F\cap U_\alpha$ are closed (resp. open, dense) in
$U_\alpha$.

\begin{env}{2.2.9}
\label{env-1.2.2.9}
Let $(X,\OO_X)$ and $(Y,\OO_Y)$ be two preschemes; suppose that
$X$ (resp. $Y$) has a finite number of irreducible components $X_i$ (resp.
$Y_i$) ($1\leqslant i\leqslant n$); let $\xi_i$ (resp. $\eta_i$) be the generic
point of $X_i$ (resp. $Y_i$) \sref{env}{2.1.5}. We say that a morphism
\[
  f=(\psi,\theta):(X,\OO_X)\to(Y,\OO_Y)
\]
is \emph{birational} if, for all $i$, $\psi^{-1}(\eta_i)=\{\xi_i\}$ and
$\theta_{\xi_i}^\sharp:\OO_{\eta_i}\to\OO_{\xi_i}$ is an \emph{isomorphism}. It
is clear that a birational morphism is dominant \pref{env}{2.1.8}, and so is
surjective if it is also closed.
\end{env}

\begin{env}[Notational conventions]{2.2.10}
\label{rmk-1.2.2.10}
In all that follows, when there is
no risk of confusion, we \emph{supress} the structure sheaf (resp. the morphism
of structure sheaves) from the notation of a prescheme (resp. morphism of
preschemes). If $U$ is an open subset of the underlying space $X$ of a
prescheme, then whenever we speak of $U$ as a prescheme we always mean the
induced prescheme on $U$.
\end{env}

\subsection{Gluing of preschemes}
\label{1-schemes-2.3}

\begin{env}{2.3.1}
\label{env-1.2.3.1}
\oldpage{101}
It follows from definition \sref{defn}{2.1.2} that every ringed space obtained by
\emph{gluing} preschemes \pref{env}{4.1.6} is again a prescheme. In particular, although
every prescheme admits, by definition, a cover by affine open sets, we see that every
prescheme can actually be obtained by \emph{gluing affine schemes}.
\end{env}

\begin{env}[Example]{2.3.2}
\label{exm-1.2.3.2}
Let $K$ be a field, and $B=K[s]$, $C=K[t]$ be two polynomial rings in one indeterminate over $K$,
and define $X_1=\Spec(B)$, $X_2=\Spec(C)$, which are two isomorphic affine schemes.
In $X_1$ (resp. $X_2$), let $U_{12}$ (resp. $U_{21}$) be the affine open $D(s)$ (resp. $D(t)$) where
the ring $B_s$ (resp. $C_t$) is formed of rational fractions of the form $f(s)/s^m$ (resp. $g(t)/t^n$)
with $f\in B$ (resp. $g\in C$). Let $u_{12}$ be the isomorphism of preschemes $U_{21}\to U_{12}$
corresponding \sref{prop}{2.2.4} to the isomorphism from $B$ to $C$ that, to $f(s)/s^m$, associates
the rational fraction $f(1/t)/(1/t^m)$. We can glue $X_1$ and $X_2$ along $U_{12}$ and $U_{21}$ by
using $u_{12}$, because there is clearly no gluing condition. We later show that the prescheme $X$
obtained in this manner is a particular case of a general method of construction (\textbf{II},2.4.3).
Here we only show that $X$ \emph{is not an affine scheme}; this will follow from the fact that the ring
$\Gamma(X,\OO_X)$ is \emph{isomorphic} to $K$, and so its spectrum reduces to a point. In effect, a section
of $\OO_X$ over $X$ has a restriction over $X_1$ (resp. $X_2$), identified to an affine open of $X$, that
is a polynomial $f(s)$ (resp. $g(t)$), and it follows from the definitions that we should have $g(t)=f(1/t)$,
which is not possible if $f=g\in K$.
\end{env}

\subsection{Local schemes}
\label{1-schemes-2.4}

\begin{env}{2.4.1}
\label{env-1.2.4.1}
We say that an affine scheme is a \emph{local scheme} if
it is the affine scheme associated to a local ring $A$; then there exists in
$X=\Spec(A)$ a single \emph{closed point $a\in X$}, and for all other $b\in X$
we have that $a\in\overline{\{b\}}$ \sref{cor}{1.1.7}.
\end{env}
    
For all preschemes $Y$ and points $y\in Y$, the local scheme $\Spec(\OO_y)$
is called the \emph{local scheme of $Y$ at the point $y$}. Let $V$ be an affine
open of $Y$ containing $y$, and $B$ the ring of the affine scheme $V$; then
$\OO_y$ is canonically identified with $B_y$ \sref{env}{1.3.4}, and the canonical
homomorphism $B\to B_y$ thus corresponds \sref{env}{1.6.1} to a morphism of preschemes
$\Spec(\OO_y)\to V$.  If we compose this morphism with the canonical injection
$V\to Y$, then we obtain a morphism $\Spec(\OO_y)\to Y$, which is
\emph{independent} of the affine open $V$ (containing $y$) that we chose:
indeed, if $V'$ is some other affine open containing $y$, then there exists a
third affine open $W$ containing $y$ and such that $W\subset V\cap V'$ \sref{prop}{2.1.3};
we can thus assume that $V\subset V'$, and then if $B'$ is the ring of $V'$,
everything comes down to remarking that the diagram
\[
  \xymatrix{
    B'\ar[rr]\ar[dr] & & B\ar[dl]\\
    & \OO_y &
  }
\]
is commutative \pref{env}{1.5.1}. The morphism
\[
  \Spec(\OO_y)\longrightarrow Y
\]
thus defined is said to be \emph{canonical}.
    
\begin{envs}[Proposition]{2.4.2}
\label{prop-1.2.4.2}
\oldpage{102}
Let $(Y,\OO_Y)$ be a prescheme; for all $y\in Y$, let $(\psi,\theta)$ be the canonical
morphism $(\Spec(\OO_y),\widetilde{\OO}_y)\to(Y,\OO_Y)$. Then $\psi$ is a homeomorphism
from $\Spec(\OO_y)$ to the subspace $S_y$ of $Y$ given by the $z$ such that
$y\in\overline{\{z\}}$ (\emph{or, equivalently, the generalizations of $y$
\pref{env}{2.1.2}}; furthermore, if $z=\psi(\mathfrak{p})$, then
$\theta_z^\sharp:\OO_z\to(\OO_y)_\mathfrak{p}$ is an isomorphism; $(\psi,\theta)$
is thus a monomorphism of ringed spaces.
\end{envs}
    
As the unique closed point $a$ of $\Spec(\OO_y)$ is contained in the closure of any
point of this space, and since $\psi(a)=y$, the image of $\Spec(\OO_y)$ under
the continuous map $\psi$ is contained in $S_y$. Since $S_y$ is contained in
every affine open containing $y$, one can consider just the case where $Y$ is an
affine scheme; but then this proposition follows from \sref{env}{1.6.2}.
    
\emph{We see \sref{prop}{2.1.5} that there is a bijective correspondence between
$\Spec(\OO_y)$ and the set of closed irreducible subsets of $Y$ containing $y$.}
    
\begin{envs}[Corollary]{2.4.3}
\label{cor-1.2.4.3}
For $y\in Y$ to be the generic point of an
irreducible component of $Y$, it is necessary and sufficient that the only prime
ideal of the local ring $\OO_y$ is its maximal ideal (\emph{in other words, that
$\OO_y$ is of \emph{dimension zero}}).
\end{envs}
    
\begin{envs}[Proposition]{2.4.4}
\label{prop-1.2.4.4}
Let $(X,\OO_X)$ be a local scheme of a ring
$A$, $a$ its unique closed point, and $(Y,\OO_Y)$ a prescheme.  Every morphism
$u=(\psi,\theta):(X,\OO_X)\to(Y,\OO_Y)$ then factorizes uniquely as
$X\to\Spec(\OO_{\psi(a)})\to Y$, where the second arrow denotes the canonical
morphism, and the first corresponds to a local homomorphism $\OO_{\psi(a)}\to A$.
This establishes a canonical bijective correspondence between the set of
morphisms $(X,\OO_X)\to(Y,\OO_Y)$ and the set of local homomorphisms $\OO_y\to A$
for ($y\in Y$).
\end{envs}
    
Indeed, for all $x\in X$, we have that $a\in\overline{\{x\}}$, so
$\psi(a)\in\overline{\{\psi(x)\}}$, which shows that $\psi(X)$ is contained in
every affine open containing $\psi(a)$. So it suffices to consider the case
where $(Y,\OO_Y)$ is an affine scheme of ring $B$, and we then have that
$u=(^a\vphi,\tilde{\vphi})$, where $\vphi\in\Hom(B,A)$ (1.7.3).  Further,
we have that $\vphi^{-1}(\mathfrak{j}_a)=\mathfrak{j}_{\psi(a)}$, and hence
that the image under $\vphi$ of any element of
$B\setminus\mathfrak{j}_{\psi(a)}$ is invertible in the local ring $A$; the
factorization in the result follows from the universal property of the ring of
fractions \pref{env}{1.2.4}. Conversely, to every local homomorphism
$\OO_y\to A$ there exists a unique corresponding morphism
$(\psi,\theta):X\to\Spec(\OO_y)$ such that $\psi(a)=y$ \sref{env}{1.7.3}, and,
by composing with the canonical morphism $\Spec(\OO_y)\to Y$, we obtain a morphism
$X\to Y$, which proves the proposition.
    
\begin{env}{2.4.5}
\label{env-1.2.4.5}
The affine schemes whose ring is a field $K$ have an
underlying space that is just a point. If $A$ is a local ring with maximal
ideal $\mathfrak{m}$, then every local homomorphism $A\to K$ has kernel equal to
$\mathfrak{m}$, and so factorizes as $A\to A/\mathfrak{m}\to K$, where the
second arrow is a monomorphism. The morphisms $\Spec(K)\to\Spec(A)$ thus
correspond bijectively to monomorphisms of fields $A/\mathfrak{m}\to K$.
\end{env}
    
Let $(Y,\OO_Y)$ be a prescheme; for every $y\in Y$ and every ideal
$\mathfrak{a}_y$ of $\OO_y$, the canonical homomorphism
$\OO_y\to\OO_y/\mathfrak{a}_y$ defines a morphism
$\Spec(\OO_y/\mathfrak{a}_y)\to\Spec(\OO_y)$; if we compose this with the
canonical morphism $\Spec(\OO_y)\to Y$, then we obtain a morphism
$\Spec(\OO_y/\mathfrak{a}_y)\to Y$, again said to be \textit{canonical}. For
$\mathfrak{a}_y=\mathfrak{m}_y$, this says that $\OO_y/\mathfrak{a}_y=\k(y)$, and
so proposition \sref{prop}{2.4.4} says that:
    
\begin{envs}[Corollary]{2.4.6}
\label{cor-1.2.4.6}
\oldpage{103}
Let $(X,\OO_X)$ be a local scheme whose ring $K$ is a field, $\xi$ be the unique point of
$X$, and $(Y,\OO_Y)$ a prescheme. Then every morphism $u:(X,\OO_X)\to(Y,\OO_Y)$ factorizes
uniquely as $X\to\Spec(\k(\psi(\xi)))\to Y$, where the second arrow denotes the canonical
morphism, and the first corresponds to a monomorphism $\k(\psi(\xi))\to K$.
This establishes a canonical bijective correspondance between the set of
morphisms $(X,\OO_X)\to (Y,\OO_Y)$ and the set of monomorphisms $\k(y)\to K$ (for
$y\in Y$).
\end{envs}
    
\begin{envs}[Corollary]{2.4.7}
\label{cor-1.2.4.7}
For all $y\in Y$, every canonical morphism
$\Spec(\OO_y/\mathfrak{a}_y)\to Y$ is a monomorphism of ringed spaces.
\end{envs}
    
We have already seen this when $\mathfrak{a}_y=0$ \sref{prop}{2.4.2}, and it suffices
to apply \sref{env}{1.7.5}.
    
\begin{env}[Remark]{2.4.8}
\label{rmk-1.2.4.8}
Let $X$ be a local scheme, and $a$ its unique
closed point.  Since every affine open containing $a$ is necessarily in the
whole of $X$, every \emph{invertible} $\OO_X$-module \pref{env}{5.4.1} is
necessarily \emph{isomorphic to $\OO_X$} (or, as we say, again, \emph{trivial}).
This property doesn't hold in general, for an arbitrary affine scheme
$\Spec(A)$; we will see in Chapter~V that if $A$ is a normal ring then this is
true when $A$ is \unsure{\emph{factorial}}.
\end{env}

\subsection{Preschemes over a prescheme}
\label{1-schemes-2.5}

\begin{envs}[Definition]{2.5.1}
\label{defn-1.2.5.1}
Given a prescheme $S$, we say that the data of a
prescheme $X$ and a morphism of preschemes $\vphi:X\to S$ defines a
prescheme $X$ \emph{over the prescheme $S$}, or an \emph{$S$-prescheme}; we say
that $S$ is the \emph{base prescheme} of the $S$-prescheme $X$. The morphism
$\vphi$ is called the \emph{structure morphism} of the $S$-prescheme $X$.
When $S$ is an affine scheme of ring $A$, we also say that $X$ endowed with
$\vphi$ is a prescheme \emph{over the ring $A$} (or an \emph{$A$-prescheme}).
\end{envs}

It follows from \sref{prop}{2.2.4} that the data of a prescheme over a ring $A$ is
equivalent to the data of a prescheme $(X,\OO_X)$ whose structure sheaf $\OO_X$ is
a sheaf of \emph{$A$-algebras}. \emph{An arbitrary prescheme can always be
considered as a $\mathbb{Z}$-prescheme in a unique way.}

If $\vphi:X\to S$ is the structure morphism of an $S$-prescheme $X$, we
say that a point $x\in X$ is \emph{over a point $s\in S$} if $\vphi(x)=s$.  We
say that $X$ \emph{dominates} $S$ if $\vphi$ is a dominant morphism \sref{env}{2.2.6}.

\begin{env}{2.5.2}
\label{env-1.2.5.2}
Let $X$ and $Y$ be two $S$-preschemes; we say that a morphism
of preschemes $u:X\to Y$ is a \emph{morphism of preschemes over $S$} (or
an \emph{$S$-morphism}) if the diagram
\[
  \xymatrix{
    X \ar[rr]^u \ar[dr] & & Y\ar[dl]\\
    & S &
  }
\]
(where the diagonal arrows are the structure morphisms) is
commutative: this ensures that, for all $s\in S$ and $x\in X$ over $s$, $u(x)$
is also above $s$.
\end{env}

From this definition it follows immediately that the composition of two
$S$-morphisms is an $S$-morphism; $S$-preschemes thus form a \emph{category}.

We denote by $\Hom_S(X,Y)$ the set of $S$-morphisms from an $S$-prescheme $X$ to
an $S$-prescheme $Y$; the identity morphism of an $S$-prescheme is denoted by
$1_X$.

When $S$ is an affine scheme of ring $A$, we will also say \emph{$A$-morphism}
instead of $S$-morphism.

\begin{env}{2.5.3}
\label{env-1.2.5.3}
\oldpage{104}
If $X$ is an $S$-prescheme, and $v:X'\to X$ a morphism of preschemes,
then the composition $X'\to X\to S$ endows $X'$ with the structure of an $S$-prescheme;
in particular, every prescheme induced by an open set $U$ of $X$ can be considered as an
$S$-prescheme by the canonical injection.
\end{env}

If $u:X\to Y$ is an $S$-morphism of $S$-preschemes, then the restriction
of $u$ to any prescheme induced by an open subset $U$ of $X$ is also an
$S$-morphism $U\to Y$. Conversely, let $(U_\alpha)$ be an open cover of $X$,
and for each $\alpha$ let $u_\alpha:U_\alpha\to Y$ be an $S$-morphism; if,
for all pairs of indices $(\alpha,\beta)$, the restrictions of $u_\alpha$ and
$u_\beta$ to $U_\alpha\cap U_\beta$ agree, then there exists an $S$-morphism
$X\to Y$, and only one such that the restriction to each $U_\alpha$ is
$u_\alpha$.

If $u:X\to Y$ is an $S$-morphism such that $u(X)\subset V$, where $V$ is
an open subset of $Y$, then $u$, considered as a morphism from $X$ to $V$, is
also an $S$-morphism.

\begin{env}{2.5.4}
\label{env-1.2.5.4}
Let $S'\to S$ be a morphism of preschemes; for all
$S'$-preschemes, the composition $X\to S'\to S$ endows $X$ with the structure of
an $S$-prescheme. Conversely, suppose that $S'$ is the induced prescheme of an
open subset of $S$; let $X$ be an $S$-prescheme and suppose that the structure
morphism $f:X\to S$ is such that $f(X)\subset S'$; then we can consider
$X$ as an $S'$-preschemes. In this latter case, if $Y$ is another $S$-prescheme
whose structure morphism sends the underlying space to $S'$, then every
$S$-morphism from $X$ to $Y$ is also an $S'$-morphism.
\end{env}

\begin{env}{2.5.5}
\label{env-1.2.5.5}
If $X$ is an $S$-prescheme, with structure morphism
$\vphi:X\to S$, we define an \emph{$S$-section of $X$} to be an
$S$-morphism from $S$ to $X$, that is to say a morphism of preschemes
$\psi:S\to X$ such that $\vphi\circ\psi$ is the identity on $S$.  We
denote by $\Gamma(X/S)$ the set of $S$-sections of $X$.
\end{env}

\section{Products of preschemes}
\label{1-schemes-3}

\section{Subpreschemes and immersion morphisms}
\label{1-schemes-4}

\section{Reduced preschemes; separation conditions}
\label{1-schemes-5}

\section{Finiteness conditions}
\label{1-schemes-6}

\section{Rational maps}
\label{1-schemes-7}

\section{Chevalley schemes}
\label{1-schemes-8}

\subsection{Allied local rings}
\label{1-schemes-8.1}

For every local ring $A$, we denote by $\mathfrak{m}(A)$ the maximal ideal of
$A$.

\begin{envs}[Lemma]{8.1.1}
\label{lem-1.8.1.1}
Let $A$ and $B$ be two local rings such that $A\subset B$;
then the following conditions are equivalent: (i)
$\mathfrak{m}(B)\cap A=\mathfrak{m}(A)$; (ii)
$\mathfrak{m}(A)\subset\mathfrak{m}(B)$; (iii) $1$ is not an element of
the ideal of $B$ generated by $\mathfrak{m}(A)$.
\end{envs}

It's evident that (i) implies (ii), and (ii) implies (iii); lastly, if (iii) is
true, then $\mathfrak{m}(B)\cap A$ contains $\mathfrak{m}(A)$ and doesn't
contain $1$, and is thus equal to $\mathfrak{m}(A)$.

When the equivalent conditions of \sref{lem}{8.1.1} are satisfied, we say that $B$
\emph{dominates} $A$; this is equivalent to saying that the injection $A\to B$
is a \emph{local} homomorphism. It is clear that, in the set of local subrings
of a ring $R$, the relation given by domination is an \unsure{order}.

\begin{env}{8.1.2}
\label{env-1.8.1.2}
Now consider a \emph{field} $R$. For all subrings $A$ of
$R$, we denote by $L(A)$ the set of local rings $A_\mathfrak{p}$, where
$\mathfrak{p}$ runs over the prime spectrum of $A$; they are identified with the
subrings of $R$ containing $A$. Since
$\mathfrak{p}=(\mathfrak{p}A_\mathfrak{p})\cap A$, the map $\mathfrak{p}\to
A_\mathfrak{p}$ from $\Spec(A)$ into $L(A)$ is bijective.
\end{env}

\begin{envs}[Lemma]{8.1.3}
\label{lem-1.8.1.3}
Let $R$ be a field, and $A$ a subring of $R$. For a
local subring $M$ of $R$ to dominate a ring $A_\mathfrak{p}\in L(A)$ it is
necessary and sufficient that $A\subset M$; the local ring $A_\mathfrak{p}$
dominated by $M$ is then unique, and corresponds to
$\mathfrak{p}=\mathfrak{m}(M)\cap A$.
\end{envs}

Indeed, if $M$ dominates $A_\mathfrak{p}$, then $\mathfrak{m}(M)\cap
A_\mathfrak{p}=\mathfrak{p}A_\mathfrak{p}$, by \sref{lem}{8.1.1}, whence the
uniqueness of $\mathfrak{p}$; on the other hand, if $A\subset M$, then
$\mathfrak{m}M\cap A=\mathfrak{p}$ is prime in $A$, and since
$A\setminus\mathfrak{p}\subset M$, we have that $A_\mathfrak{p}\subset M$ and
$\mathfrak{p}A_\mathfrak{p}\subset\mathfrak{m}(M)$, so $M$ dominates
$A_\mathfrak{p}$

\begin{envs}[Lemma]{8.1.4}
\label{lem-1.8.1.4}
\oldpage{165}
Let $R$ be a field, $M$ and $N$ two local
subrings of $R$, and $P$ the subring of $R$ generated by $M\cup N$. Then the
following conditions are equivalent:
\begin{enumerate}[label=\rm{(\roman*)}]
  \item There exists a prime ideal $\mathfrak{p}$ of $P$ such that
        $\mathfrak{m}(M)=\mathfrak{p}\cap M$ and $\mathfrak{m}(N)=\mathfrak{p}\cap N$.
  \item The ideal $\mathfrak{a}$ generated in $P$ by $\mathfrak{m}(M)\cup\mathfrak{m}(N)$ is
        distinct from $P$.
  \item There exists a local subring $Q$ of $R$ simultaneously dominating both $M$ and $N$.
\end{enumerate}
\end{envs}

It is clear that (i) implies (ii); conversely, if $\mathfrak{a}\neq P$, then
$\mathfrak{a}$ is contained in a maximal ideal $\mathfrak{n}$ of $P$, and since
$1\not\in\mathfrak{n}$, $\mathfrak{n}\cap M$ contains $\mathfrak{m}(M)$ and is
distinct from $M$, so $\mathfrak{n}\cap M=\mathfrak{m}(M)$, and similarly
$\mathfrak{n}\cap N=\mathfrak{m}(N)$. It is clear that, if $Q$ dominates both
$M$ and $N$, then $P\subset Q$ and $\mathfrak{m}(M)=\mathfrak{m}(Q)\cap
M=(\mathfrak{m}(Q)\cap P)\cap M$, and $\mathfrak{m}(N)=(\mathfrak{m}(Q)\cap
P)\cap N$, so (iii) implies (i); the inverse is evident when we take
$Q=P_\mathfrak{p}$.

When the conditions of \sref{lem}{8.1.4} are satisfied, we say, with C.~Chevalley,
that the local rings $M$ and $N$ are \emph{allied}.

\begin{envs}[Proposition]{8.1.5}
\label{prop-1.8.1.5}
Let $A$ and $B$ be two subrings of a field $R$,
and $C$ the subring of $R$ generated by $A\cup B$. Then the following
conditions are equivalent:
\begin{enumerate}[label=\rm{(\roman*)}]
  \item For every local ring $Q$ containing $A$ and $B$, we have that
        $A_\mathfrak{p}=B_\mathfrak{q}$, where $\mathfrak{p}=\mathfrak{m}(Q)\cap A$ and
        $\mathfrak{q}=\mathfrak{m}(Q)\cap B$.
  \item For all prime ideals $\mathfrak{r}$ of $C$, we have that
        $A_\mathfrak{p}=B_\mathfrak{q}$, where $\mathfrak{p}=\mathfrak{r}\cap A$ and
        $\mathfrak{q}=\mathfrak{r}\cap B$.
  \item If $M\in L(A)$ and $N\in L(B)$ are allied, then they are identical.
  \item $L(A)\cap L(B)=L(C)$.
\end{enumerate}
\end{envs}

Lemmas \sref{lem}{8.1.3} and \sref{lem}{8.1.4} prove that (i) and (iii) are equivalent; it
is clear that (i) implies (ii) by taking $Q=C_\mathfrak{r}$; conversely, (ii)
implies (i), because if $Q$ contains $A\cup B$ then it contains $C$, and if
$\mathfrak{r}=\mathfrak{m}(Q)\cap C$ then $\mathfrak{p}=\mathfrak{r}\cap A$ and
$\mathfrak{q}=\mathfrak{r}\cap B$, from \sref{lem}{8.1.3}. It is immediate that (iv)
implies (i), because if $Q$ contains $A\cup B$ then it dominates a local ring
$C_\mathfrak{r}\in L(C)$ by \sref{lem}{8.1.3}; by hypothesis we have that
$C_\mathfrak{r}\in L(A)\cap L(B)$, and \sref{lem}{8.1.1} and \sref{lem}{8.1.3} prove that
$C_\mathfrak{r}=A_\mathfrak{p}=B_\mathfrak{q}$. We prove finally that (iii)
implies (iv). Let $Q\in L(C)$; $Q$ dominates some $M\in L(A)$ and some $N\in
L(B)$ \sref{lem}{8.1.3}, so $M$ and $N$, being allied, are identical by hypothesis.
As we then have that $C\subset M$, we know that $M$ dominates some $Q'\in L(C)$
\sref{lem}{8.1.3}, so $Q$ dominates $Q'$, whence necessarily \sref{lem}{8.1.3} $Q=Q'=M$,
so $Q\in L(A)\cap L(B)$. Conversely, if $Q\in L(A)\cap L(B)$, then $C\subset
Q$, so \sref{lem}{8.1.3} $Q$ dominates some $Q''\in L(C)\subset L(A)\cap L(B)$; $Q$
and $Q''$, being allied, are identical, so $Q''=Q\in L(C)$, which completes the
proof.

\subsection{Local rings of an integral scheme}
\label{1-schemes-8.2}

\begin{env}{8.2.1}
\label{env-1.8.2.1}
Let $X$ be an \emph{integral} prescheme, and $R$ its field of
rational functions, identical to the local ring of the generic point $a$ of $X$;
for all $x\in X$, we know that $\OO_x$ can be canonically identified with a
subring of $R$ \sref{env}{7.1.5}, and for every rational function $f\in R$, the
domain of definition $\delta(f)$ of $f$ is the open set of $x\in X$ such that
$f\in\OO_x$. It thus follows from \sref{env}{7.2.6} that, for every open $U\subset X$,
we have
\[
  \Gamma(U,\OO_X)=\bigcap_{x\in U}\OO_x.
  \tag{8.2.1.1}
\]
\end{env}

\begin{envs}[Proposition]{8.2.2}
\label{prop-1.8.2.2}
\oldpage{166}
Let $X$ be an integral prescheme,
and $R$ its field of rational fractions. For $X$ to be a scheme, it is
necessary and sufficient that the relation ``$\OO_x$ and $\OO_y$ are allied''
\sref{lem}{8.1.4}, for points $x$, $y$ of $X$, implies that $x=y$.
\end{envs}

Suppose that this condition is verified, and aim to show that $X$ is separated.
Let $U$ and $V$ be two distinct affine opens of $X$, with rings $A$ and $B$,
identified with subrings of $R$; $U$ (resp.$V$) is thus identified \sref{env}{8.1.2}
with $L(A)$ (resp.$L(B)$), and the hypothesis tells us \sref{env}{8.1.5} that $C$ is
the subring of $R$ generated by $A\cup B$, and $W=U\cap V$ is identified with
$L(A)\cap L(B)=L(C)$. Further, we know
(\cite{1}, p.~\unsure{5-03}, .~4~\emph{bis}) that every subring $E$ of $R$ is
equal to the intersection of the local rings belonging to $L(E)$; $C$ is thus
identified with the intersection of the rings $\OO_z$ for $z\in W$, or,
equivalently (8.2.1.1) with $\Gamma(W,\OO_X)$. So consider the subprescheme
induced by $X$ on $W$; to the \unsure{identity} morphism $\vphi:
C\to\Gamma(W,\OO_X)$ there corresponds \sref{env}{2.2.4} a morphism
$\Phi=(\psi,\theta):W\to\Spec(C)$; we will see that $\Phi$ is an
\emph{isomorphism} of preschemes, whence $W$ is an \emph{affine} open. The
identification of $W$ with $L(C)=\Spec(C)$ shows that $\psi$ is
\emph{bijective}.On the other hand, for all $x\in W$, $\theta_x^\sharp$ is the
injection $C_\mathfrak{r}\to\OO_x$, where $\mathfrak{r}=\mathfrak{m}_x\cap C$,
and by definition $C_\mathfrak{r}$ is identified with $\OO_x$, so $\theta_x^\sharp$
is bijective. It thus remains to show that $\psi$ is a \emph{homeomorphism},
i.e. that for every closed subset $F\subset W$, $\psi(F)$ is closed in
$\Spec(C)$. But $F$ is the \unsure{trace over} $W$ of closed subspace of $U$,
of the form $V(\mathfrak{a})$, where $\mathfrak{a}$ is an ideal of $A$; we show
that $\psi(F)=V(\mathfrak{a}C)$, which proves our claim. In fact, the prime
ideals of $C$ containing $\mathfrak{a}C$ are the prime ideals of $C$ containing
$\mathfrak{a}$, and so are the ideals of the form $\psi(x)=\mathfrak{m}_x\cap
C$, where $\mathfrak{a}\subset\mathfrak{m}_x$ and $x\in W$; since
$\mathfrak{a}\subset\mathfrak{m}_x$ is equivalent to $x\in V(\mathfrak{a})=W\cap
F$ for $x\in U$, we do indeed have that $\psi(F)=V(\mathfrak{a}C)$.

It follows that $X$ is separated, because $U\cap V$ is affine and its ring $C$
is generated by the union $A\cup B$ of the rings of $U$ and $V$ \sref{env}{5.5.6}.

Conversely, suppose that $X$ is separated, and let $x,y$ be two points of $X$
such that $\OO_x$ and $\OO_y$ are allied. Let $U$ (resp. $V$) be an affine open
containing $x$ (resp. $y$), of ring $A$ (resp. $B$); we then know that $U\cap V$
is affine and that its ring $C$ is generated by $A\cup B$ \sref{env}{5.5.6}. If
$\mathfrak{p}=\mathfrak{m}_x\cap A$ and $\mathfrak{q}=\mathfrak{m}_y\cap B$,
then $A_\mathfrak{p}=\OO_x$ and $B_\mathfrak{q}=\OO_y$, and since $A_\mathfrak{p}$
and $B_\mathfrak{q}$ are allied, there exists a prime ideal $\mathfrak{r}$ of
$C$ such that $\mathfrak{p}=\mathfrak{r}\cap A$ and
$\mathfrak{q}=\mathfrak{r}\cap B$ \sref{lem}{8.1.4}. But then there exists a point
$z\in U\cap V$ such that $\mathfrak{r}=\mathfrak{m}_z\cap C$, since $U\cap V$ is
affine, and so evidently $x=z$ and $y=z$, whence $x=y$.

\begin{envs}[Corollary]{8.2.3}
\label{cor-1.8.2.3}
Let $X$ be an integral scheme, and $x,y$ two
points of $X$.In order that $x\in\overline{\{y\}}$, it is necessary and
sufficient that $\OO_x\subset\OO_y$, or, equivalently, that every rational
function defined at $x$ is also defined at $y$.
\end{envs}

The condition is evidently necessary because the domain of definition
$\delta(f)$ of a rational function $f\in R$ is open; we now show that it is
sufficient.If $\OO_x\subset\OO_y$, then there exists a prime ideal
$\mathfrak{p}$ of $\OO_x$ such that $\OO_y$ dominates $(\OO_x)_\mathfrak{p}$
\sref{lem}{8.1.3}; but \sref{env}{2.4.2} there exists $z\in X$ such that
$x\in\overline{\{z\}}$ and $\OO_z=(\OO_x)_\mathfrak{p}$; since $\OO_z$ and $\OO_y$
are allied, we have that $z=y$ by \sref{prop}{8.2.2}, whence the corollary.

\begin{envs}[Corollary]{8.2.4}
\label{cor-1.8.2.4}
If $X$ is an integral scheme then the map
$x\to\OO_x$ is injective; equivalently, if $x$ and $y$ are two distinct points of
$X$, then there exists a rational function defined at one of these points but
not the other.
\end{envs}

\oldpage{167}
This follows from \sref{cor}{8.2.3} and the axiom ($T_0$) \sref{env}{2.1.4}.

\begin{envs}[Corollary]{8.2.5}
\label{cor-1.8.2.5}
Let $X$ be an integral scheme whose underlying
space is Noetherian; letting $f$ run over the field $R$ of rational functions on
$X$, the sets $\delta(f)$ generate the topology of $X$.
\end{envs}

In fact, every closed subset of $X$ is thus a finite union of irreducible closed
subsets, i.e. of the form $\overline{\{y\}}$ \sref{env}{2.1.5}. But, if
$x\not\in\overline{\{y\}}$, then there exists a rational function $f$ defined at
$x$ but not at $y$ \sref{cor}{8.2.3}, or, equivalently, we have that $x\in\delta(f)$
and $\delta(f)$ is not contained in $\overline{\{y\}}$. The complement  of
$\overline{\{y\}}$ is thus a union of sets of the form $\delta(f)$, and by
virtue of the first remark, every open subset of $X$ is the union of finite
intersections of open sets of the form $\delta(f)$.

\begin{env}{8.2.6}
\label{env-1.8.2.6}
Corollary \sref{cor}{8.2.5} shows that the topology of $X$ is
entirely characterised by the data of the local rings $(\OO_x)_{x\in X}$ that
have $R$ as their field of fractions. It amounts to the same to say that the
closed subsets of $X$ are defined in the following manner: given a finite subset
$\{x_1,\ldots,x_n\}$ of $X$, consider the set of $y\in X$ such that
$\OO_y\subset\OO_{x_i}$ for at least one index $i$, and these sets (over all
choices of $\{x_1,\ldots,x_n\}$) are the closed subsets of $X$. Further, once
the topology on $X$ is known, the structure sheaf $\OO_X$ is also determined by
the family of the $\OO_x$, since $\Gamma(U,\OO_X)=\bigcap_{x\in U}\OO_x$ by
(8.2.1.1). The family $(\OO_X)_{x\in X}$ thus completely determines the
prescheme $X$ when $X$ is an integral scheme whose underlying space is
Noetherian.
\end{env}

\begin{envs}[Proposition]{8.2.7}
\label{prop-1.8.2.7}
Let $X,Y$ be two integral schemes, $f:X\to Y$ a dominant morphism
\sref{env}{2.2.6}, and $K$ (resp.$L$) the field of rational
functions on $X$ (resp.$Y$). Then $L$ can be identified with a subfield of
$K$, and for all $x\in X$, $\OO_{f(x)}$ is the unique local ring of $Y$ dominated
by $\OO_x$.
\end{envs}

In fact, if $f=(\psi,\theta)$ and $a$ is the generic point of $X$, then
$\psi(a)$ is the generic point of $Y$ \pref{env}{2.1.5}; $\theta_a^\sharp$ is then
a monomorphism of fields, from $L=\OO_{\psi(a)}$ to $K=\OO_a$. Since every
non-empty affine open $U$ of $Y$ contains $\psi(a)$, it follows from
\sref{env}{2.2.4} that the homomorphism $\Gamma(U,\OO_Y)\to\Gamma(\psi^{-1}(U),\OO_X)$
corresponding to $f$ is the restriction of $\theta_a^\sharp$ to $\Gamma(U,\OO_Y)$.
So, for every $x\in X$, $\theta_x^\sharp$ is the restriction to $\OO_{\psi(a)}$ of
$\theta_a^\sharp$, and is thus a monomorphism. We also know that $\theta_x^\sharp$ is a
local homomorphism, so, if we identify $L$ with a subfield of $K$ by
$\theta_a^\sharp$, $\OO_{\psi(x)}$ is dominated by $\OO_x$ \sref{lem}{8.1.1}; it is also
the only local ring of $Y$ dominated by $\OO_x$, since two local rings of $Y$
that are allied are identical \sref{prop}{8.2.2}.

\begin{envs}[Proposition]{8.2.8}
\label{prop-1.8.2.8}
Let $X$ be an \emph{irreducible} prescheme; and
$f:X\to Y$ a local immersion (\emph{resp.} a local isomorphism); and
suppose further that $f$ is separated. Then $f$ is an immersion (\emph{resp.}
an open immersion).
\end{envs}

Let $f=(\psi,\theta)$; it suffices, in both cases, to prove that $\psi$ is a
\emph{homeomorphism} from $X$ to $\psi(X)$ \sref{env}{4.5.3}. Replacing $f$ by
$f_\mathrm{red}$ (\sref{env}{5.1.6} and \sref{env}{5.5.1}, (vi)), we can assume that $X$
and $Y$ are \emph{reduced}. If $Y'$ is the closed reduced subprescheme of $Y$
having $\overline{\psi(X)}$ as its underlying space, then $f$ factorizes as
$X\xrightarrow{f'}Y'\xrightarrow{j}Y$, where $j$ is the canonical injection
\sref{env}{5.2.2}. It follows from (\sref{env}{5.5.1}, (v)) that $f'$ is again a
separated morphism; further, $f'$ is again
\oldpage{168}
a local immersion (resp. a local isomorphism), because, since the condition is local on $X$
and $Y$, we can reduce ourselves to the case where $f$ is a closed immersion (resp. open
immersion), and then our claim follows immediately from \sref{env}{4.2.2}.

We can thus suppose that $f$ is a \emph{dominant} morphism, which leads to the
fact that $Y$ is, itself, irreducible \pref{env}{2.1.5}, and so $X$ and $Y$
are both \emph{integral}. Further, the condition being local on $Y$, we can
suppose that $Y$ is an affine scheme; since $f$ is separated, $X$ is a scheme
(\sref{env}{5.5.1}, (ii)), and we are finally at the hypotheses of \sref{prop}{8.2.7}.
Then, for all $x\in X$, $\theta_x^\sharp$ is injective; but the hypothesis that $F$
is a local immersion implies that $\theta_x^\sharp$ is surjective \sref{env}{4.2.2}, so
$\theta_x^\sharp$ is bijective, or, equivalently (with the identification of
\sref{prop}{8.2.7}) we have that $\OO_{\psi(x)}=\OO_x$. This implies, by \sref{cor}{8.2.4},
that $\psi$ is an \emph{injective} map, which already proves the proposition
when $f$ is a local isomorphism \sref{env}{4.5.3}. When we suppose that $f$ is only
a local immersion, for all $x\in X$ there exists an open neighbourhood $U$ of
$x$ in $X$ and an open neighbourhood $V$ of $\psi(x)$ in $Y$ such that the
restriction of $\psi$ to $U$ is a homeomorphism from $U$ to a \emph{closed}
subset of $V$. But $U$ is dense in $X$, so $\psi(U)$ is dense in $Y$ and
\emph{a fortiori} in $V$, which proves that $\psi(U)=V$; since $\psi$ is
injective, $\psi^{-1}(V)=U$ and this proves that $\psi$ is a homeomorphism from
$X$ to $\psi(X)$.

\subsection{Chevalley schemes}
\label{1-schemes-8.3}

\begin{env}{8.3.1}
\label{env-1.8.3.1}
Let $X$ be a \emph{Noetherian} integral scheme, and $R$ its
field of rational functions; we denote by $X'$ the set of local subrings
$\OO_x\subset R$, where $x$ runs over all points of $X$. The set $X'$ verifies
the three following conditions:
\begin{enumerate}
  \item[(Sch.~1)] For all $M\in X'$, $R$ is the field of fractions of $M$.
  \item[(Sch.~2)] There exists a finite set of Noetherian subrings $A_i$ of $R$
  such that $X'=\bigcup_i L(A_i)$, and, for all pairs of indices $i,j$, the subring
  $A_{ij}$ of $R$ generated by $A_i\cup A_j$ is an algebra of finite type over $A_i$.
  \item[(Sch.~3)] Two elements $M$ and $N$ of $X'$ that are allied are identical.
\end{enumerate}
\end{env}

We have basically seen in \sref{env}{8.2.1} that (Sch.~1) is satisfied, and (Sch.~3)
follows from \sref{env}{8.2.2}. To show (Sch.~2), it suffices to cover $X$ by a
finite number of affine opens $U_i$, whose rings are Noetherian, and to take
$A_i=\Gamma(U_i,\OO_X)$; the hypothesis that $X$ is a scheme implies that
$U_i\cap U_j$ is affine, and also that $\Gamma(U_i\cap U_j,\OO_X)=A_{ij}$
\sref{env}{5.5.6}; further, since the space $U_i$ is Noetherian, the immersion
$U_i\cap U_j\to U_i$ is of finite type \sref{env}{6.3.5}, so $A_{ij}$ is an
$A_i$-algebra of finite type \sref{env}{6.3.3}.

\begin{env}{8.3.2}
\label{env-1.8.3.2}
The structures whose axioms are (Sch.~1), (Sch.~2), and
(Sch.~3), generalise ``schemes'' in the sense of C.~Chevalley, who supposes
furthermore that $R$ is an extension of finite type of a field $K$, and that the
$A_i$ are $K$-algebras of finite type (which renders a part of (Sch.~2) useless)
\cite{1}. Conversely, if we have such a structure on a set $X'$, then we can
associate to it an integral scheme $X$ by using the remarks from \sref{env}{8.2.6}:
the underlying space of $X$ is equal to $X'$ endowed with the topology defined
in \sref{env}{8.2.6}, and with the sheaf $\OO_X$ such that
$\Gamma(U,\OO_X)=\bigcap_{x\in U}\OO_x$ for all open $U\subset X$, with the
evident definition of restriction homomorphisms. We leave to the reader the
task of verifying that we obtain thusly an integral scheme, whose local rings
are the elements of $X'$; we will not use this result in what follows.
\end{env}

\section{Supplement on quasicoherent sheaves}
\label{1-schemes-9}

\subsection{Tensor product of quasicoherent sheaves}
\label{1-schemes-9.1}

\begin{envs}[Proposition]{9.1.1}
\label{prop-1.9.1.1}
\oldpage{169}
Let $X$ be a prescheme (\emph{resp.} a locally Noetherian prescheme). Let $\sh{F}$ and
$\sh{G}$ be two quasicoherent (\emph{resp.} coherent) $\OO_X$-modules; then
$\sh{F}\otimes_{\OO_X}\sh{G}$ is quasicoherent (\emph{resp.} coherent) and
of finite type if $\sh{F}$ and $\sh{G}$ are of finite type. If
$\sh{F}$ admits a finite presentation and if $\sh{G}$ is quasicoherent
(\emph{resp.} coherent), then $\shHom(\sh{F},\sh{G})$ is quasicoherent
(\emph{resp.} coherent).
\end{envs}

Being a local property, we can suppose that $X$ is affine (resp. Noetherian
affine); further, if $\sh{F}$ is coherent, then we can assume that it is the
cokernel of a homomorphism $\OO_X^m\to\OO_X^n$. The claims pertaining to
quasicoherent sheaves then follow from \sref{env}{1.3.12} and \sref{env}{1.3.9}; the
claims pertaining to coherent sheaves follow from \sref{env}{1.5.1} and from the fact
that, if $M$ and $N$ are modules of finite type over a Noetherian ring $A$,
$M\otimes_A N$ and $\Hom_A(M,N)$ are $A$-modules of finite type.

\begin{envs}[Definition]{9.1.2}
\label{defn-1.9.1.2}
Let $X$ and $Y$ be two $S$-preschemes, $p$ and
$q$ the projections of $X\times_S Y$, and $\sh{F}$ (resp.$\sh{G}$) a
quasicoherent $\OO_X$-module (resp. quasicoherent $\OO_Y$-module). We define the
tensor product of $\sh{F}$ and $\sh{G}$ over $\OO_S$ (\emph{or} over $S$),
denoted by $\sh{F}\otimes_{\OO_S}\sh{G}$ (\emph{or}
$\sh{F}\otimes_S\sh{G}$) to be the tensor product
$p^*(\sh{F})\otimes_{\OO_{X\times_S Y}}q^*(\sh{G})$ over the
prescheme $X\times_S Y$.
\end{envs}

If $X_i$ ($1\leqslant i\leqslant n$) are $S$-preschemes, and $\sh{F}_i$ are quasicoherent
$\OO_{X_i}$-modules ($1\leqslant i\leqslant n$), then we define similarly the tensor product
$\sh{F}_1\otimes_S\sh{F}_2\otimes_S\cdots\otimes_S\sh{F}_n$ over the
prescheme $Z=X_1\times_S X_2\times_S\cdots\times_S X_n$; it is a
\emph{quasicoherent} $\OO_Z$-module by virtue of \sref{prop}{9.1.1} and
\pref{env}{5.1.4}; it is \emph{coherent} if the $\sh{F}_i$ are coherent and
$Z$ is \emph{locally Noetherian}, by virtue of \sref{prop}{9.1.1},
\pref{env}{5.3.11}, and \sref{env}{6.1.1}.

Note that if we take $X=Y=S$ then definition \sref{defn}{9.1.2} gives us back the tensor
product of $\OO_S$-modules. Furthermore, as $q^*(\OO_Y)=\OO_{X\times_S Y}$
\pref{env}{4.3.4}, the product $\sh{F}\otimes_S\OO_Y$ is canonically
identified with $p^*(\sh{F})$, and, in the same way,
$\OO_X\otimes_S\sh{G}$ is canonically identified with $q^*(\sh{G})$. In
particular, if we take $Y=S$ and denote by $f$ the structure morphism $X\to Y$,
we have that $\OO_X\otimes_Y\sh{G}=f^*(\sh{G})$: the ordinary tensor
product and the inverse image thus appear as particular cases of the general
tensor product.

Definition \sref{defn}{9.1.2} leads immediately to the fact that, for fixed $X$ and
$Y$, $\sh{F}\otimes_S\sh{G}$ is an \emph{additive covariant bifunctor that
is right-exact} in $\sh{F}$ and $\sh{G}$.

\begin{envs}[Proposition]{9.1.3}
\label{prop-1.9.1.3}
Let $S$, $X$, $Y$ be three affine schemes of rings
$A$, $B$, $C$ (respectively), with $B$ and $C$ being $A$-algebras. Let $M$
(\emph{resp.} $N$) be a $B$-module (\emph{resp.} $C$-module), and
$\sh{F}=\widetilde{M}$ (\emph{resp.} $\sh{G}=\widetilde{N}$) the
associated quasicoherent sheaf; then $\sh{F}\otimes_S\sh{G}$ is
canonically isomorphic to the sheaf associated to the $(B\otimes_A C)$-module
$M\otimes_A N$.
\end{envs}

\oldpage{170}
In fact, by virtue of \sref{env}{1.6.5}, $\sh{F}\otimes_S\sh{G}$
is canonically isomorphic to the sheaf associated to the $(B\otimes_A C)$-module
\[
  \big(M\otimes_B(B\otimes_A C)\big)\otimes_{B\otimes_A C}\big((B\otimes_A C)\otimes_C N\big)
\]
and by the canonical isomorphisms between tensor
products, this latter module is isomorphic to
\[
  M\otimes_B(B\otimes_A C)\otimes_C N=(M\otimes_B B)\otimes_A(C\otimes_C N)=M\otimes_A N.
\]

\begin{envs}[Proposition]{9.1.4}
\label{prop-1.9.1.4}
Let $f:T\to X$, and $g:T\to Y$ be
two $S$-morphisms, and $\sh{F}$ (\emph{resp.} $\sh{G}$) a quasicoherent
$\OO_X$-module (\emph{resp.} quasicoherent $\OO_Y$-module). Then
\[
  (f,g)^*_S(\sh{F}\otimes_S\sh{G})=f^*(\sh{F})\otimes_{\OO_T}g^*(\sh{G}).
\]
\end{envs}

If $p,q$ are the projections of $X\times_S Y$, then the formula in fact follows
from the relations $(f,g)^*_S\circ p^*=f^*$ and
$(f,g)^*_S\circ q^*=g^*$ \pref{env}{3.5.5}, and the fact that the inverse
image of a tensor product of algebraic sheaves is the tensor product of their inverse
images \pref{env}{4.3.3}.

\begin{envs}[Corollary]{9.1.5}
\label{cor-1.9.1.5}
Let $f:X\to X'$ and $g:Y\to Y'$ be
$S$-morphisms, and $\sh{F}'$ (\emph{resp.} $\sh{G}'$) a quasicoherent
$\OO_{X'}$-module (\emph{resp.} quasicoherent $\OO_{Y'}$-module). Then
\[
  (f,g)^*_S(\sh{F}'\otimes_S\sh{G}')=f^*(\sh{F}')\otimes_S g^*(\sh{G}')
\]
\end{envs}

This follows from \sref{env}{9.1.4} and the fact that $f\times_S g=(f\circ p, g\circ q)_S$,
where $p,q$ are the projections of $X\times_S Y$.

\begin{envs}[Corollary]{9.1.6}
\label{cor-1.9.1.6}
Let $X,Y,Z$ be three $S$-preschemes, and $\sh{F}$ (\emph{resp.} $\sh{G},\sh{H}$) a
quasicoherent $\OO_X$-module (\emph{resp.} quasicoherent $\OO_Y$-module, quasicoherent
$\OO_Z$-module); then the sheaf $\sh{F}\otimes_S\sh{G}\otimes_S\sh{H}$ is the inverse image
of $(\sh{F}\otimes_S\sh{G})\otimes_S\sh{H}$ by the canonical isomorphism from
$X\times_S Y\times_S Z$ to $(X\times_S Y)\times_S Z$.
\end{envs}

In fact, this isomorphism is given by $(p_1,p_2)_S\times_S p_3$, where $p_1$, $p_2$, $p_3$
are the projections of $X\times_S Y\times_S Z$.

Similarly, the inverse image of $\sh{G}\otimes_S\sh{F}$ by the canonical isomorphism from
$X\times_S Y$ to $Y\times_S X$ is $\sh{F}\otimes_S\sh{G}$.

\begin{envs}[Corollary]{9.1.7}
\label{cor-1.9.1.7}
If $X$ is an $S$-prescheme, then every quasicoherent $\OO_X$-module $\sh{F}$ is the inverse
image of $\sh{F}\otimes_S\OO_S$ by the canonical isomorphism from $X$ to $X\times_S S$
\sref{env}{3.3.3}.
\end{envs}

In fact, this isomorphism is $(1_X,\vphi)_S$, where $\vphi$ is the structure morphism
$X\to S$, and the corollary follows from \sref{env}{9.1.4} and the fact that
$\vphi^*(\OO_S)=\OO_X$.

\begin{env}{9.1.8}
\label{env-1.9.1.8}
Let $X$ be an $S$-prescheme, $\sh{F}$ a quasicoherent
$\OO_X$-module, and $\vphi:S'\to S$ a morphism; we denote by
$\sh{F}_{(\vphi)}$ or $\sh{F}_{(S')}$ the quasicoherent sheaf
$\sh{F}\otimes_S\OO_{S'}$ over $X\times_S S'=X_{(\vphi)}=X_{(S')}$; so
$\sh{F}_{(S')}=p^*(\sh{F})$, where $p$ is the projection $X_{(S')}\to X$.
\end{env}

\begin{envs}[Proposition]{9.1.9}
\label{prop-1.9.1.9}
Let $\vphi'':S''\to S'$ be a morphism.
For every quasicoherent $\OO_X$-module $\sh{F}$ on the $S$-prescheme $X$,
$(\sh{F}_{(\vphi)})_{(\vphi')}$ is the inverse image of
$\sh{F}_{(\vphi\circ\vphi')}$ by the canonical isomorphism
$(X_{(\vphi)})_{(\vphi')}\isoto X_{(\vphi\circ\vphi')}$
\sref{env}{3.3.9}.
\end{envs}

This follows immediately from the definitions and from \sref{env}{3.3.9}, and is
written
\[
  (\sh{F}\otimes_S\OO_{S'})\otimes_{S'}\OO_{S''}=\sh{F}\otimes_S\OO_{S''}.
  \tag{9.1.9.1}
\]

\begin{envs}[Proposition]{9.1.10}
\label{prop-1.9.1.10}
Let $Y$ be an $S$-prescheme, and $f:X\to Y$ an $S$-morphism.
For every quasicoherent $\OO_Y$-module and every morphism
$S'\to S$, we have that
$(f_{(S')})^*(\sh{G}_{(S')})=(f^*(\sh{G}))_{(S')}$.
\end{envs}

This follows immediately from the commutativity of the diagram
\oldpage{171}
\[
  \xymatrix{
    X_{(S')}\ar[r]^{f_{(S')}}\ar[d] & Y_{(S')}\ar[d]\\
    X\ar[r]^f & Y.
  }
\]

\begin{envs}[Corollary]{9.1.11}
\label{cor-1.9.1.11}
Let $X$ and $Y$ be $S$-preschemes, and
$\sh{F}$ (\emph{resp.} $\sh{G}$) a quasicoherent $\OO_X$-module
(\emph{resp.} quasicoherent $\OO_Y$-module). Then the inverse image of the sheaf
$(\sh{F}_{(S')})\otimes_{(S')}(\sh{G}_{(S')})$ by the canonical isomorphism
$(X\times_S Y)_{(S')}\isoto(X_{(S')})\times_{S'}(Y_{(S')})$
\sref{env}{3.3.10} is equal to $(\sh{F}\otimes_S\sh{G})_{(S')}$.
\end{envs}

If $p,q$ are the projections of $X\times_S Y$, then the isomorphism in question
is nothing but $(p_{(S')}, q_{(S')})_{S'}$; the corollary follows from
propositions \sref{env}{9.1.4} and \sref{env}{9.1.10}.

\begin{envs}[Proposition]{9.1.12}
\label{prop-1.9.1.12}
With the notation from \sref{defn}{9.1.2}, let $z$ be
a point of $X\times_S Y$, $x=p(z)$, and $y=q(z)$; the fibre
$(\sh{F}\otimes_S\sh{G})_z$ is isomorphic to
$(\sh{F}_x\otimes_{\OO_x}\OO_z)\otimes_{\OO_z}(\sh{G}_y\otimes_{\OO_y}\OO_z)
=\sh{F}_x\otimes_{\OO_x}\OO_z\otimes_{\OO_y}\otimes\sh{G}_y$.
\end{envs}

As we can reduce ourselves to the affine case, the proposition follows from
equation (1.6.5.1).

\begin{envs}[Corollary]{9.1.13}
\label{cor-1.9.1.13}
If $\sh{F}$ and $\sh{G}$ are of finite type, then we have that
\[
  \Supp(\sh{F}\otimes_S\sh{G})=p^{-1}(\Supp(\sh{F}))\cap q^{-1}(\Supp(\sh{G})).
\]
\end{envs}

Since $p^*(\sh{F})$ and $q^*(\sh{G})$ are both of finite type over
$\OO_{X\times_S Y}$, we are reduced, by \sref{env}{9.1.12} and \pref{env}{1.7.5}, to
the case where $\sh{G}=\OO_Y$, that is, it remains to prove the following
equation:
\[
  \Supp(p^{-1}(\sh{F}))=p^{-1}(\Supp(\sh{F})).
  \tag{9.1.13.1}
\]

The same reasoning as in \pref{env}{1.7.5} leads us to prove that, for all
$z\in X\times_S Y$, we have $\OO_z/\mathfrak{m}_x\OO_z\neq0$ (with $x=p(z)$),
which follows from the fact that the homomorphism $\OO_x\to\OO_z$ is \emph{local},
by hypothesis.

We leave it to the reader to extend the results in this section to the more
general case of arbitrarily (but finitely) many factors, instead of just two.

\subsection{Direct image of a quasicoherent sheaf}
\label{1-schemes-9.2}

\begin{envs}[Proposition]{9.2.1}
\label{prop-1.9.2.1}
Let $f:X\to Y$ be a morphism of
preschemes. We suppose that there exists a cover $(Y_\alpha)$ of $Y$ by affine
opens having the following property: every $f^{-1}(Y_\alpha)$ admits a
\emph{finite} cover $(X_{\alpha i})$ by affine opens contained in
$f^{-1}(Y_\alpha)$ such that every intersection $X_{\alpha i}\cap X_{\alpha j}$
is itself a \emph{finite} union of affine opens. With these hypotheses, for
every quasicoherent $\OO_X$-module $\sh{F}$, $f_*(\sh{F})$ is a
quasicoherent $\OO_Y$-module.
\end{envs}

Since this is a local condition on $Y$, we can assume that $Y$ is equal to one
of the $Y_\alpha$, and thus omit the indices $\alpha$.

\begin{enumerate}[label=(\alph*)]
  \item First, suppose that the $X_i\cap X_j$
        are themselves \emph{affine} opens. We set $\sh{F}_i=\sh{F}|X_i$ and
        $\sh{F}_{ij}=\sh{F}|(X_i\cap X_j)$, and let $\sh{F}'_i$ and
        $\sh{F}'_{ij}$ be the images of $\sh{F}_i$ and $\sh{F}_{ij}$
        (respectively) by the restriction of $f$ to $X_i$ and $X_i\cap X_j$
        (respectively); we know that the $\sh{F}'_i$ and $\sh{F}'_{ij}$ are
        quasicoherent \sref{env}{1.6.3}. Set $\sh{G}=\bigoplus_i\sh{F}'_i$ and
        $\sh{H}=\bigoplus_{i,j}\sh{F}'_{ij}$; $\sh{G}$ and $\sh{H}$ are
        quasicoherent $\OO_Y$-modules; we will define a homomorphism
        $u:\sh{G}\to\sh{H}$ such that $f_*(\sh{F})$ is the
        \emph{kernel} of $u$; it will follow from this that $f_*(\sh{F})$ is
        quasicoherent \sref{env}{1.3.9}. It suffices to define $u$ as
\oldpage{172}
        a homomorphism of presheaves; taking into account the definitions of $\sh{G}$
        and $\sh{H}$, it thus suffices, for every open subset $W\subset Y$, to define a
        homomorphism
        \[
          u_W:\bigoplus_i\Gamma(f^{-1}(W)\cap X_i,\sh{F})
          \longrightarrow\bigoplus_{i,j}\Gamma(f^{-1}(W)\cap X_i\cap X_j,\sh{F})
        \]
        in such a way that it satisfies the usual compatibility conditions when $W$
        varies. If, for every section $s_i\in\Gamma(f^{-1}(W)\cap X_i,\sh{F})$, we
        denote by $s_{i|j}$ the restriction to $f^{-1}(W)\cap X_i\cap X_j$, then we set
        \[
          u_W\big((s_i)\big)=(s_{i|j}-s_{j|i})
        \]
        and the compatibility conditions are clearly satisfied. To prove that the kernel
        $\sh{R}$ of $u$ is $f_*(\sh{F})$, we define a homomorphism from $f_*(\sh{F})$ to
        $\sh{R}$ by sending each section $s\in\Gamma(f^{-1}(W),\sh{F})$ to the family
        $(s_i)$, where $s_i$ is the restriction of $s$ to $f^{-1}(W)\cap X_i$; the
        axioms (F1) and (F2) of sheaves (G, II, 1.1) tell us that this homomorphism is
        \emph{bijective}, which finishes the proof in this case.
  \item In the general case, the same reasoning applies once we have established that
        the $\sh{F}_{ij}$ are quasicoherent. But, by hypothesis, $X_i\cap X_j$ is a
        finite union of affine opens $X_{ijk}$; and since the $X_{ijk}$ are affine opens
        \emph{in a scheme}, the intersection of any two of them is again an affine open
        \sref{env}{5.5.6}. We are thus led to the first case, and so we have proved
        \sref{env}{9.2.1}.
\end{enumerate}

\begin{envs}[Corollary]{9.2.2}
\label{cor-1.9.2.2}
The conclusion of \sref{prop}{9.2.1} holds true in each of the following cases:
\begin{enumerate}[label=\rm{(\alph*)}]
  \item $f$ is separated and quasicompact.
  \item $f$ is separated and of finite type.
  \item $f$ is quasicompact and the underlying space of $X$ is locally Noetherian.
\end{enumerate}
\end{envs}

In case \emph{(a)}, the $X_{\alpha i}\cap X_{\alpha j}$ are affine \sref{env}{5.5.6}.
Case \emph{(b)} is a particular case of \emph{(a)} \sref{env}{6.6.3}. Finally, in case
\emph{(c)}, we can reduce to the case where $Y$ is affine and the underlying
space of $X$ is Noetherian; then $X$ admits a finite cover of affine opens
$(X_i)$, and the $X_i\cap X_j$, being quasicompact, are finite unions of affine
opens \sref{prop}{2.1.3}.

\subsection{Extension of sections of quasicoherent sheaves}
\label{1-schemes-9.3}

\begin{envs}[Theorem]{9.3.1}
\label{thm-1.9.3.1}
Let $X$ be a prescheme whose underlying space is Noetherian, or a scheme whose underlying
space is quasicompact. Let $\sh{L}$ be an invertible $\OO_X$-module \pref{env}{5.4.1}, $f$ a
section of $\sh{L}$ over $X$, $X_f$ the open set of $x\in X$ such that $f(x)\neq0$
\pref{env}{5.5.1}, and $\sh{F}$ a quasicoherent $\OO_X$-module.
\begin{enumerate}[label=\rm{(\roman*)}]
  \item If $s\in\Gamma(X,\sh{F})$ is such that $s|X_f=0$, then there exists an integer $n>0$
        such that $s\otimes f^{\otimes n}=0$.
  \item For every section $s\in\Gamma(X_f,\sh{F})$, there exists an integer $n>0$ such that
        $s\otimes f^{\otimes n}$ extends to a section of $\sh{F}\otimes\sh{L}^{\otimes n}$
        over $X$.
\end{enumerate}
\end{envs}

\begin{enumerate}[label=(\roman*)]
  \item Since the underlying space of $X$ is quasicompact, and thus the union of
        finitely-many affine opens $U_i$ with $\sh{L}|U_i$ is isomorphic to
        $\OO_X|U_i$, we can reduce to the case where $X$ is affine and $\sh{L}=\OO_X$.
        In this case, $f$ is identified with an element of $A(X)$, and we have that
        $X_f=D(f)$; $s$ is identified with an element of an $A(X)$-module $M$, and
        $s|X_f$ to the corresponding element of $M_f$, and the result is then trivial,
        recalling the definition of a module of fractions.
\oldpage{173}
  \item Again, $X$ is a finite union of affine opens $U_i$ ($1\leqslant i\leqslant r$)
        such that $\sh{L}|U_i\cong\OO_X|U_i$, and for every $i$,
        $(s\otimes f^{\otimes n})|(U_i\cap X_f)$ is identified (by the aforementioned
        isomorphism) with $(f|(U_i\cap X_f))^n(s|(U_i\cap X_f))$. We then know
        \sref{env}{1.4.1} that there exists an integer $n>0$ such that, for all
        $i$, $(s\otimes f^{\otimes n})|(U_i\cap X_f)$ extends to a section $s_i$ of
        $\sh{F}\otimes\sh{L}^{\otimes n}$ over $U_i$. Let $s_{i|j}$ be the restriction
        of $s_i$ to $U_i\cap U_j$; by definition we have that $s_{i|j}-s_{j|i}=0$ in
        $X_f\cap U_i\cap U_j$. But, if $X$ is a Noetherian space, then $U_i\cap U_j$ is
        quasicompact; if $X$ is a scheme, then $U_i\cap U_j$ is an affine open
        \sref{env}{5.5.6}, and so again quasicompact. By virtue of (i), there thus
        exists an integer $m$ (independent of $i$ and $j$) such that
        $(s_{i|j}-s_{j|i})\otimes f^{\otimes m}=0$. It immediately follows that there
        exists a section $s'$ of $\sh{F}\otimes\sh{L}^{\otimes(n+m)}$ over $X$,
        restricting to $s_i\otimes f^{\otimes m}$ over each $U_i$, and restricting to
        $s\otimes f^{\otimes(n+m)}$ over $X_f$.
\end{enumerate}

The following corollaries give an interpretation of theorem \sref{env}{9.3.1} in a more
algebraic language:
\begin{envs}[Corollary]{9.3.2}
\label{cor-1.9.3.2}
With the hypotheses of \sref{thm}{9.3.1}, consider the graded ring $A_*=\Gamma_*(\sh{L})$
and the graded $A_*$-module $M_*=\Gamma_*(\sh{L},\sh{F})$ \pref{env}{5.4.6}. If $f\in A_n$,
where $n\in\bb{Z}$, then there is a canonical isomorphism
$\Gamma(X_f,\sh{F})\isoto((M_*)_f)_0$ (\emph{the subgroup of the module of
fractions $(M_*)_f$ consisting of elements of degree $0$}).
\end{envs}

\begin{envs}[Corollary]{9.3.3}
\label{cor-1.9.3.3}
Suppose that the hypotheses of \sref{thm}{9.3.1} are satisfied, and suppose further that
$\sh{L}=\OO_X$. Then, setting $A=\Gamma(X,\OO_X)$ and $M=\Gamma(X,\sh{F})$, the $A_f$-module
$\Gamma(X_f,\sh{F})$ is canonically isomorphic to $M_f$.
\end{envs}

\begin{envs}[Proposition]{9.3.4}
\label{prop-1.9.3.4}
Let $X$ be a Noetherian prescheme, $\sh{F}$ a coherent $\OO_X$-module, and $\sh{J}$ a
coherent sheaf of ideals in $\OO_X$, such that the support of $\sh{F}$ is contained in that
of $\OO_X|\sh{J}$. Then there exists a whole number $n>0$ such that $\sh{J}^n\sh{F}=0$.
\end{envs}

Since $X$ is a union of finitely-many affine opens whose rings are Noetherian, we can suppose
that $X$ is affine of Noetherian ring $A$; then $\sh{F}=\widetilde{M}$, where
$M=\Gamma(X,\sh{F})$ is an $A$-module of finite type, and $\sh{J}=\widetilde{\mathfrak{J}}$,
where $\mathfrak{J}=\Gamma(X,\sh{J})$ is an ideal of $A$ (\sref{env}{1.4.1} and
\sref{env}{1.5.1}). Since $A$ is Noetherian, $\mathfrak{J}$ admits a finite system of
generators $f_i$ ($1\leqslant i\leqslant m$). By hypothesis, every section of $\sh{F}$ over
$X$ is zero in each of the $D(f_i)$; if $s_j$ ($1\leqslant j\leqslant q$) are sections of
$\sh{F}$ generating $M$, then there exists a whole number $h$, independent of $i$ and $j$,
such that $f_i^h s_j=0$ \sref{env}{1.4.1}, whence $f_i^h s=0$ for all $s\in M$. We thus
conclude that if $n=mh$ then $\mathfrak{J}^n M=0$, and so the corresponding $\OO_X$-module
$\sh{J}^n\sh{F}=\widetilde{\mathfrak{J}^n M}$ \sref{env}{1.3.13} is zero.

\begin{envs}[Corollary]{9.3.5}
\label{cor-1.9.3.5}
With the hypotheses of \sref{prop}{9.3.4}, there exists a closed subprescheme $Y$ of $X$,
whose underlying space is the support of $\OO_X/\sh{J}$, such that, if $j:Y\to X$ is the
canonical injection, then $\sh{F}=j_*(j^*(\sh{F}))$.
\end{envs}

First of all, note that the supports of $\OO_X/\sh{J}$ and $\OO_X/\sh{J}^n$ are the same,
since, if $\sh{J}_x=\OO_x$, then $\sh{J}_x^n=\OO_x$, and we also have that
$\sh{J}_x^n\subset\sh{J}_x$ for all $x\in X$. We can, thanks to \sref{prop}{9.3.4}, thus
suppose that $\sh{J}\sh{F}=0$; we can then take $Y$ to be the closed subprescheme of $X$
defined by $\sh{J}$, and since $\sh{F}$ is then an $(\OO_X/\sh{J})$-module, the conclusion
follows immediately.

\subsection{Extension of quasicoherent sheaves}
\label{1-schemes-9.4}        

\begin{env}{9.4.1}
\label{env-1.9.4.1}
Let
\oldpage{174}
$X$ be a topological space, $\sh{F}$ a sheaf of sets (resp. of groups, of rings) on $X$, $U$
an open subset of $X$, $\psi:U\to X$ the canonical injection, and $\sh{G}$ a subsheaf of
$\sh{F}|U=\psi^*(\sh{F})$. Since $\psi_*$ is left exact, $\psi_*(\sh{G})$ is a subsheaf of
$\psi_*(\psi^*(\sh{F}))$; if we denote by $\rho$ the canonical homomorphism
$\sh{F}\to\psi_*(\psi^*(\sh{F}))$ \pref{env}{3.5.3}, then we denote by $\overline{\sh{G}}$
the subsheaf $\rho^{-1}(\psi_*(\sh{G}))$ of $\sh{F}$. It follows immediately from the
definitions that, for every open subset $V$ of $X$, $\Gamma(V,\overline{\sh{G}})$ consists of
sections $s\in\Gamma(V,\sh{F})$ whose restriction to $V\cap U$ is a section of $\sh{G}$ over
$V\cap U$. We thus have that $\overline{\sh{G}}|U=\psi^*(\overline{\sh{G}})=\sh{G}$, and that
$\overline{\sh{G}}$ is the \emph{biggest} subsheaf of $\sh{F}$ that restricts to $\sh{G}$
over $U$; we say that $\overline{\sh{G}}$ is the \emph{canonical extension} of the subsheaf
$\sh{G}$ of $\sh{F}|U$ to a subsheaf of $\sh{F}$.
\end{env}

\begin{envs}[Proposition]{9.4.2}
\label{prop-1.9.4.2}
Let $X$ be a prescheme, $U$ an open subset of $X$ such that the canonical injection
$j:U\to X$ is a quasicompact morphism \emph{(which will be the case for \emph{all} $U$ if the
underlying space of $X$ is \emph{locally Noetherian} {\normalfont(\sref{env}{6.6.4}, (i))})}.
Then:
\begin{enumerate}[label=\rm{(\roman*)}]
  \item For every quasicoherent $(\OO_X|U)$-module $\sh{G}$, $j_*(\sh{G})$
        is a quasicoherent $\OO_X$-module, and $j_*(\sh{G})|U=j^*(j_*(\sh{G}))=\sh{G}$.
  \item For every quasicoherent $\OO_X$-module $\sh{F}$ and every quasicoherent
        $(\OO_X|U)$-submodule $\sh{G}$, the canonical extension
        $\overline{\sh{G}}$ of $\sh{G}$ \sref{env}{9.4.1} is a
        quasicoherent $\OO_X$-submodule of $\sh{F}$.
\end{enumerate}
\end{envs}

If $j=(\psi,\theta)$ ($\psi$ being the injection $U\to X$ of underlying spaces), then by
definition we have that $j_*(\sh{G})=\psi_*(\sh{G})$ for every $(\OO_X|U)$-module $\sh{G}$,
and, further, that $j^*(\sh{H})=\psi^*(\sh{H})=\sh{H}|U$ for every $\OO_X$-module $\sh{H}$,
by definition of the prescheme induced over an open subset. So (i) is thus a particular case
of (\sref{env}{9.2.2}, (a)); for the same reason, $j_*(j^*(\sh{F}))$ is quasicoherent, and
since $\overline{\sh{G}}$ is the inverse image of $j_*(\sh{G})$ by the homomorphism
$\rho:\sh{F}\to j_*(j^*(\sh{F}))$, (ii) follows from \sref{env}{4.1.1}.
 
Note that the hypothesis that the morphism $j:U\to X$ is quasicompact
holds whenever the open subset $U$ is \emph{quasicompact} and $X$ is a
\emph{scheme}: indeed, $U$ is then a union of finitely-many affine opens $U_i$,
and for every affine open $V$ of $X$, $V\cap U_i$ is an affine open \sref{env}{5.5.6}, and
thus quasicompact.
 
\begin{envs}[Corollary]{9.4.3}
\label{cor-1.9.4.3}
Let $X$ be a prescheme, $U$ a quasicompact open subset of $X$ such that the injection
morphism $j:U\to X$ is quasicompact. Suppose as well that every quasicoherent $\OO_X$-module
is the inductive limit of its quasicoherent $\OO_X$-submodules of finite type \emph{(which
will be the case if $X$ is an \emph{affine scheme})}. Then let $\sh{F}$ be a quasicoherent
$\OO_X$-module, and $\sh{G}$ a quasicoherent $(\OO_X|U)$-submodule \emph{of finite type} of
$\sh{F}|U$.Then there exists a quasicoherent $\OO_X$-submodule $\sh{G}'$ of $\sh{F}$ \emph{of
finite type} such that $\sh{G}'|U=\sh{G}$.
\end{envs}
 
Indeed, we have $\sh{G}=\overline{\sh{G}}|U$, and $\overline{\sh{G}}$ is quasicoherent, from
\sref{prop}{9.4.2}, and so the inductive limit of its quasicoherent $\OO_X$-submodules
$\sh{H}_\lambda$ of finite type. It follows that $\sh{G}$ is the inductive limit of the
$\sh{H}_\lambda|U$, and thus equal to one of the $\sh{H}_\lambda|U$ since it is of finite
type \pref{env}{5.2.3}.
 
\begin{env}[Remark]{9.4.4}
\label{rmk-1.9.4.4}
Suppose that for \emph{every} affine open $U\subset X$, the injection morphism $U\to X$ is
quasicompact. Then, if the conclusion of \sref{cor}{9.4.3} holds for every affine open $U$
and every quasicoherent $(\OO_X|U)$-submodule $\sh{G}$ of $\sh{F}|U$ of finite type, it
follows
\oldpage{175}
that $\sh{F}$ is the inductive limit of its quasicoherent $\OO_X$-submodules of finite type.
Indeed, for every affine open $U\subset X$, we have that $\sh{F}|U=\widetilde{M}$, where $M$
is an $A(U)$-module, and since the latter is the inductive limit of its quasicoherent
submodules of finite type, $\sh{F}|U$ is the inductive limit of its $(\OO_X|U)$-submodules of
finite type \sref{env}{1.3.9}. But, by hypothesis, each of
these submodules is induced on $U$ by a quasicoherent $\OO_X$-submodule
$\sh{G}_{\lambda,U}$ of $\sh{F}$ of finite type.The finite sums of the
$\sh{G}_{\lambda,U}$ are again quasicoherent $\OO_X$-modules of finite type,
because the property is local, and the case where $X$ is affine was covered in
\sref{env}{1.3.10}; it is clear then that $\sh{F}$ is the inductive limit of these
finite sums, whence our claim.
\end{env}
 
\begin{envs}[Corollary]{9.4.5}
\label{cor-1.9.4.5}
Under the hypotheses of \sref{cor}{9.4.3}, for every quasicoherent $(\OO_X|U)$-module
$\sh{G}$ of finite type, there exists a quasicoherent $\OO_X$-module
$\sh{G}'$ of finite type such that $\sh{G}'|U=\sh{G}$.
\end{envs}

Since $\sh{F}=j_*(\sh{G})$ is quasicoherent \sref{prop}{9.4.2} and
$\sh{F}|U=\sh{G}$, it suffices to apply \sref{cor}{9.4.3} to $\sh{F}$.

\begin{envs}[Lemma]{9.4.6}
\label{lem-1.9.4.6}
Let $X$ be a prescheme, $L$ a well-ordered set, $(V_\lambda)_{\lambda\in L}$ a cover of $X$
by affine opens, and $U$ an open subset of $X$; for all $\lambda\in L$, we set
$W_\lambda=\bigcup_{\mu<\lambda}V_\mu$. Suppose that: (1) for every $\lambda\in L$,
$V_\lambda\cap W_\lambda$ is quasicompact; (2) the immersion morphism $U\to X$ is
quasicompact. Then, for every quasicoherent $\OO_X$-module $\sh{F}$ and every quasicoherent
$(\OO_X|U)$-submodule $\sh{G}$ of $\sh{F}|U$ \emph{of finite type}, there exists a
quasicoherent $\OO_X$-submodule $\sh{G}'$ of $\sh{F}$ \emph{of finite type} such that
$\sh{G}'|U=\sh{G}$.
\end{envs}

Let $U_\lambda=U\cup W_\lambda$; we will define a family $(\sh{G}'_\lambda)$
by recurrence, where $\sh{G}'_\lambda$ is a quasicoherent
$(\OO_X|U_\lambda)$-submodule of $\sh{F}|U_\lambda$ of finite type, such that
$\sh{G}'_\lambda|U_\mu=\sh{G}'_\mu$ for $\mu<\lambda$ and
$\sh{G}'_\lambda|U=\sh{G}$. The unique $\OO_X$-submodule $\sh{G}'$ of
$\sh{F}$ such that $\sh{G}'|U_\lambda=\sh{G}'$ for all $\lambda\in L$
\pref{env}{3.3.1} gives us what we want. So suppose that the $\sh{G}'_\mu$
are defined and have the preceding properties for $\mu<\lambda$; if $\lambda$
does not have a predecessor then we take for $\sh{G}'_\lambda$ the unique
$(\OO_X|U_\lambda)$-submodule of $\sh{F}|U_\lambda$ such that
$\sh{G}'_\lambda|U_\mu=\sh{G}'_\mu$ for all $\mu<\lambda$, which is
allowed since the $U_\mu$ with $\mu<\lambda$ then form a cover of $U_\lambda$.
If, conversely, $\lambda=\mu+1$, then $U_\lambda=U_\mu\cup V_\mu$, and it
suffices to define a quasicoherent $(\OO_X|V_\mu)$-submodule $\sh{G}''_\mu$
of $\sh{F}|V_\mu$ of finite type such that
\[
  \sh{G}''_\mu|(U_\mu\cap V_\mu)=\sh{G}'_\mu|(U_\mu\cap V_\mu);
\]
and then to take for $\sh{G}'_\lambda$ the
$(\OO_X|U_\lambda)$-submodule of $\sh{F}|U_\lambda$ such that
$\sh{G}'_\lambda|U_\mu=\sh{G}'_\mu$ and
$\sh{G}'_\lambda|V_\mu=\sh{G}''_\mu$ \pref{env}{3.3.1}. But, since
$V_\mu$ is affine, the existence of $\sh{G}''_\mu$ is guaranteed by \sref{cor}{9.4.3}
as soon as we show that $U_\mu\cap V_\mu$ is quasicompact; but $U_\mu\cap V_\mu$
is the union of $U\cap V_\mu$ and $W_\mu\cap V_\mu$, which are both
quasicompact by virtue of the hypothesis.

\begin{envs}[Theorem]{9.4.7}
\label{thm-1.9.4.7}
Let $X$ be a prescheme, and $U$ an open of $X$.
Suppose that one of the following conditions is verified:
\begin{enumerate}[label=\rm{(\alph*)}]
  \item the underlying space of $X$ is locally Noetherian;
  \item $X$ is a quasicompact scheme and $U$ is a quasicompact open.
\end{enumerate}
Then, for every quasicoherent $\OO_X$-module $\sh{F}$ and every quasicoherent
$(\OO_X|U)$-submodule $\sh{G}$ of $\sh{F}|U$ \emph{of finite type}, there exists a
quasicoherent $\OO_X$-submodule $\sh{G}'$ of $\sh{F}$ \emph{of finite type}
such that $\sh{G}'|U=\sh{G}$.
\end{envs}

Let
\oldpage{176}
$(V_\lambda)_{\lambda\in L}$ be a cover of $X$ by affine opens,
with $L$ supposed finite in case (b); since $L$ is equipped with the
structure of a well-ordered set, it suffices to verify that the conditions of
\sref{lem}{9.4.6} are satisfied.It is clear in the case of (a), as the spaces
$V_\lambda$ are Noetherian.For case (b), the $V_\lambda\cap\lambda_\mu$
are affine \sref{env}{5.5.6}, and thus quasicompact, and since $L$ is finite,
$V_\lambda\cap W_\lambda$ is quasicompact. Whence the theorem.

\begin{envs}[Corollary]{9.4.8}
\label{cor-1.9.4.8}
Under the hypotheses of \sref{thm}{9.4.7}, for every quasicoherent $(\OO_X|U)$-module
$\sh{G}$ of finite type, there exists a quasicoherent $\OO_X$-module $\sh{G}'$
of finite type such that $\sh{G}'|U=\sh{G}$.
\end{envs}

It suffices to apply \sref{thm}{9.4.7} to $\sh{F}=j_*(\sh{G})$, which is
quasicoherent \sref{prop}{9.4.2} and such that $\sh{F}|U=\sh{G}$.

\begin{envs}[Corollary]{9.4.9}
\label{cor-1.9.4.9}
Let $X$ be a prescheme whose underlying space is locally Noetherian, or a
quasicompact scheme. Then every quasicoherent $\OO_X$-module is the inductive limit
of its quasicoherent $\OO_X$-submodules of finite type.
\end{envs}

This follows from \sref{thm}{9.4.7} and the remark \sref{rmk}{9.4.4}.

\begin{envs}[Corollary]{9.4.10}
\label{cor-1.9.4.10}
Under the hypotheses of \sref{cor}{9.4.9}, if a quasicoherent $\OO_X$-module $\sh{F}$
is such that every quasicoherent $\OO_X$-submodule of finite type of $\sh{F}$ is
generated by its sections over $X$, then $\sh{F}$ is generated by its sections
over $X$.
\end{envs}

In fact, let $U$ be an affine open neighbourhood of a point $x\in X$, and let
$s$ be a section of $\sh{F}$ over $U$; the $\OO_X$-submodule $\sh{G}$ of
$\sh{F}|U$ generated by $s$ is quasicoherent and of finite type, so there
exists a quasicoherent $\OO_X$-submodule $\sh{G}'$ of $\sh{F}$ of finite
type such that $\sh{G}'|U=\sh{G}$ \sref{thm}{9.4.7}.By hypothesis, there is thus a
finite number of sections $t_i$ of $\sh{G}'$ over $X$ and of sections $a_i$
of $\OO_X$ over a neighbourhood $V\subset U$ of $x$ such that
$s|V=\sum_i a_i(t_i|V)$, which proves the corollary.

\subsection{Closed image of a prescheme; closure of a subprescheme}
\label{1-schemes-9.5}        

\begin{envs}[Proposition]{9.5.1}
\label{prop-1.9.5.1}
Let $f:X\to Y$ be a morphism of preschemes
such that $f_*(\OO_X)$ is a quasicoherent $\OO_Y$-module (which will be the
case if $f$ is quasicompact \unsure{and separated, or} $X$ is locally Noetherian
\sref{cor}{9.2.2}). Then there exists a smaller subprescheme $Y'$ of $Y$ such that
the canonical injection $j:Y'\to Y$ \completelyunsure $f$ (\emph{or, equivalently
\sref{env}{4.4.1}, such that the subprescheme $f^{-1}(Y')$ of $X$ is \emph{identical}
to $X$}).
\end{envs}

More precisely:
\begin{envs}[Corollary]{9.5.2}
\label{cor-1.9.5.2}
Under the conditions of \sref{prop}{9.5.1}, let
$f=(\psi,\theta)$, and let $\sh{J}$ be the (quasicoherent) kernel of the
homomorphism $\theta:\OO_Y\to f_*(\OO_X)$. Then the closed subprescheme
$Y'$ of $Y$ defined by $\sh{J}$ satisfies the conditions of \sref{prop}{9.5.1}.
\end{envs}

Since the functor $\psi^*$ is exact, the canonical factorization
$\theta:\OO_Y\to\OO_Y/\sh{J}\xrightarrow{\theta'}\psi_*(\OO_X)$ gives
(\textbf{0},~3.5.4.3) a factorization
$\theta^\sharp:\psi^*(\OO_Y)\to\psi^*(\OO_Y)/\psi^*(\sh{J})
\xrightarrow{{\theta'}^\sharp}\OO_X$;
since $\theta_x^\sharp$ is a local homomorphism for every $x\in X$, the same is true
of ${\theta'_x}^\sharp$; if we denote by $\psi_0$ the continuous map $\psi$
considered as a map from $X$ to $X'$, and by $\theta_0$ the restriction
$\theta'|X':(\OO_Y/\sh{J})|X'\to\psi_*(\OO_X)|X'=(\psi_0)_*(\OO_X)$,
we see that $f_0=(\psi_0,\theta_0)$ is a morphism of preschemes $X\to X'$
\sref{defn}{2.2.1} such that $f=j\circ f_0$. Now, if $X''$ is
\oldpage{177}
a second closed subprescheme of $Y$, defined by a quasicoherent sheaf of ideals
$\sh{J}'$ of $\OO_Y$, such that the injection $j':X''\to Y$ \completelyunsure
$f$, then we should immediately have that $\psi(X)\subset X''$, and so
$X'\subset X''$, since $X''$ is closed. Furthermore, for all $y\in X''$,
$\theta$ should factorize as $\OO_y\to\OO_y/\sh{J}'_y\to(\psi_*(\OO_X))_y$,
which by definition leads to $\sh{J}'_y\subset\sh{J}_y$, and thus $X'$ is
a closed subprescheme of $X''$ \sref{env}{4.1.10}.

\begin{envs}[Definition]{9.5.3}
\label{defn-1.9.5.3}
Whenever there exists a smaller subprescheme $Y'$
of $Y$ such that the canonical injection $j:Y'\to Y$ \completelyunsure $f$, we
say that $Y'$ is the \emph{closed image} prescheme of $X$ by the morphism $f$.
\end{envs}

\begin{envs}[Proposition]{9.5.4}
\label{prop-1.9.5.4}
If $f_*(\OO_X)$ is a quasicoherent $\OO_Y$-module, then the underlying space of
the closed image of $X$ by $f$ is the closure $\overline{f(X)}$ in $Y$.
\end{envs}

\subsection{Quasicoherent sheaves of algebras; change of structure sheaf}
\label{1-schemes-9.6}        

\section{Formal schemes}
\label{1-schemes-10}

\clearpage

\input{ega.i.bib}

\end{document}

