\section{Quasi-affine morphisms; quasi-projective morphisms; proper morphisms; projective morphisms}
\label{section:quasi-affine-projective-proper-morphisms}

\subsection{Quasi-affine morphisms}
\label{subsection:quasi-affine-morphisms}

\begin{defn}[5.1.1]
\label{2.5.1.1}
We define a quasi-affine scheme to be a scheme isomorphic to some subscheme induced on some quasi-compact open subset of an affine scheme.
We say that a morphism $f:X\to Y$ is quasi-affine, or that $X$ (considered as a $Y$-prescheme via $f$) is a quasi-affine $Y$-scheme, if there exists a cover $(U_\alpha)$ of $Y$ by affine open subsets such that the $f^{-1}(U_\alpha)$ are quasi-affine schemes.
\end{defn}

It is clear that a quasi-affine morphism is \emph{separated} (\sref[I]{1.5.5.5} and \sref[I]{1.5.5.8}) and \emph{quasi-compact} \sref[I]{1.6.6.1};
every affine morphisms is evidently quasi-affine.

Recall that, for any prescheme $X$, setting $A=\Gamma(X,\OO_X)$, the identity homomorphism $A\to A=\Gamma(X,\OO_X)$ defines a morphism $X\to\Spec(A)$, said to be \emph{canonical} \sref[I]{1.2.2.4};
this is nothing but the canonical morphism defined in \sref{2.4.5.1} for the specific case where $\sh{L}=\OO_X$, if we remember that $\Proj(A[T])$ is canonically identified with $\Spec(A)$ \sref{2.3.1.7}.

\begin{prop}[5.1.2]
\label{2.5.1.2}
Let $X$ be a quasi-compact scheme or a prescheme whose underlying space is Noetherian, and $A$ the ring $\Gamma(X,\OO_X)$.
The following conditions are equivalent.
\begin{enumerate}[label=\emph{(\alph*)}]
    \item $X$ is a quasi-affine scheme.
    \item The canonical morphism $u:X\to\Spec(A)$ is an open immersion.
    \item[\emph{(b')}] The canonical morphism $u:X\to\Spec(A)$ is a homeomorphism from $X$ to some subspace of the underlying space of $\Spec(A)$.
    \item The $\OO_X$-module $\OO_X$ is very ample relative to $u$ \sref{2.4.4.2}.
    \item[\emph{(c')}] The $\OO_X$-module $\OO_X$ is ample \sref{2.4.5.1}.
    \item When $f$ ranges over $A$, the $X_f$ form a base for the topology of $X$.
    \item[\emph{(d')}] When $f$ ranges over $A$, the $X_f$ that are affine form a cover of $X$.
\oldpage[II]{95}
    \item Every quasi-coherent $\OO_X$-module is generated by its sections over $X$.
    \item[\emph{(e')}] Every quasi-coherent sheaf of ideals of $\OO_X$ of finite type is generated by its sections over $X$.
\end{enumerate}
\end{prop}

\begin{proof}
\label{proof-2.5.1.2}
It is clear that \emph{(b)} implies \emph{(a)}, and \emph{(a)} implies \emph{(c)} by \sref{2.4.4.4}[b] applied to the identity morphism (taking into account the remark preceding this proposition);
Furthermore, \emph{(c)} implies \emph{(c')} \sref{2.4.5.10}[i], and \emph{(c')}, \emph{(b)}, and \emph{(b')} are all equivalent by \sref{2.4.5.2}[b] and \sref{2.4.5.2}[b'].
Finally, \emph{(c')} is the same as each of \emph{(d)}, \emph{(d')}, \emph{(e)}, and \emph{(e')} by \sref{2.4.5.2}[a], \sref{2.4.5.2}[a'], \sref{2.4.5.2}[c], and \sref{2.4.5.5}[d''].
\end{proof}

We further observe that, with the previous notation, the $X_f$ that are affine form a \emph{base} for the topology of $X$, and that the canonical morphism $u$ is \emph{dominant} \sref{2.4.5.2}.

\begin{cor}[5.1.3]
\label{1.5.1.3}
Let $X$ be a quasi-compact prescheme.
If there exists a morphism $v:X\to Y$ from $X$ to some affine scheme $Y$ (which would be a homeomorphism from $X$ to some open subspace of $Y$), then $X$ is quasi-affine.
\end{cor}

\begin{proof}
\label{proof-2.5.1.3}
There exists a family $(g_\alpha)$ of sections of $\OO_Y$ over $Y$ such that the $D(g_\alpha)$ form a base for the topology of $v(X)$;
if $v=(\psi,\theta)$ and we set $f_\alpha=\theta(g_\alpha)$, then we have $X_{f_\alpha}=\psi^{-1}(D(g_\alpha))$ \sref[I]{1.2.2.4.1}, so the $X_{f_\alpha}$ form a base for the topology of $X$, and the criterion \sref{2.5.1.2}[d] is satisfied.
\end{proof}

\begin{cor}[5.1.4]
\label{2.5.1.4}
If $X$ is a quasi-affine scheme, then \emph{every} invertible $\OO_X$-module is very ample (relative to the canonical morphism), and \emph{a fortiori} ample.
\end{cor}

\begin{proof}
\label{proof-2.5.1.4}
Such a module $\sh{L}$ is generated by its sections over $X$ \sref{2.5.1.2}[e], so $\sh{L}\otimes\OO_X=\sh{L}$ is very ample \sref{2.4.4.8}.
\end{proof}

\begin{cor}[5.1.5]
\label{2.5.1.5}
Let $X$ be a quasi-compact prescheme.
If there exists an invertible $\OO_X$-module $\sh{L}$ such that $\sh{L}$ and $\sh{L}^{-1}$ are ample, then $X$ is a quasi-affine scheme.
\end{cor}

\begin{proof}
\label{proof-2.5.1.5}
Indeed, $\OO_X=\sh{L}\otimes\sh{L}^{-1}$ is then ample \sref{2.4.5.7}.
\end{proof}

\begin{prop}[5.1.6]
\label{2.5.1.6}
Let $f:X\to Y$ be a quasi-compact morphism.
Then the following conditions are equivalent.
\begin{enumerate}[label=\emph{(\alph*)}]
    \item The morphism $f$ is quasi-affine.
    \item The $\OO_Y$-algebra $f_*(\OO_X)=\sh{A}(X)$ is quasi-coherent, and the canonical morphism $X\to\Spec(\sh{A}(X))$ corresponding to the identity morphism $\sh{A}(X)\to\sh{A}(X)$ \sref{2.1.2.7} is an open immersion.
    \item[\emph{(b')}] The $\OO_Y$-algebra $\sh{A}(X)$ is quasi-coherent, and the canonical morphism $X\to\Spec(\sh{A}(X))$ is a homeomorphism from $X$ to some subspace of $\Spec(\sh{A}(X))$.
    \item The $\OO_X$-module $\OO_X$ is very ample for $f$.
    \item[\emph{(c')}] The $\OO_X$-module $\OO_X$ is ample for $f$.
    \item The morphism $f$ is separated, and, for every quasi-coherent $\OO_X$-module $\sh{F}$, the canonical homomorphism $\sigma:f^*(f_*(\sh{F}))\to\sh{F}$ \sref[0]{0.4.4.3} is surjective.
\end{enumerate}

Further, whenever $f$ is quasi-affine, every invertible $\OO_X$-module $\sh{L}$ is very ample relative to $f$.
\end{prop}

\begin{proof}
\label{proof-2.5.1.6}
The equivalence between \emph{(a)} and \emph{(c')} follows from the local (on $Y$) character of the $f$-\unsure{amplitude} \sref{2.4.6.4}, Definition~\sref{2.5.1.1}, and the criterion \sref{2.5.1.2}[c'].
The other properties are local on $Y$
\oldpage[II]{96}
and thus follow immediately from \sref{2.5.1.2} and \sref{2.5.1.4}, taking into account the fact that $f_*(\sh{F})$ is quasi-coherent whenever $f$ is separated \sref[I]{1.9.2.2}[a].
\end{proof}

\begin{cor}[5.1.7]
\label{2.5.1.7}
Let $f:X\to Y$ be a quasi-affine morphism.
For every open subset $U$ of $Y$, the restriction $f^{-1}(U)\to U$ of $f$ is quasi-affine.
\end{cor}

\begin{cor}[5.1.8]
\label{2.5.1.8}
Let $Y$ be an affine scheme, and $f:X\to Y$ a quasi-compact morphism.
For $f$ to be quasi-affine, it is necessary and sufficient for $X$ to be a quasi-affine scheme.
\end{cor}

\begin{proof}
\label{proof-2.5.1.8}
This is an immediate consequence of \sref{2.5.1.6} and \sref{2.4.6.6}.
\end{proof}

\begin{cor}[5.1.9]
\label{2.5.1.9}
Let $Y$ be a quasi-compact scheme or a prescheme whose underlying space is Noetherian, and $f:X\to Y$ a morphism of \emph{finite type}.
If $f$ is quasi-affine, then there exists a quasi-coherent sub-$\OO_Y$-algebra $\sh{B}$ of $\sh{A}(X)=f_*(\OO_X)$ of \emph{finite type} \sref[I]{1.9.6.2} such that the morphism $X\to\Spec(\sh{B}$ corresponding to the canonical injection $\sh{B}\to\sh{A}(X)$ is an immersion.
Further, every quasi-coherent sub-$\OO_Y$-algebra $\sh{B}'$ of finite type over $\sh{A}(X)$ containing $\sh{B}$ has the same property.
\end{cor}

\begin{proof}
\label{proof-2.5.1.9}
Indeed, $\sh{A}(X)$ is the inductive limit of its quasi-coherent sub-$\OO_Y$-algebras of finite type \sref[I]{1.9.6.5};
the result is then a particular case of \sref{2.3.8.4}, taking into account the identification of $\Spec(\sh{A}(X))$ with $\Proj(\sh{A}(X)[T])$ \sref{2.3.1.7}.
\end{proof}

\begin{prop}[5.1.10]
\label{2.5.1.10}
\medskip\noindent
\begin{enumerate}[label=\emph{(\roman*)}]
    \item A quasi-compact morphism $X\to Y$ that is a homeomorphism from the underlying space of $X$ to some subspace of the underlying space of $Y$ (so, in particular, any closed immersion) is quasi-affine.
    \item The composition of any two quasi-affine morphisms is quasi-affine.
    \item If $f:X\to Y$ is a quasi-affine $S$-morphism, then $f_{(S')}:X_{(S')}\to Y_{(S')}$ is a quasi-affine morphism for any extension $S'\to S$ of the base prescheme.
    \item If $f:X\to Y$ and $g:X'\to Y'$ are quasi-affine $S$-morphisms, then $f\times_S g$ is quasi-affine.
    \item If $f:X\to Y$ and $g:Y\to Z$ are morphisms such that $g\circ f$ is quasi-affine, and if $g$ is separated or the underlying space of $X$ is locally Noetherian, then $f$ is quasi-affine.
    \item If $f$ is a quasi-affine morphism then so too is $f_\red$.
\end{enumerate}
\end{prop}

\begin{proof}
\label{proof-2.5.1.10}
Taking into account the criterion \sref{2.5.1.6}[c'], all of (i), (iii), (iv), (v), and (vi) follow immediately from \sref{2.4.6.13}[i \emph{bis}], \sref{2.4.6.13}[iii], \sref{2.4.6.13}[iv], \sref{2.4.6.13}[v], and \sref{2.4.6.13}[vi] (respectively).
To prove (ii), we can restrict to the case where $Z$ is affine, and then the claim follows directly from applying \sref{2.4.6.13}[ii] to $\sh{L}=\OO_X$ and $\sh{K}=\OO_Y$.
\end{proof}

\begin{rmk}[5.1.11]
Let $f:X\to Y$ and $g:Y\to Z$ be morphisms such that $X\times_Z Y$ is locally Noetherian.
Then the graph immersion $\Gamma_f:X\to X\times_Z Y$ is quasi-affine, since it is quasi-compact \sref[I]{1.6.3.5}, and since \sref[I]{1.5.5.12} shows that, in (v), the conclusion still holds true if we remove the hypothesis that $g$ is separated.
\end{rmk}

\begin{prop}[5.1.12]
\label{2.5.1.12}
Let $f:X\to Y$ be a quasi-compact morphism, and $g:X'\to X$ a quasi-affine morphism.
If $\sh{L}$ is an ample (for $f$) $\OO_X$-module, then $g^*(\sh{L})$ is an ample (for $f\circ g$) $\OO_{X'}$-module.
\end{prop}

\begin{proof}
\label{proof-2.5.1.12}
Since $\OO_{X'}$ is very ample for $g$, and the question is local on $Y$ \sref{2.4.6.4}, it follows from \sref{2.4.6.13}[ii] that there exists (for $Y$ affine) an integer $n$ such that
\[
    g^*(\sh(L)^{\otimes n}) = (g^*(\sh{L}))^{\otimes n}
\]
is ample for $f\circ g$, and so $g^*(\sh{L})$ is ample for $f\circ g$ \sref{2.4.6.9}
\end{proof}

\subsection{Serre's criterion}
\label{subsection:serres-criterion}

\begin{thm}[5.2.1]
\label{2.5.2.1}
\emph{(Serre's criterion).}
Let $X$ be a quasi-compact scheme or a prescheme whose underlying space is Noetherian.
The following conditions are equivalent.
\begin{enumerate}[label=\emph{(\alph*)}]
    \item $X$ is an affine scheme.
    \item There exists a family of elements $f_\alpha\in A=\Gamma(X,\OO_X)$ such that the $X_{f_\alpha}$ are affine, and such that the ideal generated by the $f_\alpha$ in $A$ is equal to $A$ itself.
    \item The functor $\Gamma(X,\sh{F})$ is exact in $\sh{F}$ in the category of quasi-coherent $\OO_X$-modules, or, in other words, if
        \begin{equation*}
            0\to\sh{F}'\to\sh{F}\to\sh{F}''\to0\tag{*}
        \end{equation*}
        is an exact sequence of quasi-coherent $\OO_X$-modules, then the sequence
        \[
            0\to\Gamma(X,\sh{F}')\to\Gamma(X,\sh{F})\to\Gamma(X,\sh{F}'')\to0
        \]
        is also exact.
    \item[\emph{(c')}] Condition~\emph{(c)} holds for every exact sequence \emph{(*)} of quasi-coherent $\OO_X$-modules such that $\sh{F}$ is isomorphic to a sub-$\OO_X$-module of $\OO_X^n$ for some finite $n$.
    \item $\HH^1(X,\sh{F})=0$ for every quasi-coherent $\OO_X$-module $\sh{F}$.
    \item[\emph{(d')}] $\HH^1(X,\sh{J})=0$ for every quasi-coherent sheaf of ideals $\sh{J}$ of $\OO_X$.
\end{enumerate}
\end{thm}

\begin{proof}
\label{proof-2.5.2.1}
It is evident that \emph{(a)} implies \emph{(b)};
furthermore, \emph{(b)} implies that the $X_{f_\alpha}$ cover $X$, because, by hypothesis, the section $1$ is a linear combination of the $f_\alpha$, and the $D(f_\alpha)$ thus cover $\Spec(A)$.
The final claim of \sref{2.4.5.2} thus implies that $X\to\Spec(A)$ is an isomorphism.

We know that \emph{(a)} implies \emph{(c)} \sref[I]{1.1.3.11}, and \emph{(c)} trivially implies \emph{(c')}.
We now prove that \emph{(c')} implies \emph{(b)}.
First of all, \emph{(c')} implies that, for every \emph{closed} point $x\in X$ and every open neighbourhood $U$ of $x$, there exists some $f\in A$ such that $x\in X_f\subset X\setmin U$.
Let $\sh{J}$ (resp. $\sh{J}'$) be the quasi-coherent sheaf of ideals of $\OO_X$ defining the reduced closed subprescheme of $X$ that has $X\setmin U$ (resp. $(X\setmin U)\cup\{x\}$) as its underlying space \sref[I]{1.5.2.1};
it is clear that we have $\sh{J}'\subset\sh{J}$, and that $\sh{J}''=\sh{J}/\sh{J}'$ is a quasi-coherent $\OO_X$ module that has support equal to $\{x\}$, and such that $\sh{J}_x''=\kres(x)$.
Hypothesis~\emph{(c')} applied to the exact sequence $0\to\sh{J}'\to\sh{J}\to\sh{J}''\to0$ shows that $\Gamma(X,\sh{J})\to\Gamma(X,\sh{J}'')$ is surjective.
The section of $\sh{J}''$ whose germ at $x$ is $1_x$ is thus the image of some section $f\in\Gamma(X,\sh{J})\subset\Gamma(X,\OO_X)$, and we have, by definition, that $f(x)=1_x$ and $f(y)=0$ in $X\setmin U$, which establishes our claim.
Now, if $U$ is affine, then so too is $X_f$ \sref[I]{1.1.3.6}, so the union of the $X_f$ that are affine ($f\in A$) is an open set $Z$ that contains \emph{all the closed points} of $X$;
since $X$ is a quasi-compact Kolmogoroff space, we necessarily have $Z=X$ \sref[0]{0.2.1.3}.
Because $X$ is quasi-compact, there are a \emph{finite} number of elements $f_i\in A$ ($1\leq i\leq n$) such that the $X_{f_i}$ are affine and cover $X$.
So consider the homomorphism $\OO_X^n\to\OO_X$ defined by the sections $f_i$ \sref[0]{0.5.1.1};
since, for all $x\in X$, at least one of the $(f_i)_x$ is invertible, this homomorphism is \emph{surjective}, and we thus have an exact sequence $0\to\sh{R}\to\OO_X^n\to\OO_X\to0$, where $\sh{R}$ is a quasi-coherent sub-$\OO_X$-module of $\OO_X$.
It then follows
\oldpage[II]{98}
from \emph{(c')} that the corresponding homomorphism $\Gamma(X,\OO_X^n)\to\Gamma(X,\OO_X)$ is surjective, which proves \emph{(b)}.

Finally, \emph{(a)} implies \emph{(d)} \sref[I]{1.5.1.9.2}, and \emph{(d)} trivially implies \emph{(d')}.
It remains to show that \emph{(d')} implies \emph{(c')}.
But if $\sh{F}'$ is a quasi-coherent sub-$\OO_X$-module of $\OO_X^n$, then the filtration $0\subset\OO_X\subset\OO_X^2\subset\ldots\subset\OO_X^n$ defines a filtration of $\sh{F}'$ given by the $\sh{F}'_k=\sh{F}\cap\OO_X^k$ ($0\leq k\leq n$), which are quasi-coherent $\OO_X$-modules \sref[I]{1.4.1.1}, and $\sh{F}'_{k+1}/\sh{F}'_k$ is isomorphic to a quasi-coherent sub-$\OO_X$-module of $\OO_X^{k+1}/\OO_X^k=\OO_X$, which is to say, a quasi-coherent sheaf of ideals of $\OO_X$.
Hypothesis~\emph{(d')} thus implies that $\HH^1(X,\sh{F}'_{k+1}/\sh{F}'_k)=0$;
the exact cohomology sequence $\HH^1(X,\sh{F}'_k)\to\HH^1(X,\sh{F}'_{k+1})\to\HH^1(X,\sh{F}'_{k+1}/\sh{F}'_k)=0$ then lets us prove by induction on $k$ that $H^1(X,\sh{F}'_k)=0$ for all $k$.
\end{proof}

\begin{rmk}[5.2.1.1]
\label{2.5.2.1.1}
\end{rmk}
