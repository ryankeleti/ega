\section{Subpreschemes and immersion morphisms}
\label{section-subpreschemes-and-immersion-morphisms}

\subsection{Subpreschemes}
\label{subsection-subpreschemes}

\begin{env}[4.1.1]
\label{1.4.1.1}
As the notion of a quasi-coherent sheaf \sref[0]{0.5.1.3} is local, a quasi-coherent $\OO_X$-module $\sh{F}$ over a prescheme $X$ can be defined by the condition that, for each affine open $V$ of $X$, $\sh{F}|V$ is isomorphic to the sheaf associated to a $\Gamma(V,\OO_X)$-module \sref{1.1.4.1}.
It is clear that over a prescheme $X$, the structure sheaf $\OO_X$ is quasi-coherent and that the kernels, cokernels, and images of homomorphisms of quasi-coherent $\OO_X$-modules, as well as inductive limits and direct sums of quasi-coherent $\OO_X$-modules, are also quasi-coherent (Theorem \sref{1.1.3.7} and Corollary \sref{1.1.3.9}).
\end{env}

\begin{prop}[4.1.2]
\label{1.4.1.2}
Let $X$ be a prescheme, $\sh{I}$ a quasi-coherent sheaf of ideals of $\OO_X$.
The support $Y$ of the sheaf $\OO_X/\sh{I}$ is then closed, and if we denote by $\OO_Y$ the restriction of $\OO_X/\sh{I}$ to $Y$, then $(Y,\OO_Y)$ is a prescheme.
\end{prop}

\begin{proof}
\label{proof-1.4.1.2}
\oldpage[I]{120}
It evidently suffices \sref{1.2.1.3} to consider the case where $X$ is an affine scheme, and to show that in this case $Y$ is closed in $X$ and is an {\em affine scheme}.
Indeed, if $X=\Spec(A)$, then we have $\OO_X=\widetilde{A}$ and $\sh{I}=\widetilde{\fk{I}}$, where $\fk{I}$ is an ideal of $A$ \sref{1.1.4.1}; $Y$ is then equal to the closed subset $V(\fk{I})$ of $X$ and identifies with the prime spectrum of the ring $B=A/\fk{I}$ \sref{1.1.1.11};
in addition, if $\vphi$ is the canonical homomorphism $A\to B=A/\fk{I}$, then the direct image ${}^a\vphi_*(\widetilde{B})$ canonically identifies with the sheaf $\widetilde{A}/\widetilde{\fk{I}}=\OO_X/\sh{I}$ (Proposition \sref{1.1.6.3} and Corollary \sref{1.1.3.9}), which finishes the proof.
\end{proof}

We say that $(Y,\OO_Y)$ is the {\em subprescheme} of $(X,\OO_X)$ {\em defined by the sheaf of ideals $\sh{I}$}; this is a particular case of the more general notion of a {\em subprescheme}:

\begin{defn}[4.1.3]
\label{1.4.1.3}
We say that a ringed space $(Y,\OO_Y)$ is a subprescheme of a prescheme $(X,\OO_X)$ if:
\begin{enumerate}
  \item[1st] $Y$ is a locally closed subspace of $X$;
  \item[2nd] if $U$ denotes the largest open subset of $X$ containing $Y$ such that     $Y$ is closed in $U$ ({\em equivalently}, the complement in $X$ of the boundary of $Y$ with respect to $\overline{Y}$), then $(Y,\OO_Y)$ is a subprescheme of $(U,\OO_X|U)$ defined by a quasi-coherent sheaf of ideals of $\OO_X|U$.
\end{enumerate}
We say that the subprescheme $(Y,\OO_Y)$ of $(X,\OO_X)$ is closed if $Y$ is closed in $X$ (in which case $U=X$).
\end{defn}

It follows immediately from this definition and Proposition \sref{1.4.1.2} that the closed subpreschemes of $X$ are in canonical {\em bijective correspondence} with the quasi-coherent sheaf of ideals $\sh{J}$ of $\OO_X$, since if two such sheaves $\sh{J}$, $\sh{J}'$ have the same (closed) support $Y$ and if the restrictions of $\OO_X/\sh{J}$ and $\OO_X/\sh{J}'$ to $Y$ are \unsure{identical/the identity}, then we have $\sh{J}'=\sh{J}$.

\begin{env}[4.1.4]
\label{1.4.1.4}
Let $(Y,\OO_Y)$ be a subprescheme of $X$, $U$ the largest open subset of $X$ containing $Y$ and in which $Y$ is closed, $V$ an open subset of $X$ contained in $U$; then $V\cap Y$ is closed in $V$. In addition, if $Y$ is defined by the quasi-coherent sheaf of ideals $\sh{J}$ of $\OO_X|U$, then $\sh{J}|V$ is a quasi-coherent sheaf of ideals of $\OO_X|V$, and it is immediate that the prescheme induced by $Y$ on $Y\cap V$ is the closed subprescheme of $V$ defined by the sheaf of ideals $\sh{J}|V$.
Conversely:
\end{env}

\begin{prop}[4.1.5]
\label{1.4.1.5}
Let $(Y,\OO_Y)$ be a ringed space such that $Y$ is a subspace of $X$ and that there exists a cover $(V_\alpha)$ of $Y$ by open subsets of $X$ such that for each $\alpha$, $Y\cap V_\alpha$ is closed in $V_\alpha$ and the ringed space $(Y\cap V_\alpha,\OO_Y|(Y\cap V_\alpha))$ is a closed subprescheme of the prescheme induced on $V_\alpha$ by $X$.
Then $(Y,\OO_Y)$ is a subprescheme of $X$.
\end{prop}

\begin{proof}
\label{proof-1.4.1.5}
The hypotheses imply that $Y$ is locally closed in $X$ and that the largest open $U$ containing $Y$ in which $Y$ is closed contains all the $V_\alpha$; we can thus reduce to the case where $U=X$ and $Y$ is closed in $X$.
We then define a quasi-coherent sheaf of ideals $\sh{J}$ of $\OO_X$ by taking $\sh{J}|V_\alpha$ to be the sheaf of ideals of $\OO_X|V_\alpha$ which define the closed subprescheme $(Y\cap V_\alpha,\OO_Y|(Y\cap V_\alpha))$, and for each open subset $W$ of $X$ not intersecting $Y$, $\sh{J}|W=\OO_X|W$.
We check immediately according to Definition \sref{1.4.1.3} and \sref{1.4.1.4} that there exists a unique sheaf of ideals $\sh{J}$ satisfying these conditions and that define the closed subprescheme $(Y,\OO_Y)$.
\end{proof}

In particular, the {\em induced} prescheme by $X$ on an {\em open subset} of $X$ is a {\em subprescheme} of $X$.

\begin{prop}[4.1.6]
\label{1.4.1.6}
A subprescheme (resp. a closed subprescheme) of a subprescheme
\oldpage[I]{121}
(resp. closed subprescheme) of $X$ canonically identifies with a subprescheme (resp. closed subprescheme) of $X$.
\end{prop}

\begin{proof}
\label{proof-1.4.1.6}
Since a locally closed subset of a locally closed subspace of $X$ is a locally closed subspace of $X$, it is clear \sref{1.4.1.5} that the question is local and that we can thus suppose that $X$ is affine; the proposition then follows from the canonical identification of $A/\fk{J}'$ and $(A/\fk{J})/(\fk{J}'/\fk{J})$ when $\fk{J}$, $\fk{J}'$ are two ideals of a ring $A$ such that $\fk{J}\subset\fk{J}'$.
\end{proof}

We will always make the previous identification.
\begin{env}[4.1.7]
\label{1.4.1.7}
Let $Y$ be a subprescheme of a prescheme $X$, and denote by $\psi$ the canonical injection $Y\to X$ of the {\em underlying subspaces}; we know that the inverse image $\psi^*(\OO_X)$ is the restriction $\OO_X|Y$ \sref[0]{0.3.7.1}.
If, for each $y\in Y$, we denote by $\omega_y$ the canonical homomorphism $(\OO_X)_y\to(\OO_Y)_y$, then these homomorphisms are the restrictions to stalks of a {\em surjective} homomorphism $\omega$ of sheaves of rings $\OO_X|Y\to\OO_Y$: indeed, it suffices to check locally on $Y$, that is to say, we can suppose that $X$ is affine and that the subprescheme $Y$ is closed; if in this case $\sh{I}$ is the sheaf of ideals in $\OO_X$ which defines $Y$, then the $\omega_y$ are none other than the restriction to stalks of the homomorphism $\OO_X|Y\to(\OO_X/\sh{I})|Y$.
We have thus defined a {\em monomorphism of ringed spaces} \sref[0]{0.4.1.1} $j=(\psi,\omega^\flat)$ which is evidently a morphism $Y\to X$ of preschemes \sref{1.2.2.1}, and we call this the {\em canonical injection morphism}.

If $f:X\to Z$ is a morphism, we then say that the composite morphism $Y\xrightarrow{j}X\xrightarrow{f}Z$ is the {\em restriction} of $f$ to the subprescheme $Y$.
\end{env}

\begin{env}[4.1.8]
\label{1.4.1.8}
Conforming to the general definitions (T, I, 1.1), we will say that a morphism of preschemes $f:Z\to X$ is \unsure{{\em majorized}} by the injection morphism $j:Y\to X$ of a subprescheme $Y$ of $X$ if $f$ factors as $Z\xrightarrow{g}Y\xrightarrow{j}X$, where $g$ is a morphism of preschemes; $g$ is necessarily {\em unique} since $j$ is a monomorphism.
\end{env}

\begin{prop}[4.1.9]
\label{1.4.1.9}
For a morphism $f:Z\to X$ to be majorized by an injection morphism $j:Y\to X$, it is necessary and sufficient that $f(Z)\subset Y$ and that for all $z\in Z$, if we set $y=f(z)$, then the homomorphism $(\OO_X)_y\to\OO_z$ corresponding to $f$ factors as $(\OO_Z)_y\to(\OO_Y)_y\to\OO_z$ ({\em or equivalently, that} the kernel of $(\OO_X)_y\to\OO_z$ contains the kernel of $(\OO_X)_y\to(\OO_Y)_y$).
\end{prop}

\begin{proof}
\label{proof-1.4.1.9}
The conditions are evidently necessary.
To see that they are sufficient, we can reduce to the case where $Y$ is a {\em closed} subprescheme of $X$, by replacing if needed $X$ by an open $U$ such that $Y$ is closed in $U$ \sref{1.4.1.3}; $Y$ is then defined by a quasi-coherent sheaf of ideals $\sh{I}$ of $\OO_X$.
Set $f=(\psi,\theta)$, and let $\sh{J}$ be the sheaf of ideals of $\psi^*(\OO_X)$, kernel of $\theta^\sharp:\psi^*(\OO_X)\to\OO_Z$; considering the properties of the functor $\psi^*$ \sref[0]{0.3.7.2}, the hypotheses emply that for each $z\in Z$, we have $(\psi^*(\sh{I}))_z\subset\sh{J}_z$, and as a result $\psi^*(\sh{I})\subset\sh{J}$.
Thus $\theta^\sharp$ factors as
\[
  \psi^*(\OO_X)\longrightarrow\psi^*(\OO_X)/\psi^*(\sh{I})=\psi^*(\OO_X/\sh{I})\xrightarrow{\omega}\OO_Z,
\]
the first arrow being the canonical homomorphism.
Let $\psi'$ be the continuous map $Z\to Y$ coinciding with $\psi$; it is clear that we have ${\psi'}^*(\OO_Y)=\psi^*(\OO_X/\sh{J})$; on the other hand, $\omega$ is evidently a local homomorphism, so $g=(\psi',\omega^\flat)$ is a morphism
\oldpage[I]{122}
of preschemes $Z\to Y$ \sref{1.2.2.1}, which according to the above is such that $f=j\circ g$, hence the proposition.
\end{proof}

\begin{cor}[4.1.10]
\label{1.4.1.10}
For an injection morphism $Z\to X$ to be majorized by the injection morphism $Y\to X$, it is necessary and sufficient that $Z$ is a subprescheme of $Y$.
\end{cor}

We then write $Z\leqslant Y$, and this condition is evidently an {\em order relation} on the set of subpreschemes of $X$.

\subsection{Immersion morphisms}
\label{subsection-immersion-morphisms}

\begin{defn}[4.2.1]
\label{1.4.2.1}
We say that a morphism $f:Y\to X$ is an immersion (resp. a closed immersion, an open immersion) if it factors as $Y\xrightarrow{g}Z\xrightarrow{j}X$, where $g$ is an isomorphism, $Z$ is a subprescheme of $X$ (resp. a closed subprescheme, a subprescheme induced by an open set) and $j$ is the injection morphism.
\end{defn}

The subprescheme $Z$ and the isomorphism $g$ are then determined in a {\em unique} way, since if $Z'$ is a second subprescheme of $X$, $j'$ the injection $Z'\to X$, and $g'$ an isomorphism $Y\to Z'$ such that $j\circ g=j'\circ g'$, then we have $j'=j\circ g\circ{g'}^{-1}$, hence $Z'\leqslant Z$ \sref{1.4.1.10}, and we similarly show that $Z\leqslant Z'$, hence $Z'=Z$, and as $j$ is a monomorphism of preschemes, $g'=g$.

We say that $f=j\circ g$ is the {\em canonical factorization} of the immersion $f$, and the subprescheme $Z$ and the isomorphism $g$ are those {\em associated to $f$}.

It is clear that an immersion is a {\em monomorphism} of preschemes \sref{1.4.1.7} and {\em a fortiori} a {\em radical} morphism \sref{1.3.5.4}.

\begin{prop}[4.2.2]
\label{1.4.2.2}
\medskip\noindent
\begin{enumerate}[label={\rm(\alph*)}]
  \item For a morphism $f=(\psi,\theta):Y\to X$ to be an open immersion, it is necessary and sufficient that $\psi$ is a homeomorphism between $Y$ and an open subset of $X$, and that for all $y\in Y$, the homomorphism $\theta_y^\sharp:\OO_{\psi(y)}\to\OO_y$ is bijective.
  \item For a morphism $f=(\psi,\theta):Y\to X$ to be an immersion (resp. a closed immersion), it is necessary and sufficient that $\psi$ is a homeomorphism between $Y$ and a locally closed (resp. closed) subset of $X$, and that for all $y\in Y$, the homomorphism $\theta_y^\sharp:\OO_{\psi(y)}\to\OO_y$ is surjective.
\end{enumerate}
\end{prop}

\begin{proof}
\label{proof-1.4.2.2}
\medskip\noindent
\begin{enumerate}[label=(\alph*)]
  \item The conditions are evidently necessary.
    Conversely, if they are satisfied, then it is clear that $\theta^\sharp$ is an isomorphism from $\OO_Y$ to $\psi^*(\OO_X)$, and $\psi^*(\OO_X)$ is the sheaf induced by ``transport of structure'' via $\psi^{-1}$ from $\OO_X|\psi(Y)$; hence the conclusion.
  \item The conditions are evidently necessary---we prove that they are sufficient.
    Consider first the particular case where we suppose that $X$ is an affine scheme and that $Z=\psi(Y)$ is {\em closed} in $X$.
    We then know \sref[0]{0.3.4.6} that $\psi_*(\OO_Y)$ has $Z$ for its support and that if we denote by $\OO_Z'$ its restriction ot $Z$, then the ringed space $(Z,\OO_Z')$ is induced from $(Y,\OO_Y)$ by transport of structure via the homeomorphism $\psi$, considered as a map from $Y$ to $Z$.
    Let us show that $f_*(\OO_Y)=\psi_*(\OO_Y)$ is a {\em quasi-coherent} $\OO_X$-module.
    Indeed, for all $x\not\in Z$, $\psi_*(\OO_Y)$ restricted to a suitable neighborhood of $x$ is zero.
    On the contrary, if $z\in Z$, then we have $x=\psi(y)$ for a well-defined  $y\in Y$; let $V$ be an open affine neighborhood of $y$ in $Y$; $\psi(V)$ is then open in $Z$, so \unsure{trace} over $Z$ of....
\end{enumerate}
\end{proof}


