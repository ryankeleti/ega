\section{Supplement on quasi-coherent sheaves}
\label{section-supplement-on-qcoh}

\subsection{Tensor product of quasi-coherent sheaves}
\label{subsection-tensor-product-of-qcoh}

\begin{prop}[9.1.1]
\label{1.9.1.1}
\oldpage[I]{169}
Let $X$ be a prescheme ({\em resp.} a locally Noetherian prescheme). Let $\sh{F}$ and
$\sh{G}$ be two quasi-coherent ({\em resp.} coherent) $\OO_X$-modules; then
$\sh{F}\otimes_{\OO_X}\sh{G}$ is quasi-coherent ({\em resp.} coherent) and
of finite type if $\sh{F}$ and $\sh{G}$ are of finite type. If
$\sh{F}$ admits a finite presentation and if $\sh{G}$ is quasi-coherent
({\em resp.} coherent), then $\shHom(\sh{F},\sh{G})$ is quasi-coherent
({\em resp.} coherent).
\end{prop}

\begin{proof}
\label{proof-1.9.1.1}
Being a local property, we can suppose that $X$ is affine (resp. Noetherian
affine); further, if $\sh{F}$ is coherent, then we can assume that it is the
cokernel of a homomorphism $\OO_X^m\to\OO_X^n$. The claims pertaining to
quasi-coherent sheaves then follow from the Corollaries \hyperref[1.1.3.12]{(1.3.12)} and \hyperref[1.1.3.9]{(1.3.9)}; the
claims pertaining to coherent sheaves follow from Theorem \hyperref[1.1.5.1]{(1.5.1)} and from the fact
that, if $M$ and $N$ are modules of finite type over a Noetherian ring $A$,
$M\otimes_A N$ and $\Hom_A(M,N)$ are $A$-modules of finite type.
\end{proof}

\begin{defn}[9.1.2]
\label{1.9.1.2}
Let $X$ and $Y$ be two $S$-preschemes, $p$ and
$q$ the projections of $X\times_S Y$, and $\sh{F}$ (resp.$\sh{G}$) a
quasi-coherent $\OO_X$-module (resp. quasi-coherent $\OO_Y$-module). We define the
tensor product of $\sh{F}$ and $\sh{G}$ over $\OO_S$ ({\em or} over $S$),
denoted by $\sh{F}\otimes_{\OO_S}\sh{G}$ ({\em or}
$\sh{F}\otimes_S\sh{G}$) to be the tensor product
$p^*(\sh{F})\otimes_{\OO_{X\times_S Y}}q^*(\sh{G})$ over the
prescheme $X\times_S Y$.
\end{defn}

If $X_i$ ($1\leqslant i\leqslant n$) are $S$-preschemes, and $\sh{F}_i$ are quasi-coherent
$\OO_{X_i}$-modules ($1\leqslant i\leqslant n$), then we define similarly the tensor product
$\sh{F}_1\otimes_S\sh{F}_2\otimes_S\cdots\otimes_S\sh{F}_n$ over the
prescheme $Z=X_1\times_S X_2\times_S\cdots\times_S X_n$; it is a
{\em quasi-coherent} $\OO_Z$-module by virtue of \hyperref[1.9.1.1]{(9.1.1)} and
\hyperref[0.5.1.4]{(\textbf{0},~5.1.4)}; it is {\em coherent} if the $\sh{F}_i$ are coherent and
$Z$ is {\em locally Noetherian}, by virtue of \hyperref[1.9.1.1]{(9.1.1)},
\hyperref[0.5.3.11]{(\textbf{0},~5.3.11)}, and \hyperref[1.6.1.1]{(6.1.1)}.

Note that if we take $X=Y=S$ then definition \hyperref[1.9.1.2]{(9.1.2)} gives us back the tensor
product of $\OO_S$-modules. Furthermore, as $q^*(\OO_Y)=\OO_{X\times_S Y}$
\hyperref[0.4.3.4]{(\textbf{0},~4.3.4)}, the product $\sh{F}\otimes_S\OO_Y$ is canonically
identified with $p^*(\sh{F})$, and, in the same way,
$\OO_X\otimes_S\sh{G}$ is canonically identified with $q^*(\sh{G})$. In
particular, if we take $Y=S$ and denote by $f$ the structure morphism $X\to Y$,
we have that $\OO_X\otimes_Y\sh{G}=f^*(\sh{G})$: the ordinary tensor
product and the inverse image thus appear as particular cases of the general
tensor product.

Definition \hyperref[1.9.1.2]{(9.1.2)} leads immediately to the fact that, for fixed $X$ and
$Y$, $\sh{F}\otimes_S\sh{G}$ is an {\em additive covariant bifunctor that
is right exact} in $\sh{F}$ and $\sh{G}$.

\begin{prop}[9.1.3]
\label{1.9.1.3}
Let $S$, $X$, $Y$ be three affine schemes of rings
$A$, $B$, $C$ (respectively), with $B$ and $C$ being $A$-algebras. Let $M$
({\em resp.} $N$) be a $B$-module ({\em resp.} $C$-module), and
$\sh{F}=\widetilde{M}$ ({\em resp.} $\sh{G}=\widetilde{N}$) the
associated quasi-coherent sheaf; then $\sh{F}\otimes_S\sh{G}$ is
canonically isomorphic to the sheaf associated to the $(B\otimes_A C)$-module
$M\otimes_A N$.
\end{prop}

\begin{proof}
\label{proof-1.9.1.3}
\oldpage[I]{170}
According to Proposition \hyperref[1.1.6.5]{(1.6.5)}, $\sh{F}\otimes_S\sh{G}$
is canonically isomorphic to the sheaf associated to the $(B\otimes_A C)$-module
\[
  \big(M\otimes_B(B\otimes_A C)\big)\otimes_{B\otimes_A C}\big((B\otimes_A C)\otimes_C N\big)
\]
and by the canonical isomorphisms between tensor
products, this latter module is isomorphic to
\[
  M\otimes_B(B\otimes_A C)\otimes_C N=(M\otimes_B B)\otimes_A(C\otimes_C N)=M\otimes_A N.
\]
\end{proof}

\begin{prop}[9.1.4]
\label{1.9.1.4}
Let $f:T\to X$, and $g:T\to Y$ be
two $S$-morphisms, and $\sh{F}$ ({\em resp.} $\sh{G}$) a quasi-coherent
$\OO_X$-module ({\em resp.} quasi-coherent $\OO_Y$-module). Then
\[
  (f,g)^*_S(\sh{F}\otimes_S\sh{G})=f^*(\sh{F})\otimes_{\OO_T}g^*(\sh{G}).
\]
\end{prop}

\begin{proof}
\label{proof-1.9.14}
If $p$, $q$ are the projections of $X\times_S Y$, then the formula in fact follows
from the relations $(f,g)^*_S\circ p^*=f^*$ and
$(f,g)^*_S\circ q^*=g^*$ \hyperref[0.3.5.5]{(\textbf{0},~3.5.5)}, and the fact that the inverse
image of a tensor product of algebraic sheaves is the tensor product of their inverse
images \hyperref[0.4.3.3]{(\textbf{0},~4.3.3)}.
\end{proof}

\begin{cor}[9.1.5]
\label{1.9.1.5}
Let $f:X\to X'$ and $g:Y\to Y'$ be
$S$-morphisms, and $\sh{F}'$ ({\em resp.} $\sh{G}'$) a quasi-coherent
$\OO_{X'}$-module ({\em resp.} quasi-coherent $\OO_{Y'}$-module). Then
\[
  (f,g)^*_S(\sh{F}'\otimes_S\sh{G}')=f^*(\sh{F}')\otimes_S g^*(\sh{G}')
\]
\end{cor}

\begin{proof}
\label{proof-1.9.1.5}
This follows from \hyperref[1.9.1.4]{(9.1.4)} and the fact that $f\times_S g=(f\circ p, g\circ q)_S$,
where $p$, $q$ are the projections of $X\times_S Y$.
\end{proof}

\begin{cor}[9.1.6]
\label{1.9.1.6}
Let $X$, $Y$, $Z$ be three $S$-preschemes, and $\sh{F}$ ({\em resp.} $\sh{G}$, $\sh{H}$) a
quasi-coherent $\OO_X$-module ({\em resp.} quasi-coherent $\OO_Y$-module, quasi-coherent
$\OO_Z$-module); then the sheaf $\sh{F}\otimes_S\sh{G}\otimes_S\sh{H}$ is the inverse image
of $(\sh{F}\otimes_S\sh{G})\otimes_S\sh{H}$ by the canonical isomorphism from
$X\times_S Y\times_S Z$ to $(X\times_S Y)\times_S Z$.
\end{cor}

\begin{proof}
\label{proof-1.9.16}
This isomorphism is given by $(p_1,p_2)_S\times_S p_3$, where $p_1$, $p_2$, $p_3$
are the projections of $X\times_S Y\times_S Z$.

Similarly, the inverse image of $\sh{G}\otimes_S\sh{F}$ under the canonical isomorphism from
$X\times_S Y$ to $Y\times_S X$ is $\sh{F}\otimes_S\sh{G}$.
\end{proof}

\begin{cor}[9.1.7]
\label{1.9.1.7}
If $X$ is an $S$-prescheme, then every quasi-coherent $\OO_X$-module $\sh{F}$ is the inverse
image of $\sh{F}\otimes_S\OO_S$ by the canonical isomorphism from $X$ to $X\times_S S$
\hyperref[1.3.3.3]{(3.3.3)}.
\end{cor}

\begin{proof}
\label{proof-1.9.1.7}
This isomorphism is $(1_X,\vphi)_S$, where $\vphi$ is the structure morphism
$X\to S$, and the corollary follows from \hyperref[1.9.1.4]{(9.1.4)} and the fact that
$\vphi^*(\OO_S)=\OO_X$.
\end{proof}

\begin{env}[9.1.8]
\label{1.9.1.8}
Let $X$ be an $S$-prescheme, $\sh{F}$ a quasi-coherent
$\OO_X$-module, and $\vphi:S'\to S$ a morphism; we denote by
$\sh{F}_{(\vphi)}$ or $\sh{F}_{(S')}$ the quasi-coherent sheaf
$\sh{F}\otimes_S\OO_{S'}$ over $X\times_S S'=X_{(\vphi)}=X_{(S')}$; so
$\sh{F}_{(S')}=p^*(\sh{F})$, where $p$ is the projection $X_{(S')}\to X$.
\end{env}

\begin{prop}[9.1.9]
\label{1.9.1.9}
Let $\vphi'':S''\to S'$ be a morphism.
For every quasi-coherent $\OO_X$-module $\sh{F}$ on the $S$-prescheme $X$,
$(\sh{F}_{(\vphi)})_{(\vphi')}$ is the inverse image of
$\sh{F}_{(\vphi\circ\vphi')}$ by the canonical isomorphism
$(X_{(\vphi)})_{(\vphi')}\isoto X_{(\vphi\circ\vphi')}$
\hyperref[1.3.3.9]{(3.3.9)}.
\end{prop}

\begin{proof}
\label{proof-1.9.1.9}
This follows immediately from the definitions and from \hyperref[1.3.3.9]{(3.3.9)}, and is
written
\[
  (\sh{F}\otimes_S\OO_{S'})\otimes_{S'}\OO_{S''}=\sh{F}\otimes_S\OO_{S''}.
  \tag{9.1.9.1}
\]
\end{proof}

\begin{prop}[9.1.10]
\label{1.9.1.10}
Let $Y$ be an $S$-prescheme, and $f:X\to Y$ an $S$-morphism.
For every quasi-coherent $\OO_Y$-module and every morphism
$S'\to S$, we have that
$(f_{(S')})^*(\sh{G}_{(S')})=(f^*(\sh{G}))_{(S')}$.
\end{prop}

\begin{proof}
\label{proof-1.9.1.10}
This follows immediately from the commutativity of the diagram
\oldpage[I]{171}
\[
  \xymatrix{
    X_{(S')}\ar[r]^{f_{(S')}}\ar[d] &
    Y_{(S')}\ar[d]\\
    X\ar[r]^f &
    Y.
  }
\]
\end{proof}

\begin{cor}[9.1.11]
\label{1.9.1.11}
Let $X$ and $Y$ be $S$-preschemes, and
$\sh{F}$ ({\em resp.} $\sh{G}$) a quasi-coherent $\OO_X$-module
({\em resp.} quasi-coherent $\OO_Y$-module). Then the inverse image of the sheaf
$(\sh{F}_{(S')})\otimes_{(S')}(\sh{G}_{(S')})$ by the canonical isomorphism
$(X\times_S Y)_{(S')}\isoto(X_{(S')})\times_{S'}(Y_{(S')})$
\hyperref[1.3.3.10]{(3.3.10)} is equal to $(\sh{F}\otimes_S\sh{G})_{(S')}$.
\end{cor}

\begin{proof}
\label{proof-1.9.1.11}
If $p$, $q$ are the projections of $X\times_S Y$, then the isomorphism in question
is nothing but $(p_{(S')}, q_{(S')})_{S'}$; the corollary then follows from the
Propositions \hyperref[1.9.1.4]{(9.1.4)} and \hyperref[1.9.1.10]{(9.1.10)}.
\end{proof}

\begin{prop}[9.1.12]
\label{1.9.1.12}
With the notation from Definition \hyperref[1.9.1.2]{(9.1.2)}, let $z$ be
a point of $X\times_S Y$, $x=p(z)$, and $y=q(z)$; the stalk
$(\sh{F}\otimes_S\sh{G})_z$ is isomorphic to
$(\sh{F}_x\otimes_{\OO_x}\OO_z)\otimes_{\OO_z}(\sh{G}_y\otimes_{\OO_y}\OO_z)
  =\sh{F}_x\otimes_{\OO_x}\OO_z\otimes_{\OO_y}\otimes\sh{G}_y$.
\end{prop}

\begin{proof}
\label{proof-1.9.1.12}
As we can reduce to the affine case, the proposition follows from
equation (1.6.5.1).
\end{proof}

\begin{cor}[9.1.13]
\label{1.9.1.13}
If $\sh{F}$ and $\sh{G}$ are of finite type, then we have that
\[
  \Supp(\sh{F}\otimes_S\sh{G})=p^{-1}(\Supp(\sh{F}))\cap q^{-1}(\Supp(\sh{G})).
\]
\end{cor}

\begin{proof}
\label{proof-1.9.1.13}
Since $p^*(\sh{F})$ and $q^*(\sh{G})$ are both of finite type over
$\OO_{X\times_S Y}$, we reduce, by Proposition \hyperref[1.9.1.12]{(9.1.12)} and
by \hyperref[0.1.7.5]{(\textbf{0},~1.7.5)}, to the case where $\sh{G}=\OO_Y$, that
is, it remains to prove the following equation:
\[
  \Supp(p^{-1}(\sh{F}))=p^{-1}(\Supp(\sh{F})).
  \tag{9.1.13.1}
\]

The same reasoning as in \hyperref[0.1.7.5]{(\textbf{0},~1.7.5)} leads us to prove that, for all
$z\in X\times_S Y$, we have $\OO_z/\mathfrak{m}_x\OO_z\neq0$ (with $x=p(z)$),
which follows from the fact that the homomorphism $\OO_x\to\OO_z$ is {\em local},
by hypothesis.
\end{proof}

We leave it to the reader to extend the results in this section to the more
general case of arbitrarily (but finitely) many factors, instead of just two.

\subsection{Direct image of a quasi-coherent sheaf}
\label{subsection-direct-image-of-qcoh}

\begin{prop}[9.2.1]
\label{1.9.2.1}
Let $f:X\to Y$ be a morphism of
preschemes. We suppose that there exists a cover $(Y_\alpha)$ of $Y$ by affine
opens having the following property: every $f^{-1}(Y_\alpha)$ admits a
{\em finite} cover $(X_{\alpha i})$ by affine opens contained in
$f^{-1}(Y_\alpha)$ such that every intersection $X_{\alpha i}\cap X_{\alpha j}$
is itself a {\em finite} union of affine opens. With these hypotheses, for
every quasi-coherent $\OO_X$-module $\sh{F}$, $f_*(\sh{F})$ is a
quasi-coherent $\OO_Y$-module.
\end{prop}

\begin{proof}
\label{proof-1.9.2.1}
Since this is a local condition on $Y$, we can assume that $Y$ is equal to one
of the $Y_\alpha$, and thus omit the indices $\alpha$.
\begin{enumerate}[label=(\alph*)]
  \item First, suppose that the $X_i\cap X_j$
    are themselves {\em affine} opens. We set $\sh{F}_i=\sh{F}|X_i$ and
    $\sh{F}_{ij}=\sh{F}|(X_i\cap X_j)$, and let $\sh{F}'_i$ and
    $\sh{F}'_{ij}$ be the images of $\sh{F}_i$ and $\sh{F}_{ij}$
    (respectively) by the restriction of $f$ to $X_i$ and $X_i\cap X_j$
    (respectively); we know that the $\sh{F}'_i$ and $\sh{F}'_{ij}$ are
    quasi-coherent \hyperref[1.1.6.3]{(1.6.3)}. Set $\sh{G}=\bigoplus_i\sh{F}'_i$ and
    $\sh{H}=\bigoplus_{i,j}\sh{F}'_{ij}$; $\sh{G}$ and $\sh{H}$ are
    quasi-coherent $\OO_Y$-modules; we will define a homomorphism
    $u:\sh{G}\to\sh{H}$ such that $f_*(\sh{F})$ is the
    {\em kernel} of $u$; it will follow from this that $f_*(\sh{F})$ is
    quasi-coherent \hyperref[1.1.3.9]{(1.3.9)}. It suffices to define $u$ as
\oldpage[I]{172}
    a homomorphism of presheaves; taking into account the definitions of $\sh{G}$
    and $\sh{H}$, it thus suffices, for every open subset $W\subset Y$, to define a
    homomorphism
    \[
      u_W:\bigoplus_i\Gamma(f^{-1}(W)\cap X_i,\sh{F})
      \longrightarrow\bigoplus_{i,j}\Gamma(f^{-1}(W)\cap X_i\cap X_j,\sh{F})
    \]
    in such a way that it satisfies the usual compatibility conditions when $W$
    varies. If, for every section $s_i\in\Gamma(f^{-1}(W)\cap X_i,\sh{F})$, we
    denote by $s_{i|j}$ the restriction to $f^{-1}(W)\cap X_i\cap X_j$, then we set
    \[
      u_W\big((s_i)\big)=(s_{i|j}-s_{j|i})
    \]
    and the compatibility conditions are clearly satisfied. To prove that the kernel
    $\sh{R}$ of $u$ is $f_*(\sh{F})$, we define a homomorphism from $f_*(\sh{F})$ to
    $\sh{R}$ by sending each section $s\in\Gamma(f^{-1}(W),\sh{F})$ to the family
    $(s_i)$, where $s_i$ is the restriction of $s$ to $f^{-1}(W)\cap X_i$; the
    axioms (F1) and (F2) of sheaves (G, II, 1.1) tell us that this homomorphism is
    {\em bijective}, which finishes the proof in this case.
  \item In the general case, the same reasoning applies once we have established that
    the $\sh{F}_{ij}$ are quasi-coherent. But, by hypothesis, $X_i\cap X_j$ is a
    finite union of affine opens $X_{ijk}$; and since the $X_{ijk}$ are affine opens
    {\em in a scheme}, the intersection of any two of them is again an affine open
    \hyperref[1.5.5.6]{(5.5.6)}. We are thus led to the first case, and so we have proved
    Proposition \hyperref[1.9.2.1]{(9.2.1)}.
\end{enumerate}
\end{proof}

\begin{cor}[9.2.2]
\label{1.9.2.2}
The conclusion of Proposition \hyperref[1.9.2.1]{(9.2.1)} holds true in each of the following cases:
\begin{enumerate}[label={\rm(\alph*)}]
  \item $f$ is separated and quasi-compact.
  \item $f$ is separated and of finite type.
  \item $f$ is quasi-compact and the underlying space of $X$ is locally Noetherian.
\end{enumerate}
\end{cor}

\begin{proof}
\label{proof-1.9.2.2}
In the case (a), the $X_{\alpha i}\cap X_{\alpha j}$ are affine \hyperref[1.5.5.6]{(5.5.6)}.
Case (b) is a particular case of (a) \hyperref[1.6.6.3]{(6.6.3)}. Finally, in case
(c), we can reduce to the case where $Y$ is affine and the underlying
space of $X$ is Noetherian; then $X$ admits a finite cover of affine opens
$(X_i)$, and the $X_i\cap X_j$, being quasi-compact, are finite unions of affine
opens \hyperref[1.2.1.3]{(2.1.3)}.
\end{proof}

\subsection{Extension of sections of quasi-coherent sheaves}
\label{subsection-extension-of-sections-of-qcoh}

\begin{thm}[9.3.1]
\label{1.9.3.1}
Let $X$ be a prescheme whose underlying space is Noetherian, or a scheme whose underlying
space is quasi-compact. Let $\sh{L}$ be an invertible $\OO_X$-module \hyperref[0.5.4.1]{(\textbf{0},~5.4.1)}, $f$ a
section of $\sh{L}$ over $X$, $X_f$ the open set of $x\in X$ such that $f(x)\neq0$
\hyperref[0.5.5.1]{(\textbf{0},~5.5.1)}, and $\sh{F}$ a quasi-coherent $\OO_X$-module.
\begin{enumerate}[label={\rm(\roman*)}]
  \item If $s\in\Gamma(X,\sh{F})$ is such that $s|X_f=0$, then there exists an integer $n>0$
    such that $s\otimes f^{\otimes n}=0$.
  \item For every section $s\in\Gamma(X_f,\sh{F})$, there exists an integer $n>0$ such that
    $s\otimes f^{\otimes n}$ extends to a section of $\sh{F}\otimes\sh{L}^{\otimes n}$ over $X$.
\end{enumerate}
\end{thm}

\begin{proof}
\label{proof-1.9.3.1}
\medskip\noindent
\begin{enumerate}[label=(\roman*)]
  \item Since the underlying space of $X$ is quasi-compact, and thus the union of
    finitely-many affine opens $U_i$ with $\sh{L}|U_i$ is isomorphic to
    $\OO_X|U_i$, we can reduce to the case where $X$ is affine and $\sh{L}=\OO_X$.
    In this case, $f$ is identified with an element of $A(X)$, and we have that
    $X_f=D(f)$; $s$ is identified with an element of an $A(X)$-module $M$, and
    $s|X_f$ to the corresponding element of $M_f$, and the result is then trivial,
    recalling the definition of a module of fractions.
\oldpage[I]{173}
  \item Again, $X$ is a finite union of affine opens $U_i$ ($1\leqslant i\leqslant r$)
    such that $\sh{L}|U_i\cong\OO_X|U_i$, and for every $i$,
    $(s\otimes f^{\otimes n})|(U_i\cap X_f)$ is identified (by the aforementioned
    isomorphism) with $(f|(U_i\cap X_f))^n(s|(U_i\cap X_f))$. We then know
    \hyperref[1.1.4.1]{(1.4.1)} that there exists an integer $n>0$ such that, for all
    $i$, $(s\otimes f^{\otimes n})|(U_i\cap X_f)$ extends to a section $s_i$ of
    $\sh{F}\otimes\sh{L}^{\otimes n}$ over $U_i$. Let $s_{i|j}$ be the restriction
    of $s_i$ to $U_i\cap U_j$; by definition we have that $s_{i|j}-s_{j|i}=0$ on
    $X_f\cap U_i\cap U_j$. But, if $X$ is a Noetherian space, then $U_i\cap U_j$ is
    quasi-compact; if $X$ is a scheme, then $U_i\cap U_j$ is an affine open
    \hyperref[1.5.5.6]{(5.5.6)}, and so again quasi-compact. By virtue of (i), there thus
    exists an integer $m$ (independent of $i$ and $j$) such that
    $(s_{i|j}-s_{j|i})\otimes f^{\otimes m}=0$. It immediately follows that there
    exists a section $s'$ of $\sh{F}\otimes\sh{L}^{\otimes(n+m)}$ over $X$,
    restricting to $s_i\otimes f^{\otimes m}$ over each $U_i$, and restricting to
    $s\otimes f^{\otimes(n+m)}$ over $X_f$.
\end{enumerate}
\end{proof}

The following corollaries give an interpretation of Theorem \hyperref[1.9.3.1]{(9.3.1)} in a more
algebraic language:
\begin{cor}[9.3.2]
\label{1.9.3.2}
With the hypotheses of \hyperref[1.9.3.1]{(9.3.1)}, consider the graded ring $A_*=\Gamma_*(\sh{L})$
and the graded $A_*$-module $M_*=\Gamma_*(\sh{L},\sh{F})$ \hyperref[0.5.4.6]{(\textbf{0},~5.4.6)}. If $f\in A_n$,
where $n\in\bb{Z}$, then there is a canonical isomorphism
$\Gamma(X_f,\sh{F})\isoto((M_*)_f)_0$ ({\em the subgroup of the module of
fractions $(M_*)_f$ consisting of elements of degree $0$}).
\end{cor}

\begin{cor}[9.3.3]
\label{1.9.3.3}
Suppose that the hypotheses of \hyperref[1.9.3.1]{(9.3.1)} are satisfied, and suppose further that
$\sh{L}=\OO_X$. Then, setting $A=\Gamma(X,\OO_X)$ and $M=\Gamma(X,\sh{F})$, the $A_f$-module
$\Gamma(X_f,\sh{F})$ is canonically isomorphic to $M_f$.
\end{cor}

\begin{prop}[9.3.4]
\label{1.9.3.4}
Let $X$ be a Noetherian prescheme, $\sh{F}$ a coherent $\OO_X$-module, and $\sh{J}$ a
coherent sheaf of ideals in $\OO_X$, such that the support of $\sh{F}$ is contained in that
of $\OO_X|\sh{J}$. Then there exists a whole number $n>0$ such that $\sh{J}^n\sh{F}=0$.
\end{prop}

\begin{proof}
\label{proof-1.9.3.4}
Since $X$ is a union of finitely-many affine opens whose rings are Noetherian, we can suppose
that $X$ is affine of Noetherian ring $A$; then $\sh{F}=\widetilde{M}$, where
$M=\Gamma(X,\sh{F})$ is an $A$-module of finite type, and $\sh{J}=\widetilde{\mathfrak{J}}$,
where $\mathfrak{J}=\Gamma(X,\sh{J})$ is an ideal of $A$ (\hyperref[1.1.4.1]{(1.4.1)} and
\hyperref[1.1.5.1]{(1.5.1)}). Since $A$ is Noetherian, $\mathfrak{J}$ admits a finite system of
generators $f_i$ ($1\leqslant i\leqslant m$). By hypothesis, every section of $\sh{F}$ over
$X$ is zero on each of the $D(f_i)$; if $s_j$ ($1\leqslant j\leqslant q$) are sections of
$\sh{F}$ generating $M$, then there exists a whole number $h$, independent of $i$ and $j$,
such that $f_i^h s_j=0$ \hyperref[1.1.4.1]{(1.4.1)}, whence $f_i^h s=0$ for all $s\in M$. We thus
conclude that if $n=mh$ then $\mathfrak{J}^n M=0$, and so the corresponding $\OO_X$-module
$\sh{J}^n\sh{F}=\widetilde{\mathfrak{J}^n M}$ \hyperref[1.1.3.13]{(1.3.13)} is zero.
\end{proof}

\begin{cor}[9.3.5]
\label{1.9.3.5}
With the hypotheses of \hyperref[1.9.3.4]{(9.3.4)}, there exists a closed subprescheme $Y$ of $X$,
whose underlying space is the support of $\OO_X/\sh{J}$, such that, if $j:Y\to X$ is the
canonical injection, then $\sh{F}=j_*(j^*(\sh{F}))$.
\end{cor}

\begin{proof}
\label{proof-1.9.3.5}
First, note that the supports of $\OO_X/\sh{J}$ and $\OO_X/\sh{J}^n$ are the same,
since, if $\sh{J}_x=\OO_x$, then $\sh{J}_x^n=\OO_x$, and we also have that
$\sh{J}_x^n\subset\sh{J}_x$ for all $x\in X$. We can, thanks to \hyperref[1.9.3.4]{(9.3.4)}, thus
suppose that $\sh{J}\sh{F}=0$; we can then take $Y$ to be the closed subprescheme of $X$
defined by $\sh{J}$, and since $\sh{F}$ is then an $(\OO_X/\sh{J})$-module, the conclusion
follows immediately.
\end{proof}

\subsection{Extension of quasi-coherent sheaves}
\label{subsection-extension-of-qcoh}

\begin{env}[9.4.1]
\label{1.9.4.1}
Let
\oldpage[I]{174}
$X$ be a topological space, $\sh{F}$ a sheaf of sets (resp. of groups, of rings) on $X$, $U$
an open subset of $X$, $\psi:U\to X$ the canonical injection, and $\sh{G}$ a subsheaf of
$\sh{F}|U=\psi^*(\sh{F})$. Since $\psi_*$ is left exact, $\psi_*(\sh{G})$ is a subsheaf of
$\psi_*(\psi^*(\sh{F}))$; if we denote by $\rho$ the canonical homomorphism
$\sh{F}\to\psi_*(\psi^*(\sh{F}))$ \hyperref[0.3.5.3]{(\textbf{0},~3.5.3)}, then we denote by $\overline{\sh{G}}$
the subsheaf $\rho^{-1}(\psi_*(\sh{G}))$ of $\sh{F}$. It follows immediately from the
definitions that, for every open subset $V$ of $X$, $\Gamma(V,\overline{\sh{G}})$ consists of
sections $s\in\Gamma(V,\sh{F})$ whose restriction to $V\cap U$ is a section of $\sh{G}$ over
$V\cap U$. We thus have that $\overline{\sh{G}}|U=\psi^*(\overline{\sh{G}})=\sh{G}$, and that
$\overline{\sh{G}}$ is the {\em largest} subsheaf of $\sh{F}$ that restricts to $\sh{G}$
over $U$; we say that $\overline{\sh{G}}$ is the {\em canonical extension} of the subsheaf
$\sh{G}$ of $\sh{F}|U$ to a subsheaf of $\sh{F}$.
\end{env}

\begin{prop}[9.4.2]
\label{1.9.4.2}
Let $X$ be a prescheme, $U$ an open subset of $X$ such that the canonical injection
$j:U\to X$ is a quasi-compact morphism {\em (which will be the case for {\em all} $U$ if
the underlying space of $X$ is {\em locally Noetherian}
\hyperref[1.6.6.4]{(6.6.4)}, (i))}. Then:
\begin{enumerate}[label={\rm(\roman*)}]
  \item For every quasi-coherent $(\OO_X|U)$-module $\sh{G}$, $j_*(\sh{G})$
    is a quasi-coherent $\OO_X$-module, and $j_*(\sh{G})|U=j^*(j_*(\sh{G}))=\sh{G}$.
  \item For every quasi-coherent $\OO_X$-module $\sh{F}$ and every quasi-coherent
    $(\OO_X|U)$-submodule $\sh{G}$, the canonical extension
    $\overline{\sh{G}}$ of $\sh{G}$ \hyperref[1.9.4.1]{(9.4.1)} is a
    quasi-coherent $\OO_X$-submodule of $\sh{F}$.
\end{enumerate}
\end{prop}

\begin{proof}
\label{proof-1.9.4.2}
If $j=(\psi,\theta)$ ($\psi$ being the injection $U\to X$ of underlying spaces), then by
definition we have that $j_*(\sh{G})=\psi_*(\sh{G})$ for every $(\OO_X|U)$-module $\sh{G}$,
and, further, that $j^*(\sh{H})=\psi^*(\sh{H})=\sh{H}|U$ for every $\OO_X$-module $\sh{H}$,
by definition of the prescheme induced over an open subset. So (i) is thus a particular case
of (\hyperref[1.9.2.2]{(9.2.2)}, (a)); for the same reason, $j_*(j^*(\sh{F}))$ is quasi-coherent, and
since $\overline{\sh{G}}$ is the inverse image of $j_*(\sh{G})$ by the homomorphism
$\rho:\sh{F}\to j_*(j^*(\sh{F}))$, (ii) follows from \hyperref[1.4.1.1]{(4.1.1)}.
\end{proof}

Note that the hypothesis that the morphism $j:U\to X$ is quasi-compact
holds whenever the open subset $U$ is {\em quasi-compact} and $X$ is a
{\em scheme}: indeed, $U$ is then a union of finitely-many affine opens $U_i$,
and for every affine open $V$ of $X$, $V\cap U_i$ is an affine open \hyperref[1.5.5.6]{(5.5.6)}, and
thus quasi-compact.

\begin{cor}[9.4.3]
\label{1.9.4.3}
Let $X$ be a prescheme, $U$ a quasi-compact open subset of $X$ such that the injection
morphism $j:U\to X$ is quasi-compact. Suppose as well that every quasi-coherent
$\OO_X$-module is the inductive limit of its quasi-coherent $\OO_X$-submodules of finite type
{\em (which will be the case if $X$ is an {\em affine scheme})}. Then let $\sh{F}$ be a
quasi-coherent $\OO_X$-module, and $\sh{G}$ a quasi-coherent $(\OO_X|U)$-submodule {\em of
finite type} of $\sh{F}|U$. Then there exists a quasi-coherent $\OO_X$-submodule $\sh{G}'$ of
$\sh{F}$ {\em of finite type} such that $\sh{G}'|U=\sh{G}$.
\end{cor}

\begin{proof}
\label{proof-1.9.4.3}
We have $\sh{G}=\overline{\sh{G}}|U$, and $\overline{\sh{G}}$ is quasi-coherent, from
\hyperref[1.9.4.2]{(9.4.2)}, and so the inductive limit of its quasi-coherent $\OO_X$-submodules
$\sh{H}_\lambda$ of finite type. It follows that $\sh{G}$ is the inductive limit of the
$\sh{H}_\lambda|U$, and thus equal to one of the $\sh{H}_\lambda|U$ since it is of finite
type \hyperref[0.5.2.3]{(\textbf{0},~5.2.3)}.
\end{proof}

\begin{rmk}[9.4.4]
\label{1.9.4.4}
Suppose that for {\em every} affine open $U\subset X$, the injection morphism $U\to X$ is
quasi-compact. Then, if the conclusion of \hyperref[1.9.4.3]{(9.4.3)} holds for every affine open $U$
and every quasi-coherent $(\OO_X|U)$-submodule $\sh{G}$ of $\sh{F}|U$ of finite type, it
follows
\oldpage[I]{175}
that $\sh{F}$ is the inductive limit of its quasi-coherent $\OO_X$-submodules of finite type.
Indeed, for every affine open $U\subset X$, we have that $\sh{F}|U=\widetilde{M}$, where $M$
is an $A(U)$-module, and since the latter is the inductive limit of its quasi-coherent
submodules of finite type, $\sh{F}|U$ is the inductive limit of its $(\OO_X|U)$-submodules of
finite type \hyperref[1.1.3.9]{(1.3.9)}. But, by hypothesis, each of these submodules is induced on $U$
by a quasi-coherent $\OO_X$-submodule $\sh{G}_{\lambda,U}$ of $\sh{F}$ of finite type. The
finite sums of the $\sh{G}_{\lambda,U}$ are again quasi-coherent $\OO_X$-modules of finite
type, because the property is local, and the case where $X$ is affine was covered in
\hyperref[1.1.3.10]{(1.3.10)}; it is clear then that $\sh{F}$ is the inductive limit of these finite
sums, whence our claim.
\end{rmk}

\begin{cor}[9.4.5]
\label{1.9.4.5}
Under the hypotheses of Corollary \hyperref[1.9.4.3]{(9.4.3)}, for every quasi-coherent $(\OO_X|U)$-module
$\sh{G}$ of finite type, there exists a quasi-coherent $\OO_X$-module $\sh{G}'$ of finite
type such that $\sh{G}'|U=\sh{G}$.
\end{cor}

\begin{proof}
\label{proof-1.9.4.5}
Since $\sh{F}=j_*(\sh{G})$ is quasi-coherent \hyperref[1.9.4.2]{(9.4.2)} and $\sh{F}|U=\sh{G}$, it
suffices to apply Corollary \hyperref[1.9.4.3]{(9.4.3)} to $\sh{F}$.
\end{proof}

\begin{lem}[9.4.6]
\label{1.9.4.6}
Let $X$ be a prescheme, $L$ a well-ordered set, $(V_\lambda)_{\lambda\in L}$ a cover of $X$
by affine opens, and $U$ an open subset of $X$; for all $\lambda\in L$, we set
$W_\lambda=\bigcup_{\mu<\lambda}V_\mu$. Suppose that: (1) for every $\lambda\in L$,
$V_\lambda\cap W_\lambda$ is quasi-compact; (2) the immersion morphism $U\to X$ is
quasi-compact. Then, for every quasi-coherent $\OO_X$-module $\sh{F}$ and every
quasi-coherent $(\OO_X|U)$-submodule $\sh{G}$ of $\sh{F}|U$ {\em of finite type}, there
exists a quasi-coherent $\OO_X$-submodule $\sh{G}'$ of $\sh{F}$ {\em of finite type} such
that $\sh{G}'|U=\sh{G}$.
\end{lem}

\begin{proof}
\label{proof-1.9.4.6}
Let $U_\lambda=U\cup W_\lambda$; we will define a family $(\sh{G}'_\lambda)$ by induction,
where $\sh{G}'_\lambda$ is a quasi-coherent $(\OO_X|U_\lambda)$-submodule of
$\sh{F}|U_\lambda$ of finite type, such that $\sh{G}'_\lambda|U_\mu=\sh{G}'_\mu$ for
$\mu<\lambda$ and $\sh{G}'_\lambda|U=\sh{G}$. The unique $\OO_X$-submodule $\sh{G}'$ of
$\sh{F}$ such that $\sh{G}'|U_\lambda=\sh{G}'$ for all $\lambda\in L$ \hyperref[0.3.3.1]{(\textbf{0},~3.3.1)} gives
us what we want. So suppose that the $\sh{G}'_\mu$ are defined and have the preceding
properties for $\mu<\lambda$; if $\lambda$ does not have a predecessor then we take for
$\sh{G}'_\lambda$ the unique $(\OO_X|U_\lambda)$-submodule of $\sh{F}|U_\lambda$ such that
$\sh{G}'_\lambda|U_\mu=\sh{G}'_\mu$ for all $\mu<\lambda$, which is allowed since the $U_\mu$
with $\mu<\lambda$ then form a cover of $U_\lambda$. If, conversely, $\lambda=\mu+1$, then
$U_\lambda=U_\mu\cup V_\mu$, and it suffices to define a quasi-coherent
$(\OO_X|V_\mu)$-submodule $\sh{G}''_\mu$ of $\sh{F}|V_\mu$ of finite type such that
\[
  \sh{G}''_\mu|(U_\mu\cap V_\mu)=\sh{G}'_\mu|(U_\mu\cap V_\mu);
\]
and then to take for $\sh{G}'_\lambda$ the $(\OO_X|U_\lambda)$-submodule of
$\sh{F}|U_\lambda$ such that $\sh{G}'_\lambda|U_\mu=\sh{G}'_\mu$ and
$\sh{G}'_\lambda|V_\mu=\sh{G}''_\mu$ \hyperref[0.3.3.1]{(\textbf{0},~3.3.1)}. But, since $V_\mu$ is affine, the
existence of $\sh{G}''_\mu$ is guaranteed by \hyperref[1.9.4.3]{(9.4.3)} as soon as we show that
$U_\mu\cap V_\mu$ is quasi-compact; but $U_\mu\cap V_\mu$ is the union of $U\cap V_\mu$ and
$W_\mu\cap V_\mu$, which are both quasi-compact by virtue of the hypothesis.
\end{proof}

\begin{thm}[9.4.7]
\label{1.9.4.7}
Let $X$ be a prescheme, and $U$ an open set of $X$. Suppose that one of the following
conditions is verified:
\begin{enumerate}[label={\rm(\alph*)}]
  \item the underlying space of $X$ is locally Noetherian;
  \item $X$ is a quasi-compact scheme and $U$ is a quasi-compact open.
\end{enumerate}
Then, for every quasi-coherent $\OO_X$-module $\sh{F}$ and every quasi-coherent
$(\OO_X|U)$-submodule $\sh{G}$ of $\sh{F}|U$ {\em of finite type}, there exists a
quasi-coherent $\OO_X$-submodule $\sh{G}'$ of $\sh{F}$ {\em of finite type} such that
$\sh{G}'|U=\sh{G}$.
\end{thm}

\begin{proof}
\label{proof-1.9.4.7}
Let
\oldpage[I]{176}
$(V_\lambda)_{\lambda\in L}$ be a cover of $X$ by affine opens, with $L$ assumed to be finite
in case (b); since $L$ is equipped with the structure of a well-ordered set, it suffices to
check that the conditions of \hyperref[1.9.4.6]{(9.4.6)} are satisfied. It is clear in the case of (a),
as the spaces $V_\lambda$ are Noetherian. For case (b), the $V_\lambda\cap\lambda_\mu$ are
affine \hyperref[1.5.5.6]{(5.5.6)}, and thus quasi-compact, and since $L$ is finite,
$V_\lambda\cap W_\lambda$ is quasi-compact. Whence the theorem.
\end{proof}

\begin{cor}[9.4.8]
\label{1.9.4.8}
Under the hypotheses of \hyperref[1.9.4.7]{(9.4.7)}, for every quasi-coherent $(\OO_X|U)$-module
$\sh{G}$ of finite type, there exists a quasi-coherent $\OO_X$-module $\sh{G}'$ of finite
type such that $\sh{G}'|U=\sh{G}$.
\end{cor}

\begin{proof}
\label{proof-1.9.4.8}
It suffices to apply \hyperref[1.9.4.7]{(9.4.7)} to $\sh{F}=j_*(\sh{G})$, which is quasi-coherent
\hyperref[1.9.4.2]{(9.4.2)} and such that $\sh{F}|U=\sh{G}$.
\end{proof}

\begin{cor}[9.4.9]
\label{1.9.4.9}
Let $X$ be a prescheme whose underlying space is locally Noetherian, or a quasi-compact
scheme. Then every quasi-coherent $\OO_X$-module is the inductive limit of its quasi-coherent
$\OO_X$-submodules of finite type.
\end{cor}

\begin{proof}
\label{proof-1.9.4.9}
This follows from Theorem \hyperref[1.9.4.7]{(9.4.7)} and Remark \hyperref[1.9.4.4]{(9.4.4)}.
\end{proof}

\begin{cor}[9.4.10]
\label{1.9.4.10}
Under the hypotheses of \hyperref[1.9.4.9]{(9.4.9)}, if a quasi-coherent $\OO_X$-module $\sh{F}$ is
such that every quasi-coherent $\OO_X$-submodule of finite type of $\sh{F}$ is generated by
its sections over $X$, then $\sh{F}$ is generated by its sections over $X$.
\end{cor}

\begin{proof}
\label{proof-1.9.4.10}
Let $U$ be an affine open neighborhood of a point $x\in X$, and let $s$ be a
section of $\sh{F}$ over $U$; the $\OO_X$-submodule $\sh{G}$ of $\sh{F}|U$ generated by $s$
is quasi-coherent and of finite type, so there exists a quasi-coherent $\OO_X$-submodule
$\sh{G}'$ of $\sh{F}$ of finite type such that $\sh{G}'|U=\sh{G}$ \hyperref[1.9.4.7]{(9.4.7)}. By
hypothesis, there is thus a finite number of sections $t_i$ of $\sh{G}'$ over $X$ and of
sections $a_i$ of $\OO_X$ over a neighborhood $V\subset U$ of $x$ such that
$s|V=\sum_i a_i(t_i|V)$, which proves the corollary.
\end{proof}

\subsection{Closed image of a prescheme; closure of a subprescheme}
\label{subsection-closed-image-and-closure}

\begin{prop}[9.5.1]
\label{1.9.5.1}
Let $f:X\to Y$ be a morphism of preschemes such that $f_*(\OO_X)$ is a quasi-coherent
$\OO_Y$-module (which will be the case if $f$ is quasi-compact and if in addition $f$ is
either separated or $X$ is locally Noetherian \hyperref[1.9.2.2]{(9.2.2)}). Then there exists a smaller
subprescheme $Y'$ of $Y$ such that $f$ factors through the canonical injection $j:Y'\to Y$
({\em or, equivalently \hyperref[1.4.4.1]{(4.4.1)}, such that the subprescheme $f^{-1}(Y')$ of $X$ is
{\em identical} to $X$}).
\end{prop}

More precisely:
\begin{cor}[9.5.2]
\label{1.9.5.2}
Under the conditions of \hyperref[1.9.5.1]{(9.5.1)}, let $f=(\psi,\theta)$, and let $\sh{J}$ be the
(quasi-coherent) kernel of the homomorphism $\theta:\OO_Y\to f_*(\OO_X)$. Then the closed
subprescheme $Y'$ of $Y$ defined by $\sh{J}$ satisfies the conditions of \hyperref[1.9.5.1]{(9.5.1)}.
\end{cor}

\begin{proof}
\label{proof-1.9.5.2}
Since the functor $\psi^*$ is exact, the canonical factorization
$\theta:\OO_Y\to\OO_Y/\sh{J}\xrightarrow{\theta'}\psi_*(\OO_X)$ gives (\textbf{0},~3.5.4.3)
a factorization
$\theta^\sharp:\psi^*(\OO_Y)\to\psi^*(\OO_Y)/\psi^*(\sh{J})
  \xrightarrow{{\theta'}^\sharp}\OO_X$; since $\theta_x^\sharp$ is a local homomorphism for
every $x\in X$, the same is true of ${\theta_x'}^\sharp$; if we denote by $\psi_0$ the
continuous map $\psi$ considered as a map from $X$ to $X'$, and by $\theta_0$ the restriction
$\theta'|X':(\OO_Y/\sh{J})|X'\to\psi_*(\OO_X)|X'=(\psi_0)_*(\OO_X)$, we see that
$f_0=(\psi_0,\theta_0)$ is a morphism of preschemes $X\to X'$ \hyperref[1.2.2.1]{(2.2.1)} such that
$f=j\circ f_0$. Now, if $X''$ is
\oldpage[I]{177}
a second closed subprescheme of $Y$, defined by a quasi-coherent sheaf of ideals $\sh{J}'$ of
$\OO_Y$, such that $f$ factors through the injection $j':X''\to Y$, then we should
immediately have that $\psi(X)\subset X''$, and so $X'\subset X''$, since $X''$ is closed.
Furthermore, for all $y\in X''$, $\theta$ should factorize as
$\OO_y\to\OO_y/\sh{J}'_y\to(\psi_*(\OO_X))_y$, which by definition leads to
$\sh{J}'_y\subset\sh{J}_y$, and thus $X'$ is a closed subprescheme of $X''$
\hyperref[1.4.1.10]{(4.1.10)}.
\end{proof}

\begin{defn}[9.5.3]
\label{1.9.5.3}
Whenever there exists a smaller subprescheme $Y'$ of $Y$ such that $f$ factors
through the canonical injection $j:Y'\to Y$, we say that $Y'$ is the
{\em closed image} prescheme of $X$ under the morphism $f$.
\end{defn}

\begin{prop}[9.5.4]
\label{1.9.5.4}
If $f_*(\OO_X)$ is a quasi-coherent $\OO_Y$-module, then the underlying space of
the closed image of $X$ under $f$ is the closure $\overline{f(X)}$ in $Y$.
\end{prop}

\begin{proof}
\label{proof-1.9.5.4}
As the support of $f_*(\OO_X)$ is contained in $\overline{f(X)}$, we have (with
the notation of \hyperref[1.9.5.2]{(9.5.2)}) $\sh{J}_y=\OO_y$ for
$y\not\in\overline{f(X)}$, thus the support of $\OO_Y/\sh{J}$ is contained in
$\overline{f(X)}$. In addition, this support is closed and contains $f(X)$:
indeed, if $y\in f(X)$, the unit element of the ring $(\psi_*(\OO_X))_y$ is not
zero, being the germ at $y$ of the section
\[
  1\in\Gamma(X,\OO_X)=\Gamma(Y,\psi_*(\OO_X));
\]
as it is the image under $\theta$ of the unit element of $\OO_y$, the latter
does not belong to $\sh{J}_y$, hence $\OO_y/\sh{J}_y\neq 0$; this finishes the
proof.
\end{proof}

\begin{prop}[9.5.5]
\label{1.9.5.5}
{\em (Transitivity of closed images)}. Let $f:X\to Y$ and $g:Y\to Z$ be two morphisms of
preschemes; we suppose that the closed image $Y'$ of $X$ under $f$ exists, and that if $g'$
is the restriction of $g$ to $Y'$, then the closed image $Z'$ of $Y'$ under $g'$ exists. Then
the closed image of $X$ under $g\circ f$ exists and is equal to $Z'$.
\end{prop}

\begin{proof}
\label{proof-1.9.5.5}
It suffices \hyperref[1.9.5.1]{(9.5.1)} to show that $Z'$ is the smallest closed
subprescheme $Z_1$ of $Z$ such that the closed subprescheme $(g\circ f)^{-1}(Z_1)$ of $X$
(equal to $f^{-1}(g^{-1}(Z_1))$ by Corollary \hyperref[1.4.4.2]{(4.4.2)}) is equal to
$X$; it is equivalent to say that $Z'$ is the smallest closed subprescheme of $Z$ such that
$f$ \unsure{factors} through the injection $g^{-1}(Z_1)\to Y$ \hyperref[1.4.4.1]{(4.4.1)}. By
virtue of the existence of the closed image $Y'$, every $Z_1$ with this property is such
that $g^{-1}(Z_1)$ \unsure{factors} through $Y'$, which is equivalent to saying that $j^{-1}(g^{-1}(Z_1))=g'^{-1}(Z_1)=Y'$, denoting by $j$ the injection $Y'\to Y$.
By the definition of $Z'$, we indeed conclude that $Z'$ is the smallest closed
subprescheme of $Z$ satisfying the preceding condition.
\end{proof}

\begin{cor}[9.5.6]
\label{1.9.5.6}
Let $f:X\to Y$ be an $S$-morphism such that $Y$ is the closed image of $X$ under $f$.
Let $Z$ be an $S$-scheme; if two $S$-morphisms $g_1$, $g_2$ from $Y$ to $Z$ are such that $g_1\circ f=g_2\circ f$ then $g_1=g_2$.
\end{cor}

\begin{proof}
\label{proof-1.9.5.6}
Let $h=(g_1,g_2)_S:Y\to Z\times_S Z$; since the diagonal $T=\Delta_Z(Z)$ is a closed subprescheme of $Z\times_S Z$, $Y'=h^{-1}(T)$ is a closed subprescheme of $Y$ \hyperref[1.4.4.1]{(4.4.1)}.
Let $u=g_1\circ f=g_2\circ f$; we then have, by definition of the product, $h'=h\circ f=(u,u)_S$, so $h\circ f=\Delta_Z\circ u$; since $\Delta_Z^{-1}(T)=Z$, we have $h'^{-1}(T)=u^{-1}(Z)=X$, so $f^{-1}(Y')=X$.
From this, we conclude \hyperref[1.4.4.1]{(4.4.1)} that the canonical injection $Y'\to Y$ \unsure{factors} through $f$, so $Y'=Y$ by hypothesis; it then follows \hyperref[1.4.4.1]{(4.4.1)} that $h$ factorizes as $\Delta_Z\circ v$, where $v$ is a morphism $Y\to Z$, which implies that $g_1=g_2=v$.
\end{proof}

\begin{rmk}[9.5.7]
\label{1.9.5.7}
If $X$ and $Y$ are $S$-schemes, proposition~\hyperref[1.9.5.6]{(9.5.6)} implies that, when\oldpage[I]{178} $Y$ if the closed image of $X$ under $f$, $f$ is an {\em epimorphism} in the category of {\em $S$-schemes} (T,~1.1).
We will show in Chapter~V that, conversely, if the closed image $Y'$ of $X$ under $f$ exists and if $f$ is an epimorphism of $S$-schemes, then we necessarily have $Y'=Y$.
\end{rmk}

\begin{prop}[9.5.8]
\label{1.9.5.8}
Suppose that the hypotheses of \hyperref[1.9.5.1]{(9.5.1)} are satisfied, and let $Y'$ be the closed image of $X$ under $f$.
For every open $V$ of $Y$, let $f_V:f^{-1}(V)\to V$ be the restriction of $f$; then the closed image of $f^{-1}(V)$ under $f_V$ in $V$ exists and is equal to the prescheme induced by $Y'$ on the open $V\cap Y'$ of $Y'$ {\em (said otherwise, to the subprescheme $\inf(V,Y)$) of $Y$ \hyperref[1.4.4.3]{(4.4.3)}}.
\end{prop}

\begin{proof}
\label{proof-1.9.5.8}
Let $X'=f^{-1}(V)$; since the direct image of $\OO_{X'}$ by $f_V$ is exactly the restriction of $f_*(\OO_X)$ to $V$, it is clear that the kernel $\sh{J}'$ of the homomorphism $\OO_V\to(f_V)_*(\OO_{X'})$ is the restriction of $\sh{J}$ to $V$, from where the proposition quickly follows.
\end{proof}

We will see that this result can be understood as saying that taking the closed image commutes with an extension $Y_1\to Y$ of the base prescheme, which is an {\em open immersion}.
We will see in Chapter~IV that it is the same for an extension $Y_1\to Y$ which is a {\em flat} morphism, provided that $f$ is separated and quasi-compact.

\begin{prop}[9.5.9]
\label{1.9.5.9}
Let $f\colon X\to Y$ be a morphism such that the closed image $Y'$ of $X$ under $f$ exists.
\begin{enumerate}[label={\rm(\roman*)}]
  \item If $X$ is reduced, then so too is $Y'$.
  \item If the hypotheses of Proposition \hyperref[1.9.5.1]{(9.5.1)} are satisfied and $X$ is irreducible ({\em resp.} \unsure{integral}), then so too is $Y'$.
\end{enumerate}
\end{prop}

\begin{proof}
\label{proof-1.9.5.9}
By hypothesis, the morphism $f$ factorizes as $X\xrightarrow{g}Y'\xrightarrow{j}Y$, where $j$ is the canonical injection.
As $X$ is reduced, $g$ factorizes as $X\xrightarrow{h}Y'_\mathrm{red}\xrightarrow{j'}Y'$, where $j'$ is the canonical injection \hyperref[1.5.2.2]{(5.2.2)}, and it then follows from the definition of $Y'$ that $Y'_\mathrm{red}=Y'$.
If moreover the conditions of Proposition \hyperref[1.5.9.1]{(9.5.1)} are satisfied, then it follows from \hyperref[1.9.5.4]{(9.5.4)} that $f(X)$ is dense in $Y'$; if $X$ is irreducible, then so is $Y'$ \hyperref[0.2.1.5]{(\textbf{0},~2.1.5)}.
The claim about integral preschemes follows from the conjunction of the two others.
\end{proof}

\begin{prop}[9.5.10]
\label{1.9.5.10}
Let $Y$ be a subprescheme of a prescheme $X$, such that the canonical injection $i:Y\to X$ is a quasi-compact morphism.
Then there exists a smaller closed subprescheme $\overline{Y}$ of $X$ \unsure{containing} $Y$; its underlying space is the closure of that of $Y$; the latter is open in its closure, and the prescheme $Y$ is induced on this open by $\overline{Y}$.
\end{prop}

\begin{proof}
\label{proof-1.9.5.10}
It suffices to apply \hyperref[1.5.9.1]{(9.5.1)} to the injection $j$, which is separated \hyperref[1.5.5.1]{(5.5.1)} and quasi-compact by hypothesis; \hyperref[1.5.9.1]{(9.5.1)} thus proves the existence of $\overline{Y}$ and \hyperref[1.5.9.4]{(9.5.4)} shows that its underlying space is the closure of $Y$ in $X$; since $Y$ is locally closed in $X$, it is open in $\overline{Y}$, and the last claim comes from \hyperref[1.5.9.8]{(9.5.8)} applied to an open $V$ of $X$ such that $Y$ is closed in $V$.
\end{proof}

With the above notation, if the injection $V\to X$ is quasi-compact, and if $\sh{J}$ is the quasi-coherent sheaf of ideals of $\OO_X|V$ defining the closed subprescheme $Y$ of $V$, it follows from \hyperref[1.9.5.1]{(9.5.1)} that the quasi-coherent sheaf of ideals of $\OO_X$ defining $\overline{Y}$ is the canonical extension \hyperref[1.9.4.1]{(9.4.1)} $\overline{\sh{J}}$ of $\sh{J}$, because it is evidently the largest quasi-coherent subsheaf of ideals of $\OO_X$ inducing $\sh{J}$ on $V$.

\begin{cor}[9.5.11]
\label{1.9.5.11}
Under\oldpage[I]{179} the hypotheses of \hyperref[1.9.5.10]{(9.5.10)}, every section of $\OO_{\overline{Y}}$ over an open $V$ of $\overline{Y}$ that is null on $V\cap Y$ is null.
\end{cor}

\begin{proof}
\label{proof-1.9.5.11}
By \hyperref[1.9.5.8]{(9.5.8)}, we can reduce to the case where $V=\overline{Y}$.
If we take into account that the sections of $\OO_{\overline{Y}}$ over $\overline{Y}$ canonically correspond to the $\overline{Y}$-sections of $\overline{Y}\otimes_Z Z[T]$ \hyperref[1.3.3.15]{(3.3.15)} and that the latter is separated over $\overline{Y}$, the corollary appears as a specific case of \hyperref[1.9.5.6]{(9.5.6)}.
\end{proof}

When there exists a smaller closed subprescheme $Y$ of $X$ \unsure{containing} a subprescheme $Y$ of $X$, we say that $Y'$ is the {\em closure} of $Y$ in $X$, when it doesn't lead to any confusion.

\subsection{Quasi-coherent sheaves of algebras; change of structure sheaf}
\label{subsection-qcoh-algs-and-change-of-str-sheaf}

\begin{prop}[9.6.1]
\label{1.9.6.1}
Let $X$ be a prescheme, $\sh{B}$ a quasi-coherent $\OO_X$-algebra \hyperref[0.5.1.3]{(\textbf{0},~5.1.3)}.
For a $\sh{B}$-module $\sh{F}$ to be quasi-coherent (on the ringed space $(X,\sh{B})$) it is necessary and sufficient that $\sh{F}$ be a quasi-coherent $\OO_X$-module.
\end{prop}

\begin{proof}
\label{proof-1.9.6.1}
Since the question is a local, we can assume $X$ to be affine, given by the ring $A$, and thus $\sh{B}=\widetilde{B}$, where $B$ is an $A$-algebra \hyperref[1.1.4.3]{(1.4.3)}.
If $\sh{F}$ is quasi-coherent on the ringed space $(X,\sh{B})$ then we can also assume that $\sh{F}$ is the cokernel of a $\sh{B}$-homomorphism $\sh{B}^{(I)}\to\sh{B}^{(J)}$; since this homomorphism is also an $\OO_X$-homomorphism of $\OO_X$-modules, and $\sh{B}^{(I)}$ and $\sh{B}^{(J)}$ are quasi-coherent $\OO_X$-modules \hyperref[1.1.3.9]{(1.3.9, ii)}, $\sh{F}$ is also a quasi-coherent $\OO_X$-module \hyperref[1.1.3.9]{(1.3.9, i)}.

Conversely, if $\sh{F}$ is a quasi-coherent $\OO_X$-module, then $\sh{F}=\widetilde{M}$, where $M$ is a $B$-module \hyperref[1.1.4.3]{(1.4.3)}; $M$ is isomorphic to the cokernel of a $B$-homomorphism $B^{(I)}\to B^{(J)}$, so $\sh{F}$ is a $\sh{B}$-module isomorphic to the cokernel of the corresponding homomorphism $\sh{B}^{(I)}\to\sh{B}^{(J)}$ \hyperref[1.1.3.13]{(1.3.13)}, which finishes the proof.
\end{proof}

In particular, if $\sh{F}$ and $\sh{G}$ are two quasi-coherent $\sh{B}$-modules, $\sh{F}\otimes_{\sh{B}}\sh{G}$ is a quasi-coherent $\sh{B}$-module; similarly for $\shHom(\sh{F},\sh{G})$ whenever we further suppose that $\sh{F}$ admits a finite presentation \hyperref[1.1.3.13]{(1.3.13)}.

\begin{env}[9.6.2]
\label{1.9.6.2}
Given a prescheme $X$, we say that a quasi-coherent $\OO_X$-algebra $\sh{B}$ is of {\em finite type} if, for all $x\in X$, there exists an open {\em affine} neighborhood $U$ of $x$ such that $\Gamma(U,\sh{B})=B$ is an algebra of finite type over $\Gamma(U,\OO_X)=A$.
We then have that $\sh{B}|U=\widetilde{B}$ and, for all $f\in A$, the induced $(\OO_X|D(f))$-algebra $\sh{B}|D(f)$ is of finite type, because it is isomorphic to $(B_f)^{\sim}$, and $B_f=B\otimes_A A_f$ is clearly an algebra of finite type over $A_f$.
Since the $D(f)$ form a basis of the topology of $U$, we thus conclude that if $\sh{B}$ is a quasi-coherent $\OO_X$-algebra of finite type then, for every open $V$ of $X$, $\sh{B}|V$ is a quasi-coherent $(\OO_X|V)$-algebra of finite type.
\end{env}

\begin{prop}[9.6.3]
\label{1.9.6.3}
Let $X$ be a locally Noetherian prescheme.
Then every quasi-coherent $\OO_X$-algebra $\sh{B}$ of finite type is a coherent sheaf of rings \hyperref[0.5.3.7]{(\textbf{0},~5.3.7)}.
\end{prop}

\begin{proof}
\label{proof-1.9.6.3}
We can once again restrict to the case where $X$ is an affine scheme given by a Noetherian ring $A$, and where $\sh{B}=\widetilde{B}$, $B$ being an $A$-algebra of finite type; $B$ is then a Noetherian ring.
With this, it remains to prove that the kernel $\sh{N}$ of a $\sh{B}$-homomorphism $\sh{B}^m\to\sh{B}$ is a $\sh{B}$-module\oldpage[I]{180} of finite type; but it is isomorphic (as a $\sh{B}$-module) to $\widetilde{N}$, where $N$ is the kernel of the corresponding homomorphism of $B$-modules $B^m\to B$ \hyperref[1.1.3.13]{(1.3.13)}.
Since $B$ is Noetherian, the submodule $N$ of $B^m$ is a $B$-module of finite type, so there exists a homomorphism $B^p\to B^m$ with image $N$; since the sequence $B^p\to B^m\to B$ is exact, so too is the corresponding sequence $\sh{B}^p\to\sh{B}^m\to\sh{B}$ \hyperref[1.1.3.5]{(1.3.5)} and since $\sh{N}$ is the image of $\sh{B}^p\to\sh{B}^m$ \hyperref[1.1.3.9]{(1.3.9,~(i))}, the proposition is proved.
\end{proof}

\begin{cor}[9.6.4]
\label{1.9.6.4}
Under the hypotheses of \hyperref[1.9.6.3]{(9.6.3)}, for a $\sh{B}$-module $\sh{F}$ to be coherent, it is necessary and sufficient that it be a quasi-coherent $\OO_X$-module and a $\sh{B}$-module of finite type.
If this is the case, and if $\sh{G}$ is a sub-$\sh{B}$-module or a quotient module of $\sh{F}$, then in order for $\sh{G}$ to be a coherent $\sh{B}$-module, it is necessary and sufficient that it is a quasi-coherent $\OO_X$-module.
\end{cor}

\begin{proof}
\label{proof-1.9.6.4}
Taking into account \hyperref[1.9.6.1]{(9.6.1)}, the conditions on $\sh{F}$ are clearly necessary; we will show that they are sufficient.
We can restrict to the case where $X$ is affine given by a Noetherian ring $A$, $\sh{B}=\widetilde{B}$, where $B$ is an $A$-algebra of finite type, $\sh{F}=\widetilde{M}$, where $M$ is a $B$-module, and where there exists a surjective $\sh{B}$-homomorphism $\sh{B}^m\to\sh{F}\to0$.
We then have the corresponding exact sequence $B^m\to M\to0$, so $M$ is a $B$-module of finite type; further, the kernel $P$ of the homomorphism $B^m\to M$ is then a $B$-module of finite type, since $B$ is Noetherian.
We thus conclude \hyperref[1.1.3.13]{(1.3.13)} that $\sh{F}$ is the cokernel of a $\sh{B}$-homomorphism $\sh{B}^m\to\sh{B}^n$, and is thus coherent, since $\sh{B}$ is a coherent sheaf of rings \hyperref[0.5.3.4]{(\textbf{0},~5.3.4)}.
The same reasoning shows that a quasi-coherent sub-$\sh{B}$-module (resp. a quotient $\sh{B}$-module) of $\sh{F}$ is of finite type, from whence the second part of the corollary.
\end{proof}

\begin{prop}[9.6.5]
\label{1.9.6.5}
Let $X$ be a quasi-compact scheme or a prescheme whose underlying space is Noetherian.
For all quasi-compact $\OO_X$-algebras $\sh{B}$ of finite type, there exists a quasi-coherent sub-$\OO_X$-module $\sh{E}$ of $\sh{B}$ of finite type such that $\sh{E}$ generates \hyperref[0.4.1.4]{(\textbf{0},~4.1.4)} the $\OO_X$-algebra $\sh{B}$.
\end{prop}

\begin{proof}
\label{proof-1.9.6.5}
In fact, by the hypothesis there exists a finite cover $(U_i)$ of $X$ consisting of open affines such that $\Gamma(U_i,\sh{B})=B_i$ is an algebra of finite type over $\Gamma(U_i,\OO_X)=A_i$; let $E_i$ be a sub-$A_i$-module of $B_i$ of finite type that generates the $A_i$-algebra $B_i$; thanks to \hyperref[1.9.4.7]{(9.4.7)}, there exists a sub-$\OO_X$-module $\sh{E}_i$ of $\sh{B}$, quasi-coherent and of finite type, such that $\sh{E}_i|U_i=\widetilde{E_i}$.
It is clear that the sum $\sh{E}$ of the $\sh{E}_i$ is the desired object.
\end{proof}

\begin{prop}[9.6.6]
\label{1.9.6.6}
Let $X$ be a prescheme whose underlying space is locally Noetherian, or a quasi-compact scheme.
Then every quasi-coherent $\OO_X$-algebra $\sh{B}$ is the inductive limit of its quasi-coherent sub-$\OO_X$-algebras of finite type.
\end{prop}

\begin{proof}
\label{proof-1.9.6.6}
In fact, it follows from \hyperref[1.9.4.9]{(9.4.9)} that $\sh{B}$ is the inductive limit (as an $\OO_X$-module) of its quasi-coherent sub-$\OO_X$-modules of finite type; the latter generating quasi-coherent sub-$\OO_X$-{\em algebras} of $\sh{B}$ of finite type \hyperref[1.1.3.14]{(1.3.14)}, and so $\sh{B}$ is a fortiori their inductive limit.
\end{proof}

\section{Formal schemes}
\label{section-formal-schemes}

\subsection{Formal affine schemes}
\label{subsection-formal-affine-schemes}

\begin{env}[10.1.1]
\label{1.10.1.1}
Let $A$ be an {\em admissible} topological ring \hyperref[0.7.1.2]{(\textbf{0},~7.1.2)}; for each
ideal of definition $\mathfrak{J}$ of $A$, $\Spec(A/\mathfrak{J})$ identifies
with the closed subspace $V(\mathfrak{J})$ of $\Spec(A)$ \hyperref[1.1.1.11]{(1.1.11)},
the set of {\em open} prime ideals of $A$; this topological space does not depend
\oldpage[I]{181}
on the ideal of definition $\mathfrak{J}$ considered; we denote this topological
space by $\mathfrak{X}$. Let $(\mathfrak{J}_\lambda)$ be a fundamental system
of neighborhoods of $0$ in $A$, consisting of ideals of definition, and for each
$\lambda$, let $\OO_\lambda$ be the structure sheaf of
$\Spec(A/\mathfrak{J}_\lambda)$; this sheaf is induced on $\mathfrak{X}$ by
$\widetilde{A}/\widetilde{\mathfrak{J}_\lambda}$ (which is zero outside of
$\mathfrak{X}$). For $\mathfrak{J}_\mu\subset\mathfrak{J}_\lambda$, the
canonical homomorphism $A/\mathfrak{J}_\mu\to A/\mathfrak{J}_\lambda$ thus
defines a homomorphism $u_{\lambda\mu}:\OO_\mu\to\OO_\lambda$ of sheaves of
rings \hyperref[1.1.6.1]{(1.6.1)}, and $(\OO_\lambda)$ is a {\em projective system of
sheaves of rings} for these homomorphisms. As the topology of $\mathfrak{X}$
admits a basis consisting of quasi-compact open subsets, we can associate to
each $\OO_\lambda$ a {\em sheaf of pseudo-discrete topological rings}
\hyperref[0.3.8.1]{(\textbf{0},~3.8.1)} which have $\OO_\lambda$ as the underlying (without topology)
sheaf of rings, and that we denote also by $\OO_\lambda$; and the $\OO_\lambda$ give again a
{\em projective system of sheaves of topological rings} \hyperref[0.3.8.2]{(\textbf{0},~3.8.2)}.
We denote by $\OO_\mathfrak{X}$ the {\em sheaf of topological rings} on $\mathfrak{X}$, the
projective limit of the system $(\OO_\lambda)$; for each {\em quasi-compact} open subset $U$
aof $\mathfrak{X}$, then $\Gamma(U,\OO_\mathfrak{X})$ is a topological ring, the projective
limit of the system of {\em discrete} rings $\Gamma(U,\OO_\lambda)$
\hyperref[0.3.2.6]{(3.2.6)}.
\end{env}

\begin{defn}[10.1.2]
\label{1.10.1.2}
Given an admissible topological ring $A$, we define the formal spectrum of $A$, and denote
it by $\Spf(A)$, to be the closed subspace $\mathfrak{X}$ of $\Spec(A)$ consisting of the
open prime ideals of $A$. We say that a topologically ringed space is a formal affine scheme
if it is isomorphic to a formal spectrum $\Spf(A)=\mathfrak{X}$ equipped with a sheaf of
topological rings $\OO_\mathfrak{X}$ which is the projective limit of sheaves of
psuedo-discrete topological rings
$(\widetilde{A}/\widetilde{\mathfrak{J}_\lambda})|\mathfrak{X}$, where $\mathfrak{J}_\lambda$
varies over the filtered set of ideals of definition for $A$.
\end{defn}

When we speak of a {\em formal spectrum $\mathfrak{X}=\Spf(A)$} as a formal affine scheme,

\bibliography{the}
\bibliographystyle{amsalpha}

\end{document}

