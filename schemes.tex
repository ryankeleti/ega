\input{preamble}

\begin{document}
\title{The language of schemes}
\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section*{Summary}
\label{section-schemes-summary}

\begin{tabular}{ll}
  \textsection1. & Affine schemes.\\
  \textsection2. & Preschemes and morphisms of preschemes.\\
  \textsection3. & Products of preschemes.\\
  \textsection4. & Subpreschemes and immersion morphisms.\\
  \textsection5. & Reduced preschemes; separation condition.\\
  \textsection6. & Finiteness conditions.\\
  \textsection7. & Rational maps.\\
  \textsection8. & Chevalley schemes.\\
  \textsection9. & Supplement on quasi-coherent sheaves.\\
  \textsection10. & Formal schemes.
\end{tabular}\\

\oldpage{79}
The \textsection\textsection1--8 do little more than develop a language, which
will be used in the following. It should be noted, however, that in accordance
with the general spirit of this treatise, \textsection\textsection7--8 will be
used less than the others, and in a less essential way; we have moreover spoken
of Chevalley's schemes only to make the link with the language of
Chevalley \cite{I-1} and Nagata \cite{I-9}. The \textsection9 gives definitions
and results on quasi-coherent sheaves, some of which are no longer limited to a
translation into a ``geometric'' language of known notions of commutative
algebra, but are already of a global nature; they will be indispensable, in the
following chapters, for the global study of morphisms. Finally, \textsection10
introduces a generalization of the notion of schemes, which will be used as an
intermediary in Chapter~III to formulate and prove in a convenient way the
fundamental results of the cohomological study of the proper morphisms;
moreover, it should be noted that the notion of formal schemes seems
indispensable to express certain facts of the ``theory of modules''
(classification problems of algebraic varieties). The results of \textsection10
will not be used before \textsection3 of Chapter~III and it is recommended to
omit reading until then.
\bigskip

\setcounter{section}{0}
\section{Affine schemes}
\label{section-affine-schemes}

\setcounter{subsection}{0}
\subsection{The prime spectrum of a ring}
\label{subsection-prime-spec}

\begin{env}[1.1.1]
\label{env-1.1.1.1}
\oldpage{80}
{\it Notation}. Let $A$ be a (commutative) ring, $M$ an $A$-module. In
this chapter and the following, we will constantly use the following notations:
\begin{itemize}
  \item[--] $\Spec(A)=$ {\it set of prime ideals} of $A$, also called the
        {\it prime spectrum} of $A$; for an $x\in X=\Spec(A)$, it will often be
        convenient to write $\mathfrak{j}_x$ instead of $x$. When $\Spec(A)$ is
        {\it empty}, it is necessary and sufficient that the ring $A$ is
        reduced to $0$.
  \item[--] $A_x=A_{\mathfrak{j}_x}=$ {\it (local) ring of fractions $S^{-1}A$},
        where $S=A-\mathfrak{j}_x$.
  \item[--] $\mathfrak{m}_x=\mathfrak{j}_x A_{\mathfrak{j}_x}=$ {\it maximal ideal
        of $A$}.
  \item[--] $\kres(x)=A_x/\mathfrak{m}_x=$ {\it residue field of $A_x$},
        canonically isomorphic to the field of fractions
        of the integral ring $A/\mathfrak{j}_x$, to which it is identified.
  \item[--] $f(x)=$ {\it class of $f$} modulo $\mathfrak{j}_x$ in
        $A/\mathfrak{j}_x\subset\kres(x)$,
        for $f\in A$ and $x\in X$. We still say that $f(x)$ is the {\it value}
        of $f$ at a point $x\in\Spec(A)$; the relations $f(x)=0$ and
        $f\in\mathfrak{j}_x$ are {\it equivalent}.
  \item[--] $M_x=M\otimes_A A_x=$ {\it module of denominators of fractions in
        $A-\mathfrak{j}_x$}.
  \item[--] $\rad(E)=$ {\it radical of the ideal of $A$ generated by a subset $E$
        of $A$}.
  \item[--] $V(E)=$ {\it set of $x\in X$ such that $E\subset\mathfrak{j}_x$} (or
        the set of
        $x\in X$ such that $f(x)=0$ for all $f\in E$), for $E\subset A$. So we
        have
        \[
          \rad(E)=\bigcap_{x\in V(E)}\mathfrak{j}_x.
          \tag{1.1.1.1}
        \]
  \item[--] $V(f)=V(\{f\})$ for $f\in A$.
  \item[--] $D(f)=X-V(f)=$ {\it set of $x\in X$ where $f(x)\neq 0$}.
\end{itemize}
\end{env}

\begin{prop}[1.1.2]
\label{prop-1.1.1.2}
We have the following properties:
\begin{itemize}
  \item[{\rm(i)}] $V(0)=X$, $V(1)=\emp$.
  \item[{\rm(ii)}] The relation $E\subset E'$ implies $V(E)\supset V(E')$.
  \item[{\rm(iii)}] For each family $(E_\lambda)$ of subsets of $A$,
        $V(\bigcup_\lambda E_\lambda)=V(\sum_\lambda E_\lambda)
          =\bigcap_\lambda V(E_\lambda)$.
  \item[{\rm(iv)}] $V(EE')=V(E)\cup V(E')$.
  \item[{\rm(v)}] $V(E)=V(\mathfrak{r}(E))$.
\end{itemize}
\end{prop}

\begin{proof}
\label{proof-prop-1.1.1.2}
The properties (i), (ii), (iii) are trivial, and (v) follows from (ii) and from
the formula (1.1.1.1). It is evident that $V(EE')\supset V(E)\cap V(E')$;
conversely, if $x\not\in V(E)$ and $x\not\in V(E')$, there exists $f\in E$ and
$f'\in E'$ such that $f(x)\neq 0$ and $f'(x)\neq 0$ in $\kres(x)$, hence
$f(x)f'(x)\neq 0$, i.e., $x\not\in V(EE')$, which proves (iv).
\end{proof}

\begin{rmk}
\label{rmk-prop-1.1.1.2}
Proposition \hyperref[prop-1.1.1.2]{(1.1.2)} shows, among other things, that sets of the form $V(E)$
(where $E$ runs through all the subsets of $A$) are the {\it closed sets} of a topology on
$X$, which we will call the {\it spectral topology}\footnote{The introduction of this
topology in algebraic geometry is due to Zariski. So this topology is usually called
the ``Zariski topology'' of $X$.}; unless expressely stated otherwise, always assume
$X=\Spec(A)$ is equipped with the spectral topology.
\end{rmk}

\begin{env}[1.1.3]
\label{env-1.1.1.3}
\oldpage{81}
For each subset $Y$ of $X$, we denote by $\mathfrak{j}(Y)$ the set of $f\in A$ such that
$f(y)=0$ for all $y\in Y$; equivalently, $\mathfrak{j}(Y)$ is the intersection of the prime
ideals $\mathfrak{j}_y$ for $y\in Y$. It is clear that the relation $Y\subset Y'$ implies
that $\mathfrak{j}(Y)\supset\mathfrak{j}(Y')$ and that we have
\[
  \mathfrak{j}\bigg(\bigcup_\lambda Y_\lambda\bigg)=\bigcap_\lambda\mathfrak{j}(Y_\lambda)
  \tag{1.1.3.1}
\]
for each family $(Y_\lambda)$ of subsets of $X$. Finally we have
\[
  \mathfrak{j}(\{x\})=\mathfrak{j}_x.
  \tag{1.1.3.2}
\]
\end{env}

\begin{prop}[1.1.4]
\label{prop-1.1.1.4}
\medskip\noindent
\begin{itemize}
  \item[{\rm(i)}] For each subset $E$ of $A$, we have $\mathfrak{j}(V(E))=\rad(E)$.
  \item[{\rm(ii)}] For each subset $Y$ of $X$, $V(\mathfrak{j}(Y))=\overline{Y}$, the closure of $Y$
        in $X$.
\end{itemize}
\end{prop}

\begin{proof}
\label{proof-prop-1.1.1.4}
(i) is an immeidate consequence of the definitions and (1.1.1.1); on the other hand,
$V(\mathfrak{j}(Y))$ is closed and contains $Y$; conversely, if $Y\subset V(E)$, we have
$f(y)=0$ for $f\in E$ and all $y\in Y$, so $E\subset\mathfrak{j}(Y)$,
$V(E)\supset V(\mathfrak{j}(Y))$, which proves (ii).
\end{proof}

\begin{cor}[1.1.5]
\label{cor-1.1.1.5}
The closed subsets of $X=\Spec(A)$ and the ideals of $A$ equal to their radicals (otherwise
the intersection of prime ideals) correspond bijectively by the \unsure{descent} maps
$Y\mapsto\mathfrak{j}(Y)$, $\mathfrak{a}\mapsto V(\mathfrak{a})$; the union $Y_1\cup Y_2$ of
two closed subsets corresponds to $\mathfrak{j}(Y_1)\cap\mathfrak{j}(Y_2)$, and the
intersection of any family $(Y_\lambda)$ of closed subsets corresponds to the radical of the
sum of the $\mathfrak{j}(Y_\lambda)$.
\end{cor}

\begin{cor}[1.1.6]
\label{cor-1.1.1.6}
If $A$ is a Noetherian ring, $X=\Spec(A)$ is a Noetherian space.
\end{cor}

Note that the converse of this corollary is false, as shown
in the example of a non-Noetherian integral ring with a single prime ideal $\neq\{0\}$, for
example a non-discrete valuation ring of rank $1$.

As an example of ring $A$ whose spectrum is not a Noetherian space, one can consider the ring
$\sh{C}(Y)$ of continuous real functions on an infinite compact space $Y$; we know that as a
whole, $Y$ corresponds with the set of maximal ideals of $A$, and it is easy to see that the
topology induced on $Y$ by that of $X=\Spec(A)$ is the initial topology of $Y$. Since $Y$ is
not a Noetherian space, the same is true for $X$.

\begin{cor}[1.1.7]
\label{cor-1.1.1.7}
For each $x\in X$, the closure of $\{x\}$ is the set of $y\in X$ such that
$\mathfrak{j}_x\subset\mathfrak{j}_y$. For $\{x\}$ to be closed, it is necessary and
sufficient that $\mathfrak{j}_x$ is maximal.
\end{cor}

\begin{cor}[1.1.8]
\label{cor-1.1.1.8}
The space $X=\Spec(A)$ is a Kolmogoroff space.
\end{cor}

\begin{proof}
\label{proof-cor-1.1.1.8}
If $x$, $y$ are two distinct points of $X$, we have either
$\mathfrak{j}_x\not\subset\mathfrak{j}_y$ or $\mathfrak{j}_y\not\subset\mathfrak{j}_x$, so
one of the points $x$, $y$ does not belong to the closure of the other.
\end{proof}

\begin{env}[1.1.9]
\label{env-1.1.1.9}
According to Proposition \hyperref[prop-1.1.1.2]{(1.1.2)}, (iv), for two elements $f$, $g$ of $A$, we have
\[
  D(fg)=D(f)\cap D(g).
  \tag{1.1.9.1}
\]
Note also that the relation $D(f)=D(g)$ means, according to Proposition
\hyperref[prop-1.1.1.4]{(1.1.4)}, (i) and Proposition \hyperref[prop-1.1.1.2]{(1.1.2)}, (v) that $\rad(f)=\rad(g)$, or
that the minimal prime ideals containing $(f)$ and $(g)$ are the same; in particular, when
$f=ug$, where $u$ is invertible.
\end{env}

\begin{prop}[1.1.10]
\label{prop-1.1.1.10}
\medskip\noindent
\oldpage{82}
\begin{itemize}
  \item[{\rm(i)}] When $f$ ranges over $A$, the sets $D(f)$ forms a basis for the topology of $X$.
  \item[{\rm(ii)}] For each $f\in A$, $D(f)$ is quasi-compact. In particular $X=D(1)$ is quasi-compact.
\end{itemize}
\end{prop}

\begin{proof}
\label{proof-prop-1.1.1.10}
\medskip\noindent
\begin{itemize}
  \item[(i)] Let $U$ be an open set in $X$; by definition, we have $U=X-V(E)$ where $E$ is a subset of
$A$, and $V(E)=\bigcap_{f\in E}V(f)$, hence $U=\bigcup_{f\in E}D(f)$.
  \item[(ii)] According to (i), it is sufficient to prove that if $(f_\lambda)_{\lambda\in L}$ is a
family of elements of $A$ such that $D(f)\subset\bigcup_{\lambda\in L}D(f_\lambda)$, there
exists a finite subset $J$ of $L$ such that $D(f)\subset\bigcup_{\lambda\in J}D(f_\lambda)$.
Let $\mathfrak{a}$ be the ideal of $A$ generated by the $f_\lambda$; we have by hypothesis
that $V(f)\supset V(\mathfrak{a})$, so $\rad(f)\subset\rad(\mathfrak{a})$; as $f\in\rad(f)$,
there exists an integer $n\geqslant 0$ such that $f^n\in\mathfrak{a}$. But then $f^n$ belongs
to the ideal $\mathfrak{b}$ generated by the finite subfamily $(f_\lambda)_{\lambda\in J}$,
and we have $V(f)=V(f^n)\supset V(\mathfrak{b})=\bigcap_{\lambda\in J}V(f_\lambda)$, that is
to say, $D(f)\supset\bigcup_{\lambda\in J}D(f_\lambda)$.
\end{itemize}
\end{proof}

\begin{prop}[1.1.11]
\label{prop-1.1.1.11}
For each ideal $\mathfrak{a}$ of $A$, $\Spec(A/\mathfrak{a})$ canonically identifies with the
closed subspace $V(\mathfrak{a})$ of $\Spec(A)$.
\end{prop}

\begin{proof}
\label{proof-prop-1.1.1.11}
We know there is a canonical bijective correspondence (respecting the inclusion order
structure) between ideals (resp. prime ideals) of $A/\mathfrak{a}$ and ideals (resp. prime
ideals) of $A$ containing $\mathfrak{a}$.
\end{proof}

Recall that the set $\nilrad$ of nilpotent elements of $A$ (the {\it nilradical} of $A$) is
an ideal equal to $\rad(0)$, the intersection of all the prime ideals of $A$
\hyperref[env-0.1.1.1]{(\textbf{0},~1.1.1)}.

\begin{cor}[1.1.12]
\label{cor-1.1.1.12}
The topological spaces $\Spec(A)$ and $\Spec(A/\nilrad)$ are canonically homeomorphic.
\end{cor}

\begin{prop}[1.1.13]
\label{prop-1.1.1.13}
For $X=\Spec(A)$ to be irreducible \hyperref[env-0.2.1.1]{(\textbf{0},~2.1.1)}, it is necessary and
sufficient that the ring $A/\nilrad$ is integral (or, equivalently, that the ideal $\nilrad$ is prime).
\end{prop}

\begin{proof}
\label{proof-prop-1.1.1.13}
By virtue of Corollary \hyperref[cor-1.1.1.12]{(1.1.12)}, we can restrict to the case where
$\nilrad=0$. If $X$ is reducible, then there exist two distinct closed subsets $Y_1$, $Y_2$
of $X$ such that $X=Y_1\cup Y_2$,
so $\mathfrak{j}(X)=\mathfrak{j}(Y_1)\cap\mathfrak{j}(Y_2)=0$, the ideals $\mathfrak{j}(Y_1)$
and $\mathfrak{j}(Y_2)$ being distinct from $(0)$ \hyperref[cor-1.1.1.5]{(1.1.5)}; so
$A$ is not integral. Conversely, if in $A$ there are elements $f\neq 0$, $g\neq 0$ such
that $fg=0$, we have $V(f)\neq X$, $V(g)\neq X$ (since the intersection of the prime ideals
of $A$ is $(0)$), and $X=V(fg)=V(f)\cup V(g)$.
\end{proof}

\begin{cor}[1.1.14]
\label{cor-1.1.1.14}
\medskip\noindent
\begin{itemize}
  \item[{\rm(i)}] In the bijective correspondence between closed subsets of $X=\Spec(A)$
        and ideals of $A$ equal to their roots, the irreducible closed subsets
        of $X$ correspond to the prime ideals of $A$. In particular, the irreducible
        components of $X$ correspond to the minimal prime ideals of $A$.
  \item[{\rm(ii)}] The map $x\mapsto\overline{\{x\}}$ establishes a bijective correspondence
        between $X$ and the set of closed irreducible subsets of $X$
        ({\it said otherwise,} all closed irreducible subsets of $X$ containing
        only one generic point).
\end{itemize}
\end{cor}

\begin{proof}
\label{proof-cor-1.1.1.14}
(i) follows immediately from \hyperref[prop-1.1.1.13]{(1.1.13)} and
\hyperref[prop-1.1.1.11]{(1.1.11)}; and for
proving (ii), we can, by virtue of \hyperref[prop-1.1.1.11]{(1.1.11)}, we restrict to the
case where $X$ is irreducible; then, according to
Proposition \hyperref[prop-1.1.1.13]{(1.1.13)}, there exists
in $A$ a smaller prime ideal $\nilrad$, which corresponds to the generic point
\oldpage{83}
of $X$; in addition, $X$ does not admit only one generic point since it is a Kolmogoroff
space (\hyperref[cor-1.1.1.8]{(1.1.8)} and \hyperref[env-0.2.1.3]{(\textbf{0},~2.1.3)}).
\end{proof}

\begin{prop}[1.1.15]
\label{prop-1.1.1.15}
If $\mathfrak{J}$ is an ideal in $A$ containing the radical $\nilrad(A)$, the only
neighborhood of $V(\mathfrak{J})$ in $X=\Spec(A)$ is the whole space $X$.
\end{prop}

\begin{proof}
\label{proof-prop-1.1.1.15}
Each maximal ideal of $A$ belongs by definition of $V(\mathfrak{J})$.
As each ideal $\mathfrak{a}$ of $A$ is contained in a maximal ideal, we have
$V(\mathfrak{a})\cap V(\mathfrak{J})\neq 0$, hence the proposition.
\end{proof}

\subsection{Functorial properties of prime spectra of rings}
\label{subsection-func-prop}

\begin{env}[1.2.1]
\label{env-1.1.2.1}
Let $A$, $A'$ be two rings,
\[
  \vphi:A'\longrightarrow A
\]
a homomorphism of rings. For each prime ideal $x=\mathfrak{j}_x\in\Spec(A)=X$, the
ring $A'/\vphi^{-1}(\mathfrak{j}_x)$ is canonically isomorphic to a subring of
$A/\mathfrak{j}_x$, so it is integral, otherwise we say
$\vphi^{-1}(\mathfrak{j}_x)$ is a prime ideal of $A'$; we denote it by
${}^a\vphi(x)$, and we have also defined a map
\[
  {}^a\vphi:X=\Spec(A)\longrightarrow X'=\Spec(A')
\]
(also denoted $\Spec(\vphi)$) we call this the map {\it associated} to the
homomorphism $\vphi$. We denote by $\vphi^x$ the injective homomorphism of
$A'/\vphi^{-1}(\mathfrak{j}_x)$ to $A/\mathfrak{j}_x$ induced by $\vphi$ by
passing to quotients, so the canonical extention is a monomorphism of fields
\[
  \vphi^x:\kres({}^a\vphi(x))\longrightarrow\kres(x);
\]
for each $f'\in A'$, we therefore have by definition
\[
  \vphi^x(f'({}^a\vphi(x)))=(\vphi(f'))(x)\quad(x\in X).
  \tag{1.2.1.1}
\]
\end{env}

\begin{prop}[1.2.2]
\label{prop-1.1.2.2}
\medskip\noindent
\begin{itemize}
  \item[{\rm(i)}] For each subset $E'$ of $A'$, we have
        \[
          {}^a\vphi^{-1}(V(E'))=V(\vphi(E')),
          \tag{1.2.2.1}
        \]
        and in particular, for each $f'\in A'$,
        \[
          {}^a\vphi^{-1}(D(f'))=D(\vphi(f')).
          \tag{1.2.2.2}
        \]
  \item[{\rm(ii)}] For each ideal $\mathfrak{a}$ of $A$, we have
        \[
          \overline{{}^a\vphi(V(\mathfrak{a}))}=V(\vphi^{-1}(\mathfrak{a})).
          \tag{1.2.2.3}
        \]
\end{itemize}
\end{prop}

\begin{proof}
\label{proof-prop-1.1.2.2}
Indeed, the relation ${}^a\vphi(x)\in V(E')$ is by definition equivalent to
$E'\subset\vphi^{-1}(\mathfrak{j}_x)$, so $\vphi(E')\subset\mathfrak{j}_x$, and
finally $x\in V(\vphi(E'))$, hence (i). To prove (ii), we can suppose that
$\mathfrak{a}$ is equal to its radical, since $V(\rad(\mathfrak{a}))=V(\mathfrak{a})$
(\hyperref[prop-1.1.1.2]{(1.1.2)}, (v)) and
$\vphi^{-1}(\rad(\mathfrak{a}))=\rad(\vphi^{-1}(\mathfrak{a}))$; the relation
$f'\in\mathfrak{a}'$ is by definition equivalent to $f'(x')=0$ for each
$x\in{{}^a\vphi(Y)}$, so, by virtue of the formula (1.2.1.1), it is equivalent as well
to $\vphi(f')(x)=0$ for each $x\in Y$, or $\vphi(f')\in\mathfrak{j}(Y)=\mathfrak{a}$,
since $\mathfrak{a}$ is equal to its radical; hence (ii).
\end{proof}

\begin{cor}[1.2.3]
\label{cor-1.1.2.3}
The map ${}^a\vphi$ is continuous.
\end{cor}

We remark that if $A''$ is a third ring, $\vphi'$ a homomorphism $A''\to A'$, we have
${}^a(\vphi'\circ\vphi)={}^a\vphi\circ{}^a\vphi'$; this result and Corollary
\hyperref[cor-1.1.2.3]{(1.2.3)} gives that $\Spec(A)$ is a {\it contravariant functor} in $A$, from the
category of rings to that of topological spaces.

\begin{cor}[1.2.4]
\label{cor-1.1.2.4}
\oldpage{84}
Suppose that $\vphi$ is such that for each $f\in A$ written as $f=h\vphi(f')$, where $h$ is
invertible in $A$ ({\it which is in particular the case when $\vphi$ is} surjective). Then
${}^a\vphi$ is a homeomorphism from $X$ to ${}^a\vphi(X)$.
\end{cor}

\begin{proof}
\label{proof-cor-1.1.2.4}
We show that for each subset $E\subset A$, there exists a subset $E'$ of $A'$ such that
$V(E)=V(\vphi(E'))$; according to the axiom ($T_0$) \hyperref[cor-1.1.1.8]{(1.1.8)} and the formula
(1.2.2.1), this implies first that ${}^a\vphi$ is injective, then, according to (1.2.2.1),
that ${}^a\vphi$ is a homeomorphism. Or, it suffices for each $f\in E$ to have a $f'\in A'$
such that $h\vphi(f')=f$ with $h$ invertible in $A$; the set $E'$ of these elements $f'$
provides the answer.
\end{proof}

\begin{env}[1.2.5]
\label{env-1.1.2.5}
In particular, when $\vphi$ is the canonical homomorphism of $A$ to a ring quotient
$A/\mathfrak{a}$, we get \hyperref[cor-1.1.1.12]{(1.1.12)}, and ${}^a\vphi$ is the
{\it canonical injection} of $V(\mathfrak{a})$, identifed with $\Spec(A/\mathfrak{a})$,
in $X=\Spec(A)$.
\end{env}

Another particular case of \hyperref[cor-1.1.2.4]{(1.2.4)}:
\begin{cor}[1.2.6]
\label{cor-1.1.2.6}
If $S$ is a multiplicative subset of $A$, the spectrum $\Spec(S^{-1}A)$ identifies
canonically (with its topology) with the subspace of $X=\Spec(A)$ consisting of the $x$
such that $\mathfrak{j}_x\cap S=\emp$.
\end{cor}

\begin{proof}
\label{proof-cor-1.1.2.6}
We know by \hyperref[env-0.1.2.6]{(\textbf{0},~1.2.6)} that the prime ideals of $S^{-1}A$ are the ideals
$S^{-1}\mathfrak{j}_x$ such that $\mathfrak{j}_x\cap S=\emp$, and that we have
$\mathfrak{j}_x=(i_A^S)^{-1}(S^{-1}\mathfrak{j}_x)$. It suffices to apply the $i_A^S$
with Corollary \hyperref[cor-1.1.2.4]{(1.2.4)}.
\end{proof}

\begin{cor}[1.2.7]
\label{cor-1.1.2.7}
For ${}^a\vphi(X)$ to be dense in $X'$, it is necessary and sufficient that each element
of the kernel $\Ker\vphi$ is nilpotent.
\end{cor}

\begin{proof}
\label{proof-cor-1.1.2.7}
Applying the formula (1.2.2.3) to the ideal $\mathfrak{a}=(0)$, we have
$\widetilde{{}^a\vphi(X)}=V(\Ker\vphi)$, and for $V(\Ker\vphi)=X$ to hold, it is necessary
and sufficient that $\Ker\vphi$ is contained in all the prime ideals of $A'$, that is to say
in the nilradical $\rad'$ of $A'$.
\end{proof}

\subsection{Sheaf associated to a module}
\label{subsection-assoc-sheaf}

\begin{env}[1.3.1]
\label{env-1.1.3.1}
Let $A$ be a commutative ring, $M$ an $A$-module, $f$ an element of $A$, $S_f$ the
multiplicative set of the $f^n$, where $n\geqslant 0$. Recall that we put $A_f=S_f^{-1}A$,
$M_f=S_f^{-1}M$. If $S_f'$ is the saturated multiplicative subset of $A$ consisting of the
$g\in A$ which divide an element of $S_f$, we know that $A_f$ and $M_f$ canonically identify
with ${S_f'}^{-1}A$ and ${S_f'}^{-1}M$ \hyperref[env-0.1.4.3]{(\textbf{0},~1.4.3)}.
\end{env}

\begin{lem}[1.3.2]
\label{lem-1.1.3.2}
The following conditions are equivalent:
\begin{center}
{\rm(a)} $g\in S_f'$;
{\rm(b)} $S_g'\subset S_f'$;
{\rm(c)} $f\in\rad(g)$;
{\rm(d)} $\rad(f)\subset\rad(g)$;
{\rm(e)} $V(g)\subset V(f)$;
{\rm(f)} $D(f)\subset D(g)$.
\end{center}
\end{lem}
This follows immediately from the definitions and from
Corollary \hyperref[cor-1.1.1.5]{(1.1.5)}.

\begin{env}[1.3.3]
\label{env-1.1.3.3}
If $D(f)=D(g)$, then Lemma \hyperref[lem-1.1.3.2]{(1.3.2)}, (b), shows that $M_f=M_g$. More generally, if
$D(f)\supset D(g)$, then $S_f'\subset S_g'$, and we know \hyperref[env-0.1.4.1]{(\textbf{0},~1.4.1)} that there exists
a canonical functorial homomorphism
\[
  \rho_{g,f}:M_f\longrightarrow M_g,
\]
and if $D(f)\supset D(g)\supset D(h)$, we have \hyperref[env-0.1.4.4]{(\textbf{0},~1.4.4)}
\[
  \rho_{h,g}\circ\rho_{g,f}=\rho_{h,f}.
  \tag{1.3.3.1}
\]
\end{env}

\oldpage{85}
When $f$ runs over the elements of $A-\mathfrak{j}_x$ (for a given $x$ in $X=\Spec(A)$), the
sets $S_f'$ constitute an increasing filtered set of subsets of $A-\mathfrak{j}_x$, since for
two elements $f$, $g$ of $A-\mathfrak{j}_x$, $S_f'$ and $S_g'$ are contained in $S_{fg}'$; as
the union of the $S_f'$ for $f\in A-\mathfrak{j}_x$ is $A-\mathfrak{j}_x$, we conclude
\hyperref[env-0.1.4.5]{(\textbf{0},~1.4.5)} that the $A_x$-module $M_x$ canonically identifies with the {\it inductive
limit} $\varinjlim M_f$, relative to the family of homomorphisms $(\rho_{g,f})$. We denote by
\[
  \rho_x^f:M_f\longrightarrow M_x
\]
the canonical homomorphism for $f\in A-\mathfrak{j}_x$ (or, equivalently, $x\in D(f)$).

\begin{defn}[1.3.4]
\label{defn-1.1.3.4}
We define the structure sheaf of the prime spectrum $X=\Spec(A)$ (resp. sheaf associated to
an $A$-module $M$) and denote it by $\widetilde{A}$ or $\OO_X$ (resp. $\widetilde{M}$) as the
sheaf of rings (resp. the $\widetilde{A}$-module) associated to the presheaf
$D(f)\mapsto A_f$ (resp. $D(f)\mapsto M_f$) over the basis $\mathfrak{B}$ of $X$ consisting
of the $D(f)$ for $f\in A$ (\hyperref[prop-1.1.1.10]{(1.1.10)}, \hyperref[env-0.3.2.1]{(\textbf{0},~3.2.1)}, and
\hyperref[env-0.3.5.6]{(\textbf{0},~3.5.6)}).
\end{defn}

We saw \hyperref[env-0.3.2.4]{(\textbf{0},~3.2.4)} that the stalk $\widetilde{A}_x$ (resp. $\widetilde{M}_x$)
{\it identifies with the ring $A_x$} (resp. {\it the $A_x$-module $M_x$}); we denote by
\[
  \theta_f:A_f\longrightarrow\Gamma(D(f),\widetilde{A})
\]
\[
  (\text{resp. }\theta_f:M_f\longrightarrow\Gamma(D(f),\widetilde{M})),
\]
the canonical map, so that for each $x\in D(f)$ and each $\xi\in M_f$, we have
\[
  (\theta_f(\xi))_x=\rho_x^f(\xi).
  \tag{1.3.4.1}
\]

\begin{prop}[1.3.5]
\label{prop-1.1.3.5}
$\widetilde{M}$ is an exact covariant functor in $M$, from the category of $A$-modules to the
category of $\widetilde{A}$-modules.
\end{prop}

\begin{proof}
\label{proof-prop-1.1.3.5}
Indeed, let $M$, $N$ be two $A$-modules, $u$ a homomorphism $M\to N$; for each $f\in A$,
it canonically assigns to $u$ a homomorphism $u_f$ of the $A_f$-module $M_f$ to the
$A_f$-module $N_f$, and the diagram (for $D(g)\subset D(f)$)
\[
  \xymatrix{
    M_f\ar[r]^{u_f}\ar[d]_{\rho_{g,f}} & N_f\ar[d]^{\rho_{g,f}}\\
    M_g\ar[r]^{u_g} & N_g
  }
\]
is commutative \hyperref[thm-1.1.4.1]{(1.4.1)}; these homomorphisms then define a homomorphism of
$\widetilde{A}$-modules $\widetilde{u}:\widetilde{M}\to\widetilde{N}$ \hyperref[env-0.3.2.3]{(\textbf{0},~3.2.3)}. In
addition, for each $x\in X$, $\widetilde{u}_x$ is the inductive limit of the $u_f$ for
$x\in D(f)$ ($f\in A$), and as a result \hyperref[env-0.1.4.5]{(\textbf{0},~1.4.5)}, if we canonically identify
$\widetilde{M}_x$ and $\widetilde{N}_x$ with $M_x$ and $N_x$ respectively, then $\widetilde{u}_x$
identifies with the homomorphism $u_x$ canonically induced by $u$. If $P$ is a third
$A$-module, $v$ a homomorphism $N\to P$ and $w=v\circ u$, it is immediate that
$w_x=v_x\circ u_x$, so $\widetilde{w}=\widetilde{v}\circ\widetilde{u}$. We have therefore
clearly defined a {\it covariant functor} $\widetilde{M}$ in $M$, from the category of
$A$-modules to that of $\widetilde{A}$-modules. {\it This functor is exact}, since for each
$x\in X$, $M_x$ is an exact functor in $M$ \hyperref[env-0.1.3.2]{(\textbf{0},~1.3.2)}; in addition, we have
$\Supp(M)=\Supp(\widetilde{M})$ by the definitions \hyperref[env-0.1.7.1]{(\textbf{0},~1.7.1)} and
\hyperref[env-0.3.1.6]{(\textbf{0},~3.1.6)}.
\end{proof}

\oldpage{86}
\begin{prop}[1.3.6]
\label{prop-1.1.3.6}
For each $f\in A$, the open subset $D(f)\subset X$ canonically identifies with the prime
spectrum $\Spec(A_f)$, and the sheaf $\widetilde{M_f}$ associated to the $A_f$-module
$M_f$ canonically identifies with the restriction $\widetilde{M}|D(f)$.
\end{prop}

The first assertion is a particular case of \hyperref[cor-1.1.2.6]{(1.2.6)}. In addition, for $g\in A$ is
such that $D(g)\subset D(f)$, $M_g$ canonically identifies with the module of fractions of
$M_f$ whose denominators are the powers of the canonical image of $g$ in $A_f$
\hyperref[env-0.1.4.6]{(\textbf{0},~1.4.6)}. The canonical identification of $\widetilde{M_f}$ with
$\widetilde{M}|D(f)$ then follows from the definitions.

\begin{thm}[1.3.7]
\label{thm-1.1.3.7}
For each $A$-module $M$ and each $f\in A$, the homomorphism
\[
  \theta_f:M_f\longrightarrow\Gamma(D(f),\widetilde{M})
\]
is bijective {\it (in other words, the presheaf $D(f)\mapsto M_f$ is a {\it sheaf})}. In
particular, $M$ identifies with $\Gamma(X,\widetilde{M})$ via $\theta_1$.
\end{thm}

\begin{proof}
\label{proof-thm-1.1.3.7}
We note that, if $M=A$, $\theta_f$ is a homomorphism of structure rings; Theorem
\hyperref[thm-1.1.3.7]{(1.3.7)} implies then that, if we identify the rings $A_f$ and
$\Gamma(D(f),\widetilde{A})$ by means of the $\theta_f$, the homomorphism
$\theta_f:M_f\to\Gamma(D(f),\widetilde{M})$ is an isomorphism of {\it modules}.

We show first that $\theta_f$ is {\it injective}. Indeed, if $\xi\in M_f$ is such that
$\theta_f(\xi)=0$, then this means that for each prime ideal $\mathfrak{p}$ of $A_f$, there
exists $h\not\in\mathfrak{p}$ such that $h\xi=0$; as the annihilator of $\xi$ is not
contained in any prime ideal of $A_f$, each $A_f$ integral, so $\xi=0$.

It remains to show that $\theta_f$ is {\it surjective}; we can reduce to the case where
$f=1$, the general case deduced by ``localizing'' using \hyperref[prop-1.1.3.6]{(1.3.6)}. Now let $s$ be a
section of $\widetilde{M}$ over $X$; according to \hyperref[defn-1.1.3.4]{(1.3.4)} and
\hyperref[prop-1.1.1.10]{(1.1.10)}, (ii), there exists a {\it finite} cover $(D(f_i))_{i\in I}$ of $X$
($f_i\in A$) such that, for each $i\in I$, the restriction $s_i=s|D(f_i)$ is of the form
$\theta_{f_i}(\xi_i)$, where $\xi_i\in M_{f_i}$. If $i$, $j$ are two indices of $I$, and if
the restrictions of $s_i$ and $s_j$ to $D(f_i)\cap D(f_j)=D(f_i f_j)$ are equal, then
it follows by definition of $M$ that
\[
  \rho_{f_i f_j,f_i}(\xi_i)=\rho_{f_i f_j,f_j}(\xi_j).
  \tag{1.3.7.1}
\]
By definition, we can write, for each $i\in I$, $\xi_i=z_i/f_i^{n_i}$, where $z_i\in M$, and
as $I$ is finite, by multiplying each $z_i$ by a power of $f_i$, we can suppose that all the
$n_i$ are equal to the same $n$. Then, by definition, (1.3.7.1) implies that there exists an
integer $m_{ij}\geqslant 0$ such that $(f_i f_j)^{m_{ij}}(f_j^n z_i-f_i^n z_j)=0$, and we can
moreover suppose that the $m_{ij}$ are equal to the same integer $m$; replacing then the
$z_i$ by $f_i^m z_i$, it remains to prove for the case where $m=0$, in other words, the case
where we have
\[
  f_j^n z_i=f_i^n z_j
  \tag{1.3.7.2}
\]
for any $i$, $j$. We have $D(f_i^n)=D(f_i)$, and as the $D(f_i)$ form a cover of $X$,
the ideal generated by the $f_i^n$ is $A$; in other words, there exist elements $g_i\in A$
such that $\sum_i g_i f_i^n=1$. Then consider the element $z=\sum_i g_i z_i$ of $M$; in
(1.3.7.2), we have $f_i^n z=\sum_j g_j f_i^n z_j=(\sum_j g_j f_j^n)z_i=z_i$, where by
definition $\xi_i=z/1$ in $M_{f_i}$. We conclude
\oldpage{87}
that the $s_i$ are the restrictions to $D(f_i)$ of $\theta_1(z)$, which proves that
$s=\theta_1(z)$ and finishes the proof.
\end{proof}

\begin{cor}[1.3.8]
\label{cor-1.1.3.8}
Let $M$, $N$ be two $A$-modules; the canonical homomorphism $u\mapsto\widetilde{u}$ from
$\Hom_A(M,N)$ to $\Hom_{\widetilde{A}}(\widetilde{M},\widetilde{N})$ is bijective. In
particular, the relations $M=0$ and $\widetilde{M}=0$ are equivalent.
\end{cor}

\begin{proof}
\label{proof-cor-1.1.3.8}
Consider the canonical homomorphism $v\mapsto\Gamma(v)$ from
$\Hom_{\widetilde{A}}(\widetilde{M},\widetilde{N})$ to
$\Hom_{\Gamma(\widetilde{A})}(\Gamma(\widetilde{M}),\Gamma(\widetilde{N}))$; the latter
module canonically identifies with $\Hom_A(M,N)$ according to Theorem \hyperref[thm-1.1.3.7]{(1.3.7)}.
It remains to show that $u\mapsto\widetilde{u}$ and $v\mapsto\Gamma(v)$ are inverses of each
other; it is evident that $\Gamma(\widetilde{u})=u$ by definition of $\widetilde{u}$; on the
other hand, if we put $u=\Gamma(v)$ for
$v\in\Hom_{\widetilde{A}}(\widetilde{M},\widetilde{N})$, the map
$w:\Gamma(D(f),\widetilde{M})\to\Gamma(D(f),\widetilde{N})$ canonically induced from $v$
is such that the diagram
\[
  \xymatrix{
    M\ar[r]^u\ar[d]_{\rho_{f,1}} & N\ar[d]^{\rho_{f,1}}\\
    M_f\ar[r]^w & N_f
  }
\]
is commutative; so we have necessarily that $w=u_f$ for all $f\in A$ \hyperref[env-0.1.2.4]{(\textbf{0},~1.2.4)},
which shows that $\widetilde{\Gamma(v)}=v$.
\end{proof}

\begin{cor}[1.3.9]
\label{cor-1.1.3.9}
\medskip\noindent
\begin{itemize}
  \item[{\rm(i)}] Let $u$ be a homomorphism from an $A$-module $M$ to an $A$-module $N$; then the
        sheaves associated to $\Ker u$, $\Im u$, $\Coker u$, are respectively
        $\Ker\widetilde{u}$, $\Im\widetilde{u}$, $\Coker\widetilde{u}$. In particular, for
        $\widetilde{u}$ to be injective (resp. surjective, bijective), it is necessary and
        sufficient that $u$ is.
  \item[{\rm(ii)}] If $M$ is an inductive limit (resp. direct sum) of a family of $A$-modules
        $(M_\lambda)$, $\widetilde{M}$ is the inductive limit (resp. direct sum) of the
        family $(\widetilde{M_\lambda})$, via a canonical isomorphism.
\end{itemize}
\end{cor}

\begin{proof}
\label{proof-cor-1.1.3.9}
\medskip\noindent
\begin{itemize}
  \item[(i)] If suffices to apply the fact that $\widetilde{M}$ is an exact functor in $M$
        \hyperref[prop-1.1.3.5]{(1.3.5)} to the two exact sequences of $A$-modules
        \[
          0\longrightarrow\Ker u\longrightarrow M\longrightarrow\Im u\longrightarrow 0,
        \]
        \[
          0\longrightarrow\Im u\longrightarrow N\longrightarrow\Coker u\longrightarrow 0.
        \]
        The second assertion then follows from Theorem \hyperref[thm-1.1.3.7]{(1.3.7)}.
  \item[(ii)] Let $(M_\lambda,g_{\mu\lambda})$ be an inductive system of $A$-modules, with
        inductive limit $M$, and let $g_\lambda$ be the canonical homomorphism
        $M_\lambda\to M$. As we have
        $\widetilde{g_{\nu\mu}}\circ\widetilde{g_{\mu\lambda}}=\widetilde{g_{\nu\lambda}}$
        and $\widetilde{g_\lambda}=\widetilde{g_\mu}\circ\widetilde{g_{\mu\lambda}}$ for
        $\lambda\leqslant\mu\leqslant\nu$,
        $(\widetilde{M_\lambda},\widetilde{g_{\mu\lambda}})$ is an inductive system of
        sheaves on $X$, and if we denote by $h_\lambda$ the canonical homomorphism
        $\widetilde{M_\lambda}\to\varinjlim\widetilde{M_\lambda}$, there is a unique
        homomorphism $v:\varinjlim\widetilde{M_\lambda}\to\widetilde{M}$ such that
        $v\circ h_\lambda=\widetilde{g_\lambda}$. To see that $v$ is bijective, it suffices
        to check, for each $x\in X$, that $v_x$ is a bijection from
        $(\varinjlim\widetilde{M_\lambda})_x$ to $\widetilde{M}_x$; but
        $\widetilde{M}_x=M_x$, and
        \[
          (\varinjlim\widetilde{M_\lambda})_x=\varinjlim(\widetilde{M_\lambda})_x
          =\varinjlim(M_\lambda)_x=M_x\quad\hyperref[env-0.1.3.3]{(\textbf{0},~1.3.3)}.
        \]
        Conversely, it follows from the definitions that $(\widetilde{g_\lambda})_x$ and
        $(h_\lambda)$ are all equal to the canonical map from $(M_\lambda)_x$ to $M_x$; as
        $(\widetilde{g_\lambda})_x=v_x\circ(h_\lambda)_x$, $v_x$ is the identity.

\oldpage{88}
        Finally, if $M$ is the direct sum of two $A$-modules $N$, $P$, it is immediate that
        $\widetilde{M}=\widetilde{N}\oplus\widetilde{P}$; each direct sum being the inductive
        limit of finite direct sums, the assertions of (ii) are proved.
\end{itemize}
\end{proof}

We note that Corollary \hyperref[cor-1.1.3.8]{(1.3.8)} proves that the sheaves isomorphic to the associated sheaves
of $A$-modules forms an {\it abelian category} (T, I, 1.4).

We also note that it follows from Corollary \hyperref[cor-1.1.3.9]{(1.3.9)} that if $M$ is an $A$-module {\it of
finite type}, that is to say there exists a surjective homomorphism $A^n\to M$, then there
exists a surjective homomorphism $\widetilde{A^n}\to\widetilde{M}$, in other words, the
$\widetilde{A}$-module $\widetilde{M}$ is {\it generated by a finite family of sections over
$X$} \hyperref[env-0.5.1.1]{(\textbf{0},~5.1.1)}, and conversely.

\begin{env}[1.3.10]
\label{env-1.1.3.10}
If $N$ is a submodule of an $A$-module $M$, the canonical injection $j:N\to M$ gives by
\hyperref[cor-1.1.3.9]{(1.3.9)} an injective homomorphism $\widetilde{N}\to\widetilde{M}$, which allows us
to canonically identify $\widetilde{N}$ with a {\it $\widetilde{A}$-submodule} of
$\widetilde{M}$; we will always assume we have made this identification. If $N$ and $P$ are
two submodules of $M$, we then have
\[
  (N+P)^\sim=\widetilde{N}+\widetilde{P},
  \tag{1.3.10.1}
\]
\[
  (N\cap P)^\sim=\widetilde{N}\cap\widetilde{P},
  \tag{1.3.10.2}
\]
since $N+P$ and $N\cap P$ are respectively the images of the canonical homomorphism
$N\oplus P\to M$, and the kernel of the canonical homomorphism $M\to(M/N)\oplus(M/P)$, and
it suffices to apply \hyperref[cor-1.1.3.9]{(1.3.9)}.

We conclude from (1.3.10.1) and (1.3.10.2) that if $\widetilde{N}=\widetilde{P}$, we have
$N=P$.
\end{env}

\begin{cor}[1.3.11]
\label{cor-1.1.3.11}
On the category of sheaves isomorphic to the associated sheaves of $A$-modules, the functor
$\Gamma$ is exact.
\end{cor}

\begin{proof}
\label{proof-cor-1.1.3.11}
Let $\widetilde{M}\xrightarrow{\widetilde{u}}\widetilde{N}
\xrightarrow{\widetilde{v}}\widetilde{P}$ be an exact sequence corresponding to two
homomorphisms $u:M\to N$, $v:N\to P$ of $A$-modules. If $Q=\Im u$ and $R=\Ker v$, we have
$\widetilde{Q}=\Im\widetilde{u}=\Ker\widetilde{v}=\widetilde{R}$ (Corollary \hyperref[cor-1.1.3.9]{(1.3.9)}),
hence $Q=R$.
\end{proof}

\begin{cor}[1.3.12]
\label{cor-1.1.3.12}
Let $M$, $N$ be two $A$-modules.
\begin{itemize}
  \item[{\rm(i)}] The sheaf associated to $M\otimes_A N$ canonically identifies with
        $\widetilde{M}\otimes_{\widetilde{A}}\widetilde{N}$.
  \item[{\rm(ii)}] If in addition $M$ admits a finite presentation, the sheaf associated to
        $\Hom_A(M,N)$ canonically identifies with
        $\shHom_{\widetilde{A}}(\widetilde{M},\widetilde{N})$.
\end{itemize}
\end{cor}

\begin{proof}
\label{proof-cor-1.1.3.12}
\medskip\noindent
\begin{itemize}
  \item[(i)] The sheaf $\sh{F}=\widetilde{M}\otimes_{\widetilde{A}}\widetilde{N}$ is associated to
        the presheaf
        \[
          U\longmapsto\sh{F}(U)
          =\Gamma(U,\widetilde{M})\otimes_{\Gamma(U,\widetilde{A})}\Gamma(U,\widetilde{N}),
        \]
        $U$ varying over the basis \hyperref[prop-1.1.1.10]{(1.1.10)}, (i) of $X$ consisting of the
        $D(f)$, where $f\in A$. We have that $\sh{F}(D(f))$ canonically identifies with
        $M_f\otimes_{A_f}N_f$ according to \hyperref[thm-1.1.3.7]{(1.3.7)} and \hyperref[prop-1.1.3.6]{(1.3.6)}.
        Moreover, we have that the $A_f$-module $M_f\otimes_{A_f}N_f$ is canonically
        isomorphic to $(M\otimes_A N)_f$ \hyperref[env-0.1.3.4]{(\textbf{0},~1.3.4)}, which itself is canonically
        isomorphic to $\Gamma(D(f),(M\otimes_A N)^\sim)$ (\hyperref[thm-1.1.3.7]{(1.3.7)} and
        \hyperref[prop-1.1.3.6]{(1.3.6)}). In addition, we check immediately that the canonical
        isomorphisms
        \[
          \sh{F}(D(f))\isoto\Gamma(D(f),(M\otimes_A N)^\sim)
        \]
\oldpage{89}
        thus obtained satisfy the compatibility conditions with respect to the restriction
        operations \hyperref[env-0.1.4.2]{(\textbf{0},~1.4.2)}, so they define canonical functorial isomorphism
        \[
          \widetilde{M}\otimes_{\widetilde{A}}\widetilde{N}\isoto(M\otimes_A N)^\sim.
        \]
  \item[(ii)] The sheaf $\sh{G}=\shHom_{\widetilde{A}}(\widetilde{M},\widetilde{N})$ is associated
        to the presheaf
        \[
          U\longmapsto\sh{G}(U)=\Hom_{\widetilde{A}|U}(\widetilde{M}|U,\widetilde{N}|U),
        \]
        $U$ varying over the basis of $X$ consisting of the $D(f)$. We have that
        $\sh{G}(D(f))$ canonically identifies with $\Hom_{A_f}(M_f,N_f)$ (Proposition \hyperref[prop-1.1.3.6]{(1.3.6)}
        and Corollary \hyperref[cor-1.1.3.8]{(1.3.8)}), which, according to the hypotheses on $M$, canonically
        identifies with $(\Hom_A(M,N))_f$ \hyperref[env-0.1.3.5]{(\textbf{0},~1.3.5)}. Finally, $(\Hom_A(M,N))_f$
        canonically identifies with $\Gamma(D(f),(\Hom_A(M,N))^\sim)$ (Proposition \hyperref[prop-1.1.3.6]{(1.3.6)} and
        Theorem \hyperref[thm-1.1.3.7]{(1.3.7)}), and the canonical isomorphisms
        $\sh{G}(D(f))\isoto\Gamma(D(f),(\Hom_A(M,N))^\sim)$ thus obtained are compatible with
        the restriction operations \hyperref[env-0.1.4.2]{(\textbf{0},~1.4.2)}; they thus define a canonical
        isomorphism
        $\shHom_{\widetilde{A}}(\widetilde{M},\widetilde{N})\isoto(\Hom_A(M,N))^\sim$.
\end{itemize}
\end{proof}

\begin{env}[1.3.13]
\label{env-1.1.3.13}
Now let $B$ be a (commutative) $A$-algebra; this can be interpreted by saying that $B$ is an
$A$-module such that we are given an element $e\in B$ and an $A$-homomorphism
$\vphi:B\otimes_A B\to B$, so that: 1st the diagrams
\[
  \xymatrix{
    B\otimes_A B\otimes_A B\ar[r]^{\vphi\otimes 1}\ar[d]_{1\otimes\vphi} &
    B\otimes_A B\ar[d]^\vphi & &
    B\otimes_A B\ar[rr]^\sigma\ar[rd]_\vphi & &
    B\otimes_A B\ar[dl]^\vphi\\
    B\otimes_A B\ar[r]^\vphi &
    B & & &
    B
  }
\]
($\sigma$ the canonical symmetry map) are commutative; 2nd
$\vphi(e\otimes x)=\vphi(x\otimes e)=x$. According to
Corollary \hyperref[cor-1.1.3.12]{(1.3.12)}, the homomorphism
$\widetilde{\vphi}:\widetilde{B}\otimes_{\widetilde{A}}\widetilde{B}\to\widetilde{B}$ of
$\widetilde{A}$-modules satisfies the analogous conditions, thus defines an
{\it $\widetilde{A}$-algebra} structure on $\widetilde{B}$. In a similar way, the data of
a $B$-module $N$ is the same as the data of an $A$-module $N$ and an $A$-homomorphism
$\psi:B\otimes_A N\to N$ such that the diagram
\[
  \xymatrix{
    B\otimes_A B\otimes_A B\ar[r]^{\vphi\otimes 1}\ar[d]_{1\otimes\psi} &
    B\otimes_A N\ar[d]^\psi\\
    B\otimes_A N\ar[r]^\psi &
    N
  }
\]
is commutative and $\psi(e\otimes n)=n$; the homomorphism
$\widetilde{\psi}:\widetilde{B}\otimes_{\widetilde{A}}\widetilde{N}\to\widetilde{N}$
satisfies the analogous condition, and so defines a {\it $\widetilde{B}$-module} structure
on $\widetilde{N}$.

In a similar way, we see that if $u:B\to B'$ (resp. $v:N\to N'$) is a homomorphism of
$A$-algebras (resp. of $B$-modules), $\widetilde{u}$ (resp. $\widetilde{v}$) is a
homomorphism of $\widetilde{A}$-algebras (resp. of $\widetilde{B}$-modules),
$\Ker\widetilde{u}$ is a $\widetilde{B}$-ideal (resp. $\Ker\widetilde{v}$,
$\Coker\widetilde{v}$, and $\Im\widetilde{v}$ are $\widetilde{B}$-modules). If $N$ is a
$B$-module, $\widetilde{N}$ is a $\widetilde{B}$-module of finite type if and only if $N$
is a $B$-module of finite type \hyperref[env-0.5.2.3]{(\textbf{0},~5.2.3)}.

\oldpage{90}
If $M$, $N$ are two $B$-modules, the $\widetilde{B}$-module
$\widetilde{M}\otimes_{\widetilde{B}}\widetilde{N}$ canonically identifies with
$(M\otimes_B N)^\sim$; similarly $\shHom_{\widetilde{B}}(\widetilde{M},\widetilde{N})$
canonically identifies with $(\Hom_B(M,N))^\sim$ when $M$ admits a finite presentation; the
proofs are similar to those in Corollary \hyperref[cor-1.1.3.12]{(1.3.12)}.

If $\mathfrak{J}$ is an ideal of $B$, $N$ a $B$-module, then we have
$(\mathfrak{J}N)^\sim=\widetilde{\mathfrak{J}}\cdot\widetilde{N}$.

Finally, if $B$ is an $A$-algebra {\it graded} by the $A$-submodules $B_n$ ($n\in\bb{Z}$),
the $\widetilde{A}$-algebra $\widetilde{B}$, the direct sum of the $\widetilde{A}$-modules
$\widetilde{B_n}$ \hyperref[cor-1.1.3.9]{(1.3.9)}, is graded by these $\widetilde{A}$-submodules, the axiom
of graded algebras giving that the image of the homomorphism $B_m\otimes B_n\to B$ is
contained in $B_{m+n}$. Similarly, if $M$ is a $B$-module graded by the submodules $M_n$,
then $\widetilde{M}$ is a $\widetilde{B}$-module graded by the $\widetilde{M_n}$.
\end{env}

\begin{env}[1.3.14]
\label{env-1.1.3.14}
If $B$ is an $A$-algebra, $M$ a submodule of $B$, then the $\widetilde{A}$-subalgebra of
$\widetilde{B}$ generated by $\widetilde{M}$ \hyperref[env-0.4.1.3]{(\textbf{0},~4.1.3)} is the
$\widetilde{A}$-subalgebra $\widetilde{C}$, where we denote by $C$ the subalgebra of $B$
generated by $M$. Indeed, $C$ is the direct sum of the submodules of $B$ which are the images
of the homomorphisms $\bigotimes^n M\to B$ ($n\geqslant 0$), and it suffices to apply
\hyperref[cor-1.1.3.9]{(1.3.9)} and \hyperref[cor-1.1.3.12]{(1.3.12)}.
\end{env}

\subsection{Quasi-coherent sheaves over a prime spectrum}
\label{subsection-qcoh-sheaves-over-spec}

\begin{thm}[1.4.1]
\label{thm-1.1.4.1}
Let $X$ be the prime spectrum of a ring $A$, $V$ a quasi-compact open subset of $X$, and
$\sh{F}$ an $(\OO_X|V)$-module. The four following conditions are equivalent:
\begin{itemize}
  \item[{\rm(a)}] There exists an $A$-module $M$ such that $\sh{F}$ is isomorphic to
        $\widetilde{M}|V$.
  \item[{\rm(b)}] There exists a finite open cover $(V_i)$ of $V$ by sets of the form $D(f_i)$
        ($f_i\in A$) contained in $V$, such that, for each $i$, $\sh{F}|V_i$ is isomorphic to
        a sheaf of the form $\widetilde{M_i}$, where $M_i$ is an $A_{f_i}$-module.
  \item[{\rm(c)}] The sheaf $\sh{F}$ is quasi-coherent \hyperref[env-0.5.1.3]{(\textbf{0},~5.1.3)}.
  \item[{\rm(d)}] The two following properties are satisfied:
        \begin{itemize}
          \item[{\rm(d1)}] For each $f\in A$ such that $D(f)\subset V$ and for each section
                $s\in\Gamma(D(f),\sh{F})$, there exists an integer $n\geqslant 0$ such that
                $f^n s$ extends to a section of $\sh{F}$ over $V$.
          \item[{\rm(d2)}] For each $f\in A$ such that $D(f)\subset V$ and for each section
                $t\in\Gamma(V,\sh{F})$ such that the restriction of $t$ to $D(f)$ is $0$,
                there exists an integer $n\geqslant 0$ such that $f^n t=0$.
        \end{itemize}
\end{itemize}
\end{thm}
(In the statement of the conditions (d1) and (d2), we have tacitly identified $A$ and
$\Gamma(\widetilde{A})$ according to Theorem \hyperref[thm-1.1.3.7]{(1.3.7)}).

\begin{proof}
\label{proof-thm-1.1.4.1}
The fact that (a) implies (b) is an immediate consequence of Proposition \hyperref[prop-1.1.3.6]{(1.3.6)} and the fact
that the $D(f_i)$ form a basis for the topology of $X$ \hyperref[prop-1.1.1.10]{(1.1.10)}. As each
$A$-module is isomorphic to the cokernel of a homomorphism of the form $A^{(I)}\to A^{(J)}$,
\hyperref[prop-1.1.3.6]{(1.3.6)} proves that each sheaf associated to an $A$-module is quasi-coherent; so
(b) implies (c). Conversely, if $\sh{F}$ is quasi-coherent, each $x\in V$ has a neighborhood
of the form $D(f)\subset V$ such that $\sh{F}|D(f)$ is isomorphic to the cokernel of a
homomorphism $\widetilde{A_f}^{(I)}\to\widetilde{A_f}^{(J)}$, so a sheaf $\widetilde{N}$
associated to the module $N$, the cokernel of the corresponding homomorphism
$A_f^{(I)}\to A_f^{(J)}$ (Corollaries \hyperref[cor-1.1.3.8]{(1.3.8)} and \hyperref[cor-1.1.3.9]{(1.3.9)}); as $V$ is quasi-compact,
it is clear that (c) implies (b).

\oldpage{91}
To prove that (b) implies (d1) and (d2), we first assume that $V=D(g)$ for a $g\in A$, and
that $\sh{F}$ is isomorphic to the sheaf $\widetilde{N}$ associated to an $A_g$-module $N$;
by replacing $X$ with $V$ and $A$ with $A_g$ \hyperref[prop-1.1.3.6]{(1.3.6)}, we can reduce to the case
where $g=1$. Then $\Gamma(D(f),\widetilde{N})$ and $N_f$ are canonically identified
(Proposition \hyperref[prop-1.1.3.6]{(1.3.6)} and Theorem \hyperref[thm-1.1.3.7]{(1.3.7)}), so a section $s\in\Gamma(D(f),\widetilde{N})$
identifies with an element of the form $z/f^n$, where $z\in N$; the section $f^n s$ identifies
with the element $z/1$ of $N_f$ and as a result the restriction to $D(f)$ of a section of
$\widetilde{N}$ over $X$ identifies with the element $z\in N$; hence (d1) in this case.
Similarly, $t\in\Gamma(X,\widetilde{N})$ is identified with an element $z'\in N$, the
restriction of $t$ to $D(f)$ is identified with the image $z'/1$ of $z'$ in $N_f$, and we say
that this image is zero means that there exists an $n\geqslant 0$ such that $f^n z'=0$ in
$N$, or, equivalently, $f^n t=0$.

To finish the proof that (b) implies (d1) and (d2), it suffices to establish the following
lemma:
\begin{lem}[1.4.1.1]
\label{lem-1.1.4.1.1}
Suppose that $V$ is the finite union of sets of the form $D(g_i)$, and that each of the
sheaves $\sh{F}|D(g_i)$, $\sh{F}|(D(g_i)\cap D(g_j))=\sh{F}|D(g_i g_j)$ satify {\it (d1)}
and {\it (d2)}; then $\sh{F}$ has the following two properties:
\begin{itemize}
  \item[{\rm(d$'$1)}] For each $f\in A$ and for each section $s\in\Gamma(D(f)\cap V,\sh{F})$, there exists
        an integer $n\geqslant 0$ such that $f^n s$ extends to a section of $\sh{F}$ over
        $V$.
  \item[{\rm(d$'$2)}] For each $f\in A$ and for each section $t\in\Gamma(V,\sh{F})$ such that the
        restriction of $t$ to $D(f)\cap V$ is $0$, there exists an integer $n\geqslant 0$
        such that $f^n t=0$.
\end{itemize}
\end{lem}

We first prove (d$'$2): as $D(f)\cap D(g_i)=D(fg_i)$, there exists for each $i$ an integer
$n_i$ such that the restriction of $(fg_i)^{n_i}t$ to $D(g_i)$ is zero: as the image of $g_i$
in $A_{g_i}$ is invertible, the restriction of $f^{n_i}t$ to $D(g_i)$ is also zero; taking
for $n$ the largest of the $n_i$, we have proved (d$'$2).

To show (d$'$1), we apply (d1) to the sheaf $\sh{F}|D(g_i)$: there exists an integer
$n_i\geqslant 0$ and a section $s_i'$ of $\sh{F}$ over $D(g_i)$ extending the restriction of
$(fg_i)^{n_i}s$ to $D(fg_i)$; as the image of $g_i$ in $A_{g_i}$ is invertible, there is a
section $s_i$ of $\sh{F}$ over $D(g_i)$ such that $s_i'=g_i^{n_i}s_i$, and $s_i$ extends the
restriction of $f^{n_i}s$ to $D(fg_i)$; in addition we can suppose that all the $n_i$ are
equal to the same integer $n$. By construction, the restriction of $s_i-s_j$ to
$D(f)\cap D(g_i)\cap D(g_j)=D(fg_i g_j)$ is zero; according to (d2) applied to the sheaf
$\sh{F}|D(g_i g_j)$, there exists an integer $m_{ij}\geqslant 0$ such that the restriction to
$D(g_i g_j)$ of $(fg_i g_j)^{m_{ij}}(s_i-s_j)$ is zero; as the image of $g_i g_j$ in
$A_{g_i g_j}$ is invertible, the restriction of $f^{m_{ij}}(s_i-s_j)$ to $D(g_i g_j)$ is
zero. We can then assume that all the $m_{ij}$ are equal to the same integer $m$, and so
there exists a section $s'\in\Gamma(V,\sh{F})$ extending the $f^m s_i$; as a result, this
section extends $f^{n+m}s$, hence we have proved (d$'$1).

It remains to prove that (d1) and (d2) imply (a). We show first that (d1) and (d2) imply that
these conditions are satisfied for each sheaf $\sh{F}|D(g)$, where $g\in A$ is such that
$D(g)\subset V$. It is evident for (d1); on the other hand, if $t\in\Gamma(D(g),\sh{F})$ is
such that its restriction to $D(f)\subset D(g)$ is zero, there exists by (d1) an integer
$m\geqslant 0$ such that $g^m t$
\oldpage{92}
extends to a section $s$ of $\sh{F}$ over $V$; applying (d2), we see that there exists an
integer $n\geqslant 0$ such that $f^n g^m t=0$, and as the image of $g$ in $A_g$ is
invertible, $f^n t=0$.

That being so, as $V$ is quasi-compact, Lemma \hyperref[lem-1.1.4.1.1]{(1.4.1.1)} proves that
the conditions (d$'$1) and (d$'$2) are satisfied. Consider then the $A$-module
$M=\Gamma(V,\sh{F})$, and define a homomorphism of $\widetilde{A}$-modules
$u:\widetilde{M}\to j_*(\sh{F})$, where $j$ is the canonical injection $V\to X$. As the
$D(f)$ form a basis for the topology of $X$, it suffices, for each $f\in A$, to define a
homomorphism $u_f:M_f\to\Gamma(D(f),j_*(\sh{F}))=\Gamma(D(f)\cap V,\sh{F})$, with the usual
compatibility conditions \hyperref[env-0.3.2.5]{(\textbf{0},~3.2.5)}. As the canonical image of $f$ in $A_f$ is
invertible, the restriction homomorphism $M=\Gamma(V,\sh{F})\to\Gamma(D(f)\cap V,\sh{F})$
factorizes as $M\to M_f\xrightarrow{u_f}\Gamma(D(f)\cap V,\sh{F})$ \hyperref[env-0.1.2.4]{(\textbf{0},~1.2.4)}, and the
verfication of these compatibility conditions for $D(g)\subset D(f)$ is immediate. This being
so, we show that the condition (d$'$1) (resp. (d$'$2)) implies that each of the $u_f$ are
surjective (resp. injective), which proves that $u$ is {\it bijective}, and as a result that
$\sh{F}$ is the restriction to $V$ of an $\widetilde{A}$-module isomorphic to
$\widetilde{M}$. If $s\in\Gamma(D(f)\cap V,\sh{F})$, there exists according to (d$'$1) an
integer $n\geqslant 0$ such that $f^n s$ extends to a section $z\in M$; we then have
$u_f(z/f^n)=s$, so $u_f$ is surjective. Similarly, if $z\in M$ is such that $u_f(z/1)=0$,
this means that the restriction to $D(f)\cap V$ of the section $z$ is zero; according to
(d$'$2), there exists an integer $n\geqslant 0$ such that $f^n z=0$, hence $z/1=0$ in $M_f$,
and therefore $u_f$ is injective.
\begin{flushright}
Q.E.D.
\end{flushright}
\end{proof}

\begin{cor}[1.4.2]
\label{cor-1.1.4.2}
Each quasi-coherent sheaf over a quasi-compact open subset of $X$ is induced by a
quasi-coherent sheaf on $X$.
\end{cor}

\begin{cor}[1.4.3]
\label{cor-1.1.4.3}
Each quasi-coherent $\OO_X$-algebra over $X=\Spec(A)$ is isomorphic to an $\OO_X$-algebra of
the form $\widetilde{B}$, where $B$ is an algebra over $A$; each quasi-coherent
$\widetilde{B}$-module is isomorphic to a $\widetilde{B}$-module of the form $\widetilde{N}$,
where $N$ is a $B$-module.
\end{cor}

\begin{proof}
\label{proof-cor-1.1.4.3}
Indeed, a quasi-coherent $\OO_X$-algebra is a quasi-coherent $\OO_X$-module, therefore of the
form $\widetilde{B}$, where $B$ is an $A$-module; the fact that $B$ is an $A$-algebra
follows from the characterization of the structure of an $\OO_X$-algebra using the
homomorphism $\widetilde{B}\otimes_{\widetilde{A}}\widetilde{B}\to\widetilde{B}$ of
$\widetilde{A}$-modules, as well as Corollary \hyperref[cor-1.1.3.12]{(1.3.12)}. If $\sh{G}$ is a quasi-coherent
$\widetilde{B}$-module, it suffices to show, in a similar way,
that it is also a quasi-coherent $\widetilde{A}$-module to conclude the proof; as the
question is local, we can, by restricting to an open subset of $X$ of the form $D(f)$, assume
that $\sh{G}$ is the cokernel of a homomorphism $\widetilde{B}^{(I)}\to\widetilde{B}^{(J)}$
of $\widetilde{B}$-modules (and {\it a fortiori} of $\widetilde{A}$-modules); the
proposition then follows from Corollaries \hyperref[cor-1.1.3.8]{(1.3.8)} and \hyperref[cor-1.1.3.9]{(1.3.9)}.
\end{proof}

\subsection{Coherent sheaves over a prime spectrum}
\label{subsection-coh-over-spec}

\begin{thm}[1.5.1]
\label{thm-1.1.5.1}
Let $A$ be a {\it Noetherian} ring, $X=\Spec(A)$ its prime spectrum, $V$ an open subset of
$X$, and $\sh{F}$ an $(\OO_X|V)$-module. The following conditions are equivalent:
\begin{itemize}
  \item[{\rm(a)}] $\sh{F}$ is coherent.
  \item[{\rm(b)}] $\sh{F}$ is of finite type and quasi-coherent.
  \item[{\rm(c)}] There exists an $A$-module $M$ of finite type such that $\sh{F}$ is isomorphic to
        the sheaf $\widetilde{M}|V$.
\end{itemize}
\end{thm}

\begin{proof}
\label{proof-thm-1.1.5.1}
\oldpage{93}
(a) trivially implies (b). To see the (b) implies (c), we have previously seen, since $V$
is quasi-compact \hyperref[env-0.2.2.3]{(\textbf{0},~2.2.3)}, that $\sh{F}$ is isomorphic to a sheaf $\widetilde{N}|V$,
where $N$ is an $A$-module \hyperref[thm-1.1.4.1]{(1.4.1)}. We have $N=\varinjlim M_\lambda$, where
$M_\lambda$ vary over the set of $A$-submodules of $N$ of finite type, hence
\hyperref[cor-1.1.3.9]{(1.3.9)} $\sh{F}=\widetilde{N}|V=\varinjlim\widetilde{M_\lambda}|V$; but as $\sh{F}$
is of finite type, and $V$ is quasi-compact, there exists an index $\lambda$ such that
$\sh{F}=\widetilde{M_\lambda}|V$ \hyperref[env-0.5.2.3]{(\textbf{0},~5.2.3)}.

Finally, we show that (c) implies (a). It is clear that $\sh{F}$ is then of finite type
(\hyperref[prop-1.1.3.6]{(1.3.6)} and \hyperref[cor-1.1.3.9]{(1.3.9)}); in addition, the question being local, we can
reduce to the case where $V=D(f)$, $f\in A$. As $A_f$ is Noetherian, we see finally that it
reduces to proving that the kernel of a homomorphism $\widetilde{A^n}\to\widetilde{M}$, where
$M$ is an $A$-module, is of finite type. Such a homomorphism is of the form $\widetilde{u}$,
where $u$ is a homomorphism $A^n\to M$ \hyperref[cor-1.1.3.8]{(1.3.8)}, and if $P=\Ker u$, we have
$\widetilde{P}=\Ker\widetilde{u}$ \hyperref[cor-1.1.3.9]{(1.3.9)}. As $A$ is Noetherian, $P$ is of finite
type, which finishes the proof.
\end{proof}

\begin{cor}[1.5.2]
\label{cor-1.1.5.2}
Under the hypotheses of \hyperref[thm-1.1.5.1]{(1.5.1)}, the sheaf $\OO_X$ is a quasi-coherent sheaf of
rings.
\end{cor}

\begin{cor}[1.5.3]
\label{cor-1.1.5.3}
Under the hypotheses of \hyperref[thm-1.1.5.1]{(1.5.1)}, each coherent sheaf over an open subset of $X$ is
induced by a coherent sheaf on $X$.
\end{cor}

\begin{cor}[1.5.4]
\label{cor-1.1.5.4}
Under the hypotheses of \hyperref[thm-1.1.5.1]{(1.5.1)}, each quasi-coherent $\OO_X$-module $\sh{F}$ is
the inductive limit of the coherent $\OO_X$-submodules of $\sh{F}$.
\end{cor}

\begin{proof}
\label{proof-cor-1.1.5.4}
Indeed, $\sh{F}=\widetilde{M}$ where $M$ is an $A$-module, and $M$ is the inductive limit of
its submodules of finite type; we conclude the proof by \hyperref[cor-1.1.3.9]{(1.3.9)} and
\hyperref[thm-1.1.5.1]{(1.5.1)}.
\end{proof}

\subsection{Functorial properties of quasi-coherent sheaves over a prime spectrum}
\label{subsection-func-prop-qcoh-over-spec}

\begin{env}[1.6.1]
\label{env-1.1.6.1}
Let $A$, $A'$ be two rings,
\[
  \vphi:A'\to A
\]
a homomorphism,
\[
  {}^a\vphi:X=\Spec(A)\longrightarrow X'=\Spec(A')
\]
the continuous map associated to $\vphi$ \hyperref[env-1.1.2.1]{(1.2.1)}. We will define a {\it canonical
homomorphism}
\[
  \widetilde{\vphi}:\OO_{X'}\longrightarrow{}^a\vphi_*(\OO_X)
\]
of sheaves of rings. For each $f'\in A'$, we put $f=\vphi(f')$; we have
${}^a\vphi^{-1}(D(f'))=D(f)$ (1.2.2.2). The rings $\Gamma(D(f'),\widetilde{A'})$ and
$\Gamma(D(f),\widetilde{A})$ identify respectively with $A_{f'}'$ and $A_f$
(\hyperref[prop-1.1.3.6]{(1.3.6)} and \hyperref[thm-1.1.3.7]{(1.3.7)}). The homomorphism $\vphi$ canonically defines a
homomorphism $\vphi_{f'}:A_{f'}'\to A_f$ \hyperref[env-0.1.5.1]{(\textbf{0},~1.5.1)}, in other words, we have a
homomorphism of rings
\[
  \Gamma(D(f),\widetilde{A'})\longrightarrow\Gamma({}^a\vphi^{-1}(D(f')),\widetilde{A})
  =\Gamma(D(f'),{}^a\vphi_*(\widetilde{A}))
\]
\oldpage{94}
In addition, these homomorphism satisfy the usual compatibility conditions: for
$D(f')\supset D(g')$, the diagram
\[
  \xymatrix{
    \Gamma(D(f'),\widetilde{A'})\ar[r]\ar[d] &
    \Gamma(D(f'),{}^a\vphi_*(\widetilde{A}))\ar[d]\\
    \Gamma(D(g'),\widetilde{A'})\ar[r] &
    \Gamma(D(g'),{}^a\vphi_*(\widetilde{A})
  }
\]
is commutative \hyperref[env-0.1.5.1]{(\textbf{0},~1.5.1)}; we have thus defined a homomorphism of $\OO_{X'}$-algebras,
as the $D(f')$ form a basis for the topology og $X'$ \hyperref[env-0.3.2.3]{(\textbf{0},~3.2.3)}. The pair
$\Phi=({}^a\vphi,\widetilde{\vphi})$ is thus a {\it morphism} of ringed spaces
\[
  \Phi:(X,\OO_X)\longrightarrow(X',\OO_{X'}),
\]
\hyperref[env-0.4.1.1]{(\textbf{0},~4.1.1)}.

We note further that, if we put $x'={}^a\vphi(x)$, then the homomorphism
$\widetilde{\vphi}_x^\sharp$ \hyperref[env-0.3.7.1]{(\textbf{0},~3.7.1)} is none other than the homomorphism
\[
  \vphi_x:A_{x'}'\longrightarrow A_x
\]
canonically induced by $\vphi:A'\to A$ \hyperref[env-0.1.5.1]{(\textbf{0},~1.5.1)}. Indeed, each $z'\in A_{x'}'$
can be written as $g'/f'$, where $f'$, $g'$ are in $A'$ and $f'\not\in\mathfrak{j}_{x'}$;
$D(f')$ is then a neighborhood of $x'$ in $X'$, and the homomorphism
$\Gamma(D(f'),\widetilde{A'})\to\Gamma({}^a\vphi^{-1}(D(f')),\widetilde{A})$ induced by
$\widetilde{\vphi}$ is none other than $\vphi_{f'}$; by considering the section
$s'\in\Gamma(D(f'),\widetilde{A'})$ corresponding to $g'/f'\in A_{f'}'$, we obtain
$\widetilde{\vphi}_x^\sharp(z')=\vphi(g')/\vphi(f')$ in $A_x$.
\end{env}

\begin{exm}[1.6.2]
\label{exm-1.1.6.2}
Let $S$ be a multiplicative subset of $A$, $\vphi$ the canonical homomorphism $A\to S^{-1}A$;
we have already seen \hyperref[cor-1.1.2.6]{(1.2.6)} that ${}^a\vphi$ is a {\it homeomorphism} from
$Y=\Spec(S^{-1}A)$ to the subspace of $X=\Spec(A)$ consisting of the $x$ such that
$\mathfrak{j}_x\cap S=\emp$. In addition, for each $x$ in this subspace, thus of the form
${}^a\vphi(y)$ with $y\in Y$, the homomorphism $\widetilde{\vphi}_y^\sharp:\OO_x\to\OO_y$ is
{\it bijective} \hyperref[env-0.1.2.6]{(\textbf{0},~1.2.6)}; in other words, $\OO_Y$ identifies with the sheaf on $Y$
induced by $\OO_X$.
\end{exm}

\begin{prop}[1.6.3]
\label{prop-1.1.6.3}
For each $A$-module $M$, there exists a canonical functorial isomorphism from the
$\OO_{X'}$-module $(M_{[\vphi]})^\sim$ to the direct image $\Phi_*(\widetilde{M})$.
\end{prop}

\begin{proof}
\label{proof-prop-1.1.6.3}
For purposes of abbreviation, we set $M'=M_{[\vphi]}$, and for each $f'\in A'$, we put
$f=\vphi(f')$. The modules of sections $\Gamma(D(f'),\widetilde{M'})$ and
$\Gamma(D(f),\widetilde{M})$ identify respectively with the modules $M_{f'}'$ and $M_f$
(over $A_{f'}'$ and $A_f$, respectively); in addition, the $A_{f'}'$-module
$(M_f)_{[\vphi_{f'}]}$ is canonically isomorphic to $M_{f'}'$ \hyperref[env-0.1.5.2]{(\textbf{0},~1.5.2)}. We thus have
a functorial isomorphism of $\Gamma(D(f'),\widetilde{A'})$-modules:
$\Gamma(D(f'),\widetilde{M'})
\isoto\Gamma({}^a\vphi^{-1}(D(f')),\widetilde{M})_{[\vphi_{f'}]}$
and these isomorphisms satisfy the usual compatibility conditions with the restrictions
\hyperref[env-0.1.5.6]{(\textbf{0},~1.5.6)}, thus defining the desired functorial isomorphism. We note that, in a
precise way, if $u:M_1\to M_2$ is a homomorphism of $A$-modules, it can be considered as a
homomorphism $(M_1)_{[\vphi]}\to(M_2)_{[\vphi]}$ of $A'$-modules; if we denote by
$u_{[\vphi]}$ this homomorphism, $\Phi_*(\widetilde{u})$ identifies with
$(u_{[\vphi]})^\sim$.
\end{proof}

This proof also shows that for each {\it $A$-algebra $B$}, the canonical functorial
isomorphism
\oldpage{95}
$(B_{[\vphi]})^\sim\isoto\Phi_*(\widetilde{B})$ is an isomorphism of
{\it $\OO_{X'}$-algebras}; if $M$ is a $B$-module, the canonical functorial isomorphism
$(M_{[\vphi]})^\sim\isoto\Phi_*(\widetilde{M})$ is an isomorphism of
$\Phi_*(\widetilde{B})$-modules.

\begin{cor}[1.6.4]
\label{cor-1.1.6.4}
The direct image functor $\Phi_*$ is exact on the category of quasi-coherent $\OO_X$-modules.
\end{cor}

\begin{proof}
\label{proof-cor-1.1.6.4}
Indeed, it is clear that $M_{[\vphi]}$ is an exact functor in $M$ and $\widetilde{M'}$ is an
exact functor in $M'$ \hyperref[prop-1.1.3.5]{(1.3.5)}.
\end{proof}

\begin{prop}[1.6.5]
\label{prop-1.1.6.5}
Let $N'$ be an $A'$-module, $N$ the $A$-module $N'\otimes_{A'}A_{[\vphi]}$; there exists a
canonical functorial isomorphism from the $\OO_X$-module $\Phi^*(\widetilde{N'})$ to
$\widetilde{N}$.
\end{prop}

\begin{proof}
\label{proof-prop-1.1.6.5}
We first remark that $j:z'\mapsto z'\otimes 1$ is an $A'$-homomorphism from $N'$ to
$N_{[\vphi]}$: indeed, by definition, for $f'\in A'$, we have
$(f' z')\otimes 1=z'\otimes\vphi(f')=\vphi(f')(z'\otimes 1)$. We have \hyperref[cor-1.1.3.8]{(1.3.8)} a
homomorphism $\widetilde{j}:\widetilde{N'}\to(N_{[\vphi]})^\sim$ of $\OO_{X'}$-modules, and
according to \hyperref[prop-1.1.6.3]{(1.6.3)}, we can consider that $\widetilde{j}$ maps $\widetilde{N'}$
to $\Phi_*(\widetilde{N})$. There canonically corresponds to this homomorphism
$\widetilde{j}$ a homomorphism $h=\widetilde{j}^\sharp$ from $\Phi^*(\widetilde{N'})$ to
$\widetilde{N}$ \hyperref[env-0.4.4.3]{(\textbf{0},~4.4.3)}; we will see that for each stalk, $h_x$ is {\it bijective}.
Put $x'={}^a\vphi(x)$ and let $f'\in A'$ be such that $x'\in D(f')$; let $f=\vphi(f')$. The
ring $\Gamma(D(f),\widetilde{A})$ identifies with $A_f$, the modules
$\Gamma(D(f),\widetilde{N})$ and $\Gamma(D(f'),\widetilde{N'})$ with $N_f$ and $N_{f'}'$
respectively; let $s\in\Gamma(D(f'),\widetilde{N'})$, identified with $n'/{f'}^p$
($n'\in N'$), $s$ its image under $\widetilde{j}$ in $\Gamma(D(f),\widetilde{N})$; $s$
identifies with $(n'\otimes 1)/f^p$. On the other hand, let $t\in\Gamma(D(f),\widetilde{A})$,
identified with $g/f^q$ ($g\in A$); then, by definition, we have
$h_x(s_x'\otimes t_x)=t_x\cdot s_x$ \hyperref[env-0.4.4.3]{(\textbf{0},~4.4.3)}. But we can canonically identify $N_f$
with $N_{f'}'\otimes_{A_{f'}'}(A_f)_{[\vphi_{f'}]}$ \hyperref[env-0.1.5.4]{(\textbf{0},~1.5.4)}; $s$ then corresponds
to the element $(n'/{f'}^p)\otimes 1$, and the section $y\mapsto t_y\cdot s_y$ with
$(n'/{f'}^p)\otimes(g/f^q)$. The compatibility diagram of \hyperref[env-0.1.5.6]{(\textbf{0},~1.5.6)} show that $h_x$
is none other than the canonical isomorphism
\[
  N_{x'}'\otimes_{A_{x'}'}(A_x)_{[\vphi_{x'}]}\isoto N_x=(N'\otimes_{A'}A_{[\vphi]})_x.
  \tag{1.6.5.1}
\]

In addition, let $v:N_1'\to N_2'$ be a homomorphism of $A'$-modules; as
$\widetilde{v}_{x'}=v_{x'}$ for each $x'\in X'$, it follows immediately from the above that
$\Phi^*(\widetilde{v})$ canonically identifies with $(v\otimes 1)^\sim$, which finishes the
proof of \hyperref[prop-1.1.6.5]{(1.6.5)}.
\end{proof}

If $B'$ is an $A'$-algebra, the canonical isomorphism from $\Phi^*(\widetilde{B'})$ to
$(B'\otimes_{A'}A_{[\vphi]})^\sim$ is an isomorphism of $\OO_X$-algebras; if in addition $N'$
is a $B'$-module, the canonical isomorphism from $\Phi^*(\widetilde{N'})$ to
$(N'\otimes_{A'}A_{[\vphi]})^\sim$ is an isomorphism of $\Phi^*(\widetilde{B'})$-modules.

\begin{cor}[1.6.6]
\label{cor-1.1.6.6}
The sections of $\Phi^*(\widetilde{N'})$, the canonical images of the sections $s'$, where
$s'$ varies over the $A'$-module $\Gamma(\widetilde{N'})$, generate the $A$-module
$\Gamma(\Phi^*(N'))$.
\end{cor}

\begin{proof}
\label{proof-cor-1.1.6.6}
Indeed. these images identify with the elements $z'\otimes 1$ of $N$, when we identify $N'$
and $N$ with $\Gamma(\widetilde{N'})$ and $\Gamma(\widetilde{N})$ respectively
\hyperref[thm-1.1.3.7]{(1.3.7)} and $z'$ varies over $N'$.
\end{proof}

\begin{env}[1.6.7]
\label{env-1.1.6.7}
In the proof of \hyperref[prop-1.1.6.5]{(1.6.5)}, we had proved in passing that the canonical map
(\textbf{0},~4.4.3.2) $\rho:\widetilde{N'}\to\Phi_*(\Phi^*(\widetilde{N'}))$ is none other
than the homomorphism $\widetilde{j}$,
\oldpage{96}
where $j:N'\to N'\otimes_{A'}A_{[\vphi]}$ is the homomorphism $z'\mapsto z'\otimes 1$.
Similarly, the canonical map (\textbf{0},~4.4.3.3)
$\sigma:\Phi^*(\Phi_*(\widetilde{M}))\to\widetilde{M}$ is none other than $\widetilde{p}$,
where $p:M_{[\vphi]}\otimes_{A'}A_{[\vphi]}\to M$ is the canonical homomorphism which, sends
each tensor product $z\otimes a$ ($z\in M$, $a\in A$) to $a\cdot z$; this follows immediately
from the definitions (\hyperref[env-0.3.7.1]{(\textbf{0},~3.7.1)}, \hyperref[env-0.4.4.3]{(\textbf{0},~4.4.3)},
and \hyperref[thm-1.1.3.7]{(1.3.7)}).

We conclude (\hyperref[env-0.4.4.3]{(\textbf{0},~4.4.3)} and (\textbf{0},~3.5.4.4)) that if $v:N'\to M_{[\vphi]}$ is an
$A'$-homomorphism, we have $\widetilde{v}^\sharp=(v\otimes 1)^\sim$.
\end{env}

\begin{env}[1.6.8]
\label{env-1.1.6.8}
Let $N_1'$, $N_2'$ be two $A'$-modules, and assume $N_1'$ admits a {\it finite
presentation}; it then follows from \hyperref[env-1.1.6.7]{(1.6.7)} and \hyperref[cor-1.1.3.12]{(1.3.12)}, (ii) that the
canonical homomorphism \hyperref[env-0.4.4.6]{(\textbf{0},~4.4.6)}
\[
  \Phi^*(\shHom_{\widetilde{A'}}(\widetilde{N_1'},\widetilde{N_2'}))
  \longrightarrow\shHom_{\widetilde{A}}(\Phi^*(\widetilde{N_1'}),\Phi^*(\widetilde{N_2'}))
\]
is none other than $\widetilde{\gamma}$, where $\gamma$ denotes the canonical homomorphism
of $A$-modules
$\Hom_{A'}(N_1',N_2')\otimes_{A'}A\to\Hom_A(N_1'\otimes_{A'}A,N_2'\otimes_{A'}A)$.
\end{env}

\begin{env}[1.6.9]
\label{env-1.1.6.9}
Let $\mathfrak{J}'$ be an ideal of $A'$, $M$ an $A$-module; as by definition
$\widetilde{\mathfrak{J}'}\widetilde{M}$ is the image of the canonical homomorphism
$\Phi^*(\widetilde{\mathfrak{J}'})\otimes_{\widetilde{A}}\widetilde{M}\to\widetilde{M}$, it
follows from Proposition \hyperref[prop-1.1.6.5]{(1.6.5)} and
Corollary \hyperref[cor-1.1.3.12]{(1.3.12)}, (i) that
$\widetilde{\mathfrak{J}'}\widetilde{M}$ canonically identifies with $(\mathfrak{J}' M)^\sim$;
in particular, $\Phi^*(\widetilde{\mathfrak{J}'})\widetilde{A}$ identifies with
$(\mathfrak{J}' A)^\sim$, and taking into account the right exactness of the functor $\Phi^*$,
the $\widetilde{A}$-algebra $\Phi^*((A'/\mathfrak{J}')^\sim)$ identifies with
$(A/\mathfrak{J}' A)^\sim$.
\end{env}

\begin{env}[1.6.10]
\label{env-1.1.6.10}
Let $A''$ be a third ring, $\vphi'$ a homomorphism $A''\to A'$, and put
$\vphi''=\vphi\circ\vphi'$. It follows immediately from the definitions that
${}^a\vphi''=({}^a\vphi')\circ({}^a\vphi)$, and
$\widetilde{\vphi''}=\widetilde{\vphi}\circ\widetilde{\vphi'}$ \hyperref[env-0.1.5.7]{(\textbf{0},~1.5.7)}. We conclude
that we have $\Phi''=\Phi'\circ\Phi$; in other words, $(\Spec(A),\widetilde{A})$ is a
{\it functor} from the category of rings to that of ringed spaces.
\end{env}

\subsection{Characterization of morphisms of affine schemes}
\label{subsection-morphisms-affine-schemes}

\begin{defn}[1.7.1]
\label{defn-1.1.7.1}
We say that a ringed space $(X,\OO_X)$ is an affine scheme if it is isomorphic to a ringed
space of the form $(\Spec(A),\widetilde{A})$, where $A$ is a ring; we then say that
$\Gamma(X,\OO_X)$, which canonically identifies with the ring $A$ \hyperref[thm-1.1.3.7]{(1.3.7)} is the
ring of the affine scheme $(X,\OO_X)$, and we denote it by $A(X)$ when there is no chance of
confusion.
\end{defn}

By abuse of language, when we speak of an {\it affine scheme $\Spec(A)$}, it will always be
the ringed space $(\Spec(A),\widetilde{A})$.

\begin{env}[1.7.2]
\label{env-1.1.7.2}
Let $A$, $B$ be two rings, $(X,\OO_X)$, $(Y,\OO_Y)$ the affine schemes corresponding to
the prime spectra $X=\Spec(A)$, $Y=\Spec(B)$. We have seen \hyperref[env-1.1.6.1]{(1.6.1)} that each ring
homomorphism $\vphi:B\to A$ corresponds to a morphism
$\Phi=({}^a\vphi,\widetilde{\vphi})=\Spec(\vphi):(X,\OO_X)\to(Y,\OO_Y)$. We note that $\vphi$
is entirely determined by $\Phi$, since we have by definition
$\vphi=\Gamma(\widetilde{\vphi}):\Gamma(\widetilde{B})
\to\Gamma({}^a\vphi_*(\widetilde{A})=\Gamma(\widetilde{A})$.
\end{env}

\begin{thm}[1.7.3]
\label{thm-1.1.7.3}
Let $(X,\OO_X)$, $(Y,\OO_Y)$ be two affine schemes. For a morphism of ringed spaces
$(\psi,\theta):(X,\OO_X)\to(Y,\OO_Y)$ to be of the form $({}^a\vphi,\widetilde{\vphi})$,
where $\vphi$ is a homomorphism of rings: $A(Y)\to A(X)$, it is necessary and sufficient
that, for each $x\in X$, $\theta_x^\sharp$ is a local homomorphism: $\OO_{\psi(x)}\to\OO_x$.
\end{thm}

\begin{proof}
\label{proof-thm-1.1.7.3}
\oldpage{97}
Set $A=A(X)$, $B=A(Y)$. The condition is necessary, since we saw \hyperref[env-1.1.6.1]{(1.6.1)} that
$\widetilde{\vphi}_x^\sharp$ is the homomorphism from $B_{{}^a\vphi(x)}$ to $A_x$ canonically
induced by $\vphi$, and by definition of ${}^a\vphi(x)=\vphi^{-1}(\mathfrak{j}_x)$, this
homomorphism is local.

We prove that the condition is sufficient. By definition, $\theta$ is a homomorphism
$\OO_Y\to\psi_*(\OO_X)$, and we canonically obtain a ring homomorphism
\[
  \vphi=\Gamma(\theta):B=\Gamma(Y,\OO_Y)
  \longrightarrow\Gamma(Y,\psi_*(\OO_X))=\Gamma(X,\OO_X)=A.
\]

The hypotheses on $\theta_x^\sharp$ allow us to deduce from this homomorphism, by passing to
quotients, a momomorphism $\theta^x$ from the residue field $\kres(\psi(x))$ to the residue
field $\kres(x)$, such that, for each section $f\in\Gamma(Y,\OO_Y)=B$, we have
$\theta^x(f(\psi(x)))=\vphi(f)(x)$. The relation $f(\psi(x))=0$ is therefore equivalent to
$\vphi(f)(x)=0$, which means that $\mathfrak{j}_{\psi(x)}=\mathfrak{j}_{{}^a\vphi(x)}$, and
we now write $\psi(x)={}^a\vphi(x)$ for each $x\in X$, or $\psi={}^a\vphi$. We also know that
the diagram
\[
  \xymatrix{
    B=\Gamma(Y,\OO_Y)\ar[r]^\vphi\ar[d] &
    \Gamma(X,\OO_X)=A\ar[d]\\
    B_{\psi(x)}\ar[r]^{\theta_x^\sharp} &
    A_x
  }
\]
is commutative \hyperref[env-0.3.7.2]{(\textbf{0},~3.7.2)}, which means that $\theta_x^\sharp$ is equal to the
homomorphism $\vphi_x:B_{\psi(x)}\to A_x$ canonically induced by $\vphi$ \hyperref[env-0.1.5.1]{(\textbf{0},~1.5.1)}.
As the data of the $\theta_x^\sharp$ completely characterize $\theta^\sharp$, and as a result
$\theta$ \hyperref[env-0.3.7.1]{(\textbf{0},~3.7.1)}, we conclude that we have $\theta=\widetilde{\vphi}$, by
definition of $\widetilde{\vphi}$ \hyperref[env-1.1.6.1]{(1.6.1)}.
\end{proof}

We say that a mormphism $(\psi,\theta)$ of ringed spaces satisfying the condition of
\hyperref[thm-1.1.7.3]{(1.7.3)} is a {\it morphism of affine schemes}.

\begin{cor}[1.7.4]
\label{cor-1.1.7.4}
If $(X,\OO_X)$, $(Y,\OO_Y)$ are affine schemes, there exists a canonical isomorphism from
the set of morphisms of affine schemes $\Hom((X,\OO_X),(Y,\OO_Y))$ to the set of
ring homomorphisms from $B$ to $A$, where $A=\Gamma(\OO_X)$ and $B=\Gamma(\OO_Y)$.
\end{cor}

Furthermore, we can say that the functors $(\Spec(A),\widetilde{A})$ in $A$ and
$\Gamma(X,\OO_X)$ in $(X,\OO_X)$ define an {\it equivalence} between the category of
commutative rings and the opposite category of affine schemes (T, I, 1.2).

\begin{cor}[1.7.5]
\label{cor-1.1.7.5}
If $\vphi:B\to A$ is surjective, then the corresponding morphism
$({}^a\vphi,\widetilde{\vphi})$ is a momomorphism of ringed spaces
{\it (cf. \hyperref[env-1.4.1.7]{(4.1.7)})}.
\end{cor}

\begin{proof}
\label{proof-cor-1.1.7.5}
Indeed, we know that ${}^a\vphi$ is injective \hyperref[env-1.1.2.5]{(1.2.5)}, and as $\vphi$ is
surjective, for each $x\in X$, $\vphi_x^\sharp:B_{{}^a\vphi(x)}\to A_x$, which is induced
by $\vphi$ by passing to rings of fractions, is also surjective \hyperref[env-0.1.5.1]{(\textbf{0},~1.5.1)}; hence
the conclusion \hyperref[env-0.4.1.1]{(\textbf{0},~4.1.1)}.
\end{proof}

\subsection{Morphisms from locally ringed spaces to affine schemes}
\label{subsection-morphisms-lrs-to-affine-schemes}

\oldpage{217$'$}
Due to a remark by J.~Tate, the statements given in Theorem \hyperref[thm-1.1.7.3]{(1.7.3)}
and Proposition \hyperref[prop-1.2.2.4]{(2.2.4)}
can be generalized as follows:\footnote{[Trans] The following section (I.1.8) was added in
the errata of EGA~II, hence the temporary change in page numbers, which refer to EGA~II.}

\begin{prop}[1.8.1]
\label{prop-1.1.8.1}
Let $(S,\OO_S)$ be an affine scheme, $(X,\OO_X)$ a locally ringed space. Then there is a
canonical bijection from the set of ring homomorphisms
\oldpage{218$'$}
$\Gamma(S,\OO_S)\to\Gamma(X,\OO_X)$ to the set of morphisms of ringed spaces
$(\psi,\theta):(X,\OO_X)\to(S,\OO_S)$ such that, for each $x\in X$, $\theta_x^\sharp$ is a
local homomorphism: $\OO_{\psi(x)}\to\OO_x$.
\end{prop}

\begin{proof}
\label{proof-prop-1.1.8.1}
We note first that if $(X,\OO_X)$, $(S,\OO_S)$ are any two ringed spaces, a morphism
$(\psi,\theta)$ from $(X,\OO_X)$ to $(S,\OO_S)$ canonically defines a ring homomorphism
$\Gamma(\theta):\Gamma(S,\OO_S)\to\Gamma(X,\OO_X)$, hence a first map
\[
  \rho:\Hom((X,\OO_X),(S,\OO_S))\longrightarrow\Hom(\Gamma(S,\OO_S),\Gamma(X,\OO_X)).
  \tag{1.8.1.1}
\]
Conversely, under the stated hypotheses, we set $A=\Gamma(S,\OO_S)$, and consider a ring
homomorphism $\vphi:A\to\Gamma(X,\OO_X)$. For each $x\in X$, it is clear that the set of the
$f\in A$ such that $\vphi(f)(x)=0$ is a {\it prime ideal} of $A$, since
$\OO_x/\mathfrak{m}_x=\kres(x)$ is a field; it is therefore an element of $S=\Spec(A)$, which
we denote ${}^a\vphi(x)$. In addition, for each $f\in A$, we have by definition
\hyperref[env-0.5.5.2]{(\textbf{0},~5.5.2)} that ${}^a\vphi(D(f))=X_f$, which proves that ${}^a\vphi$ is a
{\it continuous map} $X\to S$. We define then a homomorphism
\[
  \widetilde{\vphi}:\OO_S\longrightarrow{}^a\vphi_*(\OO_X)
\]
of $\OO_S$-modules; for each $f\in A$, we have $\Gamma(D(f),\OO_S)=A_f$ \hyperref[prop-1.1.3.6]{(1.3.6)};
for each $s\in A$, we correspond to $s/f\in A_f$ the element
$(\vphi(s)|X_f)(\vphi(f)|X_f)^{-1}$ of $\Gamma(X_f,\OO_X)=\Gamma(D(f),{}^a\vphi(\OO_X))$, and
we check immediately (by passing from $D(f)$ to $D(fg)$) that this is a well-defined
homomorphism of $\OO_S$-modules, hence a morphism $({}^a\vphi,\widetilde{\vphi})$ of ringed
spaces. In addition, with the same notations, and setting $y={}^a\vphi(x)$ for purposes of
simplification, we see immediately \hyperref[env-0.3.7.1]{(\textbf{0},~3.7.1)} that we have
$\widetilde{\vphi}_x^\sharp(s_y/f_y)=(\vphi(s)_x)(\vphi(f)_x)^{-1}$; as the relation
$s_y\in\mathfrak{m}_y$ is by definition equivalent to $\vphi(s)_x\in\mathfrak{m}_x$, we see
that $\widetilde{\vphi}_x^\sharp$ is a {\it local} homomorphism $\OO_y\to\OO_x$, and we have
so defined a second map $\sigma:\Hom(\Gamma(S,\OO_S),\Gamma(X,\OO_X))\to\mathfrak{L}$, where
$\mathfrak{L}$ is the set of the morphisms $(\psi,\theta):(X,\OO_X)\to(S,\OO_S)$ such that
$\theta_x^\sharp$ is local for each $x\in X$. It remains to prove that $\sigma$ and $\rho$
(restricted to $\mathfrak{L}$) are inverses of each other; the definition of
$\widetilde{\vphi}$ immediately shows that $\Gamma(\widetilde{\vphi})=\vphi$, and as a result
$\rho\circ\sigma$ is the identity. To see that $\sigma\circ\rho$ is the identity, start with a
morphism $(\psi,\theta)\in\mathfrak{L}$ and let $\vphi=\Gamma(\theta)$; the hypotheses on
$\theta_x^\sharp$ allows us to induce from this morphism, by passing to quotients, a
monomorphism $\theta^x:\kres(\psi(x))\to\kres(x)$ such that for each section
$f\in A=\Gamma(S,\OO_S)$, we have $\theta^x(f(\psi(x)))=\vphi(f)(x)$; the relation
$f(\vphi(x))=0$ is therefore equivalent to $\vphi(f)(x)=0$, which proves that
${}^a\vphi=\psi$. On the other hand, the definitions imply that the diagram
\[
  \xymatrix{
    A\ar[r]^\vphi\ar[d] &
    \Gamma(X,\OO_X)\ar[d]\\
    A_{\psi(x)}\ar[r]^{\theta_x^\sharp} &
    \OO_x
  }
\]
is commutative, and it is the same for the analogous diagram where $\theta_x^\sharp$ is
replaced by $\widetilde{\vphi}_x^\sharp$, hence $\widetilde{\vphi}_x^\sharp=\theta_x^\sharp$
\hyperref[env-0.1.2.4]{(\textbf{0},~1.2.4)}, and as a result $\widetilde{\vphi}=\theta$.
\end{proof}

\begin{env}[1.8.2]
\label{env-1.1.8.2}
When $(X,\OO_X)$ and $(Y,\OO_Y)$ are {\it locally} ringed spaces, we will consider the
morphisms $(\psi,\theta):(X,\OO_X)\to(Y,\OO_Y)$ such that, for each $x\in X$,
$\theta_x^\sharp$ is a {\it local} homomorphism: $\OO_{\psi(x)}\to\OO_x$. Henceforth when
we speak
\oldpage{219$'$}
of a {\it morphism of locally ringed spaces}, it will always be a morphism such as the
above; with this definition of morphisms, it is clear that the locally ringed spaces form a
{\it category}; for two objects $X$, $Y$ of this category, $\Hom(X,Y)$ thus denotes the set
of morphisms of locally ringed spaces from $X$ to $Y$ (the set denoted $\mathfrak{L}$ in
\hyperref[prop-1.1.8.1]{(1.8.1)}); when we consider the set of {\it morphisms of ringed spaces} from $X$
to $Y$, we will denote it by $\Hom_\text{rs}(X,Y)$ to avoid any confusion. The map (1.8.1.1)
is then written as
\[
  \rho:\Hom_\text{rs}(X,Y)\longrightarrow\Hom(\Gamma(Y,\OO_Y),\Gamma(X,\OO_X))
  \tag{1.8.2.1}
\]
and its restriction
\[
  \rho':\Hom(X,Y)\longrightarrow\Hom(\Gamma(Y,\OO_Y),\Gamma(X,\OO_X))
  \tag{1.8.2.2}
\]
is a {\it functorial} map in $X$ and $Y$ on the category of locally ringed spaces.
\end{env}

\begin{cor}[1.8.3]
\label{cor-1.1.8.3}
Let $(Y,\OO_Y)$ be a locally ringed space. For $Y$ to be an affine scheme, it is necessary
and sufficient that for each locally ringed space $(X,\OO_X)$, the map {\it (1.8.2.2)} is
bijective.
\end{cor}

\begin{proof}
\label{proof-cor-1.1.8.3}
Proposition \hyperref[prop-1.1.8.1]{(1.8.1)} shows that the condition is necessary. Conversely, if we
suppose that the condition is satisfied and if we put $A=\Gamma(Y,\OO_Y)$, it follows from
the hypotheses and from \hyperref[prop-1.1.8.1]{(1.8.1)} that the functors $X\mapsto\Hom(X,Y)$ and
$X\mapsto\Hom(X,\Spec(A))$, from the category of locally ringed spaces to that of sets, are
{\it isomorphic}. We know that this implies the existence of a canonical isomorphism
$X\to\Spec(A)$ (cf. \textbf{0},~8).
\end{proof}

\begin{env}[1.8.4]
\label{env-1.1.8.4}
Let $S=\Spec(A)$ be an affine scheme; denote by $(S',A')$ the ringed space whose underlying
space is {\it reduced to a point} and the structure sheaf $A'$ is the (necessarily simple)
sheaf on $S'$ defined by the ring $A$. Let $\pi:S\to S'$ be the unique map from $S$ to $S'$;
on the other hand, we note that for each open subset $U$ of $S$, we have a canonical map
$\Gamma(S',A')=\Gamma(S,\OO_S)\to\Gamma(U,\OO_S)$ which thus defines a {\it $\pi$-morphism}
$\iota:A'\to\OO_S$ of sheaves of rings. We have thus canonically defined a {\it morphism of
ringed spaces $i=(\pi,\iota):(S,\OO_S)\to(S',A')$}. For each $A$-module $M$, we denote by
$M'$ the simple sheaf on $S'$ defined by $M$, which is evidently an $A'$-module. It is clear
that we have $i_*(\widetilde{M})=M'$ \hyperref[thm-1.1.3.7]{(1.3.7)}.
\end{env}

\begin{lem}[1.8.5]
\label{lem-1.1.8.5}
With the notation of \hyperref[env-1.1.8.4]{(1.8.4)}, for each $A$-module $M$, the canonical functorial
$\OO_S$-homomorphism {\it (\textbf{0}, 4.4.3.3)}
\[
  i^*(i_*(\widetilde{M}))\longrightarrow\widetilde{M}
  \tag{1.8.5.1}
\]
is an isomorphism.
\end{lem}

\begin{proof}
\label{proof-lem-1.1.8.5}
Indeed, the two parts of (1.8.5.1) are right exact (the functor
$M\mapsto i_*(\widetilde{M})$ being evidently exact) and commute with direct sums; by
considering $M$ as the cokernel of a homomorphism $A^{(I)}\to A^{(J)}$, we reduce to proving
the lemma for the case where $M=A$, and it is evident in this case.
\end{proof}

\begin{cor}[1.8.6]
\label{cor-1.1.8.6}
Let $(X,\OO_X)$ be a ringed space, $u:X\to S$ a morphism of ringed spaces.
\oldpage{220$'$}
For each $A$-module $M$, we have (with the notation of \hyperref[env-1.1.8.4]{(1.8.4)}) a canonical
functorial isomorphism of $\OO_X$-modules
\[
  u^*(\widetilde{M})\isoto u^*(i^*(M')).
  \tag{1.8.6.1}
\]
\end{cor}

\begin{cor}[1.8.7]
\label{cor-1.1.8.7}
Under the hypotheses of \hyperref[cor-1.1.8.6]{(1.8.6)}, we have, for each $A$-module $M$ and each
$\OO_X$-module $\sh{F}$, a canonical functorial isomorphism in $M$ and $\sh{F}$
\[
  \Hom_{\OO_S}(\widetilde{M},u_*(\sh{F}))\isoto\Hom_A(M,\Gamma(X,\sh{F})).
  \tag{1.8.7.1}
\]
\end{cor}

\begin{proof}
\label{proof-cor-1.1.8.7}
We have, according to \hyperref[env-0.4.4.3]{(\textbf{0},~4.4.3)} and Lemma \hyperref[lem-1.1.8.5]{(1.8.5)}, a canonical
isomorphism of bifunctors
\[
  \Hom_{\OO_S}(\widetilde{M},u_*(\sh{F}))\isoto\Hom_{A'}(M',i_*(u_*(\sh{F})))
\]
and it is clear that the right hand side is none other than $\Hom_A(M,\Gamma(X,\sh{F}))$. We
note that the canonical homomorphism (1.8.7.1) sends each $\OO_S$-homomorphism
$h:\widetilde{M}\to u_*(\sh{F})$ (in other words, each $u$-morphism $\widetilde{M}\to\sh{F}$)
to the $A$-homomorphism $\Gamma(h):M\to\Gamma(S,u_*(\sh{F}))=\Gamma(X,\sh{F})$.
\end{proof}

\begin{env}[1.8.8]
\label{env-1.1.8.8}
With the notation of \hyperref[env-1.1.8.4]{(1.8.4)}, it is clear \hyperref[env-0.4.1.1]{(\textbf{0},~4.1.1)} that each morphism
of ringed spaces $(\psi,\theta):X\to S'$ is equivalent to the data of a ring homomorphism
$A\to\Gamma(X,\OO_X)$. We can thus interpret Proposition \hyperref[prop-1.1.8.1]{(1.8.1)} as defining a canonical
bijection $\Hom(X,S)\isoto\Hom(X,S')$ (where we understand that the right hand side are
morphisms of ringed spaces, since in general $A$ is not a local ring). More generally, if
$X$, $Y$ are two locally ringed spaces and if $(Y',A')$ is the ringed space whose underlying
space is reduced to a point and whose sheaf of rings $A'$ is the simple sheaf defined by the
ring $\Gamma(Y,\OO_Y)$, we can interpret (1.8.2.1) as a map
\[
  \rho:\Hom_\text{rs}(X,Y)\longrightarrow\Hom(X,Y').
  \tag{1.8.8.1}
\]
The result of Corollary \hyperref[cor-1.1.8.3]{(1.8.3)} is interepreted by saying that affine schemes are
characterized among locally ringed spaces as those for which the restriction o $\rho$ to
$\Hom(X,Y)$:
\[
  \rho':\Hom(X,Y)\longrightarrow\Hom(X,Y')
  \tag{1.8.8.2}
\]
is {\it bijective} for {\it each} locally ringed space $X$. In the following chapter, we
generalize this definition, which allows us to associate to {\it any} ringed space $Z$ (and
not only to a ringed space whose underlying space is reduced to a point) a locally ringed
space which we will call $\Spec(Z)$; this will be the starting point for a ``relative''
theory of preschemes over any ringed space, extending the results of Chapter~I.
\end{env}

\begin{env}[1.8.9]
\label{env-1.1.8.9}
We can consider the pairs $(X,\sh{F})$ consisting of a locally ringed space $X$ and an
$\OO_X$-module $\sh{F}$ as forming a category, a {\it morphism} of this category being a
pair $(u,h)$ consisting of a morphism of locally ringed spaces
\oldpage{221$'$}
$u:X\to Y$ and a $u$-morphism $h:\sh{G}\to\sh{F}$ of modules; these morphisms (for
$(X,\sh{F})$ and $(Y,\sh{G})$ fixed) form a set which we denote by
$\Hom((X,\sh{F}),(Y,\sh{G}))$; the map $(u,h)\mapsto(\rho'(u),\Gamma(h))$ is a canonical
map
\[
  \Hom((X,\sh{F}),(Y,\sh{G}))
  \longrightarrow\Hom((\Gamma(Y,\OO_Y),\Gamma(Y,\sh{G})),(\Gamma(X,\OO_X),\Gamma(X,\sh{F})))
  \tag{1.8.9.1}
\]
{\it functorial} in $(X,\sh{F})$ and $(Y,\sh{G})$, the right hand side being the set of
di-homomorphisms corresponding to the rings and modules considered \hyperref[env-0.1.0.2]{(\textbf{0},~1.0.2)}.
\end{env}

\begin{cor}[1.8.10]
\label{cor-1.1.8.10}
Let $Y$ be a locally ringed space, $\sh{G}$ an $\OO_Y$-module. For $Y$ to be an affine scheme
and $\sh{G}$ to be a quasi-coherent $\OO_Y$-module, it is necessary and sufficient that for
each pair $(X,\sh{F})$ consisting of a locally ringed space $X$ and an $\OO_X$-module
$\sh{F}$, the canonical map {\it (1.8.9.1)} is bijective.
\end{cor}

We leave the reader to give the proof, which is modeled on that of \hyperref[cor-1.1.8.3]{(1.8.3)}, and
using \hyperref[prop-1.1.8.1]{(1.8.1)} and \hyperref[cor-1.1.8.7]{(1.8.7)}.

\begin{rmk}[1.8.11]
\label{rmk-1.1.8.11}
The statements \hyperref[thm-1.1.7.3]{(1.7.3)}, \hyperref[cor-1.1.7.4]{(1.7.4)}, and \hyperref[prop-1.2.2.4]{(2.2.4)} are particular
cases of \hyperref[prop-1.1.8.1]{(1.8.1)}, as well as the definition in \hyperref[env-1.1.6.1]{(1.6.1)}; similarly,
\hyperref[prop-1.2.2.5]{(2.2.5)} follows from \hyperref[cor-1.1.8.7]{(1.8.7)}. Corollary \hyperref[cor-1.1.8.7]{(1.8.7)} also implies
\hyperref[prop-1.1.6.3]{(1.6.3)} (and as a result \hyperref[cor-1.1.6.4]{(1.6.4)}) as a particular case, since if $X$ is
an affine scheme and $\Gamma(X,\sh{F})=N$, the functors
$M\mapsto\Hom_{\OO_S}(\widetilde{M},u_*(\widetilde{N}))$ and
$M\mapsto\Hom_{\OO_S}(\widetilde{M},(N_{[\vphi]})^\sim)$ (where $\vphi:A\to\Gamma(X,\OO_X)$
corresponds to $u$) are isomorphic by Corollaries \hyperref[cor-1.1.8.7]{(1.8.7)} and \hyperref[cor-1.1.3.8]{(1.3.8)}. Finally,
\hyperref[prop-1.1.6.5]{(1.6.5)} (and as a result \hyperref[cor-1.1.6.6]{(1.6.6)}) follow from \hyperref[cor-1.1.8.6]{(1.8.6)} and the
fact that for each $f\in A$, the $A_f$-modules $N'\otimes_{A'}A_f$ and $(N'\otimes_{A'}A)_f$
(notations of \hyperref[prop-1.1.6.5]{(1.6.5)}) are canonically isomorphic.
\end{rmk}

\section{Preschemes and morphisms of preschemes}
\label{section-preschemes-and-morphisms}

\subsection{Definition of preschemes}
\label{subsection-preschemes-definition}

\begin{env}[2.1.1]
\label{env-1.2.1.1}
Given a ringed space $(X,\OO_X)$, we say that an open subset
$V$ of $X$ is an {\it affine open} if the ringed space $(V,\OO_X|V)$ is an
affine scheme \hyperref[defn-1.1.7.1]{(1.7.1)}.
\end{env}

\begin{defn}[2.1.2]
\label{defn-1.2.1.2}
We define a prescheme to be a ringed space
$(X,\OO_X)$ such that every point of $X$ admits an affine open neighbourhood.
\end{defn}

\begin{prop}[2.1.3]
\label{prop-1.2.1.3}
\oldpage{98}
If $(X,\OO_X)$ is a prescheme then the affine opens give a basis for the topology of $X$.
\end{prop}

\begin{proof}
\label{proof-prop-1.2.1.3}
If $V$ is an arbitrary open neighbourhood of $x\in X$, then there
exists by hypothesis an open neighbourhood $W$ of $x$ such that $(W,\OO_X|W)$ is
an affine scheme; we write $A$ to mean its ring. In the space $W$, $V\cap W$ is
an open neighbourhood of $x$; thus there exists $f\in A$ such that $D(f)$ is an
open neighbourhood of $x$ contained inside $V\cap W$ \hyperref[prop-1.1.1.10]{(1.1.10)}, (i).
The ringed space $(D(f),\OO_X|D(f))$ is thus an affine scheme, isomorphic to $A_f$
\hyperref[prop-1.1.3.6]{(1.3.6)}, whence the proposition.
\end{proof}

\begin{prop}[2.1.4]
\label{prop-1.2.1.4}
The underlying space of a prescheme is a Kolmogoroff space.
\end{prop}

\begin{proof}
\label{proof-prop-1.2.1.4}
If $x$, $y$ are two distinct points of a prescheme $X$ then it is clear
that there exists an open neighbourhood of one of these points that does not
contain the other if $x$ and $y$ are not in the same affine open; and if they
are in the same affine open, this is a result of \hyperref[cor-1.1.1.8]{(1.1.8)}.
\end{proof}

\begin{prop}[2.1.5]
\label{prop-1.2.1.5}
If $(X,\OO_X)$ is a prescheme then every closed
irreducible subset of $X$ admits exactly one generic point, and the map
$x\mapsto\overline{\{x\}}$ is thus a bijection of $X$ onto its set of closed
irreducible subsets.
\end{prop}

\begin{proof}
\label{proof-prop-1.2.1.5}
If $Y$ is a closed irreducible subset of $X$ and $y\in Y$, and if $U$
is an open affine neighbourhood of $y$ in $X$, then $U\cap Y$ is everywhere
dense in $Y$, as well as irreducible (\hyperref[env-0.2.1.1]{(\textbf{0},~2.1.1)} and \hyperref[env-0.2.1.4]{(\textbf{0},~2.1.4)}); thus by
Corollary \hyperref[cor-1.1.1.14]{(1.1.14)}, $U\cap Y$ is the closure in $U$ of a point $x$, and then
$Y\subset\overline{U}$ is the closure of $x$ in $X$. The uniqueness of the
generic point of $X$ is a result of Proposition \hyperref[prop-1.2.1.4]{(2.1.4)} and of \hyperref[env-0.2.1.3]{(\textbf{0},~2.1.3)}.
\end{proof}

\begin{env}[2.1.6]
\label{env-1.2.1.6}
If $Y$ is a closed irreducible subset of $X$ and $y$ its
generic point then the local ring $\OO_y$, also written $\OO_{X/Y}$, is called the
{\it local ring of $X$ along $Y$}, or the {\it local ring of $Y$ in $X$}.

If $X$ itself is irreducible and $x$ its generic point then we say that
$\OO_x$ is the {\it ring of rational functions on $X$} (cf. \textsection7).
\end{env}

\begin{prop}[2.1.7]
\label{prop-1.2.1.7}
If $(X,\OO_X)$ is a prescheme then the ringed
space $(U,\OO_X|U)$ is a prescheme for every open subset $U$.
\end{prop}

\begin{proof}
\label{proof-prop-1.2.1.7}
This follows directly from Definition \hyperref[defn-1.2.1.2]{(2.1.2)} and Proposition \hyperref[prop-1.2.1.3]{(2.1.3)}.
\end{proof}

We say that $(U,\OO_X|U)$ is the prescheme {\it induced} on $U$ by
$(X,\OO_X)$, or the {\it restriction} of $(X,\OO_X)$ to $U$.

\begin{env}[2.1.8]
\label{env-1.2.1.8}
We say that a prescheme $(X,\OO_X)$ is {\it irreducible}
(resp. {\it connected}) if the underlying space $X$ is irreducible (resp.
connected). We say that a prescheme is {\it integral} if it is
{\it irreducible and reduced} (cf. \hyperref[env-1.5.1.4]{(5.1.4)}). We say that a prescheme
$(X,\OO_X)$ is {\it locally integral} if each $x\in X$ admits an open
neighbourhood $U$ such that the prescheme induced on $U$ by $(X,\OO_X)$ is integral.
\end{env}

\subsection{Morphisms of preschemes}
\label{subsection-prescheme-morphisms}

\begin{defn}[2.2.1]
\label{defn-1.2.2.1}
Given two preschemes $(X,\OO_X)$, $(Y,\OO_Y)$, we
define a morphism (of preschemes) of $(X,\OO_X)$ to $(Y,\OO_Y)$ to be a morphism
of ringed spaces $(\psi,\theta)$ such that, for all $x\in X$, $\theta_x^\sharp$ is a
local homomorphism $\OO_{\psi(x)}\to\OO_x$.
\end{defn}

\oldpage{99}
By passing to quotients, the map $\OO_{\psi(x)}\to\OO_x$ gives us a monomorphism
$\theta^x:\kres(\psi(x))\to\kres(x)$, which lets us consider $\kres(x)$ as an
{\it extension} of the field $\kres(\psi(x))$.

\begin{env}[2.2.2]
\label{env-1.2.2.2}
The composition $(\psi'',\theta'')$ of two morphisms
$(\psi,\theta)$, $(\psi',\theta')$ of preschemes is also a morphism of
preschemes, since it is given by the formula
${\theta''}^\sharp=\theta^\sharp\circ\psi^*({\theta'}^\sharp)$ \hyperref[env-0.3.5.5]{(\textbf{0},~3.5.5)}. From this
we conclude that preschemes form a {\it category}; using the usual notation, we
will write $\Hom(X,Y)$ to mean the set of morphisms from a prescheme $X$ to a
prescheme $Y$.
\end{env}

\begin{exm}[2.2.3]
\label{exm-1.2.2.3}
If $U$ is an open subset of $X$ then the canonical
injection \hyperref[env-0.4.1.2]{(\textbf{0},~4.1.2)} of the induced prescheme $(U,\OO_X|U)$ into
$(X,\OO_X)$ is a morphism of preschemes; it is further a {\it monomorphism} of
ringed spaces (and {\it a fortiori} a monomorphism of preschemes), which
quickly follows from \hyperref[env-0.4.1.1]{(\textbf{0},~4.1.1)}.
\end{exm}

\begin{prop}[2.2.4]
\label{prop-1.2.2.4}
Let $(X,\OO_X)$ be a prescheme, and $(S,\OO_S)$ an
affine scheme associated to a ring $A$. Then there exists a canonical bijective
correspondence between morphisms of preschemes from $(X,\OO_X)$ to $(S,\OO_S)$ and
ring homomorphisms from $A$ to $\Gamma(X,\OO_X)$.
\end{prop}

Note first that, if $(X,\OO_X)$ and $(Y,\OO_Y)$ are two arbitrary ringed spaces,
a morphism $(\psi,\theta)$ from $(X,\OO_X)$ to $(Y,\OO_Y)$ canonically defines a ring
homomorphism
$\Gamma(\theta):\Gamma(Y,\OO_Y)\to\Gamma(Y,\psi_*(\OO_X))=\Gamma(X,\OO_X)$.
In the case that we consider, everything boils down to showing that any
homomorphism $\vphi:A\to\Gamma(X,\OO_X)$ is of the form $\Gamma(\theta)$
for one and only one $\theta$. Now, by hypothesis there is a covering
$(V_\alpha)$ of $X$ by affine opens; by composing of $\vphi$ with the
restriction homomorphism $\Gamma(X,\OO_X)\to\Gamma(V_\alpha,\OO_X|V_\alpha)$ we
obtain a homomorphism $\vphi_\alpha:A\to\Gamma(V_\alpha,\OO_X|V_\alpha)$
that corresponds to a unique morphism $(\psi_\alpha,\theta_\alpha)$ from the
prescheme $(V_\alpha,\OO_X|V_\alpha)$ to $(S,\OO_S)$, according to Theorem \hyperref[thm-1.1.7.3]{(1.7.3)}.
Furthermore, for each pair of indices $(\alpha,\beta)$, each point of
$V_\alpha\cap V_\beta$ admits an open affine neighbourhood $W$ contained inside
$V_\alpha\cap V_\beta$ \hyperref[prop-1.2.1.3]{(2.1.3)}; it is clear that by composing
$\vphi_\alpha$ and $\vphi_\beta$ with the restriction homomorphisms to $W$,
we obtain the same homomorphism $\Gamma(S,\OO_S)\to\Gamma(W,\OO_X|W)$, so, thanks
to the relations $(\theta_\alpha^\sharp)_x=(\vphi_\alpha)_x$ for all $x\in
V_\alpha$ and all $\alpha$ \hyperref[env-1.1.6.1]{(1.6.1)}, the restriction to $W$ of the morphisms
$(\psi_\alpha,\theta_\alpha)$ and $(\psi_\beta,\theta_\beta)$ coincide. From
this we conclude that there is a morphism
$(\psi,\theta):(X,\OO_X)\to(S,\OO_S)$ of ringed spaces, and only one such
that its restriction to each $V_\alpha$ is $(\psi_\alpha,\theta_\alpha)$, and it
is clear that this morphism is a morphism of preschemes and such that
$\Gamma(\theta)=\vphi$.

Let $u:A\to\Gamma(X,\OO_X)$ be a ring homomorphism, and $v=(\psi,\theta)$
the corresponding morphism $(X,\OO_X)\to(S,\OO_S)$. For each $f\in A$ we have
that
\[
  \psi^{-1}(D(f))=X_{u(f)}
  \tag{2.2.4.1}
\]
with the notation of \hyperref[env-0.5.5.2]{(\textbf{0},~5.5.2)} relative to the locally free sheaf
$\OO_X$. In fact, it suffices to verify this formula when $X$ itself is affine,
and then this is nothing but (1.2.2.2).

\begin{prop}[2.2.5]
\label{prop-1.2.2.5}
Under the hypotheses of Proposition \hyperref[prop-1.2.2.4]{(2.2.4)}, let
$\vphi:A\to\Gamma(X,\OO_X)$ be a ring homomorphism,
$f:(X,\OO_X)\to(S,\OO_S)$ the corresponding morphism of preschemes,
$\sh{G}$ (resp. $\sh{F}$) an $\OO_X$-module (resp. $\OO_S$-module), and
$M=\Gamma(S,\sh{F})$. Then there exists a canonical bijective
\oldpage{100}
correspondence between $f$-morphisms $\sh{F}\to\sh{G}$ \hyperref[env-0.4.4.1]{(\textbf{0},~4.4.1)} and
$A$-homomorphisms $M\to(\Gamma(X,\sh{G}))_{[\vphi]}$.
\end{prop}

\begin{proof}
\label{proof-prop-1.2.2.5}
Reasoning as in Proposition \hyperref[prop-1.2.2.4]{(2.2.4)}, we reduce to the case where $X$ is
affine, and the proposition then follows from Proposition \hyperref[prop-1.1.6.3]{(1.6.3)}
and from Corollary \hyperref[cor-1.1.3.8]{(1.3.8)}.
\end{proof}

\begin{env}[2.2.6]
\label{env-1.2.2.6}
We say that a morphism of preschemes
$(\psi,\theta):(X,\OO_X)\to(Y,\OO_Y)$ is {\it open} (resp. {\it closed})
if, for all open subsets $U$ of $X$ (resp. all closed subsets $F$ of $X$),
$\psi(U)$ is open (resp. $\psi(F)$ is closed) in $Y$. We say that
$(\psi,\theta)$ is {\it dominant} if $\psi(X)$ is dense in $Y$, and
{\it surjective} if $\psi$ is surjective. We will point out that these
conditions rely only on the continuous map $\psi$.
\end{env}

\begin{prop}[2.2.7]
\label{prop-1.2.2.7}
Let
\[
  f=(\psi,\theta):(X,\OO_X)\to(Y,\OO_Y);
\]
\[
  g=(\psi',\theta'):(Y,\OO_Y)\to(Z,\OO_Z)
\]
be two morphisms of preschemes.
\begin{itemize}
  \item[{\rm(i)}] If $f$ and $g$ are both open (resp. closed, dominant, surjective),
        then so is $g\circ f$.
  \item[{\rm(ii)}] If $f$ is surjective and $g\circ f$ closed, then $g$ is closed.
  \item[{\rm(iii)}] If $g\circ f$ is surjective, then $g$ is surjective.
\end{itemize}
\end{prop}

\begin{proof}
\label{proof-prop-1.2.2.7}
Claims (i) and (iii) are evident. Write $g\circ f=(\psi'',\theta'')$.
If $F$ is closed in $Y$ then $\psi^{-1}(F)$ is closed in $X$, so
$\psi''(\psi^{-1}(F))$ is closed in $Z$; but since $\psi$ is surjective,
$\psi(\psi^{-1}(F))=F$, so $\psi''(\psi^{-1}(F))=\psi'(F)$, which proves (ii).
\end{proof}

\begin{prop}[2.2.8]
\label{prop-1.2.2.8}
Let $f=(\psi,\theta)$ be a morphism
$(X,\OO_X)\to(Y,\OO_Y)$, and $(U_\alpha)$ an open cover of $Y$. For $f$ to be
open (resp. closed, surjective, dominant), it is necessary and sufficient that
its restriction to each induced prescheme
$(\psi^{-1}(U_\alpha),\OO_X|\psi^{-1}(U_\alpha))$, considered as a morphism of
preschemes from this induced prescheme to the induced prescheme
$(U_\alpha,\OO_Y|U_\alpha)$ is open (resp. closed, surjective, dominant).
\end{prop}

\begin{proof}
\label{proof-prop-1.2.2.8}
The proposition follows immediately from the definitions, taking into
account the fact that a subset $F$ of $Y$ is closed (resp. open, dense) in $Y$
if and only if each of the $F\cap U_\alpha$ are closed (resp. open, dense) in
$U_\alpha$.
\end{proof}

\begin{env}[2.2.9]
\label{env-1.2.2.9}
Let $(X,\OO_X)$ and $(Y,\OO_Y)$ be two preschemes; suppose that
$X$ (resp. $Y$) has a finite number of irreducible components $X_i$ (resp.
$Y_i$) ($1\leqslant i\leqslant n$); let $\xi_i$ (resp. $\eta_i$) be the generic
point of $X_i$ (resp. $Y_i$) \hyperref[prop-1.2.1.5]{(2.1.5)}. We say that a morphism
\[
  f=(\psi,\theta):(X,\OO_X)\to(Y,\OO_Y)
\]
is {\it birational} if, for all $i$, $\psi^{-1}(\eta_i)=\{\xi_i\}$ and
$\theta_{\xi_i}^\sharp:\OO_{\eta_i}\to\OO_{\xi_i}$ is an {\it isomorphism}. It
is clear that a birational morphism is dominant \hyperref[env-0.2.1.8]{(\textbf{0},~2.1.8)}, and
thus it is surjective if it is also closed.
\end{env}

\begin{nota}[2.2.10]
\label{nota-1.2.2.10}
In all that follows, when there is
no risk of confusion, we {\it suppress} the structure sheaf (resp. the morphism
of structure sheaves) from the notation of a prescheme (resp. morphism of
preschemes). If $U$ is an open subset of the underlying space $X$ of a
prescheme, then whenever we speak of $U$ as a prescheme we always mean the
induced prescheme on $U$.
\end{nota}

\subsection{Gluing preschemes}
\label{subsection-gluing-preschemes}

\begin{env}[2.3.1]
\label{env-1.2.3.1}
\oldpage{101}
It follows from definition \hyperref[defn-1.2.1.2]{(2.1.2)} that every ringed space obtained by
{\it gluing} preschemes \hyperref[env-0.4.1.6]{(\textbf{0},~4.1.6)} is again a prescheme. In particular, although
every prescheme admits, by definition, a cover by affine open sets, we see that every
prescheme can actually be obtained by {\it gluing affine schemes}.
\end{env}

\begin{env}[Example]{2.3.2}
\label{exm-1.2.3.2}
Let $K$ be a field, and $B=K[s]$, $C=K[t]$ be two polynomial rings in one indeterminate over
$K$, and define $X_1=\Spec(B)$, $X_2=\Spec(C)$, which are two isomorphic affine schemes. In
$X_1$ (resp. $X_2$), let $U_{12}$ (resp. $U_{21}$) be the affine open $D(s)$ (resp. $D(t)$)
where the ring $B_s$ (resp. $C_t$) is formed of rational fractions of the form $f(s)/s^m$
(resp. $g(t)/t^n$) with $f\in B$ (resp. $g\in C$). Let $u_{12}$ be the isomorphism of
preschemes $U_{21}\to U_{12}$ corresponding \hyperref[prop-1.2.2.4]{(2.2.4)} to the isomorphism from $B$ to
$C$ that, to $f(s)/s^m$, associates the rational fraction $f(1/t)/(1/t^m)$. We can glue $X_1$
and $X_2$ along $U_{12}$ and $U_{21}$ by using $u_{12}$, because there is clearly no gluing
condition. We later show that the prescheme $X$ obtained in this manner is a particular case
of a general method of construction (\textbf{II},~2.4.3). Here we only show that $X$ {\it is
not an affine scheme}; this will follow from the fact that the ring $\Gamma(X,\OO_X)$ is
{\it isomorphic} to $K$, and so its spectrum reduces to a point. Indeed, a section of
$\OO_X$ over $X$ has a restriction over $X_1$ (resp. $X_2$), identified to an affine open of
$X$, that is a polynomial $f(s)$ (resp. $g(t)$), and it follows from the definitions that we
should have $g(t)=f(1/t)$, which is not possible if $f=g\in K$.
\end{env}

\subsection{Local schemes}
\label{subsection-local-schemes}

\begin{env}[2.4.1]
\label{env-1.2.4.1}
We say that an affine scheme is a {\it local scheme} if
it is the affine scheme associated to a local ring $A$; then there exists in
$X=\Spec(A)$ a single {\it closed point $a\in X$}, and for all other $b\in X$
we have that $a\in\overline{\{b\}}$ \hyperref[cor-1.1.1.7]{(1.1.7)}.
\end{env}

For all preschemes $Y$ and points $y\in Y$, the local scheme $\Spec(\OO_y)$
is called the {\it local scheme of $Y$ at the point $y$}. Let $V$ be an affine
open of $Y$ containing $y$, and $B$ the ring of the affine scheme $V$; then
$\OO_y$ is canonically identified with $B_y$ \hyperref[defn-1.1.3.4]{(1.3.4)}, and the canonical
homomorphism $B\to B_y$ thus corresponds \hyperref[env-1.1.6.1]{(1.6.1)} to a morphism of preschemes
$\Spec(\OO_y)\to V$. If we compose this morphism with the canonical injection
$V\to Y$, then we obtain a morphism $\Spec(\OO_y)\to Y$, which is
{\it independent} of the affine open $V$ (containing $y$) that we chose:
indeed, if $V'$ is some other affine open containing $y$, then there exists a
third affine open $W$ containing $y$ and such that $W\subset V\cap V'$ \hyperref[prop-1.2.1.3]{(2.1.3)};
we can thus assume that $V\subset V'$, and then if $B'$ is the ring of $V'$,
everything comes down to remarking that the diagram
\[
  \xymatrix{
    B'\ar[rr]\ar[dr] & & B\ar[dl]\\
    & \OO_y &
  }
\]
is commutative \hyperref[env-0.1.5.1]{(\textbf{0},~1.5.1)}. The morphism
\[
  \Spec(\OO_y)\longrightarrow Y
\]
thus defined is said to be {\it canonical}.

\begin{prop}[2.4.2]
\label{prop-1.2.4.2}
\oldpage{102}
Let $(Y,\OO_Y)$ be a prescheme; for all $y\in Y$, let $(\psi,\theta)$ be the canonical
morphism $(\Spec(\OO_y),\widetilde{\OO}_y)\to(Y,\OO_Y)$. Then $\psi$ is a homeomorphism
from $\Spec(\OO_y)$ to the subspace $S_y$ of $Y$ given by the $z$ such that
$y\in\overline{\{z\}}$ ({\it or, equivalently, the generalizations of $y$
\hyperref[env-0.2.1.2]{(\textbf{0},~2.1.2)}}; furthermore, if $z=\psi(\mathfrak{p})$, then
$\theta_z^\sharp:\OO_z\to(\OO_y)_\mathfrak{p}$ is an isomorphism; $(\psi,\theta)$
is thus a monomorphism of ringed spaces.
\end{prop}

As the unique closed point $a$ of $\Spec(\OO_y)$ is contained in the closure of any
point of this space, and since $\psi(a)=y$, the image of $\Spec(\OO_y)$ under
the continuous map $\psi$ is contained in $S_y$. Since $S_y$ is contained in
every affine open containing $y$, one can consider just the case where $Y$ is an
affine scheme; but then this proposition follows from \hyperref[exm-1.1.6.2]{(1.6.2)}.

{\it We see \hyperref[prop-1.2.1.5]{(2.1.5)} that there is a bijective correspondence between
$\Spec(\OO_y)$ and the set of closed irreducible subsets of $Y$ containing $y$.}

\begin{cor}[2.4.3]
\label{cor-1.2.4.3}
For $y\in Y$ to be the generic point of an
irreducible component of $Y$, it is necessary and sufficient that the only prime
ideal of the local ring $\OO_y$ is its maximal ideal ({\it in other words, that
$\OO_y$ is of {\it dimension zero}}).
\end{cor}

\begin{prop}[2.4.4]
\label{prop-1.2.4.4}
Let $(X,\OO_X)$ be a local scheme of a ring
$A$, $a$ its unique closed point, and $(Y,\OO_Y)$ a prescheme. Every morphism
$u=(\psi,\theta):(X,\OO_X)\to(Y,\OO_Y)$ then factorizes uniquely as
$X\to\Spec(\OO_{\psi(a)})\to Y$, where the second arrow denotes the canonical
morphism, and the first corresponds to a local homomorphism $\OO_{\psi(a)}\to A$.
This establishes a canonical bijective correspondence between the set of
morphisms $(X,\OO_X)\to(Y,\OO_Y)$ and the set of local homomorphisms $\OO_y\to A$
for ($y\in Y$).
\end{prop}

Indeed, for all $x\in X$, we have that $a\in\overline{\{x\}}$, so
$\psi(a)\in\overline{\{\psi(x)\}}$, which shows that $\psi(X)$ is contained in
every affine open containing $\psi(a)$. So it suffices to consider the case
where $(Y,\OO_Y)$ is an affine scheme of ring $B$, and we then have that
$u=({}^a\vphi,\tilde{\vphi})$, where $\vphi\in\Hom(B,A)$ \hyperref[thm-1.1.7.3]{(1.7.3)}. Further,
we have that $\vphi^{-1}(\mathfrak{j}_a)=\mathfrak{j}_{\psi(a)}$, and hence
that the image under $\vphi$ of any element of
$B-\mathfrak{j}_{\psi(a)}$ is invertible in the local ring $A$; the
factorization in the result follows from the universal property of the ring of
fractions \hyperref[env-0.1.2.4]{(\textbf{0},~1.2.4)}. Conversely, to each local homomorphism
$\OO_y\to A$ there exists a unique corresponding morphism
$(\psi,\theta):X\to\Spec(\OO_y)$ such that $\psi(a)=y$ \hyperref[thm-1.1.7.3]{(1.7.3)}, and,
by composing with the canonical morphism $\Spec(\OO_y)\to Y$, we obtain a morphism
$X\to Y$, which proves the proposition.

\begin{env}[2.4.5]
\label{env-1.2.4.5}
The affine schemes whose ring is a field $K$ have an
underlying space that is just a point. If $A$ is a local ring with maximal
ideal $\mathfrak{m}$, then each local homomorphism $A\to K$ has kernel equal to
$\mathfrak{m}$, and so factorizes as $A\to A/\mathfrak{m}\to K$, where the
second arrow is a monomorphism. The morphisms $\Spec(K)\to\Spec(A)$ thus
correspond bijectively to monomorphisms of fields $A/\mathfrak{m}\to K$.
\end{env}

Let $(Y,\OO_Y)$ be a prescheme; for each $y\in Y$ and each ideal
$\mathfrak{a}_y$ of $\OO_y$, the canonical homomorphism
$\OO_y\to\OO_y/\mathfrak{a}_y$ defines a morphism
$\Spec(\OO_y/\mathfrak{a}_y)\to\Spec(\OO_y)$; if we compose this with the
canonical morphism $\Spec(\OO_y)\to Y$, then we obtain a morphism
$\Spec(\OO_y/\mathfrak{a}_y)\to Y$, again said to be \textit{canonical}. For
$\mathfrak{a}_y=\mathfrak{m}_y$, this says that $\OO_y/\mathfrak{a}_y=\kres(y)$, and
so Proposition \hyperref[prop-1.2.4.4]{(2.4.4)} says that:

\begin{cor}[2.4.6]
\label{cor-1.2.4.6}
\oldpage{103}
Let $(X,\OO_X)$ be a local scheme whose ring $K$ is a field, $\xi$ be the unique point of
$X$, and $(Y,\OO_Y)$ a prescheme. Then each morphism $u:(X,\OO_X)\to(Y,\OO_Y)$ factorizes
uniquely as $X\to\Spec(\kres(\psi(\xi)))\to Y$, where the second arrow denotes the canonical
morphism, and the first corresponds to a monomorphism $\kres(\psi(\xi))\to K$.
This establishes a canonical bijective correspondance between the set of
morphisms $(X,\OO_X)\to (Y,\OO_Y)$ and the set of monomorphisms $\kres(y)\to K$ (for
$y\in Y$).
\end{cor}

\begin{cor}[2.4.7]
\label{cor-1.2.4.7}
For all $y\in Y$, each canonical morphism
$\Spec(\OO_y/\mathfrak{a}_y)\to Y$ is a monomorphism of ringed spaces.
\end{cor}

\begin{proof}
\label{proof-cor-1.2.4.7}
We have already seen this when $\mathfrak{a}_y=0$ \hyperref[prop-1.2.4.2]{(2.4.2)}, and it suffices
to apply Corollary \hyperref[cor-1.1.7.5]{(1.7.5)}.
\end{proof}

\begin{rmk}{2.4.8}
\label{rmk-1.2.4.8}
Let $X$ be a local scheme, and $a$ its unique
closed point. Since every affine open containing $a$ is necessarily in the
whole of $X$, every {\it invertible} $\OO_X$-module \hyperref[env-0.5.4.1]{(\textbf{0},~5.4.1)} is
necessarily {\it isomorphic to $\OO_X$} (or, as we say, again, {\it trivial}).
This property does not hold in general for an arbitrary affine scheme
$\Spec(A)$; we will see in Chapter~V that if $A$ is a normal ring then this is
true when $A$ is \unsure{{\it factorial}}.
\end{rmk}

\subsection{Preschemes over a prescheme}
\label{subsection-preschemes-over-prescheme}

\begin{defn}[2.5.1]
\label{defn-1.2.5.1}
Given a prescheme $S$, we say that the data of a
prescheme $X$ and a morphism of preschemes $\vphi:X\to S$ defines a
prescheme $X$ {\it over the prescheme $S$}, or an {\it $S$-prescheme}; we say
that $S$ is the {\it base prescheme} of the $S$-prescheme $X$. The morphism
$\vphi$ is called the {\it structure morphism} of the $S$-prescheme $X$.
When $S$ is an affine scheme of ring $A$, we also say that $X$ endowed with
$\vphi$ is a prescheme {\it over the ring $A$} (or an {\it $A$-prescheme}).
\end{defn}

It follows from \hyperref[prop-1.2.2.4]{(2.2.4)} that the data of a prescheme over a ring $A$ is
equivalent to the data of a prescheme $(X,\OO_X)$ whose structure sheaf $\OO_X$ is
a sheaf of {\it $A$-algebras}. {\it An arbitrary prescheme can always be
considered as a $\bb{Z}$-prescheme in a unique way.}

If $\vphi:X\to S$ is the structure morphism of an $S$-prescheme $X$, we
say that a point $x\in X$ is {\it over a point $s\in S$} if $\vphi(x)=s$. We
say that $X$ {\it dominates} $S$ if $\vphi$ is a dominant morphism \hyperref[env-1.2.2.6]{(2.2.6)}.

\begin{env}[2.5.2]
\label{env-1.2.5.2}
Let $X$ and $Y$ be two $S$-preschemes; we say that a morphism
of preschemes $u:X\to Y$ is a {\it morphism of preschemes over $S$} (or
an {\it $S$-morphism}) if the diagram
\[
  \xymatrix{
    X \ar[rr]^u \ar[dr] & & Y\ar[dl]\\
    & S &
  }
\]
(where the diagonal arrows are the structure morphisms) is
commutative: this ensures that, for all $s\in S$ and $x\in X$ over $s$, $u(x)$
is also above $s$.
\end{env}

From this definition it follows immediately that the composition of two
$S$-morphisms is an $S$-morphism; $S$-preschemes thus form a {\it category}.

We denote by $\Hom_S(X,Y)$ the set of $S$-morphisms from an $S$-prescheme $X$ to
an $S$-prescheme $Y$; the identity morphism of an $S$-prescheme is denoted by
$1_X$.

When $S$ is an affine scheme of ring $A$, we will also say {\it $A$-morphism}
instead of $S$-morphism.

\begin{env}[2.5.3]
\label{env-1.2.5.3}
\oldpage{104}
If $X$ is an $S$-prescheme, and $v:X'\to X$ a morphism of preschemes,
then the composition $X'\to X\to S$ endows $X'$ with the structure of an $S$-prescheme;
in particular, every prescheme induced by an open set $U$ of $X$ can be considered as an
$S$-prescheme by the canonical injection.

If $u:X\to Y$ is an $S$-morphism of $S$-preschemes, then the restriction
of $u$ to any prescheme induced by an open subset $U$ of $X$ is also an
$S$-morphism $U\to Y$. Conversely, let $(U_\alpha)$ be an open cover of $X$,
and for each $\alpha$ let $u_\alpha:U_\alpha\to Y$ be an $S$-morphism; if,
for all pairs of indices $(\alpha,\beta)$, the restrictions of $u_\alpha$ and
$u_\beta$ to $U_\alpha\cap U_\beta$ agree, then there exists an $S$-morphism
$X\to Y$, and only one such that the restriction to each $U_\alpha$ is
$u_\alpha$.

If $u:X\to Y$ is an $S$-morphism such that $u(X)\subset V$, where $V$ is
an open subset of $Y$, then $u$, considered as a morphism from $X$ to $V$, is
also an $S$-morphism.
\end{env}

\begin{env}[2.5.4]
\label{env-1.2.5.4}
Let $S'\to S$ be a morphism of preschemes; for all
$S'$-preschemes, the composition $X\to S'\to S$ endows $X$ with the structure of
an $S$-prescheme. Conversely, suppose that $S'$ is the induced prescheme of an
open subset of $S$; let $X$ be an $S$-prescheme and suppose that the structure
morphism $f:X\to S$ is such that $f(X)\subset S'$; then we can consider
$X$ as an $S'$-prescheme. In this latter case, if $Y$ is another $S$-prescheme
whose structure morphism sends the underlying space to $S'$, then every
$S$-morphism from $X$ to $Y$ is also an $S'$-morphism.
\end{env}

\begin{env}[2.5.5]
\label{env-1.2.5.5}
If $X$ is an $S$-prescheme, with structure morphism
$\vphi:X\to S$, we define an {\it $S$-section of $X$} to be an
$S$-morphism from $S$ to $X$, that is to say a morphism of preschemes
$\psi:S\to X$ such that $\vphi\circ\psi$ is the identity on $S$. We
denote by $\Gamma(X/S)$ the set of $S$-sections of $X$.
\end{env}

\section{Products of preschemes}
\label{section-products-of-preschemes}

\subsection{Sums of preschemes}
\label{subsection-sums-of-preschemes}

Let $(X_\alpha)$ be any family of preschemes; let $X$ be a topological space which is the
{\it sum} of the underlying spaces $X_\alpha$; $X$ is then the union of the pairwise
disjoint open subspaces $X_\alpha'$, and for each $\alpha$ there is a homomorphism
$\vphi_\alpha$ from $X_\alpha$ to $X_\alpha'$. If we equip each of the $X_\alpha'$ with the
sheaf $(\vphi_\alpha)_*(\OO_{X_\alpha})$, it is clear that $X$ becomes a prescheme, which
we call the {\it sum} of the family of preschemes $(X_\alpha)$ and which we denote
$\amalg_\alpha X_\alpha$. If $Y$ is a prescheme, the map $f\mapsto(f\circ\vphi_\alpha)$ is a
{\it bijection} from the set $\Hom(X,Y)$ to the product set $\Pi_\alpha\Hom(X_\alpha,Y)$.
In particular, if the $X_\alpha$ are $S$-preschemes, with structure morphisms $\psi_\alpha$,
$X$ is an $S$-prescheme by the unique morphism $\psi:X\to S$ such that
$\psi\circ\vphi_\alpha=\psi_\alpha$ for each $\alpha$. The sum of two preschemes $X$, $Y$ is
denoted by $X\amalg Y$. It is immediate that if $X=\Spec(A)$, $Y=\Spec(B)$, $X\amalg Y$
canonically identifies with $\Spec(A\times B)$.

\subsection{Products of preschemes}
\label{subsection-products-of-preschemes}

\begin{defn}[3.2.1]
\label{defn-1.3.2.1}
Given two $S$-preschemes $X$, $Y$, we say that a triple $(Z,p_1,p_2)$ consisting of an
$S$-prescheme $Z$ and of two $S$-morphisms $p_1:Z\to X$, $p_2:Z\to Y$, is a product of the
\oldpage{105}
$S$-preschemes $X$ and $Y$, if, for each $S$-prescheme $T$, the map
$f\mapsto(p_1\circ f,p_2\circ f)$ is a bijection from the set of $S$-morphisms from $T$ to
$Z$, to the set of pairs consisting of an $S$-morphism $T\to X$ and an $S$-morphism $T\to Y$
(in other words, a bijection
\[
  \Hom_S(T,Z)\isoto\Hom_S(T,X)\times\Hom_S(T,Y)).
\]
\end{defn}

There is therefore a general notion of a {\it product} of two objects in a category, applied
to the category of $S$-preschemes (T, I, 1.1); in particular, a product of two $S$-preschemes
is {\it unique} up to a unique $S$-isomorphism. Because of this uniqueness, most of the time
we will denote a product of two $S$-preschemes $X$, $Y$ by the notation $X\times_S Y$ (or
simply $X\times Y$ when there is no chance of confusion), the morphisms $p_1$, $p_2$ (called
the {\it canonical projections} of $X\times_S$ to $X$ and $Y$, respectively) are suppressed
in the notation. If $g:T\to X$, $h:T\to Y$ are two $S$-morphisms, we denote by $(g,h)_S$, or
simply $(g,h)$, the $S$-morphism $f:T\to X\times_S Y$ such that $p_1\circ f=g$,
$p_2\circ f=h$. If $X'$, $Y'$ are two $S$-preschemes, $p_1'$, $p_2'$ the canonical
projections of $X'\times_S Y'$ (assumed to exist), $u:X'\to X$, $v:Y'\to Y$ two
$S$-morphisms, then we write $u\times_S v$ (or simply $u\times v$) for the $S$-morphism
$(u\circ p_1',v\circ p_2')_S$ from $X'\times_S Y'$ to $X\times_S Y$.

When $S$ is an affine scheme of ring $A$, we often replace $S$
by $A$ is the above notations.

\begin{prop}[3.2.2]
\label{prop-1.3.2.2}
Let $X$, $Y$, $S$ be three affine schemes, $B$, $C$, $A$ their respective rings. Let
$Z=\Spec(B\otimes_A C)$, $p_1$, $p_2$ the $S$-morphisms corresponding \hyperref[prop-1.2.2.4]{(2.2.4)} to
the canonical $A$-homomorphisms $u:b\mapsto b\otimes 1$ and $v:c\mapsto 1\otimes c$ from $B$
and $C$ to $B\otimes_A C$; then $(Z,p_1,p_2)$ is a product of $X$ and $Y$.
\end{prop}

\begin{proof}
\label{proof-prop-1.3.2.2}
According to \hyperref[prop-1.2.2.4]{(2.2.4)}, it suffices to check that if, to each $A$-homomorphism
$f:B\otimes_A C\to L$ (where $L$ is an $A$-algebra), we associate the pair
$(f\circ u,f\circ v)$, then we define a bijection
$\Hom_A(B\otimes_A C,L)\isoto\Hom_A(B,L)\times\Hom_A(C,L)$,\footnote{The notation $\Hom_A$
denotes here the set of homomorphisms of {\it $A$-algebras}.} which follows immediately
from the definitions and the relation $b\otimes c=(b\otimes 1)(1\otimes c)$.
\end{proof}

\begin{cor}[3.2.3]
\label{cor-1.3.2.3}
Let $T$ be an affine scheme of ring $D$, $\alpha=({}^a\rho,\widetilde{\rho})$
(resp. $\beta=({}^a\sigma,\widetilde{\sigma})$) an $S$-morphism $T\to X$ (resp. $T\to Y$),
where $\rho$ (resp. $\sigma$) is an $A$-homomorphism from $B$ (resp. $C$) to $D$; then
$(\alpha,\beta)_S=({}^a\tau,\widetilde{\tau})$, where $\tau$ is the homomorphism
$B\otimes_A C\to D$ such that $\tau(b\otimes c)=\rho(b)\sigma(c)$.
\end{cor}

\begin{prop}[3.2.4]
\label{prop-1.3.2.4}
Let $f:S'\to S$ be a {\it monomorphism} of preschemes {\rm (T, I, 1.1)}, $X$, $Y$ two
$S'$-preschemes, which are also considered as $S$-preschemes by means of $f$. Each product of
$S$-preschemes $X$, $Y$ is then a product of $S'$-preschemes $X$, $Y$, and conversely.
\end{prop}

\begin{proof}
\label{proof-prop-1.3.2.4}
Let $\vphi:X\to S'$, $\psi:Y\to S'$ be the structure morphisms. If $T$ is an $S$-prescheme,
$u:T\to X$, $v:T\to Y$ two $S$-morphisms, we have by definition
$f\circ\vphi\circ u=f\circ\psi\circ v=\theta$, the structure morphism of $T$; the hypotheses
on $f$ imply that $\vphi\circ u=\psi\circ v=\theta'$, and we can consider $T$ as an
$S'$-prescheme with structure morphism $\theta'$, $u$ and $v$ as $S'$-morphisms. The
conclusion of the proposition follows immediately, taking into account \hyperref[defn-1.3.2.1]{(3.2.1)}.
\end{proof}

\begin{cor}[3.2.5]
\label{cor-1.3.2.5}
Let $X$, $Y$ be two $S$-preschemes, $\vphi:X\to S$, $\psi:Y\to S$ their structure morphisms,
$S'$ an open subset of $S$ wuch that $\vphi(X)\subset S'$, $\psi(Y)\subset S'$. Each product
of $S$-preschemes $X$, $Y$ is then also a product of $S'$-preschemes $X$, $Y$, and
conversely.
\end{cor}

\oldpage{106}
It suffices to apply \hyperref[prop-1.3.2.4]{(3.2.4)} to the canonical injection $S'\to S$.

\begin{thm}[3.2.6]
\label{thm-1.3.2.6}
Given two $S$-preschemes $X$, $Y$, there exists a product $X\times_S Y$.
\end{thm}

\begin{proof}
\label{proof-thm-1.3.2.6}
We proceed in several steps.

\begin{lem}[3.2.6.1]
\label{lem-1.3.2.6.1}
Let $(Z,p,q)$ be a product of $X$ and $Y$, $U$, $V$ two open subsets of $X$, $Y$,
respectively. If we put $W=p^{-1}(U)\cap q^{-1}(V)$, then the triple consisting of $W$ and
the restrictions of $p$ and $q$ to $W$ {\it (considered as the morphisms $W\to U$, $W\to V$,
respectively)} is a product of $U$ and $V$.
\end{lem}

Indeed, if $T$ is an $S$-prescheme, we can identify the $S$-morphisms $T\to W$ and the
$S$-morphisms $T\to Z$ mapping $T$ to $W$. If then $g:T\to U$, $h:T\to V$ are any two
$S$-morphisms, we can consider them as $S$-morphisms from $T$ to $X$ and $Y$ respectively,
and by hypothesis there is then a unique $S$-morphism $f:T\to Z$ such that $g=p\circ f$,
$h=q\circ f$. As $p(f(Y))\subset U$, $q(f(T))\subset V$, we have
\[
  f(T)\subset p^{-1}(U)\cap q^{-1}(V)=W,
\]
hence our assertion.

\begin{lem}[3.2.6.2]
\label{lem-1.3.2.6.2}
Let $Z$ be an $S$-prescheme, $p:Z\to X$, $q:Z\to Y$ two $S$-morphisms, $(U_\alpha)$ an open
cover of $X$, $(V_\lambda)$ an open cover of $Y$. Suppose that for each pair
$(\alpha,\lambda)$, the $S$-prescheme
$W_{\alpha\lambda}=p^{-1}(U_\alpha)\cap q^{-1}(V_\lambda)$ and the restrictions of $p$ and
$q$ to $W_{\alpha\lambda}$ form a product of $U_\alpha$ and $V_\lambda$. Then $(Z,p,q)$ is a
product of $X$ and $Y$.
\end{lem}

We first show that, if $f_1$, $f_2$ are two $S$-morphisms $T\to Z$, then the relations
$p\circ f_1=p\circ f_2$ and $q\circ f_1=q\circ f_2$ imply $f_1=f_2$. Indeed, $Z$ is the union
of the $W_{\alpha\lambda}$, so the $f_1^{-1}(W_{\alpha\lambda})$ form an open cover of $T$,
and similarly for $f_2^{-1}(W_{\alpha\lambda})$. In addition, we have
\[
  f_1^{-1}(W_{\alpha\lambda})=f_1^{-1}(p^{-1}(U_\alpha))\cap f_1^{-1}(q^{-1}(V_\lambda))
  =f_2^{-1}(p^{-1}(U_\alpha))\cap f_2^{-1}(q^{-1}(V_\lambda))=f_2^{-1}(W_{\alpha\lambda})
\]
by hypothesis, and it reduces to seeing that the the restrictions of $f_1$ and $f_2$ to
$f_1^{-1}(W_{\alpha\lambda})=f_2^{-1}(W_{\alpha\lambda})$ are \unsure{identical/the identity} for each pair of
indices. But as these restrictions can be considered as $S$-morphisms from
$f_1^{-1}(W_{\alpha\lambda})$ to $W_{\alpha\lambda}$, our assertion follows from the
hypotheses and Definition \hyperref[defn-1.3.2.1]{(3.2.1)}.

Suppose now that we are given two $S$-morphisms $g:T\to X$, $h:T\to Y$. Put
$T_{\alpha\lambda}=g^{-1}(U_\alpha)\cap h^{-1}(V_\lambda)$; the $T_{\alpha\lambda}$ form an
open cover of $T$. By hypothesis, there exists an $S$-morphism $f_{\alpha\lambda}$ such that
$p\circ f_{\alpha\lambda}$ and $q\circ f_{\alpha\lambda}$ are the respective restrictions of
$g$ and $h$ to $T_{\alpha\lambda}$. In addition, we show that the restrictions of
$f_{\alpha\lambda}$ and $f_{\beta\mu}$ to $T_{\alpha\lambda}\cap T_{\beta\mu}$ coincide,
which would finish the proof of Lemma \hyperref[lem-1.3.2.6.2]{(3.2.6.2)}. The images of
$T_{\alpha\lambda}\cap T_{\beta\mu}$ under $f_{\alpha\lambda}$ and $f_{\beta\mu}$ are
contained in $W_{\alpha\lambda}\cap W_{\beta\mu}$ by definition. As
\[
  W_{\alpha\lambda}\cap W_{\beta\mu}
  =p^{-1}(U_\alpha\cap U_\beta)\cap q^{-1}(V_\lambda\cap V_\mu),
\]
it follows from Lemma \hyperref[lem-1.3.2.6.1]{(3.2.6.1)} that $W_{\alpha\lambda}\cap W_{\beta\mu}$ and the
restrictions to this prescheme of $p$ and $q$ form a {\it product} of $U_\alpha\cap U_\beta$
and $V_\lambda\cap V_\mu$. As $p\circ f_{\alpha\lambda}$ and $p\circ f_{\beta\mu}$ coincide
on $T_{\alpha\lambda}\cap T_{\beta\mu}$ and similarly for $q\circ f_{\alpha\lambda}$ and
$q\circ f_{\beta\mu}$, we see that $f_{\alpha\lambda}$ and $f_{\beta\mu}$ coincide on
$T_{\alpha\lambda}\cap T_{\beta\mu}$, q.e.d.

\begin{lem}[3.2.6.3]
\label{lem-1.3.2.6.3}
\oldpage{107}
Let $(U_\alpha)$ be an open cover of $X$, $(V_\lambda)$ an open cover of $Y$, and suppose
that for each pair $(\alpha,\lambda)$, there exists a product of $U_\alpha$ and $V_\lambda$;
then there exists a product of $X$ and $Y$.
\end{lem}

Applying Lemma \hyperref[lem-1.3.2.6.1]{(3.2.6.1)} to the open sets $U_\alpha\cap U_\beta$ and
$V_\lambda\cap V_\mu$, we see that there exists a product of $S$-preschemes induced
respectively by $X$ and $Y$ on these open sets; in addition, the uniqueness of the product
shows that, if we set $i=(\alpha,\lambda)$, $j=(\beta,\mu)$, then there is a canonical
isomorphism $h_{ij}$ (resp. $h_{ji}$) from this product to an $S$-prescheme $W_{ij}$
(resp. $W_{ji}$) induced by $U_\alpha\times_S V_\lambda$ (resp. $U_\beta\times_S V_\mu$) on
an open set; $f_{ij}=h_{ij}\circ h_{ji}^{-1}$ is then an isomorphism from $W_{ji}$ to
$W_{ij}$. In addition, for a third pair $k=(\gamma,\nu)$, we have
$f_{ik}=f_{ij}\circ f_{jk}$ on
$W_{ki}\cap W_{kj}$, as it follows from applying Lemma \hyperref[lem-1.3.2.6.1]{(3.2.6.1)} to
the open sets $U_\alpha\cap U_\beta\cap U_\gamma$ and $V_\lambda\cap V_\mu\cap V_\nu$ in
$U_\beta$ and $V_\mu$, respectively. It follows that we have a prescheme $Z$, an open cover
$(Z_i)$ of the underlying space of $Z$, and for each $i$ and isomorphism $g_i$ from the
induced prescheme
$Z_i$ to the prescheme $U_\alpha\times_S V_\lambda$, so that for each pair $(i,j)$, we have
$f_{ij}=g_i\circ g_j^{-1}$ \hyperref[env-1.2.3.1]{(2.3.1)}; in addition, we have $g_i(Z_i\cap Z_j)=W_{ij}$.
If $p_i$, $q_i$, $\theta_i$ are the projections and the structure morphism of the
$S$-prescheme $U_\alpha\times_S V_\lambda$, we immediately note that
$p_i\circ g_i=p_j\circ g_j$ on $Z_i\cap Z_j$, and similarly for the two other morphisms. We
can thus define the morphisms of preschemes $p:Z\to X$ (resp. $q:Z\to Y$, $\theta:Z\to S$) by
the condition that $p$ (resp. $q$, $\theta$) coincide with $p_i\circ g_i$
(resp. $q_i\circ g_i$, $\theta_i\circ g_i$) on each of the $Z_i$; $Z$, equipped with
$\theta$, is then an $S$-prescheme. We now show that
$Z_i'=p^{-1}(U_\alpha)\cap q^{-1}(V_\lambda)$ is equal to $Z_i$. For each index
$j=(\beta,\mu)$, we have $Z_j\cap Z_i'=g_j^{-1}(p_j^{-1}(U_\alpha)\cap q_j^{-1}(V_\lambda))$.
We have
\[
  p_j^{-1}(U_\alpha)\cap q_j^{-1}(V_\lambda)
  =p_j^{-1}(U_\alpha\cap U_\beta)\cap q_j^{-1}(V_\lambda\cap V_\mu);
\]
according to Lemma \hyperref[lem-1.3.2.6.1]{(3.2.6.1)}, the restrictions of $p_j$ and $q_j$ to
$p_j^{-1}(U_\alpha)\cap q_j^{-1}(V_\lambda)$ define on this $S$-prescheme the structure of a
product of $U_\alpha\cap U_\beta$ and $V_\lambda\cap V_\mu$; but the uniqueness of the
product then implies that $p_j^{-1}(U_\alpha)\cap q_j^{-1}(V_\lambda)=W_{ji}$. As a result we
have $Z_j\cap Z_i'=Z_j\cap Z_i$ for each $j$, hence $Z_i'=Z_i$. We then deduce from
Lemma \hyperref[lem-1.3.2.6.2]{(3.2.6.2)} that $(Z,p,q)$ is a product of $X$ and $Y$.

\begin{lem}[3.2.6.4]
\label{lem-1.3.2.6.4}
Let $\vphi:X\to S$, $\psi:Y\to S$ be the structure morphisms of $X$ and $Y$, $(S_i)$ and open
cover of $S$, and set $X_i=\vphi^{-1}(S_i)$, $Y_i=\psi^{-1}(S_i)$. If each of the products
$X_i\times_S Y_i$ exists, then $X\times_S Y$ exists.
\end{lem}

According to Lemma \hyperref[lem-1.3.2.6.3]{(3.2.6.3)}, everything comes down to proving that the products
$X_i\times_S Y_i$ exists for any $i$ and $j$. Set
$X_{ij}=X_i\cap X_j=\vphi^{-1}(S_i\cap S_j)$, $Y_{ij}=Y_i\cap Y_j=\psi^{-1}(S_i\cap S_j)$;
according to Lemma \hyperref[lem-1.3.2.6.1]{(3.2.6.1)}, the product $Z_{ij}=X_{ij}\times_S Y_{ij}$ exists. We now
note that if $T$ is an $S$-prescheme and if $g:T\to X_i$, $h:T\to Y_j$ are $S$-morphisms,
then we necessarily have that $\vphi(g(T))=\psi(h(T))\subset S_i\cap S_j$ according to the
definition of an $S$-morphisms, thus $g(T)\subset X_{ij}$ and $h(T)\subset Y_{ij}$; it is
then immediate that $Z_{ij}$ is the product of $X_i$ and $Y_j$.

\begin{env}[3.2.6.5]
\label{env-1.3.2.6.5}
We can now complete the proof of Theorem \hyperref[thm-1.3.2.6]{(3.2.6)}. If $S$ is an {\it affine
scheme}, there are covers $(U_\alpha)$, $(V_\lambda)$ of $X$ and $Y$ respectively,
consisting of affine opens; as $U_\alpha\times_S V_\lambda$ exists according to
\hyperref[prop-1.3.2.2]{(3.2.2)}, there similarly exists $X\times_S Y$ by Lemma \hyperref[lem-1.3.2.6.3]{(3.2.6.3)}. If $S$
is any prescheme, there is a cover $(S_i)$ of $S$ consisting of affine opens. If
$\vphi:X\to S$, $\psi:Y\to S$ are the structure morphisms, and if we set
$X_i=\vphi^{-1}(S_i)$, $Y_i=\psi^{-1}(S_i)$, the products $X_i\times_{S_i}Y_i$ exist
according to the
\oldpage{108}
above; but then the products $X_i\times_S Y_i$ also exist \hyperref[cor-1.3.2.5]{(3.2.5)}, therefore
$X\times_S Y$ similarly exists by Lemma \hyperref[lem-1.3.2.6.4]{(3.2.6.4)}.
\end{env}
\end{proof}

\begin{cor}[3.2.7]
\label{cor-1.3.2.7}
Let $Z=X\times_S Y$ be the product of two $S$-preschemes, $p$, $q$ the projections from $Z$
to $X$ and $Y$, $\vphi$ (resp. $\psi$) the structure morphism of $X$ (resp. $Y$). Let $S'$ be
an open subset of $S$, $U$ (resp. $V$) an open subset of $X$ (resp. $Y$) contained in
$\vphi^{-1}(S')$ (resp. $\psi^{-1}(S')$). Then the product $U\times_{S'}V$ canonically
identifies with the prescheme induced on $Z$ by $p^{-1}(U)\cap q^{-1}(V)$ (considered as a
$S'$-prescheme). In addition, if $f:T\to X$, $g:T\to Y$ are $S$-morphisms such that
$f(T)\subset U$, $g(T)\subset V$, the $S'$-morphism $(f,g)_{S'}$ identifies with the
restriction of $(f,g)_S$ to $p^{-1}(U)\cap q^{-1}(V)$.
\end{cor}

\begin{proof}
\label{proof-cor-1.3.2.7}
This follows from Corollary \hyperref[cor-1.3.2.5]{(3.2.5)} and Lemma \hyperref[lem-1.3.2.6.1]{(3.2.6.1)}.
\end{proof}

\begin{env}[3.2.8]
\label{env-1.3.2.8}
Let $(X_\alpha)$, $(Y_\lambda)$ be two familes of $S$-preschemes, $X$ (resp. $Y$) the sum
of the family $(X_\alpha)$ (resp. $(Y_\lambda)$) (3.1). Then $X\times_S Y$ identifies with
the {\it sum} of the family $(X_\alpha\times_S Y_\lambda)$; this follows immediately from
Lemma \hyperref[lem-1.3.2.6.3]{(3.2.6.3)}.
\end{env}

\begin{env}[3.2.9]
\label{env-1.3.2.9}
\footnote{[Trans] \hyperref[env-1.3.2.9]{(3.2.9)} is from the errata of EGA~II, on page 221.}
\oldpage{221$'$}
It follows from \hyperref[prop-1.1.8.1]{(1.8.1)} that we can state \hyperref[prop-1.3.2.2]{(3.2.2)} in the following
manner: $Z=\Spec(B\otimes_A C)$ is not only a product of $X=\Spec(B)$ and $Y=\Spec(C)$ in the
category of {\it $S$-preschemes}, but also in the category of {\it locally ringed spaces
over $S$} (with a definition of $S$-morphisms modeled on that of \hyperref[env-1.2.5.2]{(2.5.2)}). The
proof of \hyperref[thm-1.3.2.6]{(3.2.6)} also proves that for any two $S$-preschemes $X$, $Y$, the
prescheme $X\times_S Y$ is not only the product of $X$ and $Y$ in the category of
$S$-preschemes, but also in the category of locally ringed spaces over the prescheme $S$.
\end{env}

\subsection{Formal properties of the product; change of the base prescheme}
\label{subsection-product-formal-prop-and-base-change}

\begin{env}[3.3.1]
\label{env-1.3.3.1}
The reader will notice that all the properties stated in this section, except
\hyperref[env-1.3.3.13]{(3.3.13)} and \hyperref[env-1.3.3.15]{(3.3.15)}, are true without modification in any
category, whenever the products involved in the statements exist (since it is
clear that the notions of an $S$-object and of an $S$-morphism can be defined
exactly as in (2.5) for any object $S$ of the category).
\end{env}

\begin{env}[3.3.2]
\label{env-1.3.3.2}
First, $X\times_S Y$ is a {\it covariant bifunctor} in $X$ and $Y$ on the
category of $S$-preschemes: it suffices in fact to note that the diagram
\[
  \xymatrix{
    X\times Y\ar[r]^{f\times 1}\ar[d] &
    X'\times Y\ar[r]^{f'\times 1}\ar[d] &
    X''\times Y\ar[d]\\
    X\ar[r]^f &
    X'\ar[r]^{f'} &
    X''
  }
\]
is commutative.
\end{env}

\begin{prop}[3.3.3]
\label{prop-1.3.3.3}
For each $S$-prescheme $X$, the first (resp. second) projection from
$X\times_S S$ (resp. $S\times_S X$) is a functorial isomorphism from
$X\times_S S$ (resp. $S\times_S X$) to $X$, whose inverse isomorphism is
$(1_X,\vphi)_S$ (resp. $(\vphi,1_X)_S$), where we denote by $\vphi$ the
structure morphism $X\to S$; therefore we can write, up to a canonical
isomorphism,
\[
  X\times_S S=S\times_S X=X.
\]
\end{prop}

\begin{proof}
\label{proof-prop-1.3.3.3}
It suffices to prove that the triple $(X,1_X,\vphi)$ is a product of $X$ and
$S$. If $T$ is an $S$-prescheme, the only $S$-morphism from $T$ to $S$ is
necessarily the structure morphism $\psi:T\to S$. If $f$ is an $S$-morphism from
$T$ to $X$, we necessarily have $\psi=\vphi\circ f$, hence our assertion.
\end{proof}

\begin{cor}[3.3.4]
\label{cor-1.3.3.4}
Let $X$, $Y$ be two $S$-preschemes, $\vphi:X\to S$, $\psi:Y\to S$ their
structure morphisms. If we canonically identify $X$ with $X\times_S S$ and $Y$
with $S\times_S Y$, the projections $X\times_S Y\to X$ and $X\times_S Y\to Y$
identify respectively with $1_X\times\psi$ and $\vphi\times 1_Y$.
\end{cor}

The proof is immediate and is left to the reader.

\begin{env}[3.3.5]
\label{env-1.3.3.5}
We can define in a manner similar to (3.2) the product of a
\oldpage{109}
finite number $n$ of $S$-preschemes, the existence of these products following
from \hyperref[thm-1.3.2.6]{(3.2.6)} by induction on $n$, and noting that
$(X_1\times_S X_2\times_S\cdots\times_S X_{n-1})\times_S X_n$ satisfies the
definition of a product. The uniqueness of the product implies, as in any
category, its {\it commutativity} and {\it associativity} properties. If, for
example, $p_1$, $p_2$, $p_3$ denote the projections from
$X_1\times_S X_2\times_S X_3$, and if we identify this prescheme with
$(X_1\times_S X_2)\times_S X_3$, then the projection to $X_1\times_S X_2$ is
identified with $(p_1,p_2)_S$.
\end{env}

\begin{env}[3.3.6]
\label{env-1.3.3.6}
Let $S$, $S'$ be two preschemes, $\vphi:S'\to S$ a morphism, which makes $S'$ an
$S$-prescheme. For each $S$-prescheme $X$, consider the product $X\times_S S'$,
and let $p$ and $\pi'$ be the projections to $X$ and $S'$ respectively. Equipped
with $\pi'$, this product is an $S'$-prescheme; when we consider it as such, we
denote it by $X_{(S')}$ or $X_{(\vphi)}$, and we say that this is the prescheme
obtained by {\it base change} from $S$ to $S'$, by means of the morphism
$\vphi$, or the {\it inverse image} of $X$ by $\vphi$. We note that if $\pi$ is
the structure morphism of $X$, $\theta$ the structure morphism of
$X\times_S S'$, considered as an $S$-prescheme, then the diagram
\[
  \xymatrix{
    X\ar[d]_\pi &
    X_{(S')}\ar[l]_p\ar[ld]_\theta\ar[d]^{\pi'}\\
    S &
    S'\ar[l]_\vphi
  }
\]
is commutative.
\end{env}

\begin{env}[3.3.7]
\label{env-1.3.3.7}
With the notation of \hyperref[env-1.3.3.6]{(3.3.6)}, for each $S$-morphism $f:X\to Y$, we
denote by $f_{(S')}$ the $S'$-morphism $f\times_S 1:X_{(S')}\to Y_{(S')}$, and
we say that $f_{(S')}$ is the {\it base change} (or {\it inverse image}) of
$f$ by $\vphi$. Therefore, $X_{(S')}$ is a {\it covariant functor} in $X$, from
the category of $S$-preschemes to that of $S'$-preschemes.
\end{env}

\begin{env}[3.3.8]
\label{env-1.3.3.8}
The prescheme $X_{(S')}$ can be considered as a solution to a {\it universal
mapping problem}: each $S'$-prescheme $T$ is also an $S$-prescheme via $\vphi$;
each $S$-morphism $g:T\to X$ is then uniquely written as $g=p\circ f$, where $f$
is an $S'$-morphism $T\to X_{(S')}$, as it follows from the definition of the
product applied to the $S$-morphisms $f$ and $\psi:T\to S'$ (the structure
morphism of $T$).
\end{env}

\begin{prop}[3.3.9]
\label{prop-1.3.3.9}
{\it (``Transitivity of base change'')}. Let $S''$ be a prescheme,
$\vphi':S''\to S$ a morphism. For each $S$-prescheme $X$, there exists an
canonical functorial isomorphism from the $S''$-prescheme
$(X_{(\vphi)})_{(\vphi')}$ to the $S''$-prescheme $X_{(\vphi\circ\vphi')}$.
\end{prop}

\begin{proof}
\label{proof-prop-1.3.3.9}
Let $T$ be a $S''$-prescheme, $\psi$ its structure morphism, and $g$ an
$S$-morphism from $T$ to $X$ ($T$ being considered as an $S$-prescheme with
structure morphism $\vphi\circ\vphi'\circ\psi$). As $T$ is also a $S'$-prescheme
with structure morphism $\vphi'\circ\psi$, we can write $g=p\circ g'$, where
$g'$ is an $S'$-morphism $T\to X_{(\vphi)}$, and then $g'=p'\circ g''$, where
$g''$ is an $S''$-morphism $T\to(X_{(\vphi)})_{(\vphi')}$:
\[
  \xymatrix{
    X\ar[d]_\pi &
    X_{(\vphi)}\ar[l]_p\ar[d]_{\pi'} &
    (X_{(\vphi)})_{(\vphi')}\ar[l]_{p'}\ar[d]^{\pi''}\\
    S &
    S\ar[l]_\vphi &
    S''\ar[l]_{\vphi'}.
  }
\]
\oldpage{110}
Hence the result follows by the uniqueness of the solution to a universal
mapping problem.
\end{proof}

This result can be written as the equality (up to a canonical isomorphism)
$(X_{(S')})_{(S'')}=X_{(S'')}$, if there is no chance of confusion, or also
\[
  (X\times_S S')\times_{S'}S''=X\times_S S'';
  \tag{3.3.9.1}
\]
the functorial nature of the isomorphism defined in \hyperref[prop-1.3.3.9]{(3.3.9)} can
similarly be expressed by the transitivity formula for base change morphisms
\[
  (f_{(S')})_{(S'')}=f_{(S'')}
  \tag{3.3.9.2}
\]
for each $S$-morphism $f:X\to Y$.

\begin{cor}[3.3.10]
\label{cor-1.3.3.10}
If $X$ and $Y$ are two $S$-preschemes, then there exists a canonical functorial
isomorphism from the $S'$-prescheme $X_{(S')}\times_{S'}Y_{(S')}$ to the
$S'$-prescheme $(X\times_S Y)_{(S')}$.
\end{cor}

\begin{proof}
\label{proof-cor-1.3.3.10}
We have, up to canonical isomorphism,
\[
  (X\times_S S')\times_{S'}(Y\times_S S')
  =X\times_S(Y\times_S S')=(X\times_S Y)\times_S S'
\]
according to (3.3.9.1) and the associativity of products of $S$-preschemes.
\end{proof}

The functorial nature of the isomorphism defined in
Corollary \hyperref[cor-1.3.3.10]{(3.3.10)} can be expressed by the formula
\[
  (u_{(S')},v_{(S')})_{S'}=((u,v)_S)_{(S')}
  \tag{3.3.10.1}
\]
for each pair of $S$-morphisms $u:T\to X$, $v:T\to Y$.

In other words, the base change functor $X_{(S')}$ {\it commutes with
products}; it also commutes with sums \hyperref[env-1.3.2.8]{(3.2.8)}.

\begin{cor}[3.3.11]
\label{cor-1.3.3.11}
Let $Y$ be an $S$-prescheme, $f:X\to Y$ a morphism which makes $X$ a
$Y$-prescheme (and as a result also an $S$-prescheme). The prescheme $X_{(S')}$
then identifies with the product $X\times_Y Y_{(S')}$, the projection
$X\times_Y Y_{(S')}\to Y_{(S')}$ identifying with $f_{(S')}$.
\end{cor}

\begin{proof}
\label{proof-cor-1.3.3.11}
Let $\psi:Y\to S$ be the structure morphism of $Y$; we have the commutative
diagram
\[
  \xymatrix{
    S'\ar[d] &
    Y_{(S')}\ar[l]\ar[d] &
    X_{(S')}\ar[l]_{f_{(S')}}\ar[d]\\
    S &
    Y\ar[l]_\psi &
    X\ar[l]_f.
  }
\]
We have that $Y_{(S')}$ identifies with $S_{(\psi)}'$ and $X_{(S')}$ with
$S_{(\psi\circ f)}'$; taking into account \hyperref[prop-1.3.3.9]{(3.3.9)} and
\hyperref[cor-1.3.3.4]{(3.3.4)}, we deduce the corollary.
\end{proof}

\begin{env}[3.3.12]
\label{env-1.3.3.12}
Let $f:X\to X'$, $g:Y\to Y'$ be two $S$-morphisms which are {\it monomorphisms}
of preschemes (T, I, 1.1); then $f\times_S g$ is a {\it monomorphism}. Indeed,
if $p$ and $q$ are the projections of $X\times_S Y$, $p'$, $q'$ those of
$X'\times_S Y'$, and $u$, $v$ two $S$-morphisms $T\to X\times_S Y$, then the
relation $(f\times_S g)\circ u=(f\times_S g)\circ v$ implies that
$p'\circ(f\times_S g)\circ u=p'\circ(f\times_S g)\circ v$, in other words,
$f\circ p\circ u=f\circ p\circ v$, and as $f$ is a monomorphism,
$p\circ u=p\circ v$; using the fact that $g$ is a monomorphism, we similarly
obtain $q\circ u=q\circ v$, hence $u=v$.

\oldpage{111}
It follows that for each base change $S'\to S$,
\[
  f_{(S')}:X_{(S')}\longrightarrow Y_{(S')}
\]
is a monomorphism.
\end{env}

\begin{env}[3.3.13]
\label{env-1.3.3.13}
Let $S$, $S'$ be two affine schemes of rings $A$, $A'$ respectively; a morphism
$S'\to S$ then corresponds to a ring homomorphism $A\to A'$. If $X$ is an
$S$-prescheme, we denote by $X_{(A')}$ or $X\otimes_A A'$ the $S'$-prescheme
$X_{(S')}$; when $X$ is also affine of ring $B$, $X_{(A')}$ is affine of ring
$B_{(A')}=B\otimes_A A'$ obtained by extension by scalars from the $A$-algebra
$B$ to $A'$.
\end{env}

\begin{env}[3.3.14]
\label{env-1.3.3.14}
With the notation of \hyperref[env-1.3.3.6]{(3.3.6)}, for each {\it $S$-morphism}
$f:S'\to X$, $f'=(f,1_{S'})_S$ is an $S'$-morphism $S'\to X'=X_{(S')}$ such that
$p\circ f'=f$, $\pi'\circ f'=1_{S'}$, in other words an {\it $S'$-section of
of $X'$}; conversely, if $f'$ is such an $S'$-section, $f=p\circ f'$ is an
$S$-morphism $S'\to X$. We thus define a canonical
{\it bijective correspondence}
\[
  \Hom_S(S',X)\isoto\Hom_{S'}(S',X').
\]
We say that $f'$ is the {\it graph morphism} of $f$, and we denote it by
$\Gamma_f$.
\end{env}

\begin{env}[3.3.15]
\label{env-1.3.3.15}
Given a prescheme $X$, which we can always consider it as a $\bb{Z}$-prescheme,
it follows in particular from \hyperref[env-1.3.3.14]{(3.3.14)} that the {\it $X$-sections} of
$X\otimes_\bb{Z}\bb{Z}[T]$ (where $T$ is an indeterminate) bijectively
correspond to {\it morphisms} $\bb{Z}[T]\to X$. Let us show that these
$X$-sections also bijectively correspond to {\it sections of the structure
sheaf $\OO_X$ over $X$}. Indeed, let $(U_\alpha)$ be a cover of $X$ by the
affine opens; let $u:X\to X\otimes_\bb{Z}\bb{Z}[T]$ be an $X$-morphism and let
$u_\alpha$ be its restriction to $U_\alpha$; if $A_\alpha$ is the ring of the
affine scheme $U_\alpha$, then $U_\alpha\otimes_\bb{Z}\bb{Z}[T]$ is an affine
scheme of ring $A_\alpha[T]$ \hyperref[prop-1.3.2.2]{(3.2.2)}, and $u_\alpha$ canonically
corresponds to an $A_\alpha$-homomorphism $A_\alpha[T]\to A_\alpha$
\hyperref[thm-1.1.7.3]{(1.7.3)}. Now, as such a homomorphism is completely determined by the
data of the image of $T$ in $A_\alpha$, let
$s_\alpha\in A_\alpha=\Gamma(U_\alpha,\OO_X)$, and if we suppose that the
restrictions of $u_\alpha$ and $u_\beta$ to an open affine
$V\subset U_\alpha\cap U_\beta$ coincide, then we see immediately that
$s_\alpha$ and $s_\beta$ coincide on $V$; thus the family $(s_\alpha)$ consists
of the restrictions to $U_\alpha$ of a section $s$ of $\OO_X$ over $X$;
convsersely, it is clear that such a section defines a family $(u_\alpha)$ of
morphisms which are the restrictions to $U_\alpha$ of an $X$-morphism
$X\to X\otimes_\bb{Z}\bb{Z}[T]$. This result is generalized in
(\textbf{II},~1.7.12).
\end{env}

\subsection{Points of a prescheme with values in a prescheme; geometric points}
\label{subsection-prescheme-geometric-points}

\begin{env}[3.4.1]
\label{env-1.3.4.1}
Let $X$ be a prescheme; for each prescheme $T$, we then denote by $X(T)$ the set
$\Hom(T,X)$ of morphism $T\to X$, and the elements of this set are called
{\it the points of $X$ with values in $T$}. If we associate to each morphism
$f:T\to T'$ the map $u'\mapsto u'\circ f$ from $X(T')$ to $X(T)$, we see that,
for $X$ fixed, $X(T)$ is a {\it contravariant functor in $T$}, from the
category of preschemes to that of sets. In addition, each morphism of preschemes
$g:X\to Y$ defines a functorial homomorphism $X(T)\to Y(T)$, which sends
$v\in X(T)$ to $g\circ v$.
\end{env}

\begin{env}[3.4.2]
\label{env-1.3.4.2}
Given three sets $P$, $Q$, $R$ and two maps $\vphi:P\to R$, $\psi:Q\to R$, we define the
{\it fibre product of $P$ and $Q$ over $R$} (relative to $\vphi$ and $\psi$) as the subset
of
\oldpage{112}
the product set $P\times Q$ consisting of the pairs $(p,q)$ such that $\vphi(p)=\psi(q)$; we
denote it by $P\times_R Q$. Definition \hyperref[defn-1.3.2.1]{(3.2.1)} of the product
of $S$-preschemes can be interpreted, with the notation of \hyperref[env-1.3.4.1]{(3.4.1)},
via the formula
\[
  (X\times_S Y)(T)=X(T)\times_{S(T)}Y(T).
  \tag{3.4.2.1}
\]
the maps $X(T)\to S(T)$ and $Y(T)\to S(T)$ corresponding to the structure morphisms
$X\to S$ and $Y\to S$.
\end{env}

\begin{env}[3.4.3]
\label{env-1.3.4.3}
If we are given a prescheme $S$ and we consider only the $S$-preschemes and $S$-morphisms,
then we will denote by $X(T)_S$ the set $\Hom_S(T,X)$ of $S$-morphisms $T\to X$, and suppress
the subscript $S$ when there is no chance of confusion; we say that the elements of $X(T)_S$
are the {\it points} (or {\it $S$-points} when there is a possibility of confusion)
{\it of the $S$-prescheme $X$ with values in the $S$-prescheme $T$}. In particular, an
{\it $S$-section} of $X$ is none other than a {\it point of $X$ with values in $S$}. The
formuka (3.4.2.1) can then be written as
\[
  (X\times_S Y)(T)_S=X(T)_S\times Y(T)_S;
  \tag{3.4.3.1}
\]
more generally, if $Z$ is an $S$-prescheme, and $X$, $Y$, $T$ are $Z$-preschemes (thus
{\it ipso facto} $S$-preschemes), then we have
\[
  (X\times_Z Y)(T)_S=X(T)_S\times_{Z(T)_S}Y(T)_S.
  \tag{3.4.3.2}
\]

We note that to show that a triple $(W,r,s)$ consisting of an $S$-prescheme $W$ and two
$S$-morphisms $r:W\to X$, $s:W\to Y$ is a product of $X$ and $Y$ (over $Z$), it suffies by
definition to check that for {\it each $S$-prescheme $T$}, the diagram
\[
  \xymatrix{
    W(T)_S\ar[r]^{r'}\ar[d]_{s'} &
    X(T)_S\ar[d]^{\vphi'}\\
    Y(T)_S\ar[r]^{\psi'} &
    Z(T)_S
  }
\]
makes $W(T)_S$ the fibre product of $X(T)_S$ and $Y(T)_S$ over $Z(T)_S$, where $r'$ and $s'$
correspond to $r$ and $s$, $\vphi'$ and $\psi'$ to the structure morphisms $\vphi:X\to Z$,
$\psi:Y\to Z$.
\end{env}

\begin{env}[3.4.4]
\label{env-1.3.4.4}
When $T$ (resp. $S$) in the above is an affine scheme of ring $B$ (resp. $A$), we replace
$T$ (resp. $S$) by $B$ (resp. $A$) in the above notations, and we then call the elements of
$X(B)$ the {\it points of $X$ with values in the ring $B$}, and the elements of $X(B)_A$ the
{\it points of the $A$-prescheme $X$ with values in the $A$-algebra $B$}. We note that
$X(B)$ and $X(B)_A$ are {\it covariant} functors in $B$. We similarly write $X(T)_A$ for the
set of points of the $A$-prescheme $X$ with values in the $A$-prescheme $T$.
\end{env}

\begin{env}[3.4.5]
\label{env-1.3.4.5}
Consider in particular that case where $T$ is of the form $\Spec(A)$, where $A$ is a
{\it local} ring; the elements of $X(A)$ then bijectively correspond to {\it local}
homomorphisms $\OO_x\to A$ for $x\in X$ \hyperref[prop-1.2.2.4]{(2.2.4)}; we say that the
point $x$ of the underlying space of $X$ is the {\it location}\footnote{[Trans] We say that
the geometric point lies over this $x$.} of the point of $X$ with values in $A$ to which it
corresponds.

More particularly, we call the {\it geometric points} of a prescheme $S$ the {\it points of
$X$ with values in a field $K$}: the data of such a point is equivalent to the data of its
\oldpage{113}
location $x$ in the underlying subspace of $X$, and of an {\it extension} $K$ of $\kres(x)$;
$K$ will be called the {\it field of values} of the corresponding geometric point, and we
say that this geometric point is {\it located at $x$}. We also define a map $X(K)\to X$,
sending a geometric point with values in $K$ to its location.

If $S'=\Spec(K)$ is an $S$-prescheme (in other words, if $K$ is considered as an extension
of the residue field $\kres(s)$, where $s\in S$) and if $X$ is an $S$-prescheme, then an
element of $X(K)_S$, or as we say, a {\it geometric point of $X$ lying over $s$ with values
in $K$}, consists of the data of a $\kres(s)$-monomorphism from the residue field $\kres(x)$
to $K$, where $x$ is a point of $X$ {\it lying over $s$} (therefore $\kres(x)$ is an
extension of $\kres(s)$).

In particular, if $S=\Spec(K)=\{\xi\}$, {\it then the geometric points of $X$ with values in
$K$ identify with the points $x\in X$ such that $\kres(x)=K$}; we say that these latter
points are the {\it $K$-rational points of the $K$-prescheme $X$}; if $K'$ is an extension
of $K$, then the geometric points of $X$ with values in $K'$ bijectively correspond to the
$K'$-rational points of $X'=X_{(K')}$ \hyperref[env-1.3.3.14]{(3.3.14)}.
\end{env}

\begin{lem}[3.4.6]
\label{lem-1.3.4.6}
Let $X_i$ ($1\leqslant i\leqslant n$) be $S$-preschemes, $s$ a point of $S$, $x_i$
($1\leqslant i\leqslant n$) a point of $X_i$ lying over $s$. Then there exists an extension
$K$ of $\kres(s)$ and a geometric point of the product
$Y=X_1\times_S X_2\times_S\cdots\times_S X_n$, with values in $K$, whose projections to
the $X_i$ are localised at the $x_i$.
\end{lem}

\begin{proof}
\label{proof-lem-1.3.4.6}
In fact, there exist $\kres(s)$-monomorphisms $\kres(x_i)\to K$, all in the same extension $K$ of $\kres(s)$ (Bourbaki, \emph{Alg.}, chap.~V, 4, prop.~2).
The compositions $\kres(s)\to\kres(x_i)\to K$ are all \unsure{identical/the identity}, and so the morphisms $\Spec(K)\to X_i$ corresponding to the $\kres(x_i)\to K$ are $S$-morphisms, and we thus conclude that they define a unique morphism $\Spec(K)\to Y$.
If $y$ is the corresponding point of $Y$, it is clear that its projection in each of the $X_i$ is $x_i$.
\end{proof}

\begin{prop}[3.4.7]
\label{prop-1.3.4.7}
Let $X_i$ ($1\leqslant i\leqslant n$) be $S$-preschemes, and for each index $i$ let $x_i$ be a point of $X_i$.
In order for there to exist a point $y$ of $Y=X_1\times_S X_2\times\ldots\times_S X_n$ whose image is $x_i$ under the $i$th projection for each $1\leqslant i\leqslant n$, it is necessary and sufficient that the $x_i$ all be above the same point $s$ of $S$.
\end{prop}

\begin{proof}
\label{proof-prop-1.3.4.7}
The condition is evidently necessary; lemma \hyperref[lem-1.3.4.6]{(3.4.6)} proves that it is sufficient.
\end{proof}

In other words, if we denote by $(X)$ the underlying set of $X$, we see that we have a canonical \emph{surjective} function $(X\times_S Y)\to(X)\times_{(S)}(Y)$; we must point out that this function \emph{is not injective} in general; said otherwise, \emph{there can exist multiple distinct points $z$ in $X\times_S Y$ having the same projections $x\in X$, $y\in Y$}; we have already seen this when $S$, $X$, and $Y$ are prime spectrums of fields $k$, $K$, and $K'$, since the tensor product $K\otimes_k K'$ has, in general, multiple distinct prime ideals \hyperref[prop-1.3.4.9]{cf. (3.4.9)}.

\begin{cor}[3.4.8]
\label{cor-1.3.4.8}
Let $f\colon X\to Y$ be an $S$-morphism, $f_{(S')}\colon X_{(S')}\to Y_{(S')}$ the $S'$-morphism inferred from $f$ by an extension $S'\to S$ of the base prescheme.
Let $p$ (\emph{resp. $q$}) be the projection $X_{(S')}\to X$ (\emph{resp. $Y_{(S')}\to Y$}); for every subset $M$ of $X$, we have
\begin{equation*}
    q^{-1}(f(M)) = f_{(S')}(p^{-1}(M)).
\end{equation*}
\end{cor}

\begin{proof}
\label{proof-cor-1.3.4.8}
In\oldpage{114} fact \hyperref[cor-1.3.3.11]{(3.3.11)}, $X_{(S')}$ is identified with the product $X\times_Y Y_{(S')}$ thanks to the commutative diagram
\begin{equation*}
    \begin{tikzcd}
        X \ar[d, swap, "f"]
        & X_{(S')} \ar[l, swap, "p"] \ar[d, "f_{(S')}"]\\
        Y
        & Y_{(S')} \ar[l, "q"]
    \end{tikzcd}
\end{equation*}
By \hyperref[prop-1.3.4.7]{(3.4.7)}, the relation $q(y')=p(x)$ for $x\in M$ and $y'\in Y_{(S)}$ is equivalent to the existence of some $x'\in X_{(S')}$ such that $p(x')=x$ and $f_{(S')}(x')=y'$, whence the corollary.
\end{proof}

Lemma~\hyperref[lem-1.3.4.6]{(3.4.6)} can be made clearer in the following manner:
\begin{prop}[3.4.9]
\label{prop-1.3.4.9}
Let $X$ and $Y$ be two $S$-preschemes, and $x$ a point of $X$ and $y$ a point of $Y$ both above the same point $s\in S$.
The set of points of $X\times_S Y$ with projections $x$ and $y$ is in bijective correspondence with the set of \unsure{types of extensions composed of $\kres(x)$ and $\kres(y)$ considered as extensions of $\kres(s)$} (Bourbaki, \emph{Alg.}, chap.~VIII, 8, prop.~2).
\end{prop}

\begin{proof}
\label{proof-prop-1.3.4.9}
Let $p$ (\emph{resp. $q$}) be the projection of $X\times_S Y$ into $X$ (\emph{resp. $Y$}), and $E$ the subspace $p^{-1}(x)\cap q^{-1}(y)$ of the underlying space of $X\times_S Y$.
First note that the morphisms $\Spec(\kres(x))\to S$ and $\Spec(\kres(y))\to S$ factorise as $\Spec(\kres(x))\to\Spec(\kres(s))\to S$ and $\Spec(\kres(y))\to\Spec(\kres(s))\to S$y since $\Spec(\kres(s))\to S$ is a monomorphism \hyperref[cor-1.2.4.7]{(2.4.7)}, it follows from \hyperref[prop-1.3.2.4]{(3.2.4)} that we have
\begin{equation*}
    P = \Spec(\kres(x))\times_S\Spec(\kres(y)) = \Spec(\kres(x))\times_{\Spec(\kres(s))}\Spec(\kres(y)) = \Spec(\kres(x)\otimes_{\kres(s)}\kres(y)).
\end{equation*}
We will define two maps, $\alpha\colon P_0\to E$ and $\beta\colon E\to P_0$, inverse to one another (where $P_0$ denotes the underlying set of the prescheme $P$).
If $i\colon\Spec(\kres(x))\to X$ and $j\colon\Spec(\kres(y))\to Y$ are the canonical morphisms \hyperref[env-1.2.4.5]{(2.4.5)}, we take for $\alpha$ the map of underlying spaces corresponding to the morphism $i\times_S j$.
On the other hand, every $z\in E$ defines by hypothesis two $\kres(s)$-monomorphisms, $\kres(x)\to\kres(z)$ and $\kres(y)\to\kres(z)$, and so a $\kres(s)$-monomorphism $\kres(x)\otimes_{\kres(s)}\kres(y)\to\kres(z)$ and so a morphism $\Spec(\kres(z))\to P$; $\beta(z)$ will be the image of $z$ in $P_0$ under this morphism.
The verification of the fact that $\alpha\circ\beta$ and $\beta\circ\alpha$ are the identity maps follows from \hyperref[env-1.2.4.5]{(2.4.5)} and the definition of the product \hyperref[defn-1.3.2.1]{(3.2.1)}.
Finally, we know that $P_0$ is in bijective correspondence with the set of \unsure{types of extensions composed of $\kres(x)$ and $\kres(y)$} (Bourbaki, \emph{Alg.}, chap.~VIII, 8, prop.~1).
\end{proof}

\subsection{Surjections and injections}
\label{subsection-surjections-and-injections}

\begin{env}[3.5.1]
\label{env-1.3.5.1}
In a general sense, consider a property $P$ of morphisms of preschemes, and the two following propositions:
\begin{enumerate}[(i)]
    \item If $f\colon X\to X'$ and $g\colon Y\to Y'$ are two $S$-morphism having property $P$, then $f\times_S g$ also has property $P$.
    \item If $f\colon X\to Y$ is an $S$-morphisms having property $P$, then every $S'$-morphism $f_{(S')}\colon X_{(S')}\to Y_{(S')}$, inferred from $f$ by an extension of base preschemes, also has property $P$.
\end{enumerate}

Since $f_{(S')}=f\times_S 1_{S'}$, we see that if, for every prescheme $X$, the \emph{identity} $1_X$ has property $P$, then (i) implies (ii); since, on the other hand, $f\times_S g$ is the composed morphism
\begin{equation*}
    X\times_S Y \xrightarrow{f\times1_Y} X'\times_S Y \xrightarrow{1_{X'}\times g} X'\times_S Y'
\end{equation*}
we see that if the \emph{composition} of two morphisms has property $P$, then so too does the product $f\times_S g$, and so (ii) implies (i).
\end{env}

A first application of this remark is
\begin{prop}[3.5.2]
\label{prop-1.3.5.2}
\begin{enumerate}[(i)]
    \item If $f\colon X\to X'$ and $g\colon Y\to Y'$ are two surjective $S$-morphisms, then $f\times_S g$ is surjective.
    \item If $f\colon X\to Y$ is a surjective $S$-morphism, then $f_{(S')}$ is surjective for every extension $S'$ of the base prescheme.
\end{enumerate}
\end{prop}

\begin{proof}
\label{proof-prop-1.3.5.2}
The composition of two surjections being a surjection, it suffices to prove (ii); but this proposition follows rapidly from \hyperref[cor-1.3.4.8]{(3.4.8)} applied to $M=X$.
\end{proof}

\begin{prop}[3.5.3]
\label{prop-1.3.5.3}
For a morphism $f\colon X\to Y$ to be surjective, it is necessary and sufficient that, for every field $K$ and every morphism $\Spec(K)\to Y$, there exist an extension $K'$ of $K$ and a morphism $\Spec(K')\to X$ making the following diagram commute:
\begin{equation*}
    \begin{tikzcd}
        X \ar[d, swap, "f"]
        & \Spec(K') \ar[l] \ar[d]\\
        Y
        & \Spec(K) \ar[l]
    \end{tikzcd}
\end{equation*}
\end{prop}

\begin{proof}
\label{proof-prof-1.3.5.3}
The condition is sufficient because, for all $y\in Y$, it suffices to apply it to a morphism $\Spec(K)\to Y$ corresponding to a monomorphism $\kres(y)\to K$, $K$ being an extension of $\kres(y)$ \hyperref[cor-1.2.4.6]{(2.4.6)}.
Conversely, suppose that $f$ is surjective, and let $y\in Y$ be the image of the unique point of $\Spec(K)$; there exists some $x\in X$ such that $f(x)=y$; we will consider the corresponding monomorphism $\kres(y)\to\kres(x)$ \hyperref[defn-1.2.2.1]{(2.2.1)}; it then suffices to take $K'$ to be the extension of $\kres(y)$ such that there exist $\kres(y)$-monomorphisms from $\kres(x)$ and $K$ to $K'$ (Bourbaki, \emph{Alg.}, chap.~V, 4, prop.~2); the morphism $\Spec(K')\to X$ corresponding to $\kres(x)\to K'$ is exactly that for which we search.
\end{proof}

With the language introduced in \hyperref[env-1.3.4.5]{(3.4.5)}, we can say that \emph{every geometric point of $Y$ with values in $K$ comes from a geometric point of $X$ with values in an extension of $K$}.

\begin{defn}[3.5.4]
\label{defn-1.3.5.4}
We say that a morphism $f\colon X\to Y$ of preschemes is universally injective, or a \unsure{radical} morphism, if, for every field $K$, the corresponding map $X(K)\to Y(K)$ is injective.
\end{defn}

It follows also from the definitions that every \emph{monomorphism of preschemes} (T,~1.1) is \unsure{radical}.

\begin{env}[3.5.5]
\label{env-1.3.5.5}
For a morphism $f\colon X\to Y$ to be \unsure{radical}, it suffices that the condition of def.~\hyperref[defn-1.3.5.4]{(3.5.4)} hold for every \emph{algebraically closed} field.
In fact, if $K$ is an arbitrary field, and $K'$ an algebraically-closed extension of $K$, then the diagram
\begin{equation*}
    \begin{tikzcd}
        X(K) \ar[r, "\alpha"] \ar[d, swap, "\vphi"]
        & Y(K) \ar[d, "\vphi'"]\\
        X(K') \ar[r, swap, "\alpha'"]
        & Y(K')
    \end{tikzcd}
\end{equation*}
commutes, where $\vphi$ and $\vphi'$ come from the morphism $\Spec(K')\to\Spec(K)$, and $\alpha$ and $\alpha'$ corresponding to $f$.
However, $\vphi$ is injective, and so too is $\alpha'$ by hypothesis; so $\alpha$ is necessarily injective.
\end{env}

\begin{prop}[3.5.6]
\label{prop-1.3.5.6}
Let $f\colon X\to Y$ and $g\colon Y\to Z$ be two morphisms of preschemes.
\begin{enumerate}
    \item If $f$ and $g$ are \unsure{radical}, then so too is $g\circ f$.
    \item Conversely, if $g\circ f$ is \unsure{radical}, then so too is $f$.
\end{enumerate}
\end{prop}

\begin{proof}
\label{proof-prop-1.3.5.6}
Taking into account def.~\hyperref[defn-1.3.5.4]{(3.5.4)}, the proposition reduces to the corresponding assertions for the maps $X(K)\to Y(K)\to Z(K)$, which are evident.
\end{proof}

\begin{prop}[3.5.7]
\label{prop-1.3.5.7}
\begin{enumerate}[(i)]
    \item If the $S$-morphisms $f\colon X\to X'$ and $g\colon X\to X'$ are \unsure{radical}, then so too is $f\times_S g$.
    \item If the $S$-morphism $f\colon X\to Y$ is \unsure{radical}, then so too is $f_{(S')}\colon X_{(S')}\to Y_{(S')}$ for every extension $S'\to S$ of the base prescheme.
\end{enumerate}
\end{prop}

\begin{proof}
\label{proof-prop-1.3.5.7}
Given \hyperref[env-1.3.5.1]{(3.5.1)}, it suffices to prove (i).
We have seen \hyperref[env-1.3.4.2]{(3.4.2.1)} that
\begin{gather*}
    (X\times_S Y)(K) = X(K)\times_{S(K)}Y(K)\\
    (X'\times_S Y')(K) = X'(K)\times_{S(K)}Y'(K)
\end{gather*}
with the map $(X\times_S Y)(K)\to(X'\times_S Y')(K)$ corresponding to $f\times_S g$ thus being identified with $(u,v)\to(f\circ u,g\circ v)$, and the proposition then follows.
\end{proof}

\begin{prop}[3.5.8]
\label{prop-1.3.5.8}
For a morphism $f=(\psi,\theta)\colon X\to Y$ to be \unsure{radical}, it is necessary and sufficient that $\psi$ be injective and that, for every $x\in X$, the monomorphism $\theta^x\colon\kres(\psi(x))\to\kres(x)$ makes $\kres(x)$ a \unsure{radical} extension of $\kres(\psi(x))$.
\end{prop}

\begin{proof}
\label{proof-prop-1.3.5.8}
We suppose that $f$ is \unsure{radical} and first show that the relation $\psi(x_1)=\psi(x_2)=y$ leads necessarily to $x_1=x_2$.
In fact, there exists a field $K$, an extension of $\kres(y)$, and $\kres(y)$-monomorphisms $\kres(x_1)\to K$ and $\kres(x_2)\to K$ (Bourbaki, \emph{Alg.}, chap.~V, 4, prop.~2); the corresponding morphisms $u_1\colon\Spec(K)\to X$ and $u_2\colon\Spec(K)\to X$ are then such that $f\circ u_1=f\circ u_2$, and so $u_1=u_2$ by hypothesis, and this implies, in particular, that $x_1=x_2$.
We now consider $\kres(x)$ as the extension of $\kres(\psi(x))$ by means of $\theta^x$: if $\kres(x)$ is not a \unsure{radical} algebraically-closed extension, then there exist two distinct $\kres(\psi(x))$-monomorphisms from $\kres(x)$ to an algebraically-closed extension $K$ of $\kres(\psi(x))$ and the two corresponding morphisms $\Spec(K)\to X$ would contradict the hypothesis.
Conversely, taking \hyperref[cor-1.2.4.6]{(2.4.6)} into account, it is immediate that the conditions stated are sufficient for $f$ to be \unsure{radical}.
\end{proof}

\begin{cor}[3.5.9]
\label{cor-1.3.5.9}
If $A$ is a ring, and $S$ a multiplicative set of $A$, then the canonical morphism $\Spec(S^{-1}A)\to\Spec(A)$ is \unsure{radical}.
\end{cor}

\begin{proof}
\label{proof-cor-1.3.5.9}
In fact, this morphism is a monomorphism \hyperref[exm-1.1.6.2]{(1.6.2)}.
\end{proof}

\begin{cor}[3.5.10]
\label{cor-1.3.5.10}
Let $f\colon X\to Y$ be a \unsure{radical} morphism, $g\colon Y'\to Y$ a morphism, and $X'=X_{(Y')}=X\times_Y Y'$.
Then the \unsure{radical} morphism $f_{(Y')}$ \hyperref[prop-1.3.5.7]{(3.5.7~(ii))} is a bijection from the underlying space of $X$ to $g^{-1}(f(X))$; further, for every field $K$, the set $X'(K)$ can be identified with the subset of $Y'(K)$ given by the inverse image of the map $Y'(K)\to Y(K)$ (corresponding to $g$) from the subset $X(K)$ of $Y(K)$.
\end{cor}

\begin{proof}
\label{proof-cor-1.3.5.10}
The first claim follows from \hyperref[prop-1.3.5.8]{(3.5.8)} and \hyperref[cor-1.3.4.8]{(3.4.8)}; the second, from the commutativity of the following diagram:\oldpage{117}
\begin{equation*}
    \begin{tikzcd}
        X'(K) \ar[r] \ar[d]
        & Y'(K) \ar[d]\\
        X(K) \ar[r]
        & Y(K)
    \end{tikzcd}
\end{equation*}
\end{proof}

\begin{rmk}[3.5.11]
\label{rmk-1.3.5.11}
We say that a morphism $f=(\psi,\theta)$ of preschemes is \emph{injective} if the map $\psi$ is injective.
For a morphism $f=(\psi,\theta)\colon X\to Y$ to be \unsure{radical}, it is necessary and sufficient that, for every morphism $Y'\to Y$, the morphism $f_{(Y')}\colon X_{(Y')}\to Y'$ be injective (which justifies the terminology of a \emph{universally injective} morphism).
In fact, the condition is necessary by \hyperref[prop-1.3.5.7]{(3.5.7),~(ii)} and \hyperref[prop-1.3.5.8]{(3.5.8)}.
Conversely, the condition implies that $\psi$ is injective; if for some $x\in X$ the monomorphism $\theta^x\colon\kres(\psi(x))\to\kres(x)$ were not \unsure{radical}, then there would be an extension $K$ of $\kres(\psi(x))$ and two distinct morphisms $\Spec(K)\to X$ corresponding to the same morphism $\Spec(K)\to Y$ \hyperref[prop-1.3.5.8]{(3.5.8)}.
But then, setting $Y'=\Spec(K)$, there would be two distinct $Y'$-sections of $X_{(Y')}$ \hyperref[env-1.3.3.14]{(3.3.14)}, which contradicts the hypothesis that $f_{(Y')}$ is injective.
\end{rmk}

\subsection{Fibres}
\label{subsection-fibres}

\begin{prop}[3.6.1]
\label{prop-1.3.6.1}
Let $f\colon X\to Y$ be a morphism, $y$ a point of $Y$, and $\mathfrak{a}_y$ a \unsure{defining ideal} of $\OO_y$ for the $\mathfrak{m}_y$-preadic topology.
The projection $p\colon X\times_Y\Spec(\OO_y/\mathfrak{a}_y)\to X$ is a homeomorphism from the underlying space of the prescheme $X\times_Y\Spec(\OO_y/\mathfrak{a}_y)$ to the fibre $f^{-1}(y)$ equipped with the topology induced from that of the underlying space of $X$.
\end{prop}

\begin{proof}
\label{proof-prop-1.3.6.1}
Since $\Spec(\OO_y/\mathfrak{a}_y)\to Y$ is \unsure{radical} (\hyperref[defn-1.3.5.4]{3.5.4} and \hyperref[cor-1.2.4.7]{2.4.7}), $\Spec(\OO_y/\mathfrak{a}_y)$ is \unsure{reduced at a single point}, and the ideal $\mathfrak{m}_y/\mathfrak{a}_y$ is nilpotent by hypothesis \hyperref[cor-1.1.1.12]{(1.1.12)}, we already know (\hyperref[cor-1.3.5.10]{3.5.10} and \hyperref[cor-1.3.3.4]{3.3.4}) that $p$ identifies, as \emph{sets}, the underlying space of $X\times_Y\Spec(\OO_y/\mathfrak{a}_y)$ with $f^{-1}(y)$; everything boils down to proving that $p$ is a homeomorphism.
By \hyperref[cor-1.3.2.7]{(3.2.7)}, the question is local on $X$ and $Y$, and so we can suppose that $X=\Spec(B)$ and $Y=\Spec(A)$, with $B$ being an $A$-algebra.
The morphism $p$ then corresponds to the homomorphism $1\otimes\vphi\colon B\to B\otimes_A A'$, where $A'=A_y/\mathfrak{a}_y$ and $\vphi$ is the canonical map from $A$ to $A'$.
Then every element of $B\otimes_A A'$ can be written as
\begin{equation*}
    \sum_i b_i\otimes\vphi(a_i)/\vphi(s) = \left(\sum_i(a_ib_i\otimes1)\right)(1\otimes\vphi(s))^{-1},
\end{equation*}
where $s\not\in\mathfrak{j}_y$, and prop.~\hyperref[cor-1.1.2.4]{(1.2.4)} applies.
\end{proof}

\begin{env}[3.6.2]
\label{env-1.3.6.2}
Throughout the rest of this treatise, whenever we consider a fibre $f^{-1}(y)$ of a morphism as having the structure of a $\kres(y)$-prescheme, \emph{it will always be the prescheme obtained by transporting the structure of $X\times_Y\Spec(\kres(y))$ by the projection to $X$}.
We will also write this (latter) product as $X\times_Y\kres(y)$, or $X\otimes_{\OO_Y}\kres(y)$; more generally, if $B$ is an $\OO_y$-algebra, we will denote by $X\times_Y B$ or $X\otimes_{\OO_Y}B$ the product $X\times_Y\Spec(B)$.
\end{env}

With the preceding convention, it follows from \hyperref[cor-1.3.5.10]{(3.5.10)} that the points of $X$ with values in an extension $K$ of $\kres(y)$ are identified with the \emph{points of $f^{-1}(y)$ with values in $K$}.

\begin{env}[3.6.3]
\label{env-1.3.6.3}
Let $f\colon X\to Y$ and $g\colon Y\to Z$ be two morphisms, and $h=g\circ f$ their composition; for all $z\in Z$, the fibre $h^{-1}(z)$ is a prescheme isomorphic to
\begin{equation*}
    X\times_Z\Spec(\kres(z)) = (X\times_Y Y)\times_Z\Spec(\kres(z)) = X\times_Y g^{-1}(z).
\end{equation*}
In\oldpage{118} particular, if $U$ is an open subset of $X$, then the prescheme induced on $U\cap f^{-1}(y)$ by the prescheme $f^{-1}(y)$ is isomorphic to $f^{-1}_U(y)$ ($f_U$ being the restriction of $f$ to $U$),
\end{env}

\begin{prop}[3.6.4]
\label{prop-1.3.6.4}
\emph{(Transitivity of fibres)}
Let $f\colon X\to Y$ and $g\colon Y'\to Y$ be two morphisms; let $X'=X\times_Y Y'=X_{(Y')}$ and $f'=f_{(Y')}\colon X'\to Y'$.
For every $y'\in Y'$, if we let $y=g(y')$, then the prescheme $f'^{-1}(y')$ is isomorphic to $f^{-1}(y)\otimes_{\kres(y)}\kres(y')$.
\end{prop}

\begin{proof}
\label{proof-prop-1.3.6.4}
Indeed, it reduces to remarking that the two preschemes $(X\otimes_Y\kres(y))\otimes_{\kres(y)}\kres(y')$ and $(X\times_Y Y')\otimes_{Y'}\kres(y')$ are both canonically isomorphic to $X\times_Y\Spec(\kres(y'))$ by (3.3.9.1).
\end{proof}

In particular, if $V$ is an open neighbourhood of $y$ in $Y$, and we denote by $f_V$ the restriction of $f$ to the induced prescheme on $f^{-1}(V)$, then the preschemes $f^{-1}(y)$ and $f^{-1}_V(y)$ are canonically identified.

\begin{prop}[3.6.5]
\label{prop-1.3.6.5}
Let $f\colon X\to Y$ be a morphism, $y$ a point of $Y$, $Z$ the local prescheme $\Spec(\OO_y)$, and $p=(\psi,\theta)$ the projection $X\times_Y Z\to X$; then $p$ is a homeomorphism from the underlying space of $X\times_Y Z$ to the subspace $f^{-1}(Z)$ of $X$ (\emph{when the underlying space of $Z$ is identified with a subspace of $Y$, cf.~\hyperref[prop-1.2.4.2]{(2.4.2)}}), and, for all $t\in X\times_Y Z$, letting $z=\psi(t)$, $\theta_t^\#$ is an isomorphism from $\OO_x$ to $\OO_t$.
\end{prop}

\begin{proof}
\label{proof-prop-1.3.6.5}
Since $Z$ (identified as a subspace of $Y$) is contained inside every open affine containing $y$ \hyperref[prop-1.2.4.2]{(2.4.2)}, we can, as in \hyperref[prop-1.3.6.1]{(3.6.1)}, reduce to the case where $X=\Spec(A)$ and $Y=\Spec(B)$ are affine schemes, with $A$ being a $B$-algebra.
Then $X\times_Y Z$ is the prime spectrum of $A\otimes_B B_y$, and this ring is canonically identified with $S^{-1}A$, where $S$ is the image of $B\setminus\mathfrak{j}_y$ in $A$ \hyperref[env-0.1.5.2]{(\textbf{0},~1.5.2)}; since $p$ then corresponds to the canonical homomorphism $A\to S^{-1}A$, the proposition follows from \hyperref[exm-1.1.6.2]{(1.6.2)}.
\end{proof}

\subsection{Application: reduction of a prescheme modulo $\mathfrak{J}$}

\emph{This section, which makes use of notions and results from chap.~I and chap.~II, will not be used in the following, and is only intended for readers familiar with classical algebraic geometry.}

\section{Subpreschemes and immersion morphisms}
\label{section-subpreschemes-and-immersion-morphisms}

\subsection{Subpreschemes}
\label{subsection-subpreschemes}

\begin{env}[4.1.1]
\label{env-1.4.1.1}
As the notion of a quasi-coherent sheaf \hyperref[env-0.5.1.3]{(\textbf{0},~5.1.3)} is local,
a quasi-coherent $\OO_X$-module $\sh{F}$ over a prescheme $X$ can be defined by the condition
that, for each affine open $V$ of $X$, $\sh{F}|V$ is isomorphic to the sheaf associated to a
$\Gamma(V,\OO_X)$-module \hyperref[thm-1.1.4.1]{(1.4.1)}. It is clear that over a prescheme
$X$, the structure sheaf $\OO_X$ is quasi-coherent and that the kernels, cokernels, and
images of homomorphisms of quasi-coherent $\OO_X$-modules, as well as inductive limits and
direct sums of quasi-coherent $\OO_X$-modules, are also quasi-coherent
(Theorem \hyperref[thm-1.1.3.7]{(1.3.7)} and Corollary \hyperref[cor-1.1.3.9]{(1.3.9)}).
\end{env}

\begin{prop}[4.1.2]
\label{prop-1.4.1.2}
Let $X$ be a prescheme, $\sh{J}$ a quasi-coherent sheaf of ideals of $\OO_X$. The support
$Y$ of the sheaf $\OO_X/\sh{J}$ is then closed, and if we denote by $\OO_Y$ the restriction
of $\OO_X/\sh{J}$ to $Y$, then $(Y,\OO_Y)$ is a prescheme.
\end{prop}

\begin{proof}
\label{proof-prop-1.4.1.2}
\oldpage{120}
It evidently suffices \hyperref[prop-1.2.1.3]{(2.1.3)} to consider the case where $X$ is an
affine scheme, and to show that in this case $Y$ is closed in $X$ and is an {\it affine
scheme}. Indeeed, if $X=\Spec(A)$, then we have $\OO_X=\widetilde{A}$ and
$\sh{J}=\widetilde{\mathfrak{J}}$, where $\mathfrak{J}$ is an ideal of $A$
\hyperref[thm-1.1.4.1]{(1.4.1)}; $Y$ is then equal to the closed subset $V(\mathfrak{J})$ of
$X$ and identifies with the prime spectrum of the ring $B=A/\mathfrak{J}$
\hyperref[prop-1.1.1.11]{(1.1.1.11)}; in addition, if $\vphi$ is the canonical
homomorphism $A\to B=A/\mathfrak{J}$, then the direct image ${}^a\vphi_*(\widetilde{B})$
canonically identifies with the sheaf $\widetilde{A}/\widetilde{\mathfrak{J}}=\OO_X/\sh{J}$
(Proposition \hyperref[prop-1.1.6.3]{(1.6.3)} and Corollary \hyperref[cor-1.1.3.9]{(1.3.9)}),
which finishes the proof.
\end{proof}

We say that $(Y,\OO_Y)$ is the {\it subprescheme} of $(X,\OO_X)$ {\it defined by the
sheaf of ideals $\sh{J}$}; this is a particular case of the more general notion of
{\it subprescheme}:

\begin{defn}[4.1.3]
\label{defn-1.4.1.3}
We say that a ringed space $(Y,\OO_Y)$ is a subprescheme of a prescheme $(X,\OO_X)$ if:
\begin{itemize}
  \item[1st] $Y$ is a localy closed subspace of $X$;
  \item[2nd] if $U$ denotes the largest open subset of $X$ containing $Y$ such that
             $Y$ is closed in $U$ ({\it equivalently}, the complement in $X$ of the
             boundary of $Y$ with respect to $\overline{Y}$), then $(Y,\OO_Y)$ is
             a subprescheme of $(U,\OO_X|U)$ defined by a quasi-coherent sheaf of ideals of
             $\OO_X|U$.
\end{itemize}
We say that the subprescheme $(Y,\OO_Y)$ of $(X,\OO_X)$ is closed if $Y$ is closed in $X$
(in which case $U=X$).
\end{defn}

It follows immediately from this definition and Proposition \hyperref[prop-1.4.1.2]{(4.1.2)}
that the closed subpreschemes of $X$ are in canonical {\it bijective correspondence} with the
quasi-coherent sheaf of ideals $\sh{J}$ of $\OO_X$, since if two such sheaves
$\sh{J}$, $\sh{J}'$ have the same (closed) support $Y$ and if the restrictions of
$\OO_X/\sh{J}$ and $\OO_X/\sh{J}'$ to $Y$ are \unsure{identical/the identity}, then we have $\sh{J}'=\sh{J}$.

\begin{env}[4.1.4]
\label{env-1.4.1.4}
Let $(Y,\OO_Y)$ be a subprescheme of $X$, $U$ the largest open subset of $X$ containing $Y$
and in which $Y$ is closed, $V$ an open subset of $X$ contained in $U$; then $V\cap Y$ is
closed in $V$. In addition, if $Y$ is defined by the quasi-coherent sheaf of ideals $\sh{J}$
of $\OO_X|U$, then $\sh{J}|V$ is a quasi-coherent sheaf of ideals of $\OO_X|V$, and it is
immediate that the prescheme induced by $Y$ on $Y\cap V$ is the closed subprescheme of $V$
defined by the sheaf of ideals $\sh{J}|V$. Conversely:
\end{env}

\begin{prop}[4.1.5]
\label{prop-1.4.1.5}
Let $(Y,\OO_Y)$ be a ringed space such that $Y$ is a subspace of $X$ and there exists a
cover $(V_\alpha)$ of $Y$ by open subsets of $X$ such that for each $\alpha$,
$Y\cap V_\alpha$ is closed in $V_\alpha$ and the ringed space
$(Y\cap V_\alpha,\OO_Y|(Y\cap V_\alpha))$ is a closed subprescheme of the prescheme induced
on $V_\alpha$ by $X$. Then $(Y,\OO_Y)$ is a subprescheme of $X$.
\end{prop}

\begin{proof}
\label{proof-prop-1.4.1.5}
The hypotheses imply that $Y$ is locally closed in $X$ and that the largest open $U$
containing $Y$ in which is closed contains all the $V_\alpha$; we can thus reduce to the case
where $U=X$ and $Y$ is closed in $X$. We then define a quasi-coherent sheaf of ideals
$\sh{J}$ of $\OO_X$ by taking $\sh{J}|V_\alpha$ to be the sheaf of ideals of $\OO_X|V_\alpha$
which define the closed subprescheme $(Y\cap V_\alpha,\OO_Y|(Y\cap V_\alpha))$, and for each
open subset $W$ of $X$ not intersecting $Y$, $\sh{J}|W=\OO_X|W$. We check immediately
according to Definition \hyperref[defn-1.4.1.3]{(4.1.3)} and \hyperref[env-1.4.1.4]{(4.1.4)}
that there exists a unique sheaf of ideals $\sh{J}$ satisfying these conditions and that
define the closed subprescheme $(Y,\OO_Y)$.
\end{proof}

In particular, the {\it induced} prescheme by $X$ on an {\it open subset} of $X$ is a
{\it subprescheme} of $X$.

\begin{prop}[4.1.6]
\label{prop-1.4.1.6}
A subprescheme (resp. a closed subprescheme) of a subprescheme
\oldpage{121}
(resp. closed subprescheme) of $X$ canonically identifies with a subprescheme
(resp. closed subprescheme) of $X$.
\end{prop}

\begin{proof}
\label{proof-prop-1.4.1.6}
Since a locally closed subset of a locally closed subspace of $X$ is a locally closed
subspace of $X$, it is clear \hyperref[prop-1.4.1.5]{(4.1.5)} that the question is local
and that we can thus suppose that $X$ is affine; the proposition then follows from the
canonical identification of $A/\mathfrak{J}'$ and
$(A/\mathfrak{J})/(\mathfrak{J}'/\mathfrak{J})$ when $\mathfrak{J}$, $\mathfrak{J}'$ are
two ideals of a ring $A$ such that $\mathfrak{J}\subset\mathfrak{J}'$.
\end{proof}

We will always make the previous identification.
\begin{env}[4.1.7]
\label{env-1.4.1.7}
Let $Y$ be a subprescheme of a prescheme $X$, and denote by $\psi$ the canonical injection
$Y\to X$ of the {\it underlying subspaces}; we know that the inverse image $\psi^*(\OO_X)$ is
the restriction $\OO_X|Y$ \hyperref[env-0.3.7.1]{(\textbf{0},~3.1.7)}. If, for each $y\in Y$,
we denote by $\omega_y$ the canonical homomorphism $(\OO_X)_y\to(\OO_Y)_y$, then these
homomorphisms are the restrictions to stalks of a {\it surjective} homomorphism $\omega$
of sheaves of rings $\OO_X|Y\to\OO_Y$: indeed, is suffices to check locally on $Y$, that is
to say, we can suppose that $X$ is affine and that the subprescheme $Y$ is closed; if in this
case $\sh{J}$ is the sheaf of ideals in $\OO_X$ which defines $Y$, then the $\omega_y$ are
none other than the restriction to stalks of the homomorphism $\OO_X|Y\to(\OO_X/\sh{J})|Y$.
We have thus defined a
{\it monomorphism of ringed spaces} \hyperref[env-0.4.1.1]{(\textbf{0},~4.1.1)}
$j=(\psi,\omega^\flat)$ which is evidently a morphism $Y\to X$ of
preschemes \hyperref[defn-1.2.2.1]{(2.2.1)}, and we call this the
{\it canonical injection morphism}.

If $f:X\to Z$ is a morphism, we then say that the composite morphism
$Y\xrightarrow{j}X\xrightarrow{f}Z$ is the {\it restriction} of $f$ to the subprescheme $Y$.
\end{env}


\section{Reduced preschemes; separation conditions}
\label{section-reduced-preschemes-and-separation-conditions}

\section{Finiteness conditions}
\label{section-finiteness-conditions}

\section{Rational maps}
\label{section-rational-maps}

\section{Chevalley schemes}
\label{section-chevalley-schemes}

\subsection{Allied local rings}
\label{subsection-allied-local-rings}

For each local ring $A$, we denote by $\mathfrak{m}(A)$ the maximal ideal of
$A$.

\begin{lem}[8.1.1]
\label{lem-1.8.1.1}
Let $A$ and $B$ be two local rings such that $A\subset B$;
then the following conditions are equivalent: {\it (i)}
$\mathfrak{m}(B)\cap A=\mathfrak{m}(A)$; {\it (ii)}
$\mathfrak{m}(A)\subset\mathfrak{m}(B)$; {\it (iii)} $1$ is not an element of
the ideal of $B$ generated by $\mathfrak{m}(A)$.
\end{lem}

\begin{proof}
\label{proof-lem-1.8.1.1}
It is evident that (i) implies (ii), and (ii) implies (iii); lastly, if (iii) is
true, then $\mathfrak{m}(B)\cap A$ contains $\mathfrak{m}(A)$ and does not
contain $1$, and is thus equal to $\mathfrak{m}(A)$.

When the equivalent conditions of \hyperref[lem-1.8.1.1]{(8.1.1)} are satisfied, we say that $B$
{\it dominates} $A$; this is equivalent to saying that the injection $A\to B$
is a {\it local} homomorphism. It is clear that, in the set of local subrings
of a ring $R$, the relation given by domination is an \unsure{order}.
\end{proof}

\begin{env}[8.1.2]
\label{env-1.8.1.2}
Now consider a {\it field} $R$. For all subrings $A$ of
$R$, we denote by $L(A)$ the set of local rings $A_\mathfrak{p}$, where
$\mathfrak{p}$ runs over the prime spectrum of $A$; they are identified with the
subrings of $R$ containing $A$. Since
$\mathfrak{p}=(\mathfrak{p}A_\mathfrak{p})\cap A$, the map
$\mathfrak{p}\mapsto A_\mathfrak{p}$ from $\Spec(A)$ to $L(A)$ is bijective.
\end{env}

\begin{lem}[8.1.3]
\label{lem-1.8.1.3}
Let $R$ be a field, and $A$ a subring of $R$. For a
local subring $M$ of $R$ to dominate a ring $A_\mathfrak{p}\in L(A)$ it is
necessary and sufficient that $A\subset M$; the local ring $A_\mathfrak{p}$
dominated by $M$ is then unique, and corresponds to
$\mathfrak{p}=\mathfrak{m}(M)\cap A$.
\end{lem}

\begin{proof}
\label{proof-lem-1.8.1.3}
If $M$ dominates $A_\mathfrak{p}$, then
$\mathfrak{m}(M)\cap A_\mathfrak{p}=\mathfrak{p}A_\mathfrak{p}$,
by \hyperref[lem-1.8.1.1]{(8.1.1)}, whence the uniqueness of $\mathfrak{p}$; on the other hand,
if $A\subset M$, then $\mathfrak{m}M\cap A=\mathfrak{p}$ is prime in $A$, and since
$A-\mathfrak{p}\subset M$, we have that $A_\mathfrak{p}\subset M$ and
$\mathfrak{p}A_\mathfrak{p}\subset\mathfrak{m}(M)$, so $M$ dominates
$A_\mathfrak{p}$.
\end{proof}

\begin{lem}[8.1.4]
\label{lem-1.8.1.4}
\oldpage{165}
Let $R$ be a field, $M$ and $N$ two local
subrings of $R$, and $P$ the subring of $R$ generated by $M\cup N$. Then the
following conditions are equivalent:
\begin{itemize}
  \item[{\rm(i)}] There exists a prime ideal $\mathfrak{p}$ of $P$ such that
        $\mathfrak{m}(M)=\mathfrak{p}\cap M$ and $\mathfrak{m}(N)=\mathfrak{p}\cap N$.
  \item[{\rm(ii)}] The ideal $\mathfrak{a}$ generated in $P$ by $\mathfrak{m}(M)\cup\mathfrak{m}(N)$ is
        distinct from $P$.
  \item[{\rm(iii)}] There exists a local subring $Q$ of $R$ simultaneously dominating both $M$ and $N$.
\end{itemize}
\end{lem}

\begin{proof}
\label{proof-lem-1.8.1.4}
It is clear that (i) implies (ii); conversely, if $\mathfrak{a}\neq P$, then
$\mathfrak{a}$ is contained in a maximal ideal $\mathfrak{n}$ of $P$, and since
$1\not\in\mathfrak{n}$, $\mathfrak{n}\cap M$ contains $\mathfrak{m}(M)$ and is
distinct from $M$, so $\mathfrak{n}\cap M=\mathfrak{m}(M)$, and similarly
$\mathfrak{n}\cap N=\mathfrak{m}(N)$. It is clear that, if $Q$ dominates both
$M$ and $N$, then $P\subset Q$ and
$\mathfrak{m}(M)=\mathfrak{m}(Q)\cap M=(\mathfrak{m}(Q)\cap P)\cap M$, and
$\mathfrak{m}(N)=(\mathfrak{m}(Q)\cap P)\cap N$, so (iii) implies (i); the converse
is evident when we take $Q=P_\mathfrak{p}$.
\end{proof}

When the conditions of \hyperref[lem-1.8.1.4]{(8.1.4)} are satisfied, we say, with C.~Chevalley,
that the local rings $M$ and $N$ are {\it allied}.

\begin{prop}[8.1.5]
\label{prop-1.8.1.5}
Let $A$ and $B$ be two subrings of a field $R$,
and $C$ the subring of $R$ generated by $A\cup B$. Then the following
conditions are equivalent:
\begin{itemize}
  \item[{\rm(i)}] For every local ring $Q$ containing $A$ and $B$, we have that
        $A_\mathfrak{p}=B_\mathfrak{q}$, where $\mathfrak{p}=\mathfrak{m}(Q)\cap A$ and
        $\mathfrak{q}=\mathfrak{m}(Q)\cap B$.
  \item[{\rm(ii)}] For all prime ideals $\mathfrak{r}$ of $C$, we have that
        $A_\mathfrak{p}=B_\mathfrak{q}$, where $\mathfrak{p}=\mathfrak{r}\cap A$ and
        $\mathfrak{q}=\mathfrak{r}\cap B$.
  \item[{\rm(iii)}] If $M\in L(A)$ and $N\in L(B)$ are allied, then they are identical.
  \item[{\rm(iv)}] $L(A)\cap L(B)=L(C)$.
\end{itemize}
\end{prop}

\begin{proof}
\label{proof-prop-1.8.1.5}
Lemmas \hyperref[lem-1.8.1.3]{(8.1.3)} and \hyperref[lem-1.8.1.4]{(8.1.4)} prove that (i) and (iii) are equivalent; it
is clear that (i) implies (ii) by taking $Q=C_\mathfrak{r}$; conversely, (ii)
implies (i), because if $Q$ contains $A\cup B$ then it contains $C$, and if
$\mathfrak{r}=\mathfrak{m}(Q)\cap C$ then $\mathfrak{p}=\mathfrak{r}\cap A$ and
$\mathfrak{q}=\mathfrak{r}\cap B$, from \hyperref[lem-1.8.1.3]{(8.1.3)}. It is immediate that (iv)
implies (i), because if $Q$ contains $A\cup B$ then it dominates a local ring
$C_\mathfrak{r}\in L(C)$ by \hyperref[lem-1.8.1.3]{(8.1.3)}; by hypothesis we have that
$C_\mathfrak{r}\in L(A)\cap L(B)$, and \hyperref[lem-1.8.1.1]{(8.1.1)} and \hyperref[lem-1.8.1.3]{(8.1.3)} prove that
$C_\mathfrak{r}=A_\mathfrak{p}=B_\mathfrak{q}$. We prove finally that (iii)
implies (iv). Let $Q\in L(C)$; $Q$ dominates some $M\in L(A)$ and some $N\in
L(B)$ \hyperref[lem-1.8.1.3]{(8.1.3)}, so $M$ and $N$, being allied, are identical by hypothesis.
As we then have that $C\subset M$, we know that $M$ dominates some $Q'\in L(C)$
\hyperref[lem-1.8.1.3]{(8.1.3)}, so $Q$ dominates $Q'$, whence necessarily \hyperref[lem-1.8.1.3]{(8.1.3)} $Q=Q'=M$,
so $Q\in L(A)\cap L(B)$. Conversely, if $Q\in L(A)\cap L(B)$, then $C\subset
Q$, so \hyperref[lem-1.8.1.3]{(8.1.3)} $Q$ dominates some $Q''\in L(C)\subset L(A)\cap L(B)$; $Q$
and $Q''$, being allied, are identical, so $Q''=Q\in L(C)$, which completes the
proof.
\end{proof}

\subsection{Local rings of an integral scheme}
\label{subsection-local-rings-of-integral-scheme}

\begin{env}[8.2.1]
\label{env-1.8.2.1}
Let $X$ be an {\it integral} prescheme, and $R$ its field of
rational functions, identical to the local ring of the generic point $a$ of $X$;
for all $x\in X$, we know that $\OO_x$ can be canonically identified with a
subring of $R$ \hyperref[env-1.7.1.5]{(7.1.5)}, and for every rational function $f\in R$, the
domain of definition $\delta(f)$ of $f$ is the open set of $x\in X$ such that
$f\in\OO_x$. It thus follows from \hyperref[env-1.7.2.6]{(7.2.6)} that, for every open $U\subset X$,
we have
\[
  \Gamma(U,\OO_X)=\bigcap_{x\in U}\OO_x.
  \tag{8.2.1.1}
\]
\end{env}

\begin{prop}[8.2.2]
\label{prop-1.8.2.2}
\oldpage{166}
Let $X$ be an integral prescheme,
and $R$ its field of rational fractions. For $X$ to be a scheme, it is
necessary and sufficient that the relation ``$\OO_x$ and $\OO_y$ are allied''
\hyperref[lem-1.8.1.4]{(8.1.4)}, for points $x$, $y$ of $X$, implies that $x=y$.
\end{prop}

\begin{proof}
\label{proof-prop-1.8.2.2}
We suppose that this condition is verified, and aim to show that $X$ is separated.
Let $U$ and $V$ be two distinct affine opens of $X$, with rings $A$ and $B$,
identified with subrings of $R$; $U$ (resp. $V$) is thus identified \hyperref[env-1.8.1.2]{(8.1.2)}
with $L(A)$ (resp. $L(B)$), and the hypotheses tell us \hyperref[env-1.8.1.5]{(8.1.5)} that $C$ is
the subring of $R$ generated by $A\cup B$, and $W=U\cap V$ is identified with
$L(A)\cap L(B)=L(C)$. Furthermore, we know
(\cite{I-1}, p.~\unsure{5-03},~4~{\it bis}) that every subring $E$ of $R$ is
equal to the intersection of the local rings belonging to $L(E)$; $C$ is thus
identified with the intersection of the rings $\OO_z$ for $z\in W$, or,
equivalently (8.2.1.1) with $\Gamma(W,\OO_X)$. So consider the subprescheme
induced by $X$ on $W$; to the \unsure{identity} morphism $\vphi:
C\to\Gamma(W,\OO_X)$ there corresponds \hyperref[prop-1.2.2.4]{(2.2.4)} a morphism
$\Phi=(\psi,\theta):W\to\Spec(C)$; we will see that $\Phi$ is an
{\it isomorphism} of preschemes, whence $W$ is an {\it affine} open. The
identification of $W$ with $L(C)=\Spec(C)$ shows that $\psi$ is
{\it bijective}.On the other hand, for all $x\in W$, $\theta_x^\sharp$ is the
injection $C_\mathfrak{r}\to\OO_x$, where $\mathfrak{r}=\mathfrak{m}_x\cap C$,
and by definition $C_\mathfrak{r}$ is identified with $\OO_x$, so $\theta_x^\sharp$
is bijective. It thus remains to show that $\psi$ is a {\it homeomorphism},
i.e. that for every closed subset $F\subset W$, $\psi(F)$ is closed in
$\Spec(C)$. But $F$ is the \unsure{trace over} $W$ of closed subspace of $U$,
of the form $V(\mathfrak{a})$, where $\mathfrak{a}$ is an ideal of $A$; we show
that $\psi(F)=V(\mathfrak{a}C)$, which proves our claim. In fact, the prime
ideals of $C$ containing $\mathfrak{a}C$ are the prime ideals of $C$ containing
$\mathfrak{a}$, and so are the ideals of the form $\psi(x)=\mathfrak{m}_x\cap
C$, where $\mathfrak{a}\subset\mathfrak{m}_x$ and $x\in W$; since
$\mathfrak{a}\subset\mathfrak{m}_x$ is equivalent to $x\in V(\mathfrak{a})=W\cap
F$ for $x\in U$, we do indeed have that $\psi(F)=V(\mathfrak{a}C)$.

It follows that $X$ is separated, because $U\cap V$ is affine and its ring $C$
is generated by the union $A\cup B$ of the rings of $U$ and $V$ \hyperref[env-1.5.5.6]{(5.5.6)}.

Conversely, suppose that $X$ is separated, and let $x$, $y$ be two points of $X$
such that $\OO_x$ and $\OO_y$ are allied. Let $U$ (resp. $V$) be an affine open
containing $x$ (resp. $y$), of ring $A$ (resp. $B$); we then know that $U\cap V$
is affine and that its ring $C$ is generated by $A\cup B$ \hyperref[env-1.5.5.6]{(5.5.6)}. If
$\mathfrak{p}=\mathfrak{m}_x\cap A$ and $\mathfrak{q}=\mathfrak{m}_y\cap B$,
then $A_\mathfrak{p}=\OO_x$ and $B_\mathfrak{q}=\OO_y$, and since $A_\mathfrak{p}$
and $B_\mathfrak{q}$ are allied, there exists a prime ideal $\mathfrak{r}$ of
$C$ such that $\mathfrak{p}=\mathfrak{r}\cap A$ and
$\mathfrak{q}=\mathfrak{r}\cap B$ \hyperref[lem-1.8.1.4]{(8.1.4)}. But then there exists a point
$z\in U\cap V$ such that $\mathfrak{r}=\mathfrak{m}_z\cap C$, since $U\cap V$ is
affine, and so evidently $x=z$ and $y=z$, whence $x=y$.
\end{proof}

\begin{cor}[8.2.3]
\label{cor-1.8.2.3}
Let $X$ be an integral scheme, and $x$, $y$ two
points of $X$.In order that $x\in\overline{\{y\}}$, it is necessary and
sufficient that $\OO_x\subset\OO_y$, or, equivalently, that every rational
function defined at $x$ is also defined at $y$.
\end{cor}

\begin{proof}
\label{proof-cor-1.8.2.3}
The condition is evidently necessary because the domain of definition
$\delta(f)$ of a rational function $f\in R$ is open; we now show that it is
sufficient.If $\OO_x\subset\OO_y$, then there exists a prime ideal
$\mathfrak{p}$ of $\OO_x$ such that $\OO_y$ dominates $(\OO_x)_\mathfrak{p}$
\hyperref[lem-1.8.1.3]{(8.1.3)}; but \hyperref[prop-1.2.4.2]{(2.4.2)} there exists $z\in X$ such that
$x\in\overline{\{z\}}$ and $\OO_z=(\OO_x)_\mathfrak{p}$; since $\OO_z$ and $\OO_y$
are allied, we have that $z=y$ by \hyperref[prop-1.8.2.2]{(8.2.2)}, whence the corollary.
\end{proof}

\begin{cor}[8.2.4]
\label{cor-1.8.2.4}
If $X$ is an integral scheme then the map
$x\to\OO_x$ is injective; equivalently, if $x$ and $y$ are two distinct points of
$X$, then there exists a rational function defined at one of these points but
not the other.
\end{cor}

\begin{proof}
\label{proof-cor-1.8.2.4}
\oldpage{167}
This follows from \hyperref[cor-1.8.2.3]{(8.2.3)} and the axiom ($T_0$) \hyperref[prop-1.2.1.4]{(2.1.4)}.
\end{proof}

\begin{cor}[8.2.5]
\label{cor-1.8.2.5}
Let $X$ be an integral scheme whose underlying
space is Noetherian; letting $f$ run over the field $R$ of rational functions on
$X$, the sets $\delta(f)$ generate the topology of $X$.
\end{cor}

In fact, every closed subset of $X$ is thus a finite union of irreducible closed
subsets, i.e., of the form $\overline{\{y\}}$ \hyperref[prop-1.2.1.5]{(2.1.5)}. But, if
$x\not\in\overline{\{y\}}$, then there exists a rational function $f$ defined at
$x$ but not at $y$ \hyperref[cor-1.8.2.3]{(8.2.3)}, or, equivalently, we have that $x\in\delta(f)$
and $\delta(f)$ is not contained in $\overline{\{y\}}$. The complement of
$\overline{\{y\}}$ is thus a union of sets of the form $\delta(f)$, and by
virtue of the first remark, every open subset of $X$ is the union of finite
intersections of open sets of the form $\delta(f)$.

\begin{env}[8.2.6]
\label{env-1.8.2.6}
Corollary \hyperref[cor-1.8.2.5]{(8.2.5)} shows that the topology of $X$ is
entirely characterised by the data of the local rings $(\OO_x)_{x\in X}$ that
have $R$ as their field of fractions. It amounts to the same to say that the
closed subsets of $X$ are defined in the following manner: given a finite subset
$\{x_1,\ldots,x_n\}$ of $X$, consider the set of $y\in X$ such that
$\OO_y\subset\OO_{x_i}$ for at least one index $i$, and these sets (over all
choices of $\{x_1,\ldots,x_n\}$) are the closed subsets of $X$. Further, once
the topology on $X$ is known, the structure sheaf $\OO_X$ is also determined by
the family of the $\OO_x$, since $\Gamma(U,\OO_X)=\bigcap_{x\in U}\OO_x$ by
(8.2.1.1). The family $(\OO_X)_{x\in X}$ thus completely determines the
prescheme $X$ when $X$ is an integral scheme whose underlying space is
Noetherian.
\end{env}

\begin{prop}[8.2.7]
\label{prop-1.8.2.7}
Let $X$, $Y$ be two integral schemes, $f:X\to Y$ a dominant morphism
\hyperref[env-1.2.2.6]{(2.2.6)}, and $K$ (resp.$L$) the field of rational
functions on $X$ (resp.$Y$). Then $L$ can be identified with a subfield of
$K$, and for all $x\in X$, $\OO_{f(x)}$ is the unique local ring of $Y$ dominated
by $\OO_x$.
\end{prop}

\begin{proof}
\label{proof-prop-1.8.2.7}
If $f=(\psi,\theta)$ and $a$ is the generic point of $X$, then
$\psi(a)$ is the generic point of $Y$ \hyperref[env-0.2.1.5]{(\textbf{0},~2.1.5)}; $\theta_a^\sharp$ is then
a monomorphism of fields, from $L=\OO_{\psi(a)}$ to $K=\OO_a$. Since every
non-empty affine open $U$ of $Y$ contains $\psi(a)$, it follows from
\hyperref[prop-1.2.2.4]{(2.2.4)} that the homomorphism $\Gamma(U,\OO_Y)\to\Gamma(\psi^{-1}(U),\OO_X)$
corresponding to $f$ is the restriction of $\theta_a^\sharp$ to $\Gamma(U,\OO_Y)$.
So, for every $x\in X$, $\theta_x^\sharp$ is the restriction to $\OO_{\psi(a)}$ of
$\theta_a^\sharp$, and is thus a monomorphism. We also know that $\theta_x^\sharp$ is a
local homomorphism, so, if we identify $L$ with a subfield of $K$ by
$\theta_a^\sharp$, $\OO_{\psi(x)}$ is dominated by $\OO_x$ \hyperref[lem-1.8.1.1]{(8.1.1)}; it is also
the only local ring of $Y$ dominated by $\OO_x$, since two local rings of $Y$
that are allied are identical \hyperref[prop-1.8.2.2]{(8.2.2)}.
\end{proof}

\begin{prop}[8.2.8]
\label{prop-1.8.2.8}
Let $X$ be an {\it irreducible} prescheme; and
$f:X\to Y$ a local immersion ({\it resp.} a local isomorphism); and
suppose further that $f$ is separated. Then $f$ is an immersion ({\it resp.}
an open immersion).
\end{prop}

\begin{proof}
\label{proof-prop-1.8.2.8}
Let $f=(\psi,\theta)$; it suffices, in both cases, to prove that $\psi$ is a
{\it homeomorphism} from $X$ to $\psi(X)$ \hyperref[env-1.4.5.3]{(4.5.3)}. Replacing $f$ by
$f_\text{red}$ (\hyperref[env-1.5.1.6]{(5.1.6)} and \hyperref[env-1.5.5.1]{(5.5.1)}, (vi)), we can assume that $X$
and $Y$ are {\it reduced}. If $Y'$ is the closed reduced subprescheme of $Y$
having $\overline{\psi(X)}$ as its underlying space, then $f$ factorizes as
$X\xrightarrow{f'}Y'\xrightarrow{j}Y$, where $j$ is the canonical injection
\hyperref[env-1.5.2.2]{(5.2.2)}. It follows from \hyperref[env-1.5.5.1]{(5.5.1)}, (v) that $f'$ is again a
separated morphism; further, $f'$ is again
\oldpage{168}
a local immersion (resp. a local isomorphism), because, since the condition is local on $X$
and $Y$, we can reduce ourselves to the case where $f$ is a closed immersion (resp. open
immersion), and then our claim follows immediately from \hyperref[env-1.4.2.2]{(4.2.2)}.

We can thus suppose that $f$ is a {\it dominant} morphism, which leads to the
fact that $Y$ is, itself, irreducible \hyperref[env-0.2.1.5]{(\textbf{0},~2.1.5)}, and so $X$ and $Y$
are both {\it integral}. Further, the condition being local on $Y$, we can
suppose that $Y$ is an affine scheme; since $f$ is separated, $X$ is a scheme
\hyperref[env-1.5.5.1]{(5.5.1)}, (ii), and we are finally at the hypotheses of Proposition \hyperref[prop-1.8.2.7]{(8.2.7)}.
Then, for all $x\in X$, $\theta_x^\sharp$ is injective; but the hypothesis that $f$
is a local immersion implies that $\theta_x^\sharp$ is surjective \hyperref[env-1.4.2.2]{(4.2.2)}, so
$\theta_x^\sharp$ is bijective, or, equivalently (with the identification of Proposition
\hyperref[prop-1.8.2.7]{(8.2.7)}) we have that $\OO_{\psi(x)}=\OO_x$. This implies, by
Corollary \hyperref[cor-1.8.2.4]{(8.2.4)},
that $\psi$ is an {\it injective} map, which already proves the proposition
when $f$ is a local isomorphism \hyperref[env-1.4.5.3]{(4.5.3)}. When we suppose that $f$ is only
a local immersion, for all $x\in X$ there exists an open neighbourhood $U$ of
$x$ in $X$ and an open neighbourhood $V$ of $\psi(x)$ in $Y$ such that the
restriction of $\psi$ to $U$ is a homeomorphism from $U$ to a {\it closed}
subset of $V$. But $U$ is dense in $X$, so $\psi(U)$ is dense in $Y$ and
{\it a fortiori} in $V$, which proves that $\psi(U)=V$; since $\psi$ is
injective, $\psi^{-1}(V)=U$ and this proves that $\psi$ is a homeomorphism from
$X$ to $\psi(X)$.
\end{proof}

\subsection{Chevalley schemes}
\label{subsection-chevalley-schemes}

\begin{env}[8.3.1]
\label{env-1.8.3.1}
Let $X$ be a {\it Noetherian} integral scheme, and $R$ its
field of rational functions; we denote by $X'$ the set of local subrings
$\OO_x\subset R$, where $x$ runs over all points of $X$. The set $X'$ satisfies
the three following conditions:
\begin{itemize}
  \item[(Sch.~1)] For all $M\in X'$, $R$ is the field of fractions of $M$.
  \item[(Sch.~2)] There exists a finite set of Noetherian subrings $A_i$ of $R$
  such that $X'=\bigcup_i L(A_i)$, and, for all pairs of indices $i$, $j$, the subring
  $A_{ij}$ of $R$ generated by $A_i\cup A_j$ is an algebra of finite type over $A_i$.
  \item[(Sch.~3)] Two elements $M$ and $N$ of $X'$ that are allied are identical.
\end{itemize}
\end{env}

We have seen in \hyperref[env-1.8.2.1]{(8.2.1)} that (Sch.~1) is satisfied, and (Sch.~3)
follows from \hyperref[env-1.8.2.2]{(8.2.2)}. To show (Sch.~2), it suffices to cover $X$ by a
finite number of affine opens $U_i$, whose rings are Noetherian, and to take
$A_i=\Gamma(U_i,\OO_X)$; the hypothesis that $X$ is a scheme implies that
$U_i\cap U_j$ is affine, and also that $\Gamma(U_i\cap U_j,\OO_X)=A_{ij}$
\hyperref[env-1.5.5.6]{(5.5.6)}; further, since the space $U_i$ is Noetherian, the immersion
$U_i\cap U_j\to U_i$ is of finite type \hyperref[env-1.6.3.5]{(6.3.5)}, so $A_{ij}$ is an
$A_i$-algebra of finite type \hyperref[env-1.6.3.3]{(6.3.3)}.

\begin{env}[8.3.2]
\label{env-1.8.3.2}
The structures whose axioms are (Sch.~1), (Sch.~2), and
(Sch.~3), generalise ``schemes'' in the sense of C.~Chevalley, who supposes
furthermore that $R$ is an extension of finite type of a field $K$, and that the
$A_i$ are $K$-algebras of finite type (which renders a part of (Sch.~2) useless)
\cite{I-1}. Conversely, if we have such a structure on a set $X'$, then we can
associate to it an integral scheme $X$ by using the remarks from \hyperref[env-1.8.2.6]{(8.2.6)}:
the underlying space of $X$ is equal to $X'$ endowed with the topology defined
in \hyperref[env-1.8.2.6]{(8.2.6)}, and with the sheaf $\OO_X$ such that
$\Gamma(U,\OO_X)=\bigcap_{x\in U}\OO_x$ for all open $U\subset X$, with the
evident definition of restriction homomorphisms. We leave to the reader the
task of verifying that we obtain thusly an integral scheme, whose local rings
are the elements of $X'$; we will not use this result in what follows.
\end{env}

\section{Supplement on quasi-coherent sheaves}
\label{section-supplement-on-qcoh}

\subsection{Tensor product of quasi-coherent sheaves}
\label{subsection-tensor-product-of-qcoh}

\begin{prop}[9.1.1]
\label{prop-1.9.1.1}
\oldpage{169}
Let $X$ be a prescheme ({\it resp.} a locally Noetherian prescheme). Let $\sh{F}$ and
$\sh{G}$ be two quasi-coherent ({\it resp.} coherent) $\OO_X$-modules; then
$\sh{F}\otimes_{\OO_X}\sh{G}$ is quasi-coherent ({\it resp.} coherent) and
of finite type if $\sh{F}$ and $\sh{G}$ are of finite type. If
$\sh{F}$ admits a finite presentation and if $\sh{G}$ is quasi-coherent
({\it resp.} coherent), then $\shHom(\sh{F},\sh{G})$ is quasi-coherent
({\it resp.} coherent).
\end{prop}

\begin{proof}
\label{proof-prop-1.9.1.1}
Being a local property, we can suppose that $X$ is affine (resp. Noetherian
affine); further, if $\sh{F}$ is coherent, then we can assume that it is the
cokernel of a homomorphism $\OO_X^m\to\OO_X^n$. The claims pertaining to
quasi-coherent sheaves then follow from the Corollaries \hyperref[cor-1.1.3.12]{(1.3.12)} and \hyperref[cor-1.1.3.9]{(1.3.9)}; the
claims pertaining to coherent sheaves follow from Theorem \hyperref[thm-1.1.5.1]{(1.5.1)} and from the fact
that, if $M$ and $N$ are modules of finite type over a Noetherian ring $A$,
$M\otimes_A N$ and $\Hom_A(M,N)$ are $A$-modules of finite type.
\end{proof}

\begin{defn}[9.1.2]
\label{defn-1.9.1.2}
Let $X$ and $Y$ be two $S$-preschemes, $p$ and
$q$ the projections of $X\times_S Y$, and $\sh{F}$ (resp.$\sh{G}$) a
quasi-coherent $\OO_X$-module (resp. quasi-coherent $\OO_Y$-module). We define the
tensor product of $\sh{F}$ and $\sh{G}$ over $\OO_S$ ({\it or} over $S$),
denoted by $\sh{F}\otimes_{\OO_S}\sh{G}$ ({\it or}
$\sh{F}\otimes_S\sh{G}$) to be the tensor product
$p^*(\sh{F})\otimes_{\OO_{X\times_S Y}}q^*(\sh{G})$ over the
prescheme $X\times_S Y$.
\end{defn}

If $X_i$ ($1\leqslant i\leqslant n$) are $S$-preschemes, and $\sh{F}_i$ are quasi-coherent
$\OO_{X_i}$-modules ($1\leqslant i\leqslant n$), then we define similarly the tensor product
$\sh{F}_1\otimes_S\sh{F}_2\otimes_S\cdots\otimes_S\sh{F}_n$ over the
prescheme $Z=X_1\times_S X_2\times_S\cdots\times_S X_n$; it is a
{\it quasi-coherent} $\OO_Z$-module by virtue of \hyperref[prop-1.9.1.1]{(9.1.1)} and
\hyperref[env-0.5.1.4]{(\textbf{0},~5.1.4)}; it is {\it coherent} if the $\sh{F}_i$ are coherent and
$Z$ is {\it locally Noetherian}, by virtue of \hyperref[prop-1.9.1.1]{(9.1.1)},
\hyperref[env-0.5.3.11]{(\textbf{0},~5.3.11)}, and \hyperref[env-1.6.1.1]{(6.1.1)}.

Note that if we take $X=Y=S$ then definition \hyperref[defn-1.9.1.2]{(9.1.2)} gives us back the tensor
product of $\OO_S$-modules. Furthermore, as $q^*(\OO_Y)=\OO_{X\times_S Y}$
\hyperref[env-0.4.3.4]{(\textbf{0},~4.3.4)}, the product $\sh{F}\otimes_S\OO_Y$ is canonically
identified with $p^*(\sh{F})$, and, in the same way,
$\OO_X\otimes_S\sh{G}$ is canonically identified with $q^*(\sh{G})$. In
particular, if we take $Y=S$ and denote by $f$ the structure morphism $X\to Y$,
we have that $\OO_X\otimes_Y\sh{G}=f^*(\sh{G})$: the ordinary tensor
product and the inverse image thus appear as particular cases of the general
tensor product.

Definition \hyperref[defn-1.9.1.2]{(9.1.2)} leads immediately to the fact that, for fixed $X$ and
$Y$, $\sh{F}\otimes_S\sh{G}$ is an {\it additive covariant bifunctor that
is right exact} in $\sh{F}$ and $\sh{G}$.

\begin{prop}[9.1.3]
\label{prop-1.9.1.3}
Let $S$, $X$, $Y$ be three affine schemes of rings
$A$, $B$, $C$ (respectively), with $B$ and $C$ being $A$-algebras. Let $M$
({\it resp.} $N$) be a $B$-module ({\it resp.} $C$-module), and
$\sh{F}=\widetilde{M}$ ({\it resp.} $\sh{G}=\widetilde{N}$) the
associated quasi-coherent sheaf; then $\sh{F}\otimes_S\sh{G}$ is
canonically isomorphic to the sheaf associated to the $(B\otimes_A C)$-module
$M\otimes_A N$.
\end{prop}

\begin{proof}
\label{proof-prop-1.9.1.3}
\oldpage{170}
According to Proposition \hyperref[prop-1.1.6.5]{(1.6.5)}, $\sh{F}\otimes_S\sh{G}$
is canonically isomorphic to the sheaf associated to the $(B\otimes_A C)$-module
\[
  \big(M\otimes_B(B\otimes_A C)\big)\otimes_{B\otimes_A C}\big((B\otimes_A C)\otimes_C N\big)
\]
and by the canonical isomorphisms between tensor
products, this latter module is isomorphic to
\[
  M\otimes_B(B\otimes_A C)\otimes_C N=(M\otimes_B B)\otimes_A(C\otimes_C N)=M\otimes_A N.
\]
\end{proof}

\begin{prop}[9.1.4]
\label{prop-1.9.1.4}
Let $f:T\to X$, and $g:T\to Y$ be
two $S$-morphisms, and $\sh{F}$ ({\it resp.} $\sh{G}$) a quasi-coherent
$\OO_X$-module ({\it resp.} quasi-coherent $\OO_Y$-module). Then
\[
  (f,g)^*_S(\sh{F}\otimes_S\sh{G})=f^*(\sh{F})\otimes_{\OO_T}g^*(\sh{G}).
\]
\end{prop}

\begin{proof}
\label{proof-prop-1.9.14}
If $p$, $q$ are the projections of $X\times_S Y$, then the formula in fact follows
from the relations $(f,g)^*_S\circ p^*=f^*$ and
$(f,g)^*_S\circ q^*=g^*$ \hyperref[env-0.3.5.5]{(\textbf{0},~3.5.5)}, and the fact that the inverse
image of a tensor product of algebraic sheaves is the tensor product of their inverse
images \hyperref[env-0.4.3.3]{(\textbf{0},~4.3.3)}.
\end{proof}

\begin{cor}[9.1.5]
\label{cor-1.9.1.5}
Let $f:X\to X'$ and $g:Y\to Y'$ be
$S$-morphisms, and $\sh{F}'$ ({\it resp.} $\sh{G}'$) a quasi-coherent
$\OO_{X'}$-module ({\it resp.} quasi-coherent $\OO_{Y'}$-module). Then
\[
  (f,g)^*_S(\sh{F}'\otimes_S\sh{G}')=f^*(\sh{F}')\otimes_S g^*(\sh{G}')
\]
\end{cor}

\begin{proof}
\label{proof-cor-1.9.1.5}
This follows from \hyperref[prop-1.9.1.4]{(9.1.4)} and the fact that $f\times_S g=(f\circ p, g\circ q)_S$,
where $p$, $q$ are the projections of $X\times_S Y$.
\end{proof}

\begin{cor}[9.1.6]
\label{cor-1.9.1.6}
Let $X$, $Y$, $Z$ be three $S$-preschemes, and $\sh{F}$ ({\it resp.} $\sh{G}$, $\sh{H}$) a
quasi-coherent $\OO_X$-module ({\it resp.} quasi-coherent $\OO_Y$-module, quasi-coherent
$\OO_Z$-module); then the sheaf $\sh{F}\otimes_S\sh{G}\otimes_S\sh{H}$ is the inverse image
of $(\sh{F}\otimes_S\sh{G})\otimes_S\sh{H}$ by the canonical isomorphism from
$X\times_S Y\times_S Z$ to $(X\times_S Y)\times_S Z$.
\end{cor}

\begin{proof}
\label{proof-cor-1.9.16}
This isomorphism is given by $(p_1,p_2)_S\times_S p_3$, where $p_1$, $p_2$, $p_3$
are the projections of $X\times_S Y\times_S Z$.

Similarly, the inverse image of $\sh{G}\otimes_S\sh{F}$ under the canonical isomorphism from
$X\times_S Y$ to $Y\times_S X$ is $\sh{F}\otimes_S\sh{G}$.
\end{proof}

\begin{cor}[9.1.7]
\label{cor-1.9.1.7}
If $X$ is an $S$-prescheme, then every quasi-coherent $\OO_X$-module $\sh{F}$ is the inverse
image of $\sh{F}\otimes_S\OO_S$ by the canonical isomorphism from $X$ to $X\times_S S$
\hyperref[prop-1.3.3.3]{(3.3.3)}.
\end{cor}

\begin{proof}
\label{proof-cor-1.9.1.7}
This isomorphism is $(1_X,\vphi)_S$, where $\vphi$ is the structure morphism
$X\to S$, and the corollary follows from \hyperref[prop-1.9.1.4]{(9.1.4)} and the fact that
$\vphi^*(\OO_S)=\OO_X$.
\end{proof}

\begin{env}[9.1.8]
\label{env-1.9.1.8}
Let $X$ be an $S$-prescheme, $\sh{F}$ a quasi-coherent
$\OO_X$-module, and $\vphi:S'\to S$ a morphism; we denote by
$\sh{F}_{(\vphi)}$ or $\sh{F}_{(S')}$ the quasi-coherent sheaf
$\sh{F}\otimes_S\OO_{S'}$ over $X\times_S S'=X_{(\vphi)}=X_{(S')}$; so
$\sh{F}_{(S')}=p^*(\sh{F})$, where $p$ is the projection $X_{(S')}\to X$.
\end{env}

\begin{prop}[9.1.9]
\label{prop-1.9.1.9}
Let $\vphi'':S''\to S'$ be a morphism.
For every quasi-coherent $\OO_X$-module $\sh{F}$ on the $S$-prescheme $X$,
$(\sh{F}_{(\vphi)})_{(\vphi')}$ is the inverse image of
$\sh{F}_{(\vphi\circ\vphi')}$ by the canonical isomorphism
$(X_{(\vphi)})_{(\vphi')}\isoto X_{(\vphi\circ\vphi')}$
\hyperref[prop-1.3.3.9]{(3.3.9)}.
\end{prop}

\begin{proof}
\label{proof-prop-1.9.1.9}
This follows immediately from the definitions and from \hyperref[prop-1.3.3.9]{(3.3.9)}, and is
written
\[
  (\sh{F}\otimes_S\OO_{S'})\otimes_{S'}\OO_{S''}=\sh{F}\otimes_S\OO_{S''}.
  \tag{9.1.9.1}
\]
\end{proof}

\begin{prop}[9.1.10]
\label{prop-1.9.1.10}
Let $Y$ be an $S$-prescheme, and $f:X\to Y$ an $S$-morphism.
For every quasi-coherent $\OO_Y$-module and every morphism
$S'\to S$, we have that
$(f_{(S')})^*(\sh{G}_{(S')})=(f^*(\sh{G}))_{(S')}$.
\end{prop}

\begin{proof}
\label{proof-prop-1.9.1.10}
This follows immediately from the commutativity of the diagram
\oldpage{171}
\[
  \xymatrix{
    X_{(S')}\ar[r]^{f_{(S')}}\ar[d] & Y_{(S')}\ar[d]\\
    X\ar[r]^f & Y.
  }
\]
\end{proof}

\begin{cor}[9.1.11]
\label{cor-1.9.1.11}
Let $X$ and $Y$ be $S$-preschemes, and
$\sh{F}$ ({\it resp.} $\sh{G}$) a quasi-coherent $\OO_X$-module
({\it resp.} quasi-coherent $\OO_Y$-module). Then the inverse image of the sheaf
$(\sh{F}_{(S')})\otimes_{(S')}(\sh{G}_{(S')})$ by the canonical isomorphism
$(X\times_S Y)_{(S')}\isoto(X_{(S')})\times_{S'}(Y_{(S')})$
\hyperref[cor-1.3.3.10]{(3.3.10)} is equal to $(\sh{F}\otimes_S\sh{G})_{(S')}$.
\end{cor}

\begin{proof}
\label{proof-cor-1.9.1.11}
If $p$, $q$ are the projections of $X\times_S Y$, then the isomorphism in question
is nothing but $(p_{(S')}, q_{(S')})_{S'}$; the corollary then follows from the
Propositions \hyperref[prop-1.9.1.4]{(9.1.4)} and \hyperref[prop-1.9.1.10]{(9.1.10)}.
\end{proof}

\begin{prop}[9.1.12]
\label{prop-1.9.1.12}
With the notation from Definition \hyperref[defn-1.9.1.2]{(9.1.2)}, let $z$ be
a point of $X\times_S Y$, $x=p(z)$, and $y=q(z)$; the stalk
$(\sh{F}\otimes_S\sh{G})_z$ is isomorphic to
$(\sh{F}_x\otimes_{\OO_x}\OO_z)\otimes_{\OO_z}(\sh{G}_y\otimes_{\OO_y}\OO_z)
  =\sh{F}_x\otimes_{\OO_x}\OO_z\otimes_{\OO_y}\otimes\sh{G}_y$.
\end{prop}

\begin{proof}
\label{proof-prop-1.9.1.12}
As we can reduce to the affine case, the proposition follows from
equation (1.6.5.1).
\end{proof}

\begin{cor}[9.1.13]
\label{cor-1.9.1.13}
If $\sh{F}$ and $\sh{G}$ are of finite type, then we have that
\[
  \Supp(\sh{F}\otimes_S\sh{G})=p^{-1}(\Supp(\sh{F}))\cap q^{-1}(\Supp(\sh{G})).
\]
\end{cor}

\begin{proof}
\label{proof-cor-1.9.1.13}
Since $p^*(\sh{F})$ and $q^*(\sh{G})$ are both of finite type over
$\OO_{X\times_S Y}$, we reduce, by Proposition \hyperref[prop-1.9.1.12]{(9.1.12)} and by \hyperref[env-0.1.7.5]{(\textbf{0},~1.7.5)}, to
the case where $\sh{G}=\OO_Y$, that is, it remains to prove the following
equation:
\[
  \Supp(p^{-1}(\sh{F}))=p^{-1}(\Supp(\sh{F})).
  \tag{9.1.13.1}
\]

The same reasoning as in \hyperref[env-0.1.7.5]{(\textbf{0},~1.7.5)} leads us to prove that, for all
$z\in X\times_S Y$, we have $\OO_z/\mathfrak{m}_x\OO_z\neq0$ (with $x=p(z)$),
which follows from the fact that the homomorphism $\OO_x\to\OO_z$ is {\it local},
by hypothesis.
\end{proof}

We leave it to the reader to extend the results in this section to the more
general case of arbitrarily (but finitely) many factors, instead of just two.

\subsection{Direct image of a quasi-coherent sheaf}
\label{subsection-direct-image-of-qcoh}

\begin{prop}[9.2.1]
\label{prop-1.9.2.1}
Let $f:X\to Y$ be a morphism of
preschemes. We suppose that there exists a cover $(Y_\alpha)$ of $Y$ by affine
opens having the following property: every $f^{-1}(Y_\alpha)$ admits a
{\it finite} cover $(X_{\alpha i})$ by affine opens contained in
$f^{-1}(Y_\alpha)$ such that every intersection $X_{\alpha i}\cap X_{\alpha j}$
is itself a {\it finite} union of affine opens. With these hypotheses, for
every quasi-coherent $\OO_X$-module $\sh{F}$, $f_*(\sh{F})$ is a
quasi-coherent $\OO_Y$-module.
\end{prop}

\begin{proof}
\label{proof-prop-1.9.2.1}
Since this is a local condition on $Y$, we can assume that $Y$ is equal to one
of the $Y_\alpha$, and thus omit the indices $\alpha$.

\begin{itemize}
  \item[(a)] First, suppose that the $X_i\cap X_j$
        are themselves {\it affine} opens. We set $\sh{F}_i=\sh{F}|X_i$ and
        $\sh{F}_{ij}=\sh{F}|(X_i\cap X_j)$, and let $\sh{F}'_i$ and
        $\sh{F}'_{ij}$ be the images of $\sh{F}_i$ and $\sh{F}_{ij}$
        (respectively) by the restriction of $f$ to $X_i$ and $X_i\cap X_j$
        (respectively); we know that the $\sh{F}'_i$ and $\sh{F}'_{ij}$ are
        quasi-coherent \hyperref[prop-1.1.6.3]{(1.6.3)}. Set $\sh{G}=\bigoplus_i\sh{F}'_i$ and
        $\sh{H}=\bigoplus_{i,j}\sh{F}'_{ij}$; $\sh{G}$ and $\sh{H}$ are
        quasi-coherent $\OO_Y$-modules; we will define a homomorphism
        $u:\sh{G}\to\sh{H}$ such that $f_*(\sh{F})$ is the
        {\it kernel} of $u$; it will follow from this that $f_*(\sh{F})$ is
        quasi-coherent \hyperref[cor-1.1.3.9]{(1.3.9)}. It suffices to define $u$ as
\oldpage{172}
        a homomorphism of presheaves; taking into account the definitions of $\sh{G}$
        and $\sh{H}$, it thus suffices, for every open subset $W\subset Y$, to define a
        homomorphism
        \[
          u_W:\bigoplus_i\Gamma(f^{-1}(W)\cap X_i,\sh{F})
          \longrightarrow\bigoplus_{i,j}\Gamma(f^{-1}(W)\cap X_i\cap X_j,\sh{F})
        \]
        in such a way that it satisfies the usual compatibility conditions when $W$
        varies. If, for every section $s_i\in\Gamma(f^{-1}(W)\cap X_i,\sh{F})$, we
        denote by $s_{i|j}$ the restriction to $f^{-1}(W)\cap X_i\cap X_j$, then we set
        \[
          u_W\big((s_i)\big)=(s_{i|j}-s_{j|i})
        \]
        and the compatibility conditions are clearly satisfied. To prove that the kernel
        $\sh{R}$ of $u$ is $f_*(\sh{F})$, we define a homomorphism from $f_*(\sh{F})$ to
        $\sh{R}$ by sending each section $s\in\Gamma(f^{-1}(W),\sh{F})$ to the family
        $(s_i)$, where $s_i$ is the restriction of $s$ to $f^{-1}(W)\cap X_i$; the
        axioms (F1) and (F2) of sheaves (G, II, 1.1) tell us that this homomorphism is
        {\it bijective}, which finishes the proof in this case.
  \item[(b)] In the general case, the same reasoning applies once we have established that
        the $\sh{F}_{ij}$ are quasi-coherent. But, by hypothesis, $X_i\cap X_j$ is a
        finite union of affine opens $X_{ijk}$; and since the $X_{ijk}$ are affine opens
        {\it in a scheme}, the intersection of any two of them is again an affine open
        \hyperref[env-1.5.5.6]{(5.5.6)}. We are thus led to the first case, and so we have proved
        \hyperref[prop-1.9.2.1]{(9.2.1)}.
\end{itemize}
\end{proof}

\begin{cor}[9.2.2]
\label{cor-1.9.2.2}
The conclusion of \hyperref[prop-1.9.2.1]{(9.2.1)} holds true in each of the following cases:
\begin{itemize}
  \item[{\rm(a)}] $f$ is separated and quasi-compact.
  \item[{\rm(b)}] $f$ is separated and of finite type.
  \item[{\rm(c)}] $f$ is quasi-compact and the underlying space of $X$ is locally Noetherian.
\end{itemize}
\end{cor}

\begin{proof}
\label{proof-cor-1.9.2.2}
In the case {\it (a)}, the $X_{\alpha i}\cap X_{\alpha j}$ are affine \hyperref[env-1.5.5.6]{(5.5.6)}.
Case {\it (b)} is a particular case of {\it (a)} \hyperref[env-1.6.6.3]{(6.6.3)}. Finally, in case
{\it (c)}, we can reduce to the case where $Y$ is affine and the underlying
space of $X$ is Noetherian; then $X$ admits a finite cover of affine opens
$(X_i)$, and the $X_i\cap X_j$, being quasi-compact, are finite unions of affine
opens \hyperref[prop-1.2.1.3]{(2.1.3)}.
\end{proof}

\subsection{Extension of sections of quasi-coherent sheaves}
\label{subsection-extension-of-sections-of-qcoh}

\begin{thm}[9.3.1]
\label{thm-1.9.3.1}
Let $X$ be a prescheme whose underlying space is Noetherian, or a scheme whose underlying
space is quasi-compact. Let $\sh{L}$ be an invertible $\OO_X$-module \hyperref[env-0.5.4.1]{(\textbf{0},~5.4.1)}, $f$ a
section of $\sh{L}$ over $X$, $X_f$ the open set of $x\in X$ such that $f(x)\neq0$
\hyperref[env-0.5.5.1]{(\textbf{0},~5.5.1)}, and $\sh{F}$ a quasi-coherent $\OO_X$-module.
\begin{itemize}
  \item[{\rm(i)}] If $s\in\Gamma(X,\sh{F})$ is such that $s|X_f=0$, then there exists an integer $n>0$
        such that $s\otimes f^{\otimes n}=0$.
  \item[{\rm(ii)}] For every section $s\in\Gamma(X_f,\sh{F})$, there exists an integer $n>0$ such that
        $s\otimes f^{\otimes n}$ extends to a section of $\sh{F}\otimes\sh{L}^{\otimes n}$
        over $X$.
\end{itemize}
\end{thm}

\begin{proof}
\label{proof-thm-1.9.3.1}
\medskip\noindent
\begin{itemize}
  \item[(i)] Since the underlying space of $X$ is quasi-compact, and thus the union of
        finitely-many affine opens $U_i$ with $\sh{L}|U_i$ is isomorphic to
        $\OO_X|U_i$, we can reduce to the case where $X$ is affine and $\sh{L}=\OO_X$.
        In this case, $f$ is identified with an element of $A(X)$, and we have that
        $X_f=D(f)$; $s$ is identified with an element of an $A(X)$-module $M$, and
        $s|X_f$ to the corresponding element of $M_f$, and the result is then trivial,
        recalling the definition of a module of fractions.
\oldpage{173}
  \item[(ii)] Again, $X$ is a finite union of affine opens $U_i$ ($1\leqslant i\leqslant r$)
        such that $\sh{L}|U_i\cong\OO_X|U_i$, and for every $i$,
        $(s\otimes f^{\otimes n})|(U_i\cap X_f)$ is identified (by the aforementioned
        isomorphism) with $(f|(U_i\cap X_f))^n(s|(U_i\cap X_f))$. We then know
        \hyperref[thm-1.1.4.1]{(1.4.1)} that there exists an integer $n>0$ such that, for all
        $i$, $(s\otimes f^{\otimes n})|(U_i\cap X_f)$ extends to a section $s_i$ of
        $\sh{F}\otimes\sh{L}^{\otimes n}$ over $U_i$. Let $s_{i|j}$ be the restriction
        of $s_i$ to $U_i\cap U_j$; by definition we have that $s_{i|j}-s_{j|i}=0$ on
        $X_f\cap U_i\cap U_j$. But, if $X$ is a Noetherian space, then $U_i\cap U_j$ is
        quasi-compact; if $X$ is a scheme, then $U_i\cap U_j$ is an affine open
        \hyperref[env-1.5.5.6]{(5.5.6)}, and so again quasi-compact. By virtue of (i), there thus
        exists an integer $m$ (independent of $i$ and $j$) such that
        $(s_{i|j}-s_{j|i})\otimes f^{\otimes m}=0$. It immediately follows that there
        exists a section $s'$ of $\sh{F}\otimes\sh{L}^{\otimes(n+m)}$ over $X$,
        restricting to $s_i\otimes f^{\otimes m}$ over each $U_i$, and restricting to
        $s\otimes f^{\otimes(n+m)}$ over $X_f$.
\end{itemize}
\end{proof}

The following corollaries give an interpretation of Theorem \hyperref[thm-1.9.3.1]{(9.3.1)} in a more
algebraic language:
\begin{cor}[9.3.2]
\label{cor-1.9.3.2}
With the hypotheses of \hyperref[thm-1.9.3.1]{(9.3.1)}, consider the graded ring $A_*=\Gamma_*(\sh{L})$
and the graded $A_*$-module $M_*=\Gamma_*(\sh{L},\sh{F})$ \hyperref[env-0.5.4.6]{(\textbf{0},~5.4.6)}. If $f\in A_n$,
where $n\in\bb{Z}$, then there is a canonical isomorphism
$\Gamma(X_f,\sh{F})\isoto((M_*)_f)_0$ ({\it the subgroup of the module of
fractions $(M_*)_f$ consisting of elements of degree $0$}).
\end{cor}

\begin{cor}[9.3.3]
\label{cor-1.9.3.3}
Suppose that the hypotheses of \hyperref[thm-1.9.3.1]{(9.3.1)} are satisfied, and suppose further that
$\sh{L}=\OO_X$. Then, setting $A=\Gamma(X,\OO_X)$ and $M=\Gamma(X,\sh{F})$, the $A_f$-module
$\Gamma(X_f,\sh{F})$ is canonically isomorphic to $M_f$.
\end{cor}

\begin{prop}[9.3.4]
\label{prop-1.9.3.4}
Let $X$ be a Noetherian prescheme, $\sh{F}$ a coherent $\OO_X$-module, and $\sh{J}$ a
coherent sheaf of ideals in $\OO_X$, such that the support of $\sh{F}$ is contained in that
of $\OO_X|\sh{J}$. Then there exists a whole number $n>0$ such that $\sh{J}^n\sh{F}=0$.
\end{prop}

\begin{proof}
\label{proof-prop-1.9.3.4}
Since $X$ is a union of finitely-many affine opens whose rings are Noetherian, we can suppose
that $X$ is affine of Noetherian ring $A$; then $\sh{F}=\widetilde{M}$, where
$M=\Gamma(X,\sh{F})$ is an $A$-module of finite type, and $\sh{J}=\widetilde{\mathfrak{J}}$,
where $\mathfrak{J}=\Gamma(X,\sh{J})$ is an ideal of $A$ (\hyperref[thm-1.1.4.1]{(1.4.1)} and
\hyperref[thm-1.1.5.1]{(1.5.1)}). Since $A$ is Noetherian, $\mathfrak{J}$ admits a finite system of
generators $f_i$ ($1\leqslant i\leqslant m$). By hypothesis, every section of $\sh{F}$ over
$X$ is zero on each of the $D(f_i)$; if $s_j$ ($1\leqslant j\leqslant q$) are sections of
$\sh{F}$ generating $M$, then there exists a whole number $h$, independent of $i$ and $j$,
such that $f_i^h s_j=0$ \hyperref[thm-1.1.4.1]{(1.4.1)}, whence $f_i^h s=0$ for all $s\in M$. We thus
conclude that if $n=mh$ then $\mathfrak{J}^n M=0$, and so the corresponding $\OO_X$-module
$\sh{J}^n\sh{F}=\widetilde{\mathfrak{J}^n M}$ \hyperref[env-1.1.3.13]{(1.3.13)} is zero.
\end{proof}

\begin{cor}[9.3.5]
\label{cor-1.9.3.5}
With the hypotheses of \hyperref[prop-1.9.3.4]{(9.3.4)}, there exists a closed subprescheme $Y$ of $X$,
whose underlying space is the support of $\OO_X/\sh{J}$, such that, if $j:Y\to X$ is the
canonical injection, then $\sh{F}=j_*(j^*(\sh{F}))$.
\end{cor}

\begin{proof}
\label{proof-cor-1.9.3.5}
First, note that the supports of $\OO_X/\sh{J}$ and $\OO_X/\sh{J}^n$ are the same,
since, if $\sh{J}_x=\OO_x$, then $\sh{J}_x^n=\OO_x$, and we also have that
$\sh{J}_x^n\subset\sh{J}_x$ for all $x\in X$. We can, thanks to \hyperref[prop-1.9.3.4]{(9.3.4)}, thus
suppose that $\sh{J}\sh{F}=0$; we can then take $Y$ to be the closed subprescheme of $X$
defined by $\sh{J}$, and since $\sh{F}$ is then an $(\OO_X/\sh{J})$-module, the conclusion
follows immediately.
\end{proof}

\subsection{Extension of quasi-coherent sheaves}
\label{subsection-extension-of-qcoh}

\begin{env}[9.4.1]
\label{env-1.9.4.1}
Let
\oldpage{174}
$X$ be a topological space, $\sh{F}$ a sheaf of sets (resp. of groups, of rings) on $X$, $U$
an open subset of $X$, $\psi:U\to X$ the canonical injection, and $\sh{G}$ a subsheaf of
$\sh{F}|U=\psi^*(\sh{F})$. Since $\psi_*$ is left exact, $\psi_*(\sh{G})$ is a subsheaf of
$\psi_*(\psi^*(\sh{F}))$; if we denote by $\rho$ the canonical homomorphism
$\sh{F}\to\psi_*(\psi^*(\sh{F}))$ \hyperref[env-0.3.5.3]{(\textbf{0},~3.5.3)}, then we denote by $\overline{\sh{G}}$
the subsheaf $\rho^{-1}(\psi_*(\sh{G}))$ of $\sh{F}$. It follows immediately from the
definitions that, for every open subset $V$ of $X$, $\Gamma(V,\overline{\sh{G}})$ consists of
sections $s\in\Gamma(V,\sh{F})$ whose restriction to $V\cap U$ is a section of $\sh{G}$ over
$V\cap U$. We thus have that $\overline{\sh{G}}|U=\psi^*(\overline{\sh{G}})=\sh{G}$, and that
$\overline{\sh{G}}$ is the {\it biggest} subsheaf of $\sh{F}$ that restricts to $\sh{G}$
over $U$; we say that $\overline{\sh{G}}$ is the {\it canonical extension} of the subsheaf
$\sh{G}$ of $\sh{F}|U$ to a subsheaf of $\sh{F}$.
\end{env}

\begin{prop}[9.4.2]
\label{prop-1.9.4.2}
Let $X$ be a prescheme, $U$ an open subset of $X$ such that the canonical injection
$j:U\to X$ is a quasi-compact morphism {\it (which will be the case for {\it all} $U$ if
the underlying space of $X$ is {\it locally Noetherian}
\hyperref[env-1.6.6.4]{(6.6.4)}, (i))}. Then:
\begin{itemize}
  \item[{\rm(i)}] For every quasi-coherent $(\OO_X|U)$-module $\sh{G}$, $j_*(\sh{G})$
        is a quasi-coherent $\OO_X$-module, and $j_*(\sh{G})|U=j^*(j_*(\sh{G}))=\sh{G}$.
  \item[{\rm(ii)}] For every quasi-coherent $\OO_X$-module $\sh{F}$ and every quasi-coherent
        $(\OO_X|U)$-submodule $\sh{G}$, the canonical extension
        $\overline{\sh{G}}$ of $\sh{G}$ \hyperref[env-1.9.4.1]{(9.4.1)} is a
        quasi-coherent $\OO_X$-submodule of $\sh{F}$.
\end{itemize}
\end{prop}

\begin{proof}
\label{proof-prop-1.9.4.2}
If $j=(\psi,\theta)$ ($\psi$ being the injection $U\to X$ of underlying spaces), then by
definition we have that $j_*(\sh{G})=\psi_*(\sh{G})$ for every $(\OO_X|U)$-module $\sh{G}$,
and, further, that $j^*(\sh{H})=\psi^*(\sh{H})=\sh{H}|U$ for every $\OO_X$-module $\sh{H}$,
by definition of the prescheme induced over an open subset. So (i) is thus a particular case
of (\hyperref[cor-1.9.2.2]{(9.2.2)}, (a)); for the same reason, $j_*(j^*(\sh{F}))$ is quasi-coherent, and
since $\overline{\sh{G}}$ is the inverse image of $j_*(\sh{G})$ by the homomorphism
$\rho:\sh{F}\to j_*(j^*(\sh{F}))$, (ii) follows from \hyperref[env-1.4.1.1]{(4.1.1)}.
\end{proof}

Note that the hypothesis that the morphism $j:U\to X$ is quasi-compact
holds whenever the open subset $U$ is {\it quasi-compact} and $X$ is a
{\it scheme}: indeed, $U$ is then a union of finitely-many affine opens $U_i$,
and for every affine open $V$ of $X$, $V\cap U_i$ is an affine open \hyperref[env-1.5.5.6]{(5.5.6)}, and
thus quasi-compact.

\begin{cor}[9.4.3]
\label{cor-1.9.4.3}
Let $X$ be a prescheme, $U$ a quasi-compact open subset of $X$ such that the injection
morphism $j:U\to X$ is quasi-compact. Suppose as well that every quasi-coherent
$\OO_X$-module is the inductive limit of its quasi-coherent $\OO_X$-submodules of finite type
{\it (which will be the case if $X$ is an {\it affine scheme})}. Then let $\sh{F}$ be a
quasi-coherent $\OO_X$-module, and $\sh{G}$ a quasi-coherent $(\OO_X|U)$-submodule {\it of
finite type} of $\sh{F}|U$. Then there exists a quasi-coherent $\OO_X$-submodule $\sh{G}'$ of
$\sh{F}$ {\it of finite type} such that $\sh{G}'|U=\sh{G}$.
\end{cor}

\begin{proof}
\label{proof-cor-1.9.4.3}
We have $\sh{G}=\overline{\sh{G}}|U$, and $\overline{\sh{G}}$ is quasi-coherent, from
\hyperref[prop-1.9.4.2]{(9.4.2)}, and so the inductive limit of its quasi-coherent $\OO_X$-submodules
$\sh{H}_\lambda$ of finite type. It follows that $\sh{G}$ is the inductive limit of the
$\sh{H}_\lambda|U$, and thus equal to one of the $\sh{H}_\lambda|U$ since it is of finite
type \hyperref[env-0.5.2.3]{(\textbf{0},~5.2.3)}.
\end{proof}

\begin{rmk}[9.4.4]
\label{rmk-1.9.4.4}
Suppose that for {\it every} affine open $U\subset X$, the injection morphism $U\to X$ is
quasi-compact. Then, if the conclusion of \hyperref[cor-1.9.4.3]{(9.4.3)} holds for every affine open $U$
and every quasi-coherent $(\OO_X|U)$-submodule $\sh{G}$ of $\sh{F}|U$ of finite type, it
follows
\oldpage{175}
that $\sh{F}$ is the inductive limit of its quasi-coherent $\OO_X$-submodules of finite type.
Indeed, for every affine open $U\subset X$, we have that $\sh{F}|U=\widetilde{M}$, where $M$
is an $A(U)$-module, and since the latter is the inductive limit of its quasi-coherent
submodules of finite type, $\sh{F}|U$ is the inductive limit of its $(\OO_X|U)$-submodules of
finite type \hyperref[cor-1.1.3.9]{(1.3.9)}. But, by hypothesis, each of these submodules is induced on $U$
by a quasi-coherent $\OO_X$-submodule $\sh{G}_{\lambda,U}$ of $\sh{F}$ of finite type. The
finite sums of the $\sh{G}_{\lambda,U}$ are again quasi-coherent $\OO_X$-modules of finite
type, because the property is local, and the case where $X$ is affine was covered in
\hyperref[env-1.1.3.10]{(1.3.10)}; it is clear then that $\sh{F}$ is the inductive limit of these finite
sums, whence our claim.
\end{rmk}

\begin{cor}[9.4.5]
\label{cor-1.9.4.5}
Under the hypotheses of Corollary \hyperref[cor-1.9.4.3]{(9.4.3)}, for every quasi-coherent $(\OO_X|U)$-module
$\sh{G}$ of finite type, there exists a quasi-coherent $\OO_X$-module $\sh{G}'$ of finite
type such that $\sh{G}'|U=\sh{G}$.
\end{cor}

\begin{proof}
\label{proof-cor-1.9.4.5}
Since $\sh{F}=j_*(\sh{G})$ is quasi-coherent \hyperref[prop-1.9.4.2]{(9.4.2)} and $\sh{F}|U=\sh{G}$, it
suffices to apply Corollary \hyperref[cor-1.9.4.3]{(9.4.3)} to $\sh{F}$.
\end{proof}

\begin{lem}[9.4.6]
\label{lem-1.9.4.6}
Let $X$ be a prescheme, $L$ a well-ordered set, $(V_\lambda)_{\lambda\in L}$ a cover of $X$
by affine opens, and $U$ an open subset of $X$; for all $\lambda\in L$, we set
$W_\lambda=\bigcup_{\mu<\lambda}V_\mu$. Suppose that: (1) for every $\lambda\in L$,
$V_\lambda\cap W_\lambda$ is quasi-compact; (2) the immersion morphism $U\to X$ is
quasi-compact. Then, for every quasi-coherent $\OO_X$-module $\sh{F}$ and every
quasi-coherent $(\OO_X|U)$-submodule $\sh{G}$ of $\sh{F}|U$ {\it of finite type}, there
exists a quasi-coherent $\OO_X$-submodule $\sh{G}'$ of $\sh{F}$ {\it of finite type} such
that $\sh{G}'|U=\sh{G}$.
\end{lem}

\begin{proof}
\label{proof-lem-1.9.4.6}
Let $U_\lambda=U\cup W_\lambda$; we will define a family $(\sh{G}'_\lambda)$ by induction,
where $\sh{G}'_\lambda$ is a quasi-coherent $(\OO_X|U_\lambda)$-submodule of
$\sh{F}|U_\lambda$ of finite type, such that $\sh{G}'_\lambda|U_\mu=\sh{G}'_\mu$ for
$\mu<\lambda$ and $\sh{G}'_\lambda|U=\sh{G}$. The unique $\OO_X$-submodule $\sh{G}'$ of
$\sh{F}$ such that $\sh{G}'|U_\lambda=\sh{G}'$ for all $\lambda\in L$ \hyperref[env-0.3.3.1]{(\textbf{0},~3.3.1)} gives
us what we want. So suppose that the $\sh{G}'_\mu$ are defined and have the preceding
properties for $\mu<\lambda$; if $\lambda$ does not have a predecessor then we take for
$\sh{G}'_\lambda$ the unique $(\OO_X|U_\lambda)$-submodule of $\sh{F}|U_\lambda$ such that
$\sh{G}'_\lambda|U_\mu=\sh{G}'_\mu$ for all $\mu<\lambda$, which is allowed since the $U_\mu$
with $\mu<\lambda$ then form a cover of $U_\lambda$. If, conversely, $\lambda=\mu+1$, then
$U_\lambda=U_\mu\cup V_\mu$, and it suffices to define a quasi-coherent
$(\OO_X|V_\mu)$-submodule $\sh{G}''_\mu$ of $\sh{F}|V_\mu$ of finite type such that
\[
  \sh{G}''_\mu|(U_\mu\cap V_\mu)=\sh{G}'_\mu|(U_\mu\cap V_\mu);
\]
and then to take for $\sh{G}'_\lambda$ the $(\OO_X|U_\lambda)$-submodule of
$\sh{F}|U_\lambda$ such that $\sh{G}'_\lambda|U_\mu=\sh{G}'_\mu$ and
$\sh{G}'_\lambda|V_\mu=\sh{G}''_\mu$ \hyperref[env-0.3.3.1]{(\textbf{0},~3.3.1)}. But, since $V_\mu$ is affine, the
existence of $\sh{G}''_\mu$ is guaranteed by \hyperref[cor-1.9.4.3]{(9.4.3)} as soon as we show that
$U_\mu\cap V_\mu$ is quasi-compact; but $U_\mu\cap V_\mu$ is the union of $U\cap V_\mu$ and
$W_\mu\cap V_\mu$, which are both quasi-compact by virtue of the hypothesis.
\end{proof}

\begin{thm}[9.4.7]
\label{thm-1.9.4.7}
Let $X$ be a prescheme, and $U$ an open set of $X$. Suppose that one of the following
conditions is verified:
\begin{itemize}
  \item[{\rm(a)}] the underlying space of $X$ is locally Noetherian;
  \item[{\rm(b)}] $X$ is a quasi-compact scheme and $U$ is a quasi-compact open.
\end{itemize}
Then, for every quasi-coherent $\OO_X$-module $\sh{F}$ and every quasi-coherent
$(\OO_X|U)$-submodule $\sh{G}$ of $\sh{F}|U$ {\it of finite type}, there exists a
quasi-coherent $\OO_X$-submodule $\sh{G}'$ of $\sh{F}$ {\it of finite type} such that
$\sh{G}'|U=\sh{G}$.
\end{thm}

\begin{proof}
\label{proof-thm-1.9.4.7}
Let
\oldpage{176}
$(V_\lambda)_{\lambda\in L}$ be a cover of $X$ by affine opens, with $L$ assumed to be finite
in case (b); since $L$ is equipped with the structure of a well-ordered set, it suffices to
check that the conditions of \hyperref[lem-1.9.4.6]{(9.4.6)} are satisfied. It is clear in the case of (a),
as the spaces $V_\lambda$ are Noetherian. For case (b), the $V_\lambda\cap\lambda_\mu$ are
affine \hyperref[env-1.5.5.6]{(5.5.6)}, and thus quasi-compact, and since $L$ is finite,
$V_\lambda\cap W_\lambda$ is quasi-compact. Whence the theorem.
\end{proof}

\begin{cor}[9.4.8]
\label{cor-1.9.4.8}
Under the hypotheses of \hyperref[thm-1.9.4.7]{(9.4.7)}, for every quasi-coherent $(\OO_X|U)$-module
$\sh{G}$ of finite type, there exists a quasi-coherent $\OO_X$-module $\sh{G}'$ of finite
type such that $\sh{G}'|U=\sh{G}$.
\end{cor}

\begin{proof}
\label{proof-cor-1.9.4.8}
It suffices to apply \hyperref[thm-1.9.4.7]{(9.4.7)} to $\sh{F}=j_*(\sh{G})$, which is quasi-coherent
\hyperref[prop-1.9.4.2]{(9.4.2)} and such that $\sh{F}|U=\sh{G}$.
\end{proof}

\begin{cor}[9.4.9]
\label{cor-1.9.4.9}
Let $X$ be a prescheme whose underlying space is locally Noetherian, or a quasi-compact
scheme. Then every quasi-coherent $\OO_X$-module is the inductive limit of its quasi-coherent
$\OO_X$-submodules of finite type.
\end{cor}

\begin{proof}
\label{proof-cor-1.9.4.9}
This follows from Theorem \hyperref[thm-1.9.4.7]{(9.4.7)} and Remark \hyperref[rmk-1.9.4.4]{(9.4.4)}.
\end{proof}

\begin{cor}[9.4.10]
\label{cor-1.9.4.10}
Under the hypotheses of \hyperref[cor-1.9.4.9]{(9.4.9)}, if a quasi-coherent $\OO_X$-module $\sh{F}$ is
such that every quasi-coherent $\OO_X$-submodule of finite type of $\sh{F}$ is generated by
its sections over $X$, then $\sh{F}$ is generated by its sections over $X$.
\end{cor}

\begin{proof}
\label{proof-cor-1.9.4.10}
Let $U$ be an affine open neighbourhood of a point $x\in X$, and let $s$ be a
section of $\sh{F}$ over $U$; the $\OO_X$-submodule $\sh{G}$ of $\sh{F}|U$ generated by $s$
is quasi-coherent and of finite type, so there exists a quasi-coherent $\OO_X$-submodule
$\sh{G}'$ of $\sh{F}$ of finite type such that $\sh{G}'|U=\sh{G}$ \hyperref[thm-1.9.4.7]{(9.4.7)}. By
hypothesis, there is thus a finite number of sections $t_i$ of $\sh{G}'$ over $X$ and of
sections $a_i$ of $\OO_X$ over a neighbourhood $V\subset U$ of $x$ such that
$s|V=\sum_i a_i(t_i|V)$, which proves the corollary.
\end{proof}

\subsection{Closed image of a prescheme; closure of a subprescheme}
\label{subsection-closed-image-and-closure}

\begin{prop}[9.5.1]
\label{prop-1.9.5.1}
Let $f:X\to Y$ be a morphism of preschemes such that $f_*(\OO_X)$ is a quasi-coherent
$\OO_Y$-module (which will be the case if $f$ is quasi-compact and if in addition $f$ is
either separated or $X$ is locally Noetherian \hyperref[cor-1.9.2.2]{(9.2.2)}). Then there exists a smaller
subprescheme $Y'$ of $Y$ such that $f$ factors through the canonical injection $j:Y'\to Y$
({\it or, equivalently \hyperref[prop-1.4.4.1]{(4.4.1)}, such that the subprescheme $f^{-1}(Y')$ of $X$ is
{\it identical} to $X$}).
\end{prop}

More precisely:
\begin{cor}[9.5.2]
\label{cor-1.9.5.2}
Under the conditions of \hyperref[prop-1.9.5.1]{(9.5.1)}, let $f=(\psi,\theta)$, and let $\sh{J}$ be the
(quasi-coherent) kernel of the homomorphism $\theta:\OO_Y\to f_*(\OO_X)$. Then the closed
subprescheme $Y'$ of $Y$ defined by $\sh{J}$ satisfies the conditions of \hyperref[prop-1.9.5.1]{(9.5.1)}.
\end{cor}

\begin{proof}
\label{proof-cor-1.9.5.2}
Since the functor $\psi^*$ is exact, the canonical factorization
$\theta:\OO_Y\to\OO_Y/\sh{J}\xrightarrow{\theta'}\psi_*(\OO_X)$ gives (\textbf{0},~3.5.4.3)
a factorization
$\theta^\sharp:\psi^*(\OO_Y)\to\psi^*(\OO_Y)/\psi^*(\sh{J})
  \xrightarrow{{\theta'}^\sharp}\OO_X$; since $\theta_x^\sharp$ is a local homomorphism for
every $x\in X$, the same is true of ${\theta_x'}^\sharp$; if we denote by $\psi_0$ the
continuous map $\psi$ considered as a map from $X$ to $X'$, and by $\theta_0$ the restriction
$\theta'|X':(\OO_Y/\sh{J})|X'\to\psi_*(\OO_X)|X'=(\psi_0)_*(\OO_X)$, we see that
$f_0=(\psi_0,\theta_0)$ is a morphism of preschemes $X\to X'$ \hyperref[defn-1.2.2.1]{(2.2.1)} such that
$f=j\circ f_0$. Now, if $X''$ is
\oldpage{177}
a second closed subprescheme of $Y$, defined by a quasi-coherent sheaf of ideals $\sh{J}'$ of
$\OO_Y$, such that $f$ factors through the injection $j':X''\to Y$, then we should
immediately have that $\psi(X)\subset X''$, and so $X'\subset X''$, since $X''$ is closed.
Furthermore, for all $y\in X''$, $\theta$ should factorize as
$\OO_y\to\OO_y/\sh{J}'_y\to(\psi_*(\OO_X))_y$, which by definition leads to
$\sh{J}'_y\subset\sh{J}_y$, and thus $X'$ is a closed subprescheme of $X''$
\hyperref[cor-1.4.1.10]{(4.1.10)}.
\end{proof}

\begin{defn}[9.5.3]
\label{defn-1.9.5.3}
Whenever there exists a smaller subprescheme $Y'$ of $Y$ such that $f$ factors
through the canonical injection $j:Y'\to Y$, we say that $Y'$ is the
{\it closed image} prescheme of $X$ under the morphism $f$.
\end{defn}

\begin{prop}[9.5.4]
\label{prop-1.9.5.4}
If $f_*(\OO_X)$ is a quasi-coherent $\OO_Y$-module, then the underlying space of
the closed image of $X$ under $f$ is the closure $\overline{f(X)}$ in $Y$.
\end{prop}

\begin{proof}
\label{proof-prop-1.9.5.4}
As the support of $f_*(\OO_X)$ is contained in $\overline{f(X)}$, we have (with
the notation of \hyperref[cor-1.9.5.2]{(9.5.2)}) $\sh{J}_y=\OO_y$ for
$y\not\in\overline{f(X)}$, thus the support of $\OO_Y/\sh{J}$ is contained in
$\overline{f(X)}$. In addition, this support is closed and contains $f(X)$:
indeed, if $y\in f(X)$, the unit element of the ring $(\psi_*(\OO_X))_y$ is not
zero, being the germ at $y$ of the section
\[
  1\in\Gamma(X,\OO_X)=\Gamma(Y,\psi_*(\OO_X));
\]
as it is the image under $\theta$ of the unit element of $\OO_y$, the latter
does not belong to $\sh{J}_y$, hence $\OO_y/\sh{J}_y\neq 0$; this finishes the
proof.
\end{proof}

\begin{prop}[9.5.5]
\label{prop-1.9.5.5}
{\it (Transitivity of closed images)}. Let $f:X\to Y$ and $g:Y\to Z$ be two morphisms of
preschemes; we suppose that the closed image $Y'$ of $X$ under $f$ exists, and that if $g'$
is the restriction of $g$ to $Y'$, then the closed image $Z'$ of $Y'$ under $g'$ exists. Then
the closed image of $X$ under $g\circ f$ exists and is equal to $Z'$.
\end{prop}

\begin{proof}
\label{proof-prop-1.9.5.5}
It suffices \hyperref[prop-1.9.5.1]{(9.5.1)} to show that $Z'$ is the smallest closed
subprescheme $Z_1$ of $Z$ such that the closed subprescheme $(g\circ f)^{-1}(Z_1)$ of $X$
(equal to $f^{-1}(g^{-1}(Z_1))$ by Corollary \hyperref[cor-1.4.4.2]{(4.4.2)}) is equal to
$X$; it is equivalent to say that $Z'$ is the smallest closed subprescheme of $Z$ such that
$f$ \unsure{factors} through the injection $g^{-1}(Z_1)\to Y$ \hyperref[prop-1.4.4.1]{(4.4.1)}. By
virtue of the existence of the closed image $Y'$, every $Z_1$ with this property is such
that $g^{-1}(Z_1)$ \unsure{factors} through $Y'$, which is equivalent to saying that $j^{-1}(g^{-1}(Z_1))=g'^{-1}(Z_1)=Y'$, denoting by $j$ the injection $Y'\to Y$.
By the definition of $Z'$, we indeed conclude that $Z'$ is the smallest closed
subprescheme of $Z$ satisfying the preceding condition.
\end{proof}

\begin{cor}[9.5.6]
\label{cor-1.9.5.6}
Let $f\colon X\to Y$ be an $S$-morphism such that $Y$ is the closed image of $X$ under $f$.
Let $Z$ be an $S$-scheme; if two $S$-morphisms $g_1$, $g_2$ from $Y$ to $Z$ are such that $g_1\circ f=g_2\circ f$ then $g_1=g_2$.
\end{cor}

\begin{proof}
\label{proof-cor-1.9.5.6}
Let $h=(g_1,g_2)_S\colon Y\to Z\times_S Z$; since the diagonal $T=\Delta_Z(Z)$ is a closed subprescheme of $Z\times_S Z$, $Y'=h^{-1}(T)$ is a closed subprescheme of $Y$ \hyperref[prop-1.4.4.1]{(4.4.1)}.
Let $u=g_1\circ f=g_2\circ f$; we then have, by definition of the product, $h'=h\circ f=(u,u)_S$, so $h\circ f=\Delta_Z\circ u$; since $\Delta_Z^{-1}(T)=Z$, we have $h'^{-1}(T)=u^{-1}(Z)=X$, so $f^{-1}(Y')=X$.
From this, we conclude \hyperref[prop-1.4.4.1]{(4.4.1)} that the canonical injection $Y'\to Y$ \unsure{factors} through $f$, so $Y'=Y$ by hypothesis; it then follows \hyperref[prop-1.4.4.1]{(4.4.1)} that $h$ factorises as $\Delta_Z\circ v$, where $v$ is a morphism $Y\to Z$, which implies that $g_1=g_2=v$.
\end{proof}

\begin{rmk}[9.5.7]
\label{rmk-1.9.5.7}
If $X$ and $Y$ are $S$-schemes, proposition~\hyperref[cor-1.9.5.6]{(9.5.6)} implies that, when\oldpage{178} $Y$ if the closed image of $X$ under $f$, $f$ is an {\it epimorphism} in the category of {\it $S$-schemes} (T,~1.1).
We will show in chapter~V that, conversely, if the closed image $Y'$ of $X$ under $f$ exists and if $f$ is an epimorphism of $S$-schemes, then we necessarily have $Y'=Y$.
\end{rmk}

\begin{prop}[9.5.8]
\label{prop-1.9.5.8}
Suppose that the hypotheses of \hyperref[prop-1.9.5.1]{(9.5.1)} are satisfied, and let $Y'$ be the closed image of $X$ under $f$.
For every open $V$ of $Y$, let $f_V\colon f^{-1}(V)\to V$ be the restriction of $f$; then the closed image of $f^{-1}(V)$ under $f_V$ in $V$ exists and is equal to the prescheme induced by $Y'$ on the open $V\cap Y'$ of $Y'$ {\it (said otherwise, to the subprescheme $\inf(V,Y)$) of $Y$ \hyperref[cor-1.4.4.3]{(4.4.3)}}.
\end{prop}

\begin{proof}
\label{proof-prop-1.9.5.8}
Let $X'=f^{-1}(V)$; since the direct image of $\OO_{X'}$ by $f_V$ is exactly the restriction of $f_*(\OO_X)$ to $V$, it is clear that the kernel $\sh{J}'$ of the homomorphism $\OO_V\to(f_V)_*(\OO_{X'})$ is the restriction of $\sh{J}$ to $V$, from where the proposition quickly follows.
\end{proof}

We will see that this result can be understood as saying that taking the closed image commutes with an extension $Y_1\to Y$ of the base prescheme, which is an {\it open immersion}.
We will see in Chapter~IV that it is the same for an extension $Y_1\to Y$ which is a {\it flat} morphism, provided that $f$ is separated and quasi-compact.

\begin{prop}[9.5.9]
\label{prop-1.9.5.9}
Let $f\colon X\to Y$ be a morphism such that the closed image $Y'$ of $X$ under $f$ exists.
\begin{enumerate}[(i)]
    \item If $X$ is reduced, then so too is $Y'$.
    \item If the hypotheses of (9.5.1) are satisfied and $X$ is irreducible (\emph{resp.} \unsure{integral}), then so too is $Y'$.
\end{enumerate}
\end{prop}

\begin{proof}
\label{proof-prop-1.9.5.9}
By hypothesis, the morphism $f$ factorizes as $X\xrightarrow{g}Y'\xrightarrow{j}Y$, where $j$ is the canonical injection.
As $X$ is reduced, $g$ factorizes as $X\xrightarrow{h}Y'_\mathrm{red}\xrightarrow{j'}Y'$, where $j'$ is the canonical injection \hyperref[prop-1.5.2.2]{(5.2.2)}, and it then follows from the definition of $Y'$ that $Y'_\mathrm{red}=Y'$.
If, further, the conditions of \hyperref[prop-1.5.9.1]{(9.5.1)} are satisfied, then it follows from \hyperref[prop-1.9.5.4]{(9.5.4)} that $f(X)$ is dense in $Y'$; if $X$ is irreducible, then so too is $Y'$ \hyperref[env-0.2.1.5]{(\textbf{0},~2.1.5)}.
The claim about integral preschemes follows from the conjunction of the two others.
\end{proof}

\begin{prop}[9.5.10]
\label{prop-1.9.5.10}
Let $Y$ be a subprescheme of a prescheme $X$, such that the canonical injection $i\colon Y\to X$ is a quasi-compact morphism.
Then there exists a smaller closed subprescheme $\overline{Y}$ of $X$ \unsure{containing} $Y$; its underlying space is the closure of that of $Y$; the latter is open in its closure, and the prescheme $Y$ is induced on this open by $\overline{Y}$.
\end{prop}

\begin{proof}
\label{proof-prop-1.9.5.10}
It suffices to apply \hyperref[prop-1.5.9.1]{(9.5.1)} to the injection $j$, which is separated \hyperref[prop-1.5.5.1]{(5.5.1)} and quasi-compact by hypothesis; \hyperref[prop-1.5.9.1]{(9.5.1)} thus proves the existence of $\overline{Y}$ and \hyperref[prop-1.5.9.4]{(9.5.4)} shows that its underlying space is the closure of $Y$ in $X$; since $Y$ is locally closed in $X$, it is open in $\overline{Y}$, and the last claim comes from \hyperref[prop-1.5.9.8]{(9.5.8)} applied to an open $V$ of $X$ such that $Y$ is closed in $V$.
\end{proof}

With the above notation, if the injection $V\to X$ is quasi-compact, and if $\sh{J}$ is the quasi-coherent sheaf of ideals of $\OO_X|V$ defining the closed subprescheme $Y$ of $V$, it follows from \hyperref[prop-1.9.5.1]{(9.5.1)} that the quasi-coherent sheaf of ideals of $\OO_X$ defining $\overline{Y}$ is the canonical extension \hyperref[env-1.9.4.1]{(9.4.1)} $\overline{\sh{J}}$ of $\sh{J}$, because it is evidently the biggest quasi-coherent subsheaf of ideals of $\OO_X$ inducing $\sh{J}$ on $V$.

\begin{cor}[9.5.11]
\label{cor-1.9.5.11}
Under\oldpage{179} the hypotheses of \hyperref[prop-1.9.5.10]{(9.5.10)}, every section of $\OO_{\overline{Y}}$ over an open $V$ of $\overline{Y}$ that is null on $V\cap Y$ is null.
\end{cor}

\begin{proof}
\label{proof-cor-1.9.5.11}
By \hyperref[prop-1.9.5.8]{(9.5.8)}, we can reduce to the case where $V=\overline{Y}$.
If we take into account that the sections of $\OO_{\overline{Y}}$ over $\overline{Y}$ canonically correspond to the $\overline{Y}$-sections of $\overline{Y}\otimes_Z Z[T]$ \hyperref[env-1.3.3.15]{(3.3.15)} and that the latter is separated over $\overline{Y}$, the corollary appears as a specific case of \hyperref[cor-1.9.5.6]{(9.5.6)}.
\end{proof}

When there exists a smaller closed subprescheme $Y$ of $X$ \unsure{containing} a subprescheme $Y$ of $X$, we say that $Y'$ is the {\it closure} of $Y$ in $X$, when it doesn't lead to any confusion.

\subsection{Quasi-coherent sheaves of algebras; change of structure sheaf}
\label{subsection-qcoh-algs-and-change-of-str-sheaf}

\begin{prop}[9.6.1]
\label{prop-1.9.6.1}
Let $X$ be a prescheme, $\sh{B}$ a quasi-coherent $\OO_X$-algebra \hyperref[env-0.5.1.3]{(\textbf{0},~5.1.3)}.
For a $\sh{B}$-module $\sh{F}$ to be quasi-coherent (on the ringed space $(X,\sh{B})$) it is necessary and sufficient that $\sh{F}$ be a quasi-coherent $\OO_X$-module.
\end{prop}

\begin{proof}
\label{proof-prop-1.9.6.1}
Since the question is a local one, we can assume $X$ to be affine, given by the ring $A$, and thus $\sh{B}=\widetilde{B}$, where $B$ is an $A$-algebra \hyperref[cor-1.1.4.3]{(1.4.3)}.
If $\sh{F}$ is quasi-coherent on the ringed space $(X,\sh{B})$ then we can also assume that $\sh{F}$ is the cokernel of a $\sh{B}$-homomorphism $\sh{B}^{(I)}\to\sh{B}^{(J)}$; since this homomorphism is also an $\OO_X$-homomorphism of $\OO_X$-modules, and $\sh{B}^{(I)}$ and $\sh{B}^{(J)}$ are quasi-coherent $\OO_X$-modules \hyperref[cor-1.1.3.9]{(1.3.9,~(ii))}, $\sh{F}$ is also a quasi-coherent $\OO_X$-module \hyperref[cor-1.1.3.9]{(1.3.9,~(i))}.

Conversely, if $\sh{F}$ is a quasi-coherent $\OO_X$-module, then $\sh{F}=\widetilde{M}$, where $M$ is a $B$-module \hyperref[cor-1.1.4.3]{(1.4.3)}; $M$ is isomorphic to the cokernel of a $B$-homomorphism $B^{(I)}\to B^{(J)}$, so $\sh{F}$ is a $\sh{B}$-module isomorphic to the cokernel of the corresponding homomorphism $\sh{B}^{(I)}\to\sh{B}^{(J)}$ \hyperref[env-1.1.3.13]{(1.3.13)}, which finishes the proof.
\end{proof}

In particular, if $\sh{F}$ and $\sh{G}$ are two quasi-coherent $\sh{B}$-modules, $\sh{F}\otimes_{\sh{B}}\sh{G}$ is a quasi-coherent $\sh{B}$-module; similarly for $\shHom(\sh{F},\sh{G})$ whenever we further suppose that $\sh{F}$ admits a finite presentation \hyperref[env-1.1.3.13]{(1.3.13)}.

\begin{env}[9.6.2]
\label{env-1.9.6.2}
Given a prescheme $X$, we say that a quasi-coherent $\OO_X$-algebra $\sh{B}$ is of \emph{finite type} if, for all $x\in X$, there exists an open \emph{affine} neighbourhood $U$ of $x$ such that $\Gamma(U,\sh{B})=B$ is an algebra of finite type over $\Gamma(U,\OO_X)=A$.
We then have that $\sh{B}|U=\widetilde{B}$ and, for all $f\in A$, the induced $(\OO_X|D(f))$-algebra $\sh{B}|D(f)$ is of finite type, because it is isomorphic to $(B_f)^{\sim}$, and $B_f=B\otimes_A A_f$ is clearly an algebra of finite type over $A_f$.
Since the $D(f)$ form a basis of the topology of $U$, we thus conclude that if $\sh{B}$ is a quasi-coherent $\OO_X$-algebra of finite type then, for every open $V$ of $X$, $\sh{B}|V$ is a quasi-coherent $(\OO_X|V)$-algebra of finite type.
\end{env}

\begin{prop}[9.6.3]
\label{prop-1.9.6.3}
Let $X$ be a locally Noetherian prescheme.
Then every quasi-coherent $\OO_X$-algebra $\sh{B}$ of finite type is a coherent sheaf of rings \hyperref[env-0.5.3.7]{(\textbf{0},~5.3.7)}.
\end{prop}

\begin{proof}
\label{proof-prop-1.9.6.3}
We can once again restrict to the case where $X$ is an affine scheme given by a Noetherian ring $A$, and where $\sh{B}=\widetilde{B}$, $B$ being an $A$-algebra of finite type; $B$ is then a Noetherian ring.
With this, it remains to prove that the kernel $\sh{N}$ of a $\sh{B}$-homomorphism $\sh{B}^m\to\sh{B}$ is a $\sh{B}$-module\oldpage{180} of finite type; but it is isomorphic (as a $\sh{B}$-module) to $\widetilde{N}$, where $N$ is the kernel of the corresponding homomorphism of $B$-modules $B^m\to B$ \hyperref[env-1.1.3.13]{(1.3.13)}.
Since $B$ is Noetherian, the submodule $N$ of $B^m$ is a $B$-module of finite type, so there exists a homomorphism $B^p\to B^m$ with image $N$; since the sequence $B^p\to B^m\to B$ is exact, so too is the corresponding sequence $\sh{B}^p\to\sh{B}^m\to\sh{B}$ \hyperref[prop-1.1.3.5]{(1.3.5)} and since $\sh{N}$ is the image of $\sh{B}^p\to\sh{B}^m$ \hyperref[cor-1.1.3.9]{(1.3.9,~(i))}, the proposition is proved.
\end{proof}

\begin{cor}[9.6.4]
\label{cor-1.9.6.4}
Under the hypotheses of \hyperref[prop-1.9.6.3]{(9.6.3)}, for a $\sh{B}$-module $\sh{F}$ to be coherent, it is necessary and sufficient that it be a quasi-coherent $\OO_X$-module and a $\sh{B}$-module of finite type.
If this is the case, and if $\sh{G}$ is a sub-$\sh{B}$-module or a quotient module of $\sh{F}$, in order for $\sh{G}$ to be a coherent $\sh{B}$-module, it is necessary and sufficient that is be a quasi-coherent $\OO_X$-module.
\end{cor}

\begin{proof}
\label{proof-cor-1.9.6.4}
Taking into account \hyperref[prop-1.9.6.1]{(9.6.1)}, the conditions on $\sh{F}$ are clearly necessary; we will show that they are sufficient.
We can restrict to the case where $X$ is affine given by a Noetherian ring $A$, $\sh{B}=\widetilde{B}$, where $B$ is an $A$-algebra of finite type, $\sh{F}=\widetilde{M}$, where $M$ is a $B$-module, and where there exists a surjective $\sh{B}$-homomorphism $\sh{B}^m\to\sh{F}\to0$.
We then have the corresponding exact sequence $B^m\to M\to0$, so $M$ is a $B$-module of finite type; further, the kernel $P$ of the homomorphism $B^m\to M$ is then a $B$-module of finite type, since $B$ is Noetherian.
We thus conclude \hyperref[env-1.1.3.13]{(1.3.13)} that $\sh{F}$ is the cokernel of a $\sh{B}$-homomorphism $\sh{B}^m\to\sh{B}^n$, and is thus coherent, since $\sh{B}$ is a coherent sheaf of rings \hyperref[env-0.5.3.4]{(\textbf{0},~5.3.4)}.
The same reasoning shows that a quasi-coherent sub-$\sh{B}$-module (resp. a quotient $\sh{B}$-module) of $\sh{F}$ is of finite type, from whence the second part of the corollary.
\end{proof}

\begin{prop}[9.6.5]
\label{prop-1.9.6.5}
Let $X$ be a quasi-compact scheme or a prescheme whose underlying space is Noetherian.
For all quasi-compact $\OO_X$-algebras $\sh{B}$ of finite type, there exists a quasi-coherent sub-$\OO_X$-module $\sh{E}$ of $\sh{B}$ of finite type such that $\sh{E}$ generates \hyperref[env-0.4.1.4]{(\textbf{0},~4.1.4)} the $\OO_X$-algebra $\sh{B}$.
\end{prop}

\begin{proof}
\label{proof-prop-1.9.6.5}
In fact, by the hypothesis there exists a finite cover $(U_i)$ of $X$ consisting of open affines such that $\Gamma(U_i,\sh{B})=B_i$ is an algebra of finite type over $\Gamma(U_i,\OO_X)=A_i$; let $E_i$ be a sub$A_i$-module of $B_i$ of finite type that generates the $A_i$-algebra $B_i$; thanks to \hyperref[thm-1.9.4.7]{(9.4.7)}, there exists a sub-$\OO_X$-module $\sh{E}_i$ of $\sh{B}$, quasi-coherent and of finite type, such that $\sh{E}_i|U_i=\widetilde{E_i}$.
It is clear that the sum $\sh{E}$ of the $\sh{E}_i$ is the desired object.
\end{proof}

\begin{prop}[9.6.6]
\label{prop-1.9.6.6}
Let $X$ be a prescheme whose underlying space is locally Noetherian, or a quasi-compact scheme.
Then every quasi-coherent $\OO_X$-algebra $\sh{B}$ is the inductive limit of its quasi-coherent sub-$\OO_X$-algebras of finite type.
\end{prop}

\begin{proof}
\label{proof-prop-1.9.6.6}
In fact, it follows from \hyperref[cor-1.9.4.9]{(9.4.9)} that $\sh{B}$ is the inductive limit (as an $\OO_X$-module) of its quasi-coherent sub-$\OO_X$-modules of finite type; the latter generating quasi-coherent sub-$\OO_X$-\emph{algebras} of $\sh{B}$ of finite type \hyperref[env-1.1.3.14]{(1.3.14)}, and so $\sh{B}$ is a fortiori their inductive limit.
\end{proof}

\section{Formal schemes}
\label{section-formal-schemes}

\subsection{Formal affine schemes}
\label{subsection-formal-affine-schemes}

\begin{env}[10.1.1]
\label{env-1.10.1.1}
Let $A$ be an {\it admissible} topological ring \hyperref[defn-0.7.1.2]{(\textbf{0},~7.1.2)}; for each
ideal of definition $\mathfrak{J}$ of $A$, $\Spec(A/\mathfrak{J})$ identifies
with the closed subspace $V(\mathfrak{J})$ of $\Spec(A)$ \hyperref[prop-1.1.1.11]{(1.1.11)},
the set of {\it open} prime ideals of $A$; this topological space does not depend
\oldpage{181}
on the ideal of definition $\mathfrak{J}$ considered; we denote this topological
space by $\mathfrak{X}$. Let $(\mathfrak{J}_\lambda)$ be a fundamental system
of neighbourhoods of $0$ in $A$, consisting of ideals of definition, and for each
$\lambda$, let $\OO_\lambda$ be the structure sheaf of
$\Spec(A/\mathfrak{J}_\lambda)$; this sheaf is induced on $\mathfrak{X}$ by
$\widetilde{A}/\widetilde{\mathfrak{J}_\lambda}$ (which is zero outside of
$\mathfrak{X}$). For $\mathfrak{J}_\mu\subset\mathfrak{J}_\lambda$, the
canonical homomorphism $A/\mathfrak{J}_\mu\to A/\mathfrak{J}_\lambda$ thus
defines a homomorphism $u_{\lambda\mu}:\OO_\mu\to\OO_\lambda$ of sheaves of
rings \hyperref[env-1.1.6.1]{(1.6.1)}, and $(\OO_\lambda)$ is a {\it projective system of
sheaves of rings} for these homomorphisms. As the topology of $\mathfrak{X}$
admits a basis consisting of quasi-compact open subsets, we can associate to
each $\OO_\lambda$ a {\it sheaf of pseudo-discrete topological rings}
\hyperref[env-0.3.8.1]{(\textbf{0},~3.8.1)} which have $\OO_\lambda$ as the underlying (without topology) sheaf of rings, and that we denote also by $\OO_\lambda$; and the $\OO_\lambda$ give again a \emph{projective system of sheaves of topological rings} \hyperref[env-0.3.8.2]{(\textbf{0},~3.8.2)}.
We denote by $\OO_\mathfrak{X}$ the {\it sheaf of topological rings} on $\mathfrak{X}$, the
projective limit of the system $(\OO_\lambda)$; for each {\it quasi-compact} open subset $U$
of $\mathfrak{X}$, then $\Gamma(U,\OO_\mathfrak{X})$ is a topological ring, the projective
limit of the system of {\it discrete} rings $\Gamma(U,\OO_\lambda)$
\hyperref[env-0.3.2.6]{(3.2.6)}.
\end{env}

\begin{defn}[10.1.2]
\label{defn-1.10.1.2}
Given an admissible topological ring $A$, we define the formal spectrum of $A$, and denote
it by $\Spf(A)$, to be the closed subspace $\mathfrak{X}$ of $\Spec(A)$ consisting of the
open prime ideals of $A$. We say that a topologically ringed space is a formal affine scheme
if it is isomorphic to a formal spectrum $\Spf(A)=\mathfrak{X}$ equipped with a sheaf of
topological rings $\OO_\mathfrak{X}$ which is the projective limit of sheaves of
psuedo-discrete topological rings
$(\widetilde{A}/\widetilde{\mathfrak{J}_\lambda})|\mathfrak{X}$, where $\mathfrak{J}_\lambda$
varies over the filtered set of ideals of definition for $A$.
\end{defn}

When we speak of a {\it formal spectrum $\mathfrak{X}=\Spf(A)$} as a formal affine scheme,


\bibliography{the}
\bibliographystyle{amsalpha}

\end{document}
